(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();var xg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function il(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function Gd(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var s=a.default;if(typeof s=="function"){var n=function o(){var i=!1;try{i=this instanceof o}catch{}return i?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};n.prototype=s.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(a).forEach(function(o){var i=Object.getOwnPropertyDescriptor(a,o);Object.defineProperty(n,o,i.get?i:{enumerable:!0,get:function(){return a[o]}})}),n}var Fc={exports:{}},bo={},$c={exports:{}},it={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh;function yg(){if(yh)return it;yh=1;var a=Symbol.for("react.element"),s=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),u=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),f=Symbol.iterator;function x(B){return B===null||typeof B!="object"?null:(B=f&&B[f]||B["@@iterator"],typeof B=="function"?B:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,k={};function C(B,F,ue){this.props=B,this.context=F,this.refs=k,this.updater=ue||v}C.prototype.isReactComponent={},C.prototype.setState=function(B,F){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,F,"setState")},C.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function w(){}w.prototype=C.prototype;function j(B,F,ue){this.props=B,this.context=F,this.refs=k,this.updater=ue||v}var D=j.prototype=new w;D.constructor=j,N(D,C.prototype),D.isPureReactComponent=!0;var M=Array.isArray,I=Object.prototype.hasOwnProperty,_={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function Q(B,F,ue){var We,Ye={},Qe=null,Ne=null;if(F!=null)for(We in F.ref!==void 0&&(Ne=F.ref),F.key!==void 0&&(Qe=""+F.key),F)I.call(F,We)&&!A.hasOwnProperty(We)&&(Ye[We]=F[We]);var Pe=arguments.length-2;if(Pe===1)Ye.children=ue;else if(1<Pe){for(var pe=Array(Pe),Ce=0;Ce<Pe;Ce++)pe[Ce]=arguments[Ce+2];Ye.children=pe}if(B&&B.defaultProps)for(We in Pe=B.defaultProps,Pe)Ye[We]===void 0&&(Ye[We]=Pe[We]);return{$$typeof:a,type:B,key:Qe,ref:Ne,props:Ye,_owner:_.current}}function G(B,F){return{$$typeof:a,type:B.type,key:F,ref:B.ref,props:B.props,_owner:B._owner}}function re(B){return typeof B=="object"&&B!==null&&B.$$typeof===a}function le(B){var F={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(ue){return F[ue]})}var he=/\/+/g;function P(B,F){return typeof B=="object"&&B!==null&&B.key!=null?le(""+B.key):F.toString(36)}function L(B,F,ue,We,Ye){var Qe=typeof B;(Qe==="undefined"||Qe==="boolean")&&(B=null);var Ne=!1;if(B===null)Ne=!0;else switch(Qe){case"string":case"number":Ne=!0;break;case"object":switch(B.$$typeof){case a:case s:Ne=!0}}if(Ne)return Ne=B,Ye=Ye(Ne),B=We===""?"."+P(Ne,0):We,M(Ye)?(ue="",B!=null&&(ue=B.replace(he,"$&/")+"/"),L(Ye,F,ue,"",function(Ce){return Ce})):Ye!=null&&(re(Ye)&&(Ye=G(Ye,ue+(!Ye.key||Ne&&Ne.key===Ye.key?"":(""+Ye.key).replace(he,"$&/")+"/")+B)),F.push(Ye)),1;if(Ne=0,We=We===""?".":We+":",M(B))for(var Pe=0;Pe<B.length;Pe++){Qe=B[Pe];var pe=We+P(Qe,Pe);Ne+=L(Qe,F,ue,pe,Ye)}else if(pe=x(B),typeof pe=="function")for(B=pe.call(B),Pe=0;!(Qe=B.next()).done;)Qe=Qe.value,pe=We+P(Qe,Pe++),Ne+=L(Qe,F,ue,pe,Ye);else if(Qe==="object")throw F=String(B),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return Ne}function z(B,F,ue){if(B==null)return B;var We=[],Ye=0;return L(B,We,"","",function(Qe){return F.call(ue,Qe,Ye++)}),We}function ee(B){if(B._status===-1){var F=B._result;F=F(),F.then(function(ue){(B._status===0||B._status===-1)&&(B._status=1,B._result=ue)},function(ue){(B._status===0||B._status===-1)&&(B._status=2,B._result=ue)}),B._status===-1&&(B._status=0,B._result=F)}if(B._status===1)return B._result.default;throw B._result}var se={current:null},Y={transition:null},xe={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:Y,ReactCurrentOwner:_};function ce(){throw Error("act(...) is not supported in production builds of React.")}return it.Children={map:z,forEach:function(B,F,ue){z(B,function(){F.apply(this,arguments)},ue)},count:function(B){var F=0;return z(B,function(){F++}),F},toArray:function(B){return z(B,function(F){return F})||[]},only:function(B){if(!re(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},it.Component=C,it.Fragment=n,it.Profiler=i,it.PureComponent=j,it.StrictMode=o,it.Suspense=h,it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xe,it.act=ce,it.cloneElement=function(B,F,ue){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var We=N({},B.props),Ye=B.key,Qe=B.ref,Ne=B._owner;if(F!=null){if(F.ref!==void 0&&(Qe=F.ref,Ne=_.current),F.key!==void 0&&(Ye=""+F.key),B.type&&B.type.defaultProps)var Pe=B.type.defaultProps;for(pe in F)I.call(F,pe)&&!A.hasOwnProperty(pe)&&(We[pe]=F[pe]===void 0&&Pe!==void 0?Pe[pe]:F[pe])}var pe=arguments.length-2;if(pe===1)We.children=ue;else if(1<pe){Pe=Array(pe);for(var Ce=0;Ce<pe;Ce++)Pe[Ce]=arguments[Ce+2];We.children=Pe}return{$$typeof:a,type:B.type,key:Ye,ref:Qe,props:We,_owner:Ne}},it.createContext=function(B){return B={$$typeof:u,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:c,_context:B},B.Consumer=B},it.createElement=Q,it.createFactory=function(B){var F=Q.bind(null,B);return F.type=B,F},it.createRef=function(){return{current:null}},it.forwardRef=function(B){return{$$typeof:m,render:B}},it.isValidElement=re,it.lazy=function(B){return{$$typeof:b,_payload:{_status:-1,_result:B},_init:ee}},it.memo=function(B,F){return{$$typeof:y,type:B,compare:F===void 0?null:F}},it.startTransition=function(B){var F=Y.transition;Y.transition={};try{B()}finally{Y.transition=F}},it.unstable_act=ce,it.useCallback=function(B,F){return se.current.useCallback(B,F)},it.useContext=function(B){return se.current.useContext(B)},it.useDebugValue=function(){},it.useDeferredValue=function(B){return se.current.useDeferredValue(B)},it.useEffect=function(B,F){return se.current.useEffect(B,F)},it.useId=function(){return se.current.useId()},it.useImperativeHandle=function(B,F,ue){return se.current.useImperativeHandle(B,F,ue)},it.useInsertionEffect=function(B,F){return se.current.useInsertionEffect(B,F)},it.useLayoutEffect=function(B,F){return se.current.useLayoutEffect(B,F)},it.useMemo=function(B,F){return se.current.useMemo(B,F)},it.useReducer=function(B,F,ue){return se.current.useReducer(B,F,ue)},it.useRef=function(B){return se.current.useRef(B)},it.useState=function(B){return se.current.useState(B)},it.useSyncExternalStore=function(B,F,ue){return se.current.useSyncExternalStore(B,F,ue)},it.useTransition=function(){return se.current.useTransition()},it.version="18.3.1",it}var bh;function Kd(){return bh||(bh=1,$c.exports=yg()),$c.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh;function bg(){if(vh)return bo;vh=1;var a=Kd(),s=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(m,h,y){var b,f={},x=null,v=null;y!==void 0&&(x=""+y),h.key!==void 0&&(x=""+h.key),h.ref!==void 0&&(v=h.ref);for(b in h)o.call(h,b)&&!c.hasOwnProperty(b)&&(f[b]=h[b]);if(m&&m.defaultProps)for(b in h=m.defaultProps,h)f[b]===void 0&&(f[b]=h[b]);return{$$typeof:s,type:m,key:x,ref:v,props:f,_owner:i.current}}return bo.Fragment=n,bo.jsx=u,bo.jsxs=u,bo}var wh;function vg(){return wh||(wh=1,Fc.exports=bg()),Fc.exports}var e=vg(),q=Kd();const Jd=il(q);var Bi={},Uc={exports:{}},mr={},Bc={exports:{}},qc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jh;function wg(){return jh||(jh=1,(function(a){function s(Y,xe){var ce=Y.length;Y.push(xe);e:for(;0<ce;){var B=ce-1>>>1,F=Y[B];if(0<i(F,xe))Y[B]=xe,Y[ce]=F,ce=B;else break e}}function n(Y){return Y.length===0?null:Y[0]}function o(Y){if(Y.length===0)return null;var xe=Y[0],ce=Y.pop();if(ce!==xe){Y[0]=ce;e:for(var B=0,F=Y.length,ue=F>>>1;B<ue;){var We=2*(B+1)-1,Ye=Y[We],Qe=We+1,Ne=Y[Qe];if(0>i(Ye,ce))Qe<F&&0>i(Ne,Ye)?(Y[B]=Ne,Y[Qe]=ce,B=Qe):(Y[B]=Ye,Y[We]=ce,B=We);else if(Qe<F&&0>i(Ne,ce))Y[B]=Ne,Y[Qe]=ce,B=Qe;else break e}}return xe}function i(Y,xe){var ce=Y.sortIndex-xe.sortIndex;return ce!==0?ce:Y.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;a.unstable_now=function(){return c.now()}}else{var u=Date,m=u.now();a.unstable_now=function(){return u.now()-m}}var h=[],y=[],b=1,f=null,x=3,v=!1,N=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Y){for(var xe=n(y);xe!==null;){if(xe.callback===null)o(y);else if(xe.startTime<=Y)o(y),xe.sortIndex=xe.expirationTime,s(h,xe);else break;xe=n(y)}}function M(Y){if(k=!1,D(Y),!N)if(n(h)!==null)N=!0,ee(I);else{var xe=n(y);xe!==null&&se(M,xe.startTime-Y)}}function I(Y,xe){N=!1,k&&(k=!1,w(Q),Q=-1),v=!0;var ce=x;try{for(D(xe),f=n(h);f!==null&&(!(f.expirationTime>xe)||Y&&!le());){var B=f.callback;if(typeof B=="function"){f.callback=null,x=f.priorityLevel;var F=B(f.expirationTime<=xe);xe=a.unstable_now(),typeof F=="function"?f.callback=F:f===n(h)&&o(h),D(xe)}else o(h);f=n(h)}if(f!==null)var ue=!0;else{var We=n(y);We!==null&&se(M,We.startTime-xe),ue=!1}return ue}finally{f=null,x=ce,v=!1}}var _=!1,A=null,Q=-1,G=5,re=-1;function le(){return!(a.unstable_now()-re<G)}function he(){if(A!==null){var Y=a.unstable_now();re=Y;var xe=!0;try{xe=A(!0,Y)}finally{xe?P():(_=!1,A=null)}}else _=!1}var P;if(typeof j=="function")P=function(){j(he)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,z=L.port2;L.port1.onmessage=he,P=function(){z.postMessage(null)}}else P=function(){C(he,0)};function ee(Y){A=Y,_||(_=!0,P())}function se(Y,xe){Q=C(function(){Y(a.unstable_now())},xe)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(Y){Y.callback=null},a.unstable_continueExecution=function(){N||v||(N=!0,ee(I))},a.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<Y?Math.floor(1e3/Y):5},a.unstable_getCurrentPriorityLevel=function(){return x},a.unstable_getFirstCallbackNode=function(){return n(h)},a.unstable_next=function(Y){switch(x){case 1:case 2:case 3:var xe=3;break;default:xe=x}var ce=x;x=xe;try{return Y()}finally{x=ce}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(Y,xe){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ce=x;x=Y;try{return xe()}finally{x=ce}},a.unstable_scheduleCallback=function(Y,xe,ce){var B=a.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?B+ce:B):ce=B,Y){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ce+F,Y={id:b++,callback:xe,priorityLevel:Y,startTime:ce,expirationTime:F,sortIndex:-1},ce>B?(Y.sortIndex=ce,s(y,Y),n(h)===null&&Y===n(y)&&(k?(w(Q),Q=-1):k=!0,se(M,ce-B))):(Y.sortIndex=F,s(h,Y),N||v||(N=!0,ee(I))),Y},a.unstable_shouldYield=le,a.unstable_wrapCallback=function(Y){var xe=x;return function(){var ce=x;x=xe;try{return Y.apply(this,arguments)}finally{x=ce}}}})(qc)),qc}var Nh;function jg(){return Nh||(Nh=1,Bc.exports=wg()),Bc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh;function Ng(){if(Sh)return mr;Sh=1;var a=Kd(),s=jg();function n(t){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+t,l=1;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function c(t,r){u(t,r),u(t+"Capture",r)}function u(t,r){for(i[t]=r,t=0;t<r.length;t++)o.add(r[t])}var m=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},f={};function x(t){return h.call(f,t)?!0:h.call(b,t)?!1:y.test(t)?f[t]=!0:(b[t]=!0,!1)}function v(t,r,l,d){if(l!==null&&l.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function N(t,r,l,d){if(r===null||typeof r>"u"||v(t,r,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function k(t,r,l,d,p,g,T){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=p,this.mustUseProperty=l,this.propertyName=t,this.type=r,this.sanitizeURL=g,this.removeEmptyString=T}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){C[t]=new k(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var r=t[0];C[r]=new k(r,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){C[t]=new k(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){C[t]=new k(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){C[t]=new k(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){C[t]=new k(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){C[t]=new k(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){C[t]=new k(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){C[t]=new k(t,5,!1,t.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function j(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var r=t.replace(w,j);C[r]=new k(r,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var r=t.replace(w,j);C[r]=new k(r,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var r=t.replace(w,j);C[r]=new k(r,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){C[t]=new k(t,1,!1,t.toLowerCase(),null,!1,!1)}),C.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){C[t]=new k(t,1,!1,t.toLowerCase(),null,!0,!0)});function D(t,r,l,d){var p=C.hasOwnProperty(r)?C[r]:null;(p!==null?p.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(N(r,l,p,d)&&(l=null),d||p===null?x(r)&&(l===null?t.removeAttribute(r):t.setAttribute(r,""+l)):p.mustUseProperty?t[p.propertyName]=l===null?p.type===3?!1:"":l:(r=p.attributeName,d=p.attributeNamespace,l===null?t.removeAttribute(r):(p=p.type,l=p===3||p===4&&l===!0?"":""+l,d?t.setAttributeNS(d,r,l):t.setAttribute(r,l))))}var M=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),_=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),Q=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),re=Symbol.for("react.provider"),le=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),Y=Symbol.iterator;function xe(t){return t===null||typeof t!="object"?null:(t=Y&&t[Y]||t["@@iterator"],typeof t=="function"?t:null)}var ce=Object.assign,B;function F(t){if(B===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);B=r&&r[1]||""}return`
`+B+t}var ue=!1;function We(t,r){if(!t||ue)return"";ue=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(ae){var d=ae}Reflect.construct(t,[],r)}else{try{r.call()}catch(ae){d=ae}t.call(r.prototype)}else{try{throw Error()}catch(ae){d=ae}t()}}catch(ae){if(ae&&d&&typeof ae.stack=="string"){for(var p=ae.stack.split(`
`),g=d.stack.split(`
`),T=p.length-1,U=g.length-1;1<=T&&0<=U&&p[T]!==g[U];)U--;for(;1<=T&&0<=U;T--,U--)if(p[T]!==g[U]){if(T!==1||U!==1)do if(T--,U--,0>U||p[T]!==g[U]){var W=`
`+p[T].replace(" at new "," at ");return t.displayName&&W.includes("<anonymous>")&&(W=W.replace("<anonymous>",t.displayName)),W}while(1<=T&&0<=U);break}}}finally{ue=!1,Error.prepareStackTrace=l}return(t=t?t.displayName||t.name:"")?F(t):""}function Ye(t){switch(t.tag){case 5:return F(t.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return t=We(t.type,!1),t;case 11:return t=We(t.type.render,!1),t;case 1:return t=We(t.type,!0),t;default:return""}}function Qe(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case A:return"Fragment";case _:return"Portal";case G:return"Profiler";case Q:return"StrictMode";case P:return"Suspense";case L:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case le:return(t.displayName||"Context")+".Consumer";case re:return(t._context.displayName||"Context")+".Provider";case he:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case z:return r=t.displayName||null,r!==null?r:Qe(t.type)||"Memo";case ee:r=t._payload,t=t._init;try{return Qe(t(r))}catch{}}return null}function Ne(t){var r=t.type;switch(t.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=r.render,t=t.displayName||t.name||"",r.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qe(r);case 8:return r===Q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Pe(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pe(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Ce(t){var r=pe(t)?"checked":"value",l=Object.getOwnPropertyDescriptor(t.constructor.prototype,r),d=""+t[r];if(!t.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,g=l.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return p.call(this)},set:function(T){d=""+T,g.call(this,T)}}),Object.defineProperty(t,r,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(T){d=""+T},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Ie(t){t._valueTracker||(t._valueTracker=Ce(t))}function nt(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var l=r.getValue(),d="";return t&&(d=pe(t)?t.checked?"true":"false":t.value),t=d,t!==l?(r.setValue(t),!0):!1}function et(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Nt(t,r){var l=r.checked;return ce({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??t._wrapperState.initialChecked})}function He(t,r){var l=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;l=Pe(r.value!=null?r.value:l),t._wrapperState={initialChecked:d,initialValue:l,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function ct(t,r){r=r.checked,r!=null&&D(t,"checked",r,!1)}function pr(t,r){ct(t,r);var l=Pe(r.value),d=r.type;if(l!=null)d==="number"?(l===0&&t.value===""||t.value!=l)&&(t.value=""+l):t.value!==""+l&&(t.value=""+l);else if(d==="submit"||d==="reset"){t.removeAttribute("value");return}r.hasOwnProperty("value")?rn(t,r.type,l):r.hasOwnProperty("defaultValue")&&rn(t,r.type,Pe(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(t.defaultChecked=!!r.defaultChecked)}function fr(t,r,l){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+t._wrapperState.initialValue,l||r===t.value||(t.value=r),t.defaultValue=r}l=t.name,l!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,l!==""&&(t.name=l)}function rn(t,r,l){(r!=="number"||et(t.ownerDocument)!==t)&&(l==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+l&&(t.defaultValue=""+l))}var ls=Array.isArray;function Jr(t,r,l,d){if(t=t.options,r){r={};for(var p=0;p<l.length;p++)r["$"+l[p]]=!0;for(l=0;l<t.length;l++)p=r.hasOwnProperty("$"+t[l].value),t[l].selected!==p&&(t[l].selected=p),p&&d&&(t[l].defaultSelected=!0)}else{for(l=""+Pe(l),r=null,p=0;p<t.length;p++){if(t[p].value===l){t[p].selected=!0,d&&(t[p].defaultSelected=!0);return}r!==null||t[p].disabled||(r=t[p])}r!==null&&(r.selected=!0)}}function sn(t,r){if(r.dangerouslySetInnerHTML!=null)throw Error(n(91));return ce({},r,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nn(t,r){var l=r.value;if(l==null){if(l=r.children,r=r.defaultValue,l!=null){if(r!=null)throw Error(n(92));if(ls(l)){if(1<l.length)throw Error(n(93));l=l[0]}r=l}r==null&&(r=""),l=r}t._wrapperState={initialValue:Pe(l)}}function $n(t,r){var l=Pe(r.value),d=Pe(r.defaultValue);l!=null&&(l=""+l,l!==t.value&&(t.value=l),r.defaultValue==null&&t.defaultValue!==l&&(t.defaultValue=l)),d!=null&&(t.defaultValue=""+d)}function Aa(t){var r=t.textContent;r===t._wrapperState.initialValue&&r!==""&&r!==null&&(t.value=r)}function te(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xe(t,r){return t==null||t==="http://www.w3.org/1999/xhtml"?te(r):t==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ks,Un=(function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,l,d,p){MSApp.execUnsafeLocalFunction(function(){return t(r,l,d,p)})}:t})(function(t,r){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=r;else{for(ks=ks||document.createElement("div"),ks.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=ks.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;r.firstChild;)t.appendChild(r.firstChild)}});function _s(t,r){if(r){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=r;return}}t.textContent=r}var Yr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oa=["Webkit","ms","Moz","O"];Object.keys(Yr).forEach(function(t){Oa.forEach(function(r){r=r+t.charAt(0).toUpperCase()+t.substring(1),Yr[r]=Yr[t]})});function Bn(t,r,l){return r==null||typeof r=="boolean"||r===""?"":l||typeof r!="number"||r===0||Yr.hasOwnProperty(t)&&Yr[t]?(""+r).trim():r+"px"}function Ma(t,r){t=t.style;for(var l in r)if(r.hasOwnProperty(l)){var d=l.indexOf("--")===0,p=Bn(l,r[l],d);l==="float"&&(l="cssFloat"),d?t.setProperty(l,p):t[l]=p}}var Po=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cs(t,r){if(r){if(Po[t]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(n(137,t));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(n(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(n(61))}if(r.style!=null&&typeof r.style!="object")throw Error(n(62))}}function an(t,r){if(t.indexOf("-")===-1)return typeof r.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cs=null;function on(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qn=null,H=null,fe=null;function oe(t){if(t=so(t)){if(typeof qn!="function")throw Error(n(280));var r=t.stateNode;r&&(r=ri(r),qn(t.stateNode,t.type,r))}}function ne(t){H?fe?fe.push(t):fe=[t]:H=t}function Ee(){if(H){var t=H,r=fe;if(fe=H=null,oe(t),r)for(t=0;t<r.length;t++)oe(r[t])}}function ie(t,r){return t(r)}function qe(){}var Te=!1;function Ue(t,r,l){if(Te)return t(r,l);Te=!0;try{return ie(t,r,l)}finally{Te=!1,(H!==null||fe!==null)&&(qe(),Ee())}}function tt(t,r){var l=t.stateNode;if(l===null)return null;var d=ri(l);if(d===null)return null;l=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(t=t.type,d=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!d;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(n(231,r,typeof l));return l}var ze=!1;if(m)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){ze=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{ze=!1}function rt(t,r,l,d,p,g,T,U,W){var ae=Array.prototype.slice.call(arguments,3);try{r.apply(l,ae)}catch(be){this.onError(be)}}var yt=!1,at=null,Kt=!1,kr=null,Qr={onError:function(t){yt=!0,at=t}};function lt(t,r,l,d,p,g,T,U,W){yt=!1,at=null,rt.apply(Qr,arguments)}function de(t,r,l,d,p,g,T,U,W){if(lt.apply(this,arguments),yt){if(yt){var ae=at;yt=!1,at=null}else throw Error(n(198));Kt||(Kt=!0,kr=ae)}}function Ut(t){var r=t,l=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(l=r.return),t=r.return;while(t)}return r.tag===3?l:null}function Es(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function ln(t){if(Ut(t)!==t)throw Error(n(188))}function hl(t){var r=t.alternate;if(!r){if(r=Ut(t),r===null)throw Error(n(188));return r!==t?null:t}for(var l=t,d=r;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(d=p.return,d!==null){l=d;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return ln(p),t;if(g===d)return ln(p),r;g=g.sibling}throw Error(n(188))}if(l.return!==d.return)l=p,d=g;else{for(var T=!1,U=p.child;U;){if(U===l){T=!0,l=p,d=g;break}if(U===d){T=!0,d=p,l=g;break}U=U.sibling}if(!T){for(U=g.child;U;){if(U===l){T=!0,l=g,d=p;break}if(U===d){T=!0,d=g,l=p;break}U=U.sibling}if(!T)throw Error(n(189))}}if(l.alternate!==d)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?t:r}function La(t){return t=hl(t),t!==null?Ts(t):null}function Ts(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var r=Ts(t);if(r!==null)return r;t=t.sibling}return null}var cn=s.unstable_scheduleCallback,Io=s.unstable_cancelCallback,pl=s.unstable_shouldYield,Fa=s.unstable_requestPaint,St=s.unstable_now,fl=s.unstable_getCurrentPriorityLevel,Ds=s.unstable_ImmediatePriority,ar=s.unstable_UserBlockingPriority,Ps=s.unstable_NormalPriority,Ro=s.unstable_LowPriority,ds=s.unstable_IdlePriority,dn=null,_r=null;function gl(t){if(_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(dn,t,void 0,(t.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:Oo,zn=Math.log,Ao=Math.LN2;function Oo(t){return t>>>=0,t===0?32:31-(zn(t)/Ao|0)|0}var Hn=64,Wn=4194304;function un(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vn(t,r){var l=t.pendingLanes;if(l===0)return 0;var d=0,p=t.suspendedLanes,g=t.pingedLanes,T=l&268435455;if(T!==0){var U=T&~p;U!==0?d=un(U):(g&=T,g!==0&&(d=un(g)))}else T=l&~p,T!==0?d=un(T):g!==0&&(d=un(g));if(d===0)return 0;if(r!==0&&r!==d&&(r&p)===0&&(p=d&-d,g=r&-r,p>=g||p===16&&(g&4194240)!==0))return r;if((d&4)!==0&&(d|=l&16),r=t.entangledLanes,r!==0)for(t=t.entanglements,r&=d;0<r;)l=31-gr(r),p=1<<l,d|=t[l],r&=~p;return d}function Mo(t,r){switch(t){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Lo(t,r){for(var l=t.suspendedLanes,d=t.pingedLanes,p=t.expirationTimes,g=t.pendingLanes;0<g;){var T=31-gr(g),U=1<<T,W=p[T];W===-1?((U&l)===0||(U&d)!==0)&&(p[T]=Mo(U,r)):W<=r&&(t.expiredLanes|=U),g&=~U}}function Ar(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $a(){var t=Hn;return Hn<<=1,(Hn&4194240)===0&&(Hn=64),t}function Fo(t){for(var r=[],l=0;31>l;l++)r.push(t);return r}function mn(t,r,l){t.pendingLanes|=r,r!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,r=31-gr(r),t[r]=l}function cu(t,r){var l=t.pendingLanes&~r;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=r,t.mutableReadLanes&=r,t.entangledLanes&=r,r=t.entanglements;var d=t.eventTimes;for(t=t.expirationTimes;0<l;){var p=31-gr(l),g=1<<p;r[p]=0,d[p]=-1,t[p]=-1,l&=~g}}function Ua(t,r){var l=t.entangledLanes|=r;for(t=t.entanglements;l;){var d=31-gr(l),p=1<<d;p&r|t[d]&r&&(t[d]|=r),l&=~p}}var mt=0;function $o(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var Uo,Gn,Ba,hn,Bo,Kn=!1,pn=[],Or=null,Xr=null,Zr=null,Is=new Map,us=new Map,Mr=[],xl="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qo(t,r){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Zr=null;break;case"pointerover":case"pointerout":Is.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":us.delete(r.pointerId)}}function Rs(t,r,l,d,p,g){return t===null||t.nativeEvent!==g?(t={blockedOn:r,domEventName:l,eventSystemFlags:d,nativeEvent:g,targetContainers:[p]},r!==null&&(r=so(r),r!==null&&Gn(r)),t):(t.eventSystemFlags|=d,r=t.targetContainers,p!==null&&r.indexOf(p)===-1&&r.push(p),t)}function qa(t,r,l,d,p){switch(r){case"focusin":return Or=Rs(Or,t,r,l,d,p),!0;case"dragenter":return Xr=Rs(Xr,t,r,l,d,p),!0;case"mouseover":return Zr=Rs(Zr,t,r,l,d,p),!0;case"pointerover":var g=p.pointerId;return Is.set(g,Rs(Is.get(g)||null,t,r,l,d,p)),!0;case"gotpointercapture":return g=p.pointerId,us.set(g,Rs(us.get(g)||null,t,r,l,d,p)),!0}return!1}function za(t){var r=bn(t.target);if(r!==null){var l=Ut(r);if(l!==null){if(r=l.tag,r===13){if(r=Es(l),r!==null){t.blockedOn=r,Bo(t.priority,function(){Ba(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function fn(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var l=Va(t.domEventName,t.eventSystemFlags,r[0],t.nativeEvent);if(l===null){l=t.nativeEvent;var d=new l.constructor(l.type,l);Cs=d,l.target.dispatchEvent(d),Cs=null}else return r=so(l),r!==null&&Gn(r),t.blockedOn=l,!1;r.shift()}return!0}function gn(t,r,l){fn(t)&&l.delete(r)}function zo(){Kn=!1,Or!==null&&fn(Or)&&(Or=null),Xr!==null&&fn(Xr)&&(Xr=null),Zr!==null&&fn(Zr)&&(Zr=null),Is.forEach(gn),us.forEach(gn)}function xn(t,r){t.blockedOn===r&&(t.blockedOn=null,Kn||(Kn=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,zo)))}function es(t){function r(p){return xn(p,t)}if(0<pn.length){xn(pn[0],t);for(var l=1;l<pn.length;l++){var d=pn[l];d.blockedOn===t&&(d.blockedOn=null)}}for(Or!==null&&xn(Or,t),Xr!==null&&xn(Xr,t),Zr!==null&&xn(Zr,t),Is.forEach(r),us.forEach(r),l=0;l<Mr.length;l++)d=Mr[l],d.blockedOn===t&&(d.blockedOn=null);for(;0<Mr.length&&(l=Mr[0],l.blockedOn===null);)za(l),l.blockedOn===null&&Mr.shift()}var Wt=M.ReactCurrentBatchConfig,ms=!0;function Jn(t,r,l,d){var p=mt,g=Wt.transition;Wt.transition=null;try{mt=1,Wa(t,r,l,d)}finally{mt=p,Wt.transition=g}}function Ha(t,r,l,d){var p=mt,g=Wt.transition;Wt.transition=null;try{mt=4,Wa(t,r,l,d)}finally{mt=p,Wt.transition=g}}function Wa(t,r,l,d){if(ms){var p=Va(t,r,l,d);if(p===null)El(t,r,d,Yn,l),qo(t,d);else if(qa(p,t,r,l,d))d.stopPropagation();else if(qo(t,d),r&4&&-1<xl.indexOf(t)){for(;p!==null;){var g=so(p);if(g!==null&&Uo(g),g=Va(t,r,l,d),g===null&&El(t,r,d,Yn,l),g===p)break;p=g}p!==null&&d.stopPropagation()}else El(t,r,d,null,l)}}var Yn=null;function Va(t,r,l,d){if(Yn=null,t=on(d),t=bn(t),t!==null)if(r=Ut(t),r===null)t=null;else if(l=r.tag,l===13){if(t=Es(r),t!==null)return t;t=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null);return Yn=t,null}function Qn(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fl()){case Ds:return 1;case ar:return 4;case Ps:case Ro:return 16;case ds:return 536870912;default:return 16}default:return 16}}var ts=null,Xn=null,bt=null;function S(){if(bt)return bt;var t,r=Xn,l=r.length,d,p="value"in ts?ts.value:ts.textContent,g=p.length;for(t=0;t<l&&r[t]===p[t];t++);var T=l-t;for(d=1;d<=T&&r[l-d]===p[g-d];d++);return bt=p.slice(t,1<d?1-d:void 0)}function E(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function R(){return!0}function O(){return!1}function $(t){function r(l,d,p,g,T){this._reactName=l,this._targetInst=p,this.type=d,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var U in t)t.hasOwnProperty(U)&&(l=t[U],this[U]=l?l(g):g[U]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?R:O,this.isPropagationStopped=O,this}return ce(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=R)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=R)},persist:function(){},isPersistent:R}),r}var J={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},K=$(J),ge=ce({},J,{view:0,detail:0}),Ae=$(ge),ke,je,Be,ht=ce({},ge,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Be&&(Be&&t.type==="mousemove"?(ke=t.screenX-Be.screenX,je=t.screenY-Be.screenY):je=ke=0,Be=t),ke)},movementY:function(t){return"movementY"in t?t.movementY:je}}),Ot=$(ht),_e=ce({},ht,{dataTransfer:0}),Ze=$(_e),Le=ce({},ge,{relatedTarget:0}),kt=$(Le),or=ce({},J,{animationName:0,elapsedTime:0,pseudoElement:0}),Pt=$(or),Jt=ce({},J,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xr=$(Jt),hs=ce({},J,{data:0}),tr=$(hs),Ga={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ho={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wo(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=Ho[t])?!!r[t]:!1}function As(){return Wo}var yn=ce({},ge,{key:function(t){if(t.key){var r=Ga[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=E(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Zn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(t){return t.type==="keypress"?E(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?E(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ps=$(yn),Vo=ce({},ht,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yr=$(Vo),Go=ce({},ge,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),rs=$(Go),Ko=ce({},J,{propertyName:0,elapsedTime:0,pseudoElement:0}),yl=$(Ko),ss=ce({},ht,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Os=$(ss),Ka=[9,13,27,32],Ms=m&&"CompositionEvent"in window,Ls=null;m&&"documentMode"in document&&(Ls=document.documentMode);var h0=m&&"TextEvent"in window&&!Ls,du=m&&(!Ms||Ls&&8<Ls&&11>=Ls),uu=" ",mu=!1;function hu(t,r){switch(t){case"keyup":return Ka.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pu(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ea=!1;function p0(t,r){switch(t){case"compositionend":return pu(r);case"keypress":return r.which!==32?null:(mu=!0,uu);case"textInput":return t=r.data,t===uu&&mu?null:t;default:return null}}function f0(t,r){if(ea)return t==="compositionend"||!Ms&&hu(t,r)?(t=S(),bt=Xn=ts=null,ea=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return du&&r.locale!=="ko"?null:r.data;default:return null}}var g0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fu(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!g0[t.type]:r==="textarea"}function gu(t,r,l,d){ne(d),r=Zo(r,"onChange"),0<r.length&&(l=new K("onChange","change",null,l,d),t.push({event:l,listeners:r}))}var Ja=null,Ya=null;function x0(t){Au(t,0)}function Jo(t){var r=aa(t);if(nt(r))return t}function y0(t,r){if(t==="change")return r}var xu=!1;if(m){var bl;if(m){var vl="oninput"in document;if(!vl){var yu=document.createElement("div");yu.setAttribute("oninput","return;"),vl=typeof yu.oninput=="function"}bl=vl}else bl=!1;xu=bl&&(!document.documentMode||9<document.documentMode)}function bu(){Ja&&(Ja.detachEvent("onpropertychange",vu),Ya=Ja=null)}function vu(t){if(t.propertyName==="value"&&Jo(Ya)){var r=[];gu(r,Ya,t,on(t)),Ue(x0,r)}}function b0(t,r,l){t==="focusin"?(bu(),Ja=r,Ya=l,Ja.attachEvent("onpropertychange",vu)):t==="focusout"&&bu()}function v0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Jo(Ya)}function w0(t,r){if(t==="click")return Jo(r)}function j0(t,r){if(t==="input"||t==="change")return Jo(r)}function N0(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Lr=typeof Object.is=="function"?Object.is:N0;function Qa(t,r){if(Lr(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var l=Object.keys(t),d=Object.keys(r);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var p=l[d];if(!h.call(r,p)||!Lr(t[p],r[p]))return!1}return!0}function wu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ju(t,r){var l=wu(t);t=0;for(var d;l;){if(l.nodeType===3){if(d=t+l.textContent.length,t<=r&&d>=r)return{node:l,offset:r-t};t=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wu(l)}}function Nu(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?Nu(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function Su(){for(var t=window,r=et();r instanceof t.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)t=r.contentWindow;else break;r=et(t.document)}return r}function wl(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}function S0(t){var r=Su(),l=t.focusedElem,d=t.selectionRange;if(r!==l&&l&&l.ownerDocument&&Nu(l.ownerDocument.documentElement,l)){if(d!==null&&wl(l)){if(r=d.start,t=d.end,t===void 0&&(t=r),"selectionStart"in l)l.selectionStart=r,l.selectionEnd=Math.min(t,l.value.length);else if(t=(r=l.ownerDocument||document)&&r.defaultView||window,t.getSelection){t=t.getSelection();var p=l.textContent.length,g=Math.min(d.start,p);d=d.end===void 0?g:Math.min(d.end,p),!t.extend&&g>d&&(p=d,d=g,g=p),p=ju(l,g);var T=ju(l,d);p&&T&&(t.rangeCount!==1||t.anchorNode!==p.node||t.anchorOffset!==p.offset||t.focusNode!==T.node||t.focusOffset!==T.offset)&&(r=r.createRange(),r.setStart(p.node,p.offset),t.removeAllRanges(),g>d?(t.addRange(r),t.extend(T.node,T.offset)):(r.setEnd(T.node,T.offset),t.addRange(r)))}}for(r=[],t=l;t=t.parentNode;)t.nodeType===1&&r.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<r.length;l++)t=r[l],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var k0=m&&"documentMode"in document&&11>=document.documentMode,ta=null,jl=null,Xa=null,Nl=!1;function ku(t,r,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Nl||ta==null||ta!==et(d)||(d=ta,"selectionStart"in d&&wl(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Xa&&Qa(Xa,d)||(Xa=d,d=Zo(jl,"onSelect"),0<d.length&&(r=new K("onSelect","select",null,r,l),t.push({event:r,listeners:d}),r.target=ta)))}function Yo(t,r){var l={};return l[t.toLowerCase()]=r.toLowerCase(),l["Webkit"+t]="webkit"+r,l["Moz"+t]="moz"+r,l}var ra={animationend:Yo("Animation","AnimationEnd"),animationiteration:Yo("Animation","AnimationIteration"),animationstart:Yo("Animation","AnimationStart"),transitionend:Yo("Transition","TransitionEnd")},Sl={},_u={};m&&(_u=document.createElement("div").style,"AnimationEvent"in window||(delete ra.animationend.animation,delete ra.animationiteration.animation,delete ra.animationstart.animation),"TransitionEvent"in window||delete ra.transitionend.transition);function Qo(t){if(Sl[t])return Sl[t];if(!ra[t])return t;var r=ra[t],l;for(l in r)if(r.hasOwnProperty(l)&&l in _u)return Sl[t]=r[l];return t}var Cu=Qo("animationend"),Eu=Qo("animationiteration"),Tu=Qo("animationstart"),Du=Qo("transitionend"),Pu=new Map,Iu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fs(t,r){Pu.set(t,r),c(r,[t])}for(var kl=0;kl<Iu.length;kl++){var _l=Iu[kl],_0=_l.toLowerCase(),C0=_l[0].toUpperCase()+_l.slice(1);Fs(_0,"on"+C0)}Fs(Cu,"onAnimationEnd"),Fs(Eu,"onAnimationIteration"),Fs(Tu,"onAnimationStart"),Fs("dblclick","onDoubleClick"),Fs("focusin","onFocus"),Fs("focusout","onBlur"),Fs(Du,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Za));function Ru(t,r,l){var d=t.type||"unknown-event";t.currentTarget=l,de(d,r,void 0,t),t.currentTarget=null}function Au(t,r){r=(r&4)!==0;for(var l=0;l<t.length;l++){var d=t[l],p=d.event;d=d.listeners;e:{var g=void 0;if(r)for(var T=d.length-1;0<=T;T--){var U=d[T],W=U.instance,ae=U.currentTarget;if(U=U.listener,W!==g&&p.isPropagationStopped())break e;Ru(p,U,ae),g=W}else for(T=0;T<d.length;T++){if(U=d[T],W=U.instance,ae=U.currentTarget,U=U.listener,W!==g&&p.isPropagationStopped())break e;Ru(p,U,ae),g=W}}}if(Kt)throw t=kr,Kt=!1,kr=null,t}function vt(t,r){var l=r[Al];l===void 0&&(l=r[Al]=new Set);var d=t+"__bubble";l.has(d)||(Ou(r,t,2,!1),l.add(d))}function Cl(t,r,l){var d=0;r&&(d|=4),Ou(l,t,d,r)}var Xo="_reactListening"+Math.random().toString(36).slice(2);function eo(t){if(!t[Xo]){t[Xo]=!0,o.forEach(function(l){l!=="selectionchange"&&(E0.has(l)||Cl(l,!1,t),Cl(l,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Xo]||(r[Xo]=!0,Cl("selectionchange",!1,r))}}function Ou(t,r,l,d){switch(Qn(r)){case 1:var p=Jn;break;case 4:p=Ha;break;default:p=Wa}l=p.bind(null,r,l,t),p=void 0,!ze||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(p=!0),d?p!==void 0?t.addEventListener(r,l,{capture:!0,passive:p}):t.addEventListener(r,l,!0):p!==void 0?t.addEventListener(r,l,{passive:p}):t.addEventListener(r,l,!1)}function El(t,r,l,d,p){var g=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var T=d.tag;if(T===3||T===4){var U=d.stateNode.containerInfo;if(U===p||U.nodeType===8&&U.parentNode===p)break;if(T===4)for(T=d.return;T!==null;){var W=T.tag;if((W===3||W===4)&&(W=T.stateNode.containerInfo,W===p||W.nodeType===8&&W.parentNode===p))return;T=T.return}for(;U!==null;){if(T=bn(U),T===null)return;if(W=T.tag,W===5||W===6){d=g=T;continue e}U=U.parentNode}}d=d.return}Ue(function(){var ae=g,be=on(l),we=[];e:{var ye=Pu.get(t);if(ye!==void 0){var De=K,Oe=t;switch(t){case"keypress":if(E(l)===0)break e;case"keydown":case"keyup":De=ps;break;case"focusin":Oe="focus",De=kt;break;case"focusout":Oe="blur",De=kt;break;case"beforeblur":case"afterblur":De=kt;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=Ot;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=Ze;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=rs;break;case Cu:case Eu:case Tu:De=Pt;break;case Du:De=yl;break;case"scroll":De=Ae;break;case"wheel":De=Os;break;case"copy":case"cut":case"paste":De=xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=yr}var Me=(r&4)!==0,Dt=!Me&&t==="scroll",X=Me?ye!==null?ye+"Capture":null:ye;Me=[];for(var V=ae,Z;V!==null;){Z=V;var Se=Z.stateNode;if(Z.tag===5&&Se!==null&&(Z=Se,X!==null&&(Se=tt(V,X),Se!=null&&Me.push(to(V,Se,Z)))),Dt)break;V=V.return}0<Me.length&&(ye=new De(ye,Oe,null,l,be),we.push({event:ye,listeners:Me}))}}if((r&7)===0){e:{if(ye=t==="mouseover"||t==="pointerover",De=t==="mouseout"||t==="pointerout",ye&&l!==Cs&&(Oe=l.relatedTarget||l.fromElement)&&(bn(Oe)||Oe[fs]))break e;if((De||ye)&&(ye=be.window===be?be:(ye=be.ownerDocument)?ye.defaultView||ye.parentWindow:window,De?(Oe=l.relatedTarget||l.toElement,De=ae,Oe=Oe?bn(Oe):null,Oe!==null&&(Dt=Ut(Oe),Oe!==Dt||Oe.tag!==5&&Oe.tag!==6)&&(Oe=null)):(De=null,Oe=ae),De!==Oe)){if(Me=Ot,Se="onMouseLeave",X="onMouseEnter",V="mouse",(t==="pointerout"||t==="pointerover")&&(Me=yr,Se="onPointerLeave",X="onPointerEnter",V="pointer"),Dt=De==null?ye:aa(De),Z=Oe==null?ye:aa(Oe),ye=new Me(Se,V+"leave",De,l,be),ye.target=Dt,ye.relatedTarget=Z,Se=null,bn(be)===ae&&(Me=new Me(X,V+"enter",Oe,l,be),Me.target=Z,Me.relatedTarget=Dt,Se=Me),Dt=Se,De&&Oe)t:{for(Me=De,X=Oe,V=0,Z=Me;Z;Z=sa(Z))V++;for(Z=0,Se=X;Se;Se=sa(Se))Z++;for(;0<V-Z;)Me=sa(Me),V--;for(;0<Z-V;)X=sa(X),Z--;for(;V--;){if(Me===X||X!==null&&Me===X.alternate)break t;Me=sa(Me),X=sa(X)}Me=null}else Me=null;De!==null&&Mu(we,ye,De,Me,!1),Oe!==null&&Dt!==null&&Mu(we,Dt,Oe,Me,!0)}}e:{if(ye=ae?aa(ae):window,De=ye.nodeName&&ye.nodeName.toLowerCase(),De==="select"||De==="input"&&ye.type==="file")var $e=y0;else if(fu(ye))if(xu)$e=j0;else{$e=v0;var Ge=b0}else(De=ye.nodeName)&&De.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&($e=w0);if($e&&($e=$e(t,ae))){gu(we,$e,l,be);break e}Ge&&Ge(t,ye,ae),t==="focusout"&&(Ge=ye._wrapperState)&&Ge.controlled&&ye.type==="number"&&rn(ye,"number",ye.value)}switch(Ge=ae?aa(ae):window,t){case"focusin":(fu(Ge)||Ge.contentEditable==="true")&&(ta=Ge,jl=ae,Xa=null);break;case"focusout":Xa=jl=ta=null;break;case"mousedown":Nl=!0;break;case"contextmenu":case"mouseup":case"dragend":Nl=!1,ku(we,l,be);break;case"selectionchange":if(k0)break;case"keydown":case"keyup":ku(we,l,be)}var Ke;if(Ms)e:{switch(t){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else ea?hu(t,l)&&(st="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(st="onCompositionStart");st&&(du&&l.locale!=="ko"&&(ea||st!=="onCompositionStart"?st==="onCompositionEnd"&&ea&&(Ke=S()):(ts=be,Xn="value"in ts?ts.value:ts.textContent,ea=!0)),Ge=Zo(ae,st),0<Ge.length&&(st=new tr(st,t,null,l,be),we.push({event:st,listeners:Ge}),Ke?st.data=Ke:(Ke=pu(l),Ke!==null&&(st.data=Ke)))),(Ke=h0?p0(t,l):f0(t,l))&&(ae=Zo(ae,"onBeforeInput"),0<ae.length&&(be=new tr("onBeforeInput","beforeinput",null,l,be),we.push({event:be,listeners:ae}),be.data=Ke))}Au(we,r)})}function to(t,r,l){return{instance:t,listener:r,currentTarget:l}}function Zo(t,r){for(var l=r+"Capture",d=[];t!==null;){var p=t,g=p.stateNode;p.tag===5&&g!==null&&(p=g,g=tt(t,l),g!=null&&d.unshift(to(t,g,p)),g=tt(t,r),g!=null&&d.push(to(t,g,p))),t=t.return}return d}function sa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mu(t,r,l,d,p){for(var g=r._reactName,T=[];l!==null&&l!==d;){var U=l,W=U.alternate,ae=U.stateNode;if(W!==null&&W===d)break;U.tag===5&&ae!==null&&(U=ae,p?(W=tt(l,g),W!=null&&T.unshift(to(l,W,U))):p||(W=tt(l,g),W!=null&&T.push(to(l,W,U)))),l=l.return}T.length!==0&&t.push({event:r,listeners:T})}var T0=/\r\n?/g,D0=/\u0000|\uFFFD/g;function Lu(t){return(typeof t=="string"?t:""+t).replace(T0,`
`).replace(D0,"")}function ei(t,r,l){if(r=Lu(r),Lu(t)!==r&&l)throw Error(n(425))}function ti(){}var Tl=null,Dl=null;function Pl(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Il=typeof setTimeout=="function"?setTimeout:void 0,P0=typeof clearTimeout=="function"?clearTimeout:void 0,Fu=typeof Promise=="function"?Promise:void 0,I0=typeof queueMicrotask=="function"?queueMicrotask:typeof Fu<"u"?function(t){return Fu.resolve(null).then(t).catch(R0)}:Il;function R0(t){setTimeout(function(){throw t})}function Rl(t,r){var l=r,d=0;do{var p=l.nextSibling;if(t.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(d===0){t.removeChild(p),es(r);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=p}while(l);es(r)}function $s(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return t}function $u(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return t;r--}else l==="/$"&&r++}t=t.previousSibling}return null}var na=Math.random().toString(36).slice(2),ns="__reactFiber$"+na,ro="__reactProps$"+na,fs="__reactContainer$"+na,Al="__reactEvents$"+na,A0="__reactListeners$"+na,O0="__reactHandles$"+na;function bn(t){var r=t[ns];if(r)return r;for(var l=t.parentNode;l;){if(r=l[fs]||l[ns]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(t=$u(t);t!==null;){if(l=t[ns])return l;t=$u(t)}return r}t=l,l=t.parentNode}return null}function so(t){return t=t[ns]||t[fs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function aa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(n(33))}function ri(t){return t[ro]||null}var Ol=[],oa=-1;function Us(t){return{current:t}}function wt(t){0>oa||(t.current=Ol[oa],Ol[oa]=null,oa--)}function gt(t,r){oa++,Ol[oa]=t.current,t.current=r}var Bs={},Yt=Us(Bs),ir=Us(!1),vn=Bs;function ia(t,r){var l=t.type.contextTypes;if(!l)return Bs;var d=t.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var p={},g;for(g in l)p[g]=r[g];return d&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=p),p}function lr(t){return t=t.childContextTypes,t!=null}function si(){wt(ir),wt(Yt)}function Uu(t,r,l){if(Yt.current!==Bs)throw Error(n(168));gt(Yt,r),gt(ir,l)}function Bu(t,r,l){var d=t.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var p in d)if(!(p in r))throw Error(n(108,Ne(t)||"Unknown",p));return ce({},l,d)}function ni(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bs,vn=Yt.current,gt(Yt,t),gt(ir,ir.current),!0}function qu(t,r,l){var d=t.stateNode;if(!d)throw Error(n(169));l?(t=Bu(t,r,vn),d.__reactInternalMemoizedMergedChildContext=t,wt(ir),wt(Yt),gt(Yt,t)):wt(ir),gt(ir,l)}var gs=null,ai=!1,Ml=!1;function zu(t){gs===null?gs=[t]:gs.push(t)}function M0(t){ai=!0,zu(t)}function qs(){if(!Ml&&gs!==null){Ml=!0;var t=0,r=mt;try{var l=gs;for(mt=1;t<l.length;t++){var d=l[t];do d=d(!0);while(d!==null)}gs=null,ai=!1}catch(p){throw gs!==null&&(gs=gs.slice(t+1)),cn(Ds,qs),p}finally{mt=r,Ml=!1}}return null}var la=[],ca=0,oi=null,ii=0,Cr=[],Er=0,wn=null,xs=1,ys="";function jn(t,r){la[ca++]=ii,la[ca++]=oi,oi=t,ii=r}function Hu(t,r,l){Cr[Er++]=xs,Cr[Er++]=ys,Cr[Er++]=wn,wn=t;var d=xs;t=ys;var p=32-gr(d)-1;d&=~(1<<p),l+=1;var g=32-gr(r)+p;if(30<g){var T=p-p%5;g=(d&(1<<T)-1).toString(32),d>>=T,p-=T,xs=1<<32-gr(r)+p|l<<p|d,ys=g+t}else xs=1<<g|l<<p|d,ys=t}function Ll(t){t.return!==null&&(jn(t,1),Hu(t,1,0))}function Fl(t){for(;t===oi;)oi=la[--ca],la[ca]=null,ii=la[--ca],la[ca]=null;for(;t===wn;)wn=Cr[--Er],Cr[Er]=null,ys=Cr[--Er],Cr[Er]=null,xs=Cr[--Er],Cr[Er]=null}var br=null,vr=null,jt=!1,Fr=null;function Wu(t,r){var l=Ir(5,null,null,0);l.elementType="DELETED",l.stateNode=r,l.return=t,r=t.deletions,r===null?(t.deletions=[l],t.flags|=16):r.push(l)}function Vu(t,r){switch(t.tag){case 5:var l=t.type;return r=r.nodeType!==1||l.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(t.stateNode=r,br=t,vr=$s(r.firstChild),!0):!1;case 6:return r=t.pendingProps===""||r.nodeType!==3?null:r,r!==null?(t.stateNode=r,br=t,vr=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(l=wn!==null?{id:xs,overflow:ys}:null,t.memoizedState={dehydrated:r,treeContext:l,retryLane:1073741824},l=Ir(18,null,null,0),l.stateNode=r,l.return=t,t.child=l,br=t,vr=null,!0):!1;default:return!1}}function $l(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ul(t){if(jt){var r=vr;if(r){var l=r;if(!Vu(t,r)){if($l(t))throw Error(n(418));r=$s(l.nextSibling);var d=br;r&&Vu(t,r)?Wu(d,l):(t.flags=t.flags&-4097|2,jt=!1,br=t)}}else{if($l(t))throw Error(n(418));t.flags=t.flags&-4097|2,jt=!1,br=t}}}function Gu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;br=t}function li(t){if(t!==br)return!1;if(!jt)return Gu(t),jt=!0,!1;var r;if((r=t.tag!==3)&&!(r=t.tag!==5)&&(r=t.type,r=r!=="head"&&r!=="body"&&!Pl(t.type,t.memoizedProps)),r&&(r=vr)){if($l(t))throw Ku(),Error(n(418));for(;r;)Wu(t,r),r=$s(r.nextSibling)}if(Gu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(n(317));e:{for(t=t.nextSibling,r=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"){if(r===0){vr=$s(t.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++}t=t.nextSibling}vr=null}}else vr=br?$s(t.stateNode.nextSibling):null;return!0}function Ku(){for(var t=vr;t;)t=$s(t.nextSibling)}function da(){vr=br=null,jt=!1}function Bl(t){Fr===null?Fr=[t]:Fr.push(t)}var L0=M.ReactCurrentBatchConfig;function no(t,r,l){if(t=l.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(n(309));var d=l.stateNode}if(!d)throw Error(n(147,t));var p=d,g=""+t;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===g?r.ref:(r=function(T){var U=p.refs;T===null?delete U[g]:U[g]=T},r._stringRef=g,r)}if(typeof t!="string")throw Error(n(284));if(!l._owner)throw Error(n(290,t))}return t}function ci(t,r){throw t=Object.prototype.toString.call(r),Error(n(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}function Ju(t){var r=t._init;return r(t._payload)}function Yu(t){function r(X,V){if(t){var Z=X.deletions;Z===null?(X.deletions=[V],X.flags|=16):Z.push(V)}}function l(X,V){if(!t)return null;for(;V!==null;)r(X,V),V=V.sibling;return null}function d(X,V){for(X=new Map;V!==null;)V.key!==null?X.set(V.key,V):X.set(V.index,V),V=V.sibling;return X}function p(X,V){return X=Ys(X,V),X.index=0,X.sibling=null,X}function g(X,V,Z){return X.index=Z,t?(Z=X.alternate,Z!==null?(Z=Z.index,Z<V?(X.flags|=2,V):Z):(X.flags|=2,V)):(X.flags|=1048576,V)}function T(X){return t&&X.alternate===null&&(X.flags|=2),X}function U(X,V,Z,Se){return V===null||V.tag!==6?(V=Ic(Z,X.mode,Se),V.return=X,V):(V=p(V,Z),V.return=X,V)}function W(X,V,Z,Se){var $e=Z.type;return $e===A?be(X,V,Z.props.children,Se,Z.key):V!==null&&(V.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===ee&&Ju($e)===V.type)?(Se=p(V,Z.props),Se.ref=no(X,V,Z),Se.return=X,Se):(Se=Ri(Z.type,Z.key,Z.props,null,X.mode,Se),Se.ref=no(X,V,Z),Se.return=X,Se)}function ae(X,V,Z,Se){return V===null||V.tag!==4||V.stateNode.containerInfo!==Z.containerInfo||V.stateNode.implementation!==Z.implementation?(V=Rc(Z,X.mode,Se),V.return=X,V):(V=p(V,Z.children||[]),V.return=X,V)}function be(X,V,Z,Se,$e){return V===null||V.tag!==7?(V=Dn(Z,X.mode,Se,$e),V.return=X,V):(V=p(V,Z),V.return=X,V)}function we(X,V,Z){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Ic(""+V,X.mode,Z),V.return=X,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case I:return Z=Ri(V.type,V.key,V.props,null,X.mode,Z),Z.ref=no(X,null,V),Z.return=X,Z;case _:return V=Rc(V,X.mode,Z),V.return=X,V;case ee:var Se=V._init;return we(X,Se(V._payload),Z)}if(ls(V)||xe(V))return V=Dn(V,X.mode,Z,null),V.return=X,V;ci(X,V)}return null}function ye(X,V,Z,Se){var $e=V!==null?V.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return $e!==null?null:U(X,V,""+Z,Se);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case I:return Z.key===$e?W(X,V,Z,Se):null;case _:return Z.key===$e?ae(X,V,Z,Se):null;case ee:return $e=Z._init,ye(X,V,$e(Z._payload),Se)}if(ls(Z)||xe(Z))return $e!==null?null:be(X,V,Z,Se,null);ci(X,Z)}return null}function De(X,V,Z,Se,$e){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return X=X.get(Z)||null,U(V,X,""+Se,$e);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case I:return X=X.get(Se.key===null?Z:Se.key)||null,W(V,X,Se,$e);case _:return X=X.get(Se.key===null?Z:Se.key)||null,ae(V,X,Se,$e);case ee:var Ge=Se._init;return De(X,V,Z,Ge(Se._payload),$e)}if(ls(Se)||xe(Se))return X=X.get(Z)||null,be(V,X,Se,$e,null);ci(V,Se)}return null}function Oe(X,V,Z,Se){for(var $e=null,Ge=null,Ke=V,st=V=0,zt=null;Ke!==null&&st<Z.length;st++){Ke.index>st?(zt=Ke,Ke=null):zt=Ke.sibling;var ut=ye(X,Ke,Z[st],Se);if(ut===null){Ke===null&&(Ke=zt);break}t&&Ke&&ut.alternate===null&&r(X,Ke),V=g(ut,V,st),Ge===null?$e=ut:Ge.sibling=ut,Ge=ut,Ke=zt}if(st===Z.length)return l(X,Ke),jt&&jn(X,st),$e;if(Ke===null){for(;st<Z.length;st++)Ke=we(X,Z[st],Se),Ke!==null&&(V=g(Ke,V,st),Ge===null?$e=Ke:Ge.sibling=Ke,Ge=Ke);return jt&&jn(X,st),$e}for(Ke=d(X,Ke);st<Z.length;st++)zt=De(Ke,X,st,Z[st],Se),zt!==null&&(t&&zt.alternate!==null&&Ke.delete(zt.key===null?st:zt.key),V=g(zt,V,st),Ge===null?$e=zt:Ge.sibling=zt,Ge=zt);return t&&Ke.forEach(function(Qs){return r(X,Qs)}),jt&&jn(X,st),$e}function Me(X,V,Z,Se){var $e=xe(Z);if(typeof $e!="function")throw Error(n(150));if(Z=$e.call(Z),Z==null)throw Error(n(151));for(var Ge=$e=null,Ke=V,st=V=0,zt=null,ut=Z.next();Ke!==null&&!ut.done;st++,ut=Z.next()){Ke.index>st?(zt=Ke,Ke=null):zt=Ke.sibling;var Qs=ye(X,Ke,ut.value,Se);if(Qs===null){Ke===null&&(Ke=zt);break}t&&Ke&&Qs.alternate===null&&r(X,Ke),V=g(Qs,V,st),Ge===null?$e=Qs:Ge.sibling=Qs,Ge=Qs,Ke=zt}if(ut.done)return l(X,Ke),jt&&jn(X,st),$e;if(Ke===null){for(;!ut.done;st++,ut=Z.next())ut=we(X,ut.value,Se),ut!==null&&(V=g(ut,V,st),Ge===null?$e=ut:Ge.sibling=ut,Ge=ut);return jt&&jn(X,st),$e}for(Ke=d(X,Ke);!ut.done;st++,ut=Z.next())ut=De(Ke,X,st,ut.value,Se),ut!==null&&(t&&ut.alternate!==null&&Ke.delete(ut.key===null?st:ut.key),V=g(ut,V,st),Ge===null?$e=ut:Ge.sibling=ut,Ge=ut);return t&&Ke.forEach(function(gg){return r(X,gg)}),jt&&jn(X,st),$e}function Dt(X,V,Z,Se){if(typeof Z=="object"&&Z!==null&&Z.type===A&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case I:e:{for(var $e=Z.key,Ge=V;Ge!==null;){if(Ge.key===$e){if($e=Z.type,$e===A){if(Ge.tag===7){l(X,Ge.sibling),V=p(Ge,Z.props.children),V.return=X,X=V;break e}}else if(Ge.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===ee&&Ju($e)===Ge.type){l(X,Ge.sibling),V=p(Ge,Z.props),V.ref=no(X,Ge,Z),V.return=X,X=V;break e}l(X,Ge);break}else r(X,Ge);Ge=Ge.sibling}Z.type===A?(V=Dn(Z.props.children,X.mode,Se,Z.key),V.return=X,X=V):(Se=Ri(Z.type,Z.key,Z.props,null,X.mode,Se),Se.ref=no(X,V,Z),Se.return=X,X=Se)}return T(X);case _:e:{for(Ge=Z.key;V!==null;){if(V.key===Ge)if(V.tag===4&&V.stateNode.containerInfo===Z.containerInfo&&V.stateNode.implementation===Z.implementation){l(X,V.sibling),V=p(V,Z.children||[]),V.return=X,X=V;break e}else{l(X,V);break}else r(X,V);V=V.sibling}V=Rc(Z,X.mode,Se),V.return=X,X=V}return T(X);case ee:return Ge=Z._init,Dt(X,V,Ge(Z._payload),Se)}if(ls(Z))return Oe(X,V,Z,Se);if(xe(Z))return Me(X,V,Z,Se);ci(X,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,V!==null&&V.tag===6?(l(X,V.sibling),V=p(V,Z),V.return=X,X=V):(l(X,V),V=Ic(Z,X.mode,Se),V.return=X,X=V),T(X)):l(X,V)}return Dt}var ua=Yu(!0),Qu=Yu(!1),di=Us(null),ui=null,ma=null,ql=null;function zl(){ql=ma=ui=null}function Hl(t){var r=di.current;wt(di),t._currentValue=r}function Wl(t,r,l){for(;t!==null;){var d=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),t===l)break;t=t.return}}function ha(t,r){ui=t,ql=ma=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&r)!==0&&(cr=!0),t.firstContext=null)}function Tr(t){var r=t._currentValue;if(ql!==t)if(t={context:t,memoizedValue:r,next:null},ma===null){if(ui===null)throw Error(n(308));ma=t,ui.dependencies={lanes:0,firstContext:t}}else ma=ma.next=t;return r}var Nn=null;function Vl(t){Nn===null?Nn=[t]:Nn.push(t)}function Xu(t,r,l,d){var p=r.interleaved;return p===null?(l.next=l,Vl(r)):(l.next=p.next,p.next=l),r.interleaved=l,bs(t,d)}function bs(t,r){t.lanes|=r;var l=t.alternate;for(l!==null&&(l.lanes|=r),l=t,t=t.return;t!==null;)t.childLanes|=r,l=t.alternate,l!==null&&(l.childLanes|=r),l=t,t=t.return;return l.tag===3?l.stateNode:null}var zs=!1;function Gl(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zu(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vs(t,r){return{eventTime:t,lane:r,tag:0,payload:null,callback:null,next:null}}function Hs(t,r,l){var d=t.updateQueue;if(d===null)return null;if(d=d.shared,(dt&2)!==0){var p=d.pending;return p===null?r.next=r:(r.next=p.next,p.next=r),d.pending=r,bs(t,l)}return p=d.interleaved,p===null?(r.next=r,Vl(d)):(r.next=p.next,p.next=r),d.interleaved=r,bs(t,l)}function mi(t,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194240)!==0)){var d=r.lanes;d&=t.pendingLanes,l|=d,r.lanes=l,Ua(t,l)}}function em(t,r){var l=t.updateQueue,d=t.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var T={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};g===null?p=g=T:g=g.next=T,l=l.next}while(l!==null);g===null?p=g=r:g=g.next=r}else p=g=r;l={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:d.shared,effects:d.effects},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=r:t.next=r,l.lastBaseUpdate=r}function hi(t,r,l,d){var p=t.updateQueue;zs=!1;var g=p.firstBaseUpdate,T=p.lastBaseUpdate,U=p.shared.pending;if(U!==null){p.shared.pending=null;var W=U,ae=W.next;W.next=null,T===null?g=ae:T.next=ae,T=W;var be=t.alternate;be!==null&&(be=be.updateQueue,U=be.lastBaseUpdate,U!==T&&(U===null?be.firstBaseUpdate=ae:U.next=ae,be.lastBaseUpdate=W))}if(g!==null){var we=p.baseState;T=0,be=ae=W=null,U=g;do{var ye=U.lane,De=U.eventTime;if((d&ye)===ye){be!==null&&(be=be.next={eventTime:De,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var Oe=t,Me=U;switch(ye=r,De=l,Me.tag){case 1:if(Oe=Me.payload,typeof Oe=="function"){we=Oe.call(De,we,ye);break e}we=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=Me.payload,ye=typeof Oe=="function"?Oe.call(De,we,ye):Oe,ye==null)break e;we=ce({},we,ye);break e;case 2:zs=!0}}U.callback!==null&&U.lane!==0&&(t.flags|=64,ye=p.effects,ye===null?p.effects=[U]:ye.push(U))}else De={eventTime:De,lane:ye,tag:U.tag,payload:U.payload,callback:U.callback,next:null},be===null?(ae=be=De,W=we):be=be.next=De,T|=ye;if(U=U.next,U===null){if(U=p.shared.pending,U===null)break;ye=U,U=ye.next,ye.next=null,p.lastBaseUpdate=ye,p.shared.pending=null}}while(!0);if(be===null&&(W=we),p.baseState=W,p.firstBaseUpdate=ae,p.lastBaseUpdate=be,r=p.shared.interleaved,r!==null){p=r;do T|=p.lane,p=p.next;while(p!==r)}else g===null&&(p.shared.lanes=0);_n|=T,t.lanes=T,t.memoizedState=we}}function tm(t,r,l){if(t=r.effects,r.effects=null,t!==null)for(r=0;r<t.length;r++){var d=t[r],p=d.callback;if(p!==null){if(d.callback=null,d=l,typeof p!="function")throw Error(n(191,p));p.call(d)}}}var ao={},as=Us(ao),oo=Us(ao),io=Us(ao);function Sn(t){if(t===ao)throw Error(n(174));return t}function Kl(t,r){switch(gt(io,r),gt(oo,t),gt(as,ao),t=r.nodeType,t){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Xe(null,"");break;default:t=t===8?r.parentNode:r,r=t.namespaceURI||null,t=t.tagName,r=Xe(r,t)}wt(as),gt(as,r)}function pa(){wt(as),wt(oo),wt(io)}function rm(t){Sn(io.current);var r=Sn(as.current),l=Xe(r,t.type);r!==l&&(gt(oo,t),gt(as,l))}function Jl(t){oo.current===t&&(wt(as),wt(oo))}var _t=Us(0);function pi(t){for(var r=t;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Yl=[];function Ql(){for(var t=0;t<Yl.length;t++)Yl[t]._workInProgressVersionPrimary=null;Yl.length=0}var fi=M.ReactCurrentDispatcher,Xl=M.ReactCurrentBatchConfig,kn=0,Ct=null,Mt=null,Bt=null,gi=!1,lo=!1,co=0,F0=0;function Qt(){throw Error(n(321))}function Zl(t,r){if(r===null)return!1;for(var l=0;l<r.length&&l<t.length;l++)if(!Lr(t[l],r[l]))return!1;return!0}function ec(t,r,l,d,p,g){if(kn=g,Ct=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,fi.current=t===null||t.memoizedState===null?q0:z0,t=l(d,p),lo){g=0;do{if(lo=!1,co=0,25<=g)throw Error(n(301));g+=1,Bt=Mt=null,r.updateQueue=null,fi.current=H0,t=l(d,p)}while(lo)}if(fi.current=bi,r=Mt!==null&&Mt.next!==null,kn=0,Bt=Mt=Ct=null,gi=!1,r)throw Error(n(300));return t}function tc(){var t=co!==0;return co=0,t}function os(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?Ct.memoizedState=Bt=t:Bt=Bt.next=t,Bt}function Dr(){if(Mt===null){var t=Ct.alternate;t=t!==null?t.memoizedState:null}else t=Mt.next;var r=Bt===null?Ct.memoizedState:Bt.next;if(r!==null)Bt=r,Mt=t;else{if(t===null)throw Error(n(310));Mt=t,t={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Bt===null?Ct.memoizedState=Bt=t:Bt=Bt.next=t}return Bt}function uo(t,r){return typeof r=="function"?r(t):r}function rc(t){var r=Dr(),l=r.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=t;var d=Mt,p=d.baseQueue,g=l.pending;if(g!==null){if(p!==null){var T=p.next;p.next=g.next,g.next=T}d.baseQueue=p=g,l.pending=null}if(p!==null){g=p.next,d=d.baseState;var U=T=null,W=null,ae=g;do{var be=ae.lane;if((kn&be)===be)W!==null&&(W=W.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),d=ae.hasEagerState?ae.eagerState:t(d,ae.action);else{var we={lane:be,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};W===null?(U=W=we,T=d):W=W.next=we,Ct.lanes|=be,_n|=be}ae=ae.next}while(ae!==null&&ae!==g);W===null?T=d:W.next=U,Lr(d,r.memoizedState)||(cr=!0),r.memoizedState=d,r.baseState=T,r.baseQueue=W,l.lastRenderedState=d}if(t=l.interleaved,t!==null){p=t;do g=p.lane,Ct.lanes|=g,_n|=g,p=p.next;while(p!==t)}else p===null&&(l.lanes=0);return[r.memoizedState,l.dispatch]}function sc(t){var r=Dr(),l=r.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=t;var d=l.dispatch,p=l.pending,g=r.memoizedState;if(p!==null){l.pending=null;var T=p=p.next;do g=t(g,T.action),T=T.next;while(T!==p);Lr(g,r.memoizedState)||(cr=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),l.lastRenderedState=g}return[g,d]}function sm(){}function nm(t,r){var l=Ct,d=Dr(),p=r(),g=!Lr(d.memoizedState,p);if(g&&(d.memoizedState=p,cr=!0),d=d.queue,nc(im.bind(null,l,d,t),[t]),d.getSnapshot!==r||g||Bt!==null&&Bt.memoizedState.tag&1){if(l.flags|=2048,mo(9,om.bind(null,l,d,p,r),void 0,null),qt===null)throw Error(n(349));(kn&30)!==0||am(l,r,p)}return p}function am(t,r,l){t.flags|=16384,t={getSnapshot:r,value:l},r=Ct.updateQueue,r===null?(r={lastEffect:null,stores:null},Ct.updateQueue=r,r.stores=[t]):(l=r.stores,l===null?r.stores=[t]:l.push(t))}function om(t,r,l,d){r.value=l,r.getSnapshot=d,lm(r)&&cm(t)}function im(t,r,l){return l(function(){lm(r)&&cm(t)})}function lm(t){var r=t.getSnapshot;t=t.value;try{var l=r();return!Lr(t,l)}catch{return!0}}function cm(t){var r=bs(t,1);r!==null&&qr(r,t,1,-1)}function dm(t){var r=os();return typeof t=="function"&&(t=t()),r.memoizedState=r.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uo,lastRenderedState:t},r.queue=t,t=t.dispatch=B0.bind(null,Ct,t),[r.memoizedState,t]}function mo(t,r,l,d){return t={tag:t,create:r,destroy:l,deps:d,next:null},r=Ct.updateQueue,r===null?(r={lastEffect:null,stores:null},Ct.updateQueue=r,r.lastEffect=t.next=t):(l=r.lastEffect,l===null?r.lastEffect=t.next=t:(d=l.next,l.next=t,t.next=d,r.lastEffect=t)),t}function um(){return Dr().memoizedState}function xi(t,r,l,d){var p=os();Ct.flags|=t,p.memoizedState=mo(1|r,l,void 0,d===void 0?null:d)}function yi(t,r,l,d){var p=Dr();d=d===void 0?null:d;var g=void 0;if(Mt!==null){var T=Mt.memoizedState;if(g=T.destroy,d!==null&&Zl(d,T.deps)){p.memoizedState=mo(r,l,g,d);return}}Ct.flags|=t,p.memoizedState=mo(1|r,l,g,d)}function mm(t,r){return xi(8390656,8,t,r)}function nc(t,r){return yi(2048,8,t,r)}function hm(t,r){return yi(4,2,t,r)}function pm(t,r){return yi(4,4,t,r)}function fm(t,r){if(typeof r=="function")return t=t(),r(t),function(){r(null)};if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function gm(t,r,l){return l=l!=null?l.concat([t]):null,yi(4,4,fm.bind(null,r,t),l)}function ac(){}function xm(t,r){var l=Dr();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zl(r,d[1])?d[0]:(l.memoizedState=[t,r],t)}function ym(t,r){var l=Dr();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Zl(r,d[1])?d[0]:(t=t(),l.memoizedState=[t,r],t)}function bm(t,r,l){return(kn&21)===0?(t.baseState&&(t.baseState=!1,cr=!0),t.memoizedState=l):(Lr(l,r)||(l=$a(),Ct.lanes|=l,_n|=l,t.baseState=!0),r)}function $0(t,r){var l=mt;mt=l!==0&&4>l?l:4,t(!0);var d=Xl.transition;Xl.transition={};try{t(!1),r()}finally{mt=l,Xl.transition=d}}function vm(){return Dr().memoizedState}function U0(t,r,l){var d=Ks(t);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},wm(t))jm(r,l);else if(l=Xu(t,r,l,d),l!==null){var p=sr();qr(l,t,d,p),Nm(l,r,d)}}function B0(t,r,l){var d=Ks(t),p={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(wm(t))jm(r,p);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var T=r.lastRenderedState,U=g(T,l);if(p.hasEagerState=!0,p.eagerState=U,Lr(U,T)){var W=r.interleaved;W===null?(p.next=p,Vl(r)):(p.next=W.next,W.next=p),r.interleaved=p;return}}catch{}finally{}l=Xu(t,r,p,d),l!==null&&(p=sr(),qr(l,t,d,p),Nm(l,r,d))}}function wm(t){var r=t.alternate;return t===Ct||r!==null&&r===Ct}function jm(t,r){lo=gi=!0;var l=t.pending;l===null?r.next=r:(r.next=l.next,l.next=r),t.pending=r}function Nm(t,r,l){if((l&4194240)!==0){var d=r.lanes;d&=t.pendingLanes,l|=d,r.lanes=l,Ua(t,l)}}var bi={readContext:Tr,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},q0={readContext:Tr,useCallback:function(t,r){return os().memoizedState=[t,r===void 0?null:r],t},useContext:Tr,useEffect:mm,useImperativeHandle:function(t,r,l){return l=l!=null?l.concat([t]):null,xi(4194308,4,fm.bind(null,r,t),l)},useLayoutEffect:function(t,r){return xi(4194308,4,t,r)},useInsertionEffect:function(t,r){return xi(4,2,t,r)},useMemo:function(t,r){var l=os();return r=r===void 0?null:r,t=t(),l.memoizedState=[t,r],t},useReducer:function(t,r,l){var d=os();return r=l!==void 0?l(r):r,d.memoizedState=d.baseState=r,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},d.queue=t,t=t.dispatch=U0.bind(null,Ct,t),[d.memoizedState,t]},useRef:function(t){var r=os();return t={current:t},r.memoizedState=t},useState:dm,useDebugValue:ac,useDeferredValue:function(t){return os().memoizedState=t},useTransition:function(){var t=dm(!1),r=t[0];return t=$0.bind(null,t[1]),os().memoizedState=t,[r,t]},useMutableSource:function(){},useSyncExternalStore:function(t,r,l){var d=Ct,p=os();if(jt){if(l===void 0)throw Error(n(407));l=l()}else{if(l=r(),qt===null)throw Error(n(349));(kn&30)!==0||am(d,r,l)}p.memoizedState=l;var g={value:l,getSnapshot:r};return p.queue=g,mm(im.bind(null,d,g,t),[t]),d.flags|=2048,mo(9,om.bind(null,d,g,l,r),void 0,null),l},useId:function(){var t=os(),r=qt.identifierPrefix;if(jt){var l=ys,d=xs;l=(d&~(1<<32-gr(d)-1)).toString(32)+l,r=":"+r+"R"+l,l=co++,0<l&&(r+="H"+l.toString(32)),r+=":"}else l=F0++,r=":"+r+"r"+l.toString(32)+":";return t.memoizedState=r},unstable_isNewReconciler:!1},z0={readContext:Tr,useCallback:xm,useContext:Tr,useEffect:nc,useImperativeHandle:gm,useInsertionEffect:hm,useLayoutEffect:pm,useMemo:ym,useReducer:rc,useRef:um,useState:function(){return rc(uo)},useDebugValue:ac,useDeferredValue:function(t){var r=Dr();return bm(r,Mt.memoizedState,t)},useTransition:function(){var t=rc(uo)[0],r=Dr().memoizedState;return[t,r]},useMutableSource:sm,useSyncExternalStore:nm,useId:vm,unstable_isNewReconciler:!1},H0={readContext:Tr,useCallback:xm,useContext:Tr,useEffect:nc,useImperativeHandle:gm,useInsertionEffect:hm,useLayoutEffect:pm,useMemo:ym,useReducer:sc,useRef:um,useState:function(){return sc(uo)},useDebugValue:ac,useDeferredValue:function(t){var r=Dr();return Mt===null?r.memoizedState=t:bm(r,Mt.memoizedState,t)},useTransition:function(){var t=sc(uo)[0],r=Dr().memoizedState;return[t,r]},useMutableSource:sm,useSyncExternalStore:nm,useId:vm,unstable_isNewReconciler:!1};function $r(t,r){if(t&&t.defaultProps){r=ce({},r),t=t.defaultProps;for(var l in t)r[l]===void 0&&(r[l]=t[l]);return r}return r}function oc(t,r,l,d){r=t.memoizedState,l=l(d,r),l=l==null?r:ce({},r,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var vi={isMounted:function(t){return(t=t._reactInternals)?Ut(t)===t:!1},enqueueSetState:function(t,r,l){t=t._reactInternals;var d=sr(),p=Ks(t),g=vs(d,p);g.payload=r,l!=null&&(g.callback=l),r=Hs(t,g,p),r!==null&&(qr(r,t,p,d),mi(r,t,p))},enqueueReplaceState:function(t,r,l){t=t._reactInternals;var d=sr(),p=Ks(t),g=vs(d,p);g.tag=1,g.payload=r,l!=null&&(g.callback=l),r=Hs(t,g,p),r!==null&&(qr(r,t,p,d),mi(r,t,p))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var l=sr(),d=Ks(t),p=vs(l,d);p.tag=2,r!=null&&(p.callback=r),r=Hs(t,p,d),r!==null&&(qr(r,t,d,l),mi(r,t,d))}};function Sm(t,r,l,d,p,g,T){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(d,g,T):r.prototype&&r.prototype.isPureReactComponent?!Qa(l,d)||!Qa(p,g):!0}function km(t,r,l){var d=!1,p=Bs,g=r.contextType;return typeof g=="object"&&g!==null?g=Tr(g):(p=lr(r)?vn:Yt.current,d=r.contextTypes,g=(d=d!=null)?ia(t,p):Bs),r=new r(l,g),t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=vi,t.stateNode=r,r._reactInternals=t,d&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=p,t.__reactInternalMemoizedMaskedChildContext=g),r}function _m(t,r,l,d){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,d),r.state!==t&&vi.enqueueReplaceState(r,r.state,null)}function ic(t,r,l,d){var p=t.stateNode;p.props=l,p.state=t.memoizedState,p.refs={},Gl(t);var g=r.contextType;typeof g=="object"&&g!==null?p.context=Tr(g):(g=lr(r)?vn:Yt.current,p.context=ia(t,g)),p.state=t.memoizedState,g=r.getDerivedStateFromProps,typeof g=="function"&&(oc(t,r,g,l),p.state=t.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(r=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),r!==p.state&&vi.enqueueReplaceState(p,p.state,null),hi(t,l,p,d),p.state=t.memoizedState),typeof p.componentDidMount=="function"&&(t.flags|=4194308)}function fa(t,r){try{var l="",d=r;do l+=Ye(d),d=d.return;while(d);var p=l}catch(g){p=`
Error generating stack: `+g.message+`
`+g.stack}return{value:t,source:r,stack:p,digest:null}}function lc(t,r,l){return{value:t,source:null,stack:l??null,digest:r??null}}function cc(t,r){try{console.error(r.value)}catch(l){setTimeout(function(){throw l})}}var W0=typeof WeakMap=="function"?WeakMap:Map;function Cm(t,r,l){l=vs(-1,l),l.tag=3,l.payload={element:null};var d=r.value;return l.callback=function(){Ci||(Ci=!0,Sc=d),cc(t,r)},l}function Em(t,r,l){l=vs(-1,l),l.tag=3;var d=t.type.getDerivedStateFromError;if(typeof d=="function"){var p=r.value;l.payload=function(){return d(p)},l.callback=function(){cc(t,r)}}var g=t.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(l.callback=function(){cc(t,r),typeof d!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var T=r.stack;this.componentDidCatch(r.value,{componentStack:T!==null?T:""})}),l}function Tm(t,r,l){var d=t.pingCache;if(d===null){d=t.pingCache=new W0;var p=new Set;d.set(r,p)}else p=d.get(r),p===void 0&&(p=new Set,d.set(r,p));p.has(l)||(p.add(l),t=ag.bind(null,t,r,l),r.then(t,t))}function Dm(t){do{var r;if((r=t.tag===13)&&(r=t.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return t;t=t.return}while(t!==null);return null}function Pm(t,r,l,d,p){return(t.mode&1)===0?(t===r?t.flags|=65536:(t.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(r=vs(-1,1),r.tag=2,Hs(l,r,1))),l.lanes|=1),t):(t.flags|=65536,t.lanes=p,t)}var V0=M.ReactCurrentOwner,cr=!1;function rr(t,r,l,d){r.child=t===null?Qu(r,null,l,d):ua(r,t.child,l,d)}function Im(t,r,l,d,p){l=l.render;var g=r.ref;return ha(r,p),d=ec(t,r,l,d,g,p),l=tc(),t!==null&&!cr?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~p,ws(t,r,p)):(jt&&l&&Ll(r),r.flags|=1,rr(t,r,d,p),r.child)}function Rm(t,r,l,d,p){if(t===null){var g=l.type;return typeof g=="function"&&!Pc(g)&&g.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(r.tag=15,r.type=g,Am(t,r,g,d,p)):(t=Ri(l.type,null,d,r,r.mode,p),t.ref=r.ref,t.return=r,r.child=t)}if(g=t.child,(t.lanes&p)===0){var T=g.memoizedProps;if(l=l.compare,l=l!==null?l:Qa,l(T,d)&&t.ref===r.ref)return ws(t,r,p)}return r.flags|=1,t=Ys(g,d),t.ref=r.ref,t.return=r,r.child=t}function Am(t,r,l,d,p){if(t!==null){var g=t.memoizedProps;if(Qa(g,d)&&t.ref===r.ref)if(cr=!1,r.pendingProps=d=g,(t.lanes&p)!==0)(t.flags&131072)!==0&&(cr=!0);else return r.lanes=t.lanes,ws(t,r,p)}return dc(t,r,l,d,p)}function Om(t,r,l){var d=r.pendingProps,p=d.children,g=t!==null?t.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(xa,wr),wr|=l;else{if((l&1073741824)===0)return t=g!==null?g.baseLanes|l:l,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:t,cachePool:null,transitions:null},r.updateQueue=null,gt(xa,wr),wr|=t,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=g!==null?g.baseLanes:l,gt(xa,wr),wr|=d}else g!==null?(d=g.baseLanes|l,r.memoizedState=null):d=l,gt(xa,wr),wr|=d;return rr(t,r,p,l),r.child}function Mm(t,r){var l=r.ref;(t===null&&l!==null||t!==null&&t.ref!==l)&&(r.flags|=512,r.flags|=2097152)}function dc(t,r,l,d,p){var g=lr(l)?vn:Yt.current;return g=ia(r,g),ha(r,p),l=ec(t,r,l,d,g,p),d=tc(),t!==null&&!cr?(r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~p,ws(t,r,p)):(jt&&d&&Ll(r),r.flags|=1,rr(t,r,l,p),r.child)}function Lm(t,r,l,d,p){if(lr(l)){var g=!0;ni(r)}else g=!1;if(ha(r,p),r.stateNode===null)ji(t,r),km(r,l,d),ic(r,l,d,p),d=!0;else if(t===null){var T=r.stateNode,U=r.memoizedProps;T.props=U;var W=T.context,ae=l.contextType;typeof ae=="object"&&ae!==null?ae=Tr(ae):(ae=lr(l)?vn:Yt.current,ae=ia(r,ae));var be=l.getDerivedStateFromProps,we=typeof be=="function"||typeof T.getSnapshotBeforeUpdate=="function";we||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(U!==d||W!==ae)&&_m(r,T,d,ae),zs=!1;var ye=r.memoizedState;T.state=ye,hi(r,d,T,p),W=r.memoizedState,U!==d||ye!==W||ir.current||zs?(typeof be=="function"&&(oc(r,l,be,d),W=r.memoizedState),(U=zs||Sm(r,l,U,d,ye,W,ae))?(we||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(r.flags|=4194308)):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=W),T.props=d,T.state=W,T.context=ae,d=U):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{T=r.stateNode,Zu(t,r),U=r.memoizedProps,ae=r.type===r.elementType?U:$r(r.type,U),T.props=ae,we=r.pendingProps,ye=T.context,W=l.contextType,typeof W=="object"&&W!==null?W=Tr(W):(W=lr(l)?vn:Yt.current,W=ia(r,W));var De=l.getDerivedStateFromProps;(be=typeof De=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(U!==we||ye!==W)&&_m(r,T,d,W),zs=!1,ye=r.memoizedState,T.state=ye,hi(r,d,T,p);var Oe=r.memoizedState;U!==we||ye!==Oe||ir.current||zs?(typeof De=="function"&&(oc(r,l,De,d),Oe=r.memoizedState),(ae=zs||Sm(r,l,ae,d,ye,Oe,W)||!1)?(be||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(d,Oe,W),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(d,Oe,W)),typeof T.componentDidUpdate=="function"&&(r.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof T.componentDidUpdate!="function"||U===t.memoizedProps&&ye===t.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||U===t.memoizedProps&&ye===t.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=Oe),T.props=d,T.state=Oe,T.context=W,d=ae):(typeof T.componentDidUpdate!="function"||U===t.memoizedProps&&ye===t.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||U===t.memoizedProps&&ye===t.memoizedState||(r.flags|=1024),d=!1)}return uc(t,r,l,d,g,p)}function uc(t,r,l,d,p,g){Mm(t,r);var T=(r.flags&128)!==0;if(!d&&!T)return p&&qu(r,l,!1),ws(t,r,g);d=r.stateNode,V0.current=r;var U=T&&typeof l.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,t!==null&&T?(r.child=ua(r,t.child,null,g),r.child=ua(r,null,U,g)):rr(t,r,U,g),r.memoizedState=d.state,p&&qu(r,l,!0),r.child}function Fm(t){var r=t.stateNode;r.pendingContext?Uu(t,r.pendingContext,r.pendingContext!==r.context):r.context&&Uu(t,r.context,!1),Kl(t,r.containerInfo)}function $m(t,r,l,d,p){return da(),Bl(p),r.flags|=256,rr(t,r,l,d),r.child}var mc={dehydrated:null,treeContext:null,retryLane:0};function hc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Um(t,r,l){var d=r.pendingProps,p=_t.current,g=!1,T=(r.flags&128)!==0,U;if((U=T)||(U=t!==null&&t.memoizedState===null?!1:(p&2)!==0),U?(g=!0,r.flags&=-129):(t===null||t.memoizedState!==null)&&(p|=1),gt(_t,p&1),t===null)return Ul(r),t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((r.mode&1)===0?r.lanes=1:t.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(T=d.children,t=d.fallback,g?(d=r.mode,g=r.child,T={mode:"hidden",children:T},(d&1)===0&&g!==null?(g.childLanes=0,g.pendingProps=T):g=Ai(T,d,0,null),t=Dn(t,d,l,null),g.return=r,t.return=r,g.sibling=t,r.child=g,r.child.memoizedState=hc(l),r.memoizedState=mc,t):pc(r,T));if(p=t.memoizedState,p!==null&&(U=p.dehydrated,U!==null))return G0(t,r,T,d,U,p,l);if(g){g=d.fallback,T=r.mode,p=t.child,U=p.sibling;var W={mode:"hidden",children:d.children};return(T&1)===0&&r.child!==p?(d=r.child,d.childLanes=0,d.pendingProps=W,r.deletions=null):(d=Ys(p,W),d.subtreeFlags=p.subtreeFlags&14680064),U!==null?g=Ys(U,g):(g=Dn(g,T,l,null),g.flags|=2),g.return=r,d.return=r,d.sibling=g,r.child=d,d=g,g=r.child,T=t.child.memoizedState,T=T===null?hc(l):{baseLanes:T.baseLanes|l,cachePool:null,transitions:T.transitions},g.memoizedState=T,g.childLanes=t.childLanes&~l,r.memoizedState=mc,d}return g=t.child,t=g.sibling,d=Ys(g,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=l),d.return=r,d.sibling=null,t!==null&&(l=r.deletions,l===null?(r.deletions=[t],r.flags|=16):l.push(t)),r.child=d,r.memoizedState=null,d}function pc(t,r){return r=Ai({mode:"visible",children:r},t.mode,0,null),r.return=t,t.child=r}function wi(t,r,l,d){return d!==null&&Bl(d),ua(r,t.child,null,l),t=pc(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function G0(t,r,l,d,p,g,T){if(l)return r.flags&256?(r.flags&=-257,d=lc(Error(n(422))),wi(t,r,T,d)):r.memoizedState!==null?(r.child=t.child,r.flags|=128,null):(g=d.fallback,p=r.mode,d=Ai({mode:"visible",children:d.children},p,0,null),g=Dn(g,p,T,null),g.flags|=2,d.return=r,g.return=r,d.sibling=g,r.child=d,(r.mode&1)!==0&&ua(r,t.child,null,T),r.child.memoizedState=hc(T),r.memoizedState=mc,g);if((r.mode&1)===0)return wi(t,r,T,null);if(p.data==="$!"){if(d=p.nextSibling&&p.nextSibling.dataset,d)var U=d.dgst;return d=U,g=Error(n(419)),d=lc(g,d,void 0),wi(t,r,T,d)}if(U=(T&t.childLanes)!==0,cr||U){if(d=qt,d!==null){switch(T&-T){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(d.suspendedLanes|T))!==0?0:p,p!==0&&p!==g.retryLane&&(g.retryLane=p,bs(t,p),qr(d,t,p,-1))}return Dc(),d=lc(Error(n(421))),wi(t,r,T,d)}return p.data==="$?"?(r.flags|=128,r.child=t.child,r=og.bind(null,t),p._reactRetry=r,null):(t=g.treeContext,vr=$s(p.nextSibling),br=r,jt=!0,Fr=null,t!==null&&(Cr[Er++]=xs,Cr[Er++]=ys,Cr[Er++]=wn,xs=t.id,ys=t.overflow,wn=r),r=pc(r,d.children),r.flags|=4096,r)}function Bm(t,r,l){t.lanes|=r;var d=t.alternate;d!==null&&(d.lanes|=r),Wl(t.return,r,l)}function fc(t,r,l,d,p){var g=t.memoizedState;g===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:p}:(g.isBackwards=r,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=l,g.tailMode=p)}function qm(t,r,l){var d=r.pendingProps,p=d.revealOrder,g=d.tail;if(rr(t,r,d.children,l),d=_t.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bm(t,l,r);else if(t.tag===19)Bm(t,l,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}d&=1}if(gt(_t,d),(r.mode&1)===0)r.memoizedState=null;else switch(p){case"forwards":for(l=r.child,p=null;l!==null;)t=l.alternate,t!==null&&pi(t)===null&&(p=l),l=l.sibling;l=p,l===null?(p=r.child,r.child=null):(p=l.sibling,l.sibling=null),fc(r,!1,p,l,g);break;case"backwards":for(l=null,p=r.child,r.child=null;p!==null;){if(t=p.alternate,t!==null&&pi(t)===null){r.child=p;break}t=p.sibling,p.sibling=l,l=p,p=t}fc(r,!0,l,null,g);break;case"together":fc(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function ji(t,r){(r.mode&1)===0&&t!==null&&(t.alternate=null,r.alternate=null,r.flags|=2)}function ws(t,r,l){if(t!==null&&(r.dependencies=t.dependencies),_n|=r.lanes,(l&r.childLanes)===0)return null;if(t!==null&&r.child!==t.child)throw Error(n(153));if(r.child!==null){for(t=r.child,l=Ys(t,t.pendingProps),r.child=l,l.return=r;t.sibling!==null;)t=t.sibling,l=l.sibling=Ys(t,t.pendingProps),l.return=r;l.sibling=null}return r.child}function K0(t,r,l){switch(r.tag){case 3:Fm(r),da();break;case 5:rm(r);break;case 1:lr(r.type)&&ni(r);break;case 4:Kl(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,p=r.memoizedProps.value;gt(di,d._currentValue),d._currentValue=p;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(gt(_t,_t.current&1),r.flags|=128,null):(l&r.child.childLanes)!==0?Um(t,r,l):(gt(_t,_t.current&1),t=ws(t,r,l),t!==null?t.sibling:null);gt(_t,_t.current&1);break;case 19:if(d=(l&r.childLanes)!==0,(t.flags&128)!==0){if(d)return qm(t,r,l);r.flags|=128}if(p=r.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),gt(_t,_t.current),d)break;return null;case 22:case 23:return r.lanes=0,Om(t,r,l)}return ws(t,r,l)}var zm,gc,Hm,Wm;zm=function(t,r){for(var l=r.child;l!==null;){if(l.tag===5||l.tag===6)t.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},gc=function(){},Hm=function(t,r,l,d){var p=t.memoizedProps;if(p!==d){t=r.stateNode,Sn(as.current);var g=null;switch(l){case"input":p=Nt(t,p),d=Nt(t,d),g=[];break;case"select":p=ce({},p,{value:void 0}),d=ce({},d,{value:void 0}),g=[];break;case"textarea":p=sn(t,p),d=sn(t,d),g=[];break;default:typeof p.onClick!="function"&&typeof d.onClick=="function"&&(t.onclick=ti)}cs(l,d);var T;l=null;for(ae in p)if(!d.hasOwnProperty(ae)&&p.hasOwnProperty(ae)&&p[ae]!=null)if(ae==="style"){var U=p[ae];for(T in U)U.hasOwnProperty(T)&&(l||(l={}),l[T]="")}else ae!=="dangerouslySetInnerHTML"&&ae!=="children"&&ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&ae!=="autoFocus"&&(i.hasOwnProperty(ae)?g||(g=[]):(g=g||[]).push(ae,null));for(ae in d){var W=d[ae];if(U=p?.[ae],d.hasOwnProperty(ae)&&W!==U&&(W!=null||U!=null))if(ae==="style")if(U){for(T in U)!U.hasOwnProperty(T)||W&&W.hasOwnProperty(T)||(l||(l={}),l[T]="");for(T in W)W.hasOwnProperty(T)&&U[T]!==W[T]&&(l||(l={}),l[T]=W[T])}else l||(g||(g=[]),g.push(ae,l)),l=W;else ae==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,U=U?U.__html:void 0,W!=null&&U!==W&&(g=g||[]).push(ae,W)):ae==="children"?typeof W!="string"&&typeof W!="number"||(g=g||[]).push(ae,""+W):ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&(i.hasOwnProperty(ae)?(W!=null&&ae==="onScroll"&&vt("scroll",t),g||U===W||(g=[])):(g=g||[]).push(ae,W))}l&&(g=g||[]).push("style",l);var ae=g;(r.updateQueue=ae)&&(r.flags|=4)}},Wm=function(t,r,l,d){l!==d&&(r.flags|=4)};function ho(t,r){if(!jt)switch(t.tailMode){case"hidden":r=t.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:d.sibling=null}}function Xt(t){var r=t.alternate!==null&&t.alternate.child===t.child,l=0,d=0;if(r)for(var p=t.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags&14680064,d|=p.flags&14680064,p.return=t,p=p.sibling;else for(p=t.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=t,p=p.sibling;return t.subtreeFlags|=d,t.childLanes=l,r}function J0(t,r,l){var d=r.pendingProps;switch(Fl(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xt(r),null;case 1:return lr(r.type)&&si(),Xt(r),null;case 3:return d=r.stateNode,pa(),wt(ir),wt(Yt),Ql(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(t===null||t.child===null)&&(li(r)?r.flags|=4:t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Fr!==null&&(Cc(Fr),Fr=null))),gc(t,r),Xt(r),null;case 5:Jl(r);var p=Sn(io.current);if(l=r.type,t!==null&&r.stateNode!=null)Hm(t,r,l,d,p),t.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(n(166));return Xt(r),null}if(t=Sn(as.current),li(r)){d=r.stateNode,l=r.type;var g=r.memoizedProps;switch(d[ns]=r,d[ro]=g,t=(r.mode&1)!==0,l){case"dialog":vt("cancel",d),vt("close",d);break;case"iframe":case"object":case"embed":vt("load",d);break;case"video":case"audio":for(p=0;p<Za.length;p++)vt(Za[p],d);break;case"source":vt("error",d);break;case"img":case"image":case"link":vt("error",d),vt("load",d);break;case"details":vt("toggle",d);break;case"input":He(d,g),vt("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!g.multiple},vt("invalid",d);break;case"textarea":nn(d,g),vt("invalid",d)}cs(l,g),p=null;for(var T in g)if(g.hasOwnProperty(T)){var U=g[T];T==="children"?typeof U=="string"?d.textContent!==U&&(g.suppressHydrationWarning!==!0&&ei(d.textContent,U,t),p=["children",U]):typeof U=="number"&&d.textContent!==""+U&&(g.suppressHydrationWarning!==!0&&ei(d.textContent,U,t),p=["children",""+U]):i.hasOwnProperty(T)&&U!=null&&T==="onScroll"&&vt("scroll",d)}switch(l){case"input":Ie(d),fr(d,g,!0);break;case"textarea":Ie(d),Aa(d);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(d.onclick=ti)}d=p,r.updateQueue=d,d!==null&&(r.flags|=4)}else{T=p.nodeType===9?p:p.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=te(l)),t==="http://www.w3.org/1999/xhtml"?l==="script"?(t=T.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof d.is=="string"?t=T.createElement(l,{is:d.is}):(t=T.createElement(l),l==="select"&&(T=t,d.multiple?T.multiple=!0:d.size&&(T.size=d.size))):t=T.createElementNS(t,l),t[ns]=r,t[ro]=d,zm(t,r,!1,!1),r.stateNode=t;e:{switch(T=an(l,d),l){case"dialog":vt("cancel",t),vt("close",t),p=d;break;case"iframe":case"object":case"embed":vt("load",t),p=d;break;case"video":case"audio":for(p=0;p<Za.length;p++)vt(Za[p],t);p=d;break;case"source":vt("error",t),p=d;break;case"img":case"image":case"link":vt("error",t),vt("load",t),p=d;break;case"details":vt("toggle",t),p=d;break;case"input":He(t,d),p=Nt(t,d),vt("invalid",t);break;case"option":p=d;break;case"select":t._wrapperState={wasMultiple:!!d.multiple},p=ce({},d,{value:void 0}),vt("invalid",t);break;case"textarea":nn(t,d),p=sn(t,d),vt("invalid",t);break;default:p=d}cs(l,p),U=p;for(g in U)if(U.hasOwnProperty(g)){var W=U[g];g==="style"?Ma(t,W):g==="dangerouslySetInnerHTML"?(W=W?W.__html:void 0,W!=null&&Un(t,W)):g==="children"?typeof W=="string"?(l!=="textarea"||W!=="")&&_s(t,W):typeof W=="number"&&_s(t,""+W):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(i.hasOwnProperty(g)?W!=null&&g==="onScroll"&&vt("scroll",t):W!=null&&D(t,g,W,T))}switch(l){case"input":Ie(t),fr(t,d,!1);break;case"textarea":Ie(t),Aa(t);break;case"option":d.value!=null&&t.setAttribute("value",""+Pe(d.value));break;case"select":t.multiple=!!d.multiple,g=d.value,g!=null?Jr(t,!!d.multiple,g,!1):d.defaultValue!=null&&Jr(t,!!d.multiple,d.defaultValue,!0);break;default:typeof p.onClick=="function"&&(t.onclick=ti)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Xt(r),null;case 6:if(t&&r.stateNode!=null)Wm(t,r,t.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(n(166));if(l=Sn(io.current),Sn(as.current),li(r)){if(d=r.stateNode,l=r.memoizedProps,d[ns]=r,(g=d.nodeValue!==l)&&(t=br,t!==null))switch(t.tag){case 3:ei(d.nodeValue,l,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ei(d.nodeValue,l,(t.mode&1)!==0)}g&&(r.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[ns]=r,r.stateNode=d}return Xt(r),null;case 13:if(wt(_t),d=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(jt&&vr!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Ku(),da(),r.flags|=98560,g=!1;else if(g=li(r),d!==null&&d.dehydrated!==null){if(t===null){if(!g)throw Error(n(318));if(g=r.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[ns]=r}else da(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Xt(r),g=!1}else Fr!==null&&(Cc(Fr),Fr=null),g=!0;if(!g)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=l,r):(d=d!==null,d!==(t!==null&&t.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(t===null||(_t.current&1)!==0?Lt===0&&(Lt=3):Dc())),r.updateQueue!==null&&(r.flags|=4),Xt(r),null);case 4:return pa(),gc(t,r),t===null&&eo(r.stateNode.containerInfo),Xt(r),null;case 10:return Hl(r.type._context),Xt(r),null;case 17:return lr(r.type)&&si(),Xt(r),null;case 19:if(wt(_t),g=r.memoizedState,g===null)return Xt(r),null;if(d=(r.flags&128)!==0,T=g.rendering,T===null)if(d)ho(g,!1);else{if(Lt!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(T=pi(t),T!==null){for(r.flags|=128,ho(g,!1),d=T.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=l,l=r.child;l!==null;)g=l,t=d,g.flags&=14680066,T=g.alternate,T===null?(g.childLanes=0,g.lanes=t,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=T.childLanes,g.lanes=T.lanes,g.child=T.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=T.memoizedProps,g.memoizedState=T.memoizedState,g.updateQueue=T.updateQueue,g.type=T.type,t=T.dependencies,g.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),l=l.sibling;return gt(_t,_t.current&1|2),r.child}t=t.sibling}g.tail!==null&&St()>ya&&(r.flags|=128,d=!0,ho(g,!1),r.lanes=4194304)}else{if(!d)if(t=pi(T),t!==null){if(r.flags|=128,d=!0,l=t.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),ho(g,!0),g.tail===null&&g.tailMode==="hidden"&&!T.alternate&&!jt)return Xt(r),null}else 2*St()-g.renderingStartTime>ya&&l!==1073741824&&(r.flags|=128,d=!0,ho(g,!1),r.lanes=4194304);g.isBackwards?(T.sibling=r.child,r.child=T):(l=g.last,l!==null?l.sibling=T:r.child=T,g.last=T)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=St(),r.sibling=null,l=_t.current,gt(_t,d?l&1|2:l&1),r):(Xt(r),null);case 22:case 23:return Tc(),d=r.memoizedState!==null,t!==null&&t.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?(wr&1073741824)!==0&&(Xt(r),r.subtreeFlags&6&&(r.flags|=8192)):Xt(r),null;case 24:return null;case 25:return null}throw Error(n(156,r.tag))}function Y0(t,r){switch(Fl(r),r.tag){case 1:return lr(r.type)&&si(),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return pa(),wt(ir),wt(Yt),Ql(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 5:return Jl(r),null;case 13:if(wt(_t),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(n(340));da()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return wt(_t),null;case 4:return pa(),null;case 10:return Hl(r.type._context),null;case 22:case 23:return Tc(),null;case 24:return null;default:return null}}var Ni=!1,Zt=!1,Q0=typeof WeakSet=="function"?WeakSet:Set,Re=null;function ga(t,r){var l=t.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){Tt(t,r,d)}else l.current=null}function xc(t,r,l){try{l()}catch(d){Tt(t,r,d)}}var Vm=!1;function X0(t,r){if(Tl=ms,t=Su(),wl(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var p=d.anchorOffset,g=d.focusNode;d=d.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var T=0,U=-1,W=-1,ae=0,be=0,we=t,ye=null;t:for(;;){for(var De;we!==l||p!==0&&we.nodeType!==3||(U=T+p),we!==g||d!==0&&we.nodeType!==3||(W=T+d),we.nodeType===3&&(T+=we.nodeValue.length),(De=we.firstChild)!==null;)ye=we,we=De;for(;;){if(we===t)break t;if(ye===l&&++ae===p&&(U=T),ye===g&&++be===d&&(W=T),(De=we.nextSibling)!==null)break;we=ye,ye=we.parentNode}we=De}l=U===-1||W===-1?null:{start:U,end:W}}else l=null}l=l||{start:0,end:0}}else l=null;for(Dl={focusedElem:t,selectionRange:l},ms=!1,Re=r;Re!==null;)if(r=Re,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Re=t;else for(;Re!==null;){r=Re;try{var Oe=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(Oe!==null){var Me=Oe.memoizedProps,Dt=Oe.memoizedState,X=r.stateNode,V=X.getSnapshotBeforeUpdate(r.elementType===r.type?Me:$r(r.type,Me),Dt);X.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var Z=r.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Se){Tt(r,r.return,Se)}if(t=r.sibling,t!==null){t.return=r.return,Re=t;break}Re=r.return}return Oe=Vm,Vm=!1,Oe}function po(t,r,l){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&t)===t){var g=p.destroy;p.destroy=void 0,g!==void 0&&xc(r,l,g)}p=p.next}while(p!==d)}}function Si(t,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&t)===t){var d=l.create;l.destroy=d()}l=l.next}while(l!==r)}}function yc(t){var r=t.ref;if(r!==null){var l=t.stateNode;switch(t.tag){case 5:t=l;break;default:t=l}typeof r=="function"?r(t):r.current=t}}function Gm(t){var r=t.alternate;r!==null&&(t.alternate=null,Gm(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&(delete r[ns],delete r[ro],delete r[Al],delete r[A0],delete r[O0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Km(t){return t.tag===5||t.tag===3||t.tag===4}function Jm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Km(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bc(t,r,l){var d=t.tag;if(d===5||d===6)t=t.stateNode,r?l.nodeType===8?l.parentNode.insertBefore(t,r):l.insertBefore(t,r):(l.nodeType===8?(r=l.parentNode,r.insertBefore(t,l)):(r=l,r.appendChild(t)),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=ti));else if(d!==4&&(t=t.child,t!==null))for(bc(t,r,l),t=t.sibling;t!==null;)bc(t,r,l),t=t.sibling}function vc(t,r,l){var d=t.tag;if(d===5||d===6)t=t.stateNode,r?l.insertBefore(t,r):l.appendChild(t);else if(d!==4&&(t=t.child,t!==null))for(vc(t,r,l),t=t.sibling;t!==null;)vc(t,r,l),t=t.sibling}var Vt=null,Ur=!1;function Ws(t,r,l){for(l=l.child;l!==null;)Ym(t,r,l),l=l.sibling}function Ym(t,r,l){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(dn,l)}catch{}switch(l.tag){case 5:Zt||ga(l,r);case 6:var d=Vt,p=Ur;Vt=null,Ws(t,r,l),Vt=d,Ur=p,Vt!==null&&(Ur?(t=Vt,l=l.stateNode,t.nodeType===8?t.parentNode.removeChild(l):t.removeChild(l)):Vt.removeChild(l.stateNode));break;case 18:Vt!==null&&(Ur?(t=Vt,l=l.stateNode,t.nodeType===8?Rl(t.parentNode,l):t.nodeType===1&&Rl(t,l),es(t)):Rl(Vt,l.stateNode));break;case 4:d=Vt,p=Ur,Vt=l.stateNode.containerInfo,Ur=!0,Ws(t,r,l),Vt=d,Ur=p;break;case 0:case 11:case 14:case 15:if(!Zt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){p=d=d.next;do{var g=p,T=g.destroy;g=g.tag,T!==void 0&&((g&2)!==0||(g&4)!==0)&&xc(l,r,T),p=p.next}while(p!==d)}Ws(t,r,l);break;case 1:if(!Zt&&(ga(l,r),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(U){Tt(l,r,U)}Ws(t,r,l);break;case 21:Ws(t,r,l);break;case 22:l.mode&1?(Zt=(d=Zt)||l.memoizedState!==null,Ws(t,r,l),Zt=d):Ws(t,r,l);break;default:Ws(t,r,l)}}function Qm(t){var r=t.updateQueue;if(r!==null){t.updateQueue=null;var l=t.stateNode;l===null&&(l=t.stateNode=new Q0),r.forEach(function(d){var p=ig.bind(null,t,d);l.has(d)||(l.add(d),d.then(p,p))})}}function Br(t,r){var l=r.deletions;if(l!==null)for(var d=0;d<l.length;d++){var p=l[d];try{var g=t,T=r,U=T;e:for(;U!==null;){switch(U.tag){case 5:Vt=U.stateNode,Ur=!1;break e;case 3:Vt=U.stateNode.containerInfo,Ur=!0;break e;case 4:Vt=U.stateNode.containerInfo,Ur=!0;break e}U=U.return}if(Vt===null)throw Error(n(160));Ym(g,T,p),Vt=null,Ur=!1;var W=p.alternate;W!==null&&(W.return=null),p.return=null}catch(ae){Tt(p,r,ae)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Xm(r,t),r=r.sibling}function Xm(t,r){var l=t.alternate,d=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Br(r,t),is(t),d&4){try{po(3,t,t.return),Si(3,t)}catch(Me){Tt(t,t.return,Me)}try{po(5,t,t.return)}catch(Me){Tt(t,t.return,Me)}}break;case 1:Br(r,t),is(t),d&512&&l!==null&&ga(l,l.return);break;case 5:if(Br(r,t),is(t),d&512&&l!==null&&ga(l,l.return),t.flags&32){var p=t.stateNode;try{_s(p,"")}catch(Me){Tt(t,t.return,Me)}}if(d&4&&(p=t.stateNode,p!=null)){var g=t.memoizedProps,T=l!==null?l.memoizedProps:g,U=t.type,W=t.updateQueue;if(t.updateQueue=null,W!==null)try{U==="input"&&g.type==="radio"&&g.name!=null&&ct(p,g),an(U,T);var ae=an(U,g);for(T=0;T<W.length;T+=2){var be=W[T],we=W[T+1];be==="style"?Ma(p,we):be==="dangerouslySetInnerHTML"?Un(p,we):be==="children"?_s(p,we):D(p,be,we,ae)}switch(U){case"input":pr(p,g);break;case"textarea":$n(p,g);break;case"select":var ye=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!g.multiple;var De=g.value;De!=null?Jr(p,!!g.multiple,De,!1):ye!==!!g.multiple&&(g.defaultValue!=null?Jr(p,!!g.multiple,g.defaultValue,!0):Jr(p,!!g.multiple,g.multiple?[]:"",!1))}p[ro]=g}catch(Me){Tt(t,t.return,Me)}}break;case 6:if(Br(r,t),is(t),d&4){if(t.stateNode===null)throw Error(n(162));p=t.stateNode,g=t.memoizedProps;try{p.nodeValue=g}catch(Me){Tt(t,t.return,Me)}}break;case 3:if(Br(r,t),is(t),d&4&&l!==null&&l.memoizedState.isDehydrated)try{es(r.containerInfo)}catch(Me){Tt(t,t.return,Me)}break;case 4:Br(r,t),is(t);break;case 13:Br(r,t),is(t),p=t.child,p.flags&8192&&(g=p.memoizedState!==null,p.stateNode.isHidden=g,!g||p.alternate!==null&&p.alternate.memoizedState!==null||(Nc=St())),d&4&&Qm(t);break;case 22:if(be=l!==null&&l.memoizedState!==null,t.mode&1?(Zt=(ae=Zt)||be,Br(r,t),Zt=ae):Br(r,t),is(t),d&8192){if(ae=t.memoizedState!==null,(t.stateNode.isHidden=ae)&&!be&&(t.mode&1)!==0)for(Re=t,be=t.child;be!==null;){for(we=Re=be;Re!==null;){switch(ye=Re,De=ye.child,ye.tag){case 0:case 11:case 14:case 15:po(4,ye,ye.return);break;case 1:ga(ye,ye.return);var Oe=ye.stateNode;if(typeof Oe.componentWillUnmount=="function"){d=ye,l=ye.return;try{r=d,Oe.props=r.memoizedProps,Oe.state=r.memoizedState,Oe.componentWillUnmount()}catch(Me){Tt(d,l,Me)}}break;case 5:ga(ye,ye.return);break;case 22:if(ye.memoizedState!==null){th(we);continue}}De!==null?(De.return=ye,Re=De):th(we)}be=be.sibling}e:for(be=null,we=t;;){if(we.tag===5){if(be===null){be=we;try{p=we.stateNode,ae?(g=p.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(U=we.stateNode,W=we.memoizedProps.style,T=W!=null&&W.hasOwnProperty("display")?W.display:null,U.style.display=Bn("display",T))}catch(Me){Tt(t,t.return,Me)}}}else if(we.tag===6){if(be===null)try{we.stateNode.nodeValue=ae?"":we.memoizedProps}catch(Me){Tt(t,t.return,Me)}}else if((we.tag!==22&&we.tag!==23||we.memoizedState===null||we===t)&&we.child!==null){we.child.return=we,we=we.child;continue}if(we===t)break e;for(;we.sibling===null;){if(we.return===null||we.return===t)break e;be===we&&(be=null),we=we.return}be===we&&(be=null),we.sibling.return=we.return,we=we.sibling}}break;case 19:Br(r,t),is(t),d&4&&Qm(t);break;case 21:break;default:Br(r,t),is(t)}}function is(t){var r=t.flags;if(r&2){try{e:{for(var l=t.return;l!==null;){if(Km(l)){var d=l;break e}l=l.return}throw Error(n(160))}switch(d.tag){case 5:var p=d.stateNode;d.flags&32&&(_s(p,""),d.flags&=-33);var g=Jm(t);vc(t,g,p);break;case 3:case 4:var T=d.stateNode.containerInfo,U=Jm(t);bc(t,U,T);break;default:throw Error(n(161))}}catch(W){Tt(t,t.return,W)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Z0(t,r,l){Re=t,Zm(t)}function Zm(t,r,l){for(var d=(t.mode&1)!==0;Re!==null;){var p=Re,g=p.child;if(p.tag===22&&d){var T=p.memoizedState!==null||Ni;if(!T){var U=p.alternate,W=U!==null&&U.memoizedState!==null||Zt;U=Ni;var ae=Zt;if(Ni=T,(Zt=W)&&!ae)for(Re=p;Re!==null;)T=Re,W=T.child,T.tag===22&&T.memoizedState!==null?rh(p):W!==null?(W.return=T,Re=W):rh(p);for(;g!==null;)Re=g,Zm(g),g=g.sibling;Re=p,Ni=U,Zt=ae}eh(t)}else(p.subtreeFlags&8772)!==0&&g!==null?(g.return=p,Re=g):eh(t)}}function eh(t){for(;Re!==null;){var r=Re;if((r.flags&8772)!==0){var l=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:Zt||Si(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!Zt)if(l===null)d.componentDidMount();else{var p=r.elementType===r.type?l.memoizedProps:$r(r.type,l.memoizedProps);d.componentDidUpdate(p,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var g=r.updateQueue;g!==null&&tm(r,g,d);break;case 3:var T=r.updateQueue;if(T!==null){if(l=null,r.child!==null)switch(r.child.tag){case 5:l=r.child.stateNode;break;case 1:l=r.child.stateNode}tm(r,T,l)}break;case 5:var U=r.stateNode;if(l===null&&r.flags&4){l=U;var W=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":W.autoFocus&&l.focus();break;case"img":W.src&&(l.src=W.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var ae=r.alternate;if(ae!==null){var be=ae.memoizedState;if(be!==null){var we=be.dehydrated;we!==null&&es(we)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Zt||r.flags&512&&yc(r)}catch(ye){Tt(r,r.return,ye)}}if(r===t){Re=null;break}if(l=r.sibling,l!==null){l.return=r.return,Re=l;break}Re=r.return}}function th(t){for(;Re!==null;){var r=Re;if(r===t){Re=null;break}var l=r.sibling;if(l!==null){l.return=r.return,Re=l;break}Re=r.return}}function rh(t){for(;Re!==null;){var r=Re;try{switch(r.tag){case 0:case 11:case 15:var l=r.return;try{Si(4,r)}catch(W){Tt(r,l,W)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var p=r.return;try{d.componentDidMount()}catch(W){Tt(r,p,W)}}var g=r.return;try{yc(r)}catch(W){Tt(r,g,W)}break;case 5:var T=r.return;try{yc(r)}catch(W){Tt(r,T,W)}}}catch(W){Tt(r,r.return,W)}if(r===t){Re=null;break}var U=r.sibling;if(U!==null){U.return=r.return,Re=U;break}Re=r.return}}var eg=Math.ceil,ki=M.ReactCurrentDispatcher,wc=M.ReactCurrentOwner,Pr=M.ReactCurrentBatchConfig,dt=0,qt=null,It=null,Gt=0,wr=0,xa=Us(0),Lt=0,fo=null,_n=0,_i=0,jc=0,go=null,dr=null,Nc=0,ya=1/0,js=null,Ci=!1,Sc=null,Vs=null,Ei=!1,Gs=null,Ti=0,xo=0,kc=null,Di=-1,Pi=0;function sr(){return(dt&6)!==0?St():Di!==-1?Di:Di=St()}function Ks(t){return(t.mode&1)===0?1:(dt&2)!==0&&Gt!==0?Gt&-Gt:L0.transition!==null?(Pi===0&&(Pi=$a()),Pi):(t=mt,t!==0||(t=window.event,t=t===void 0?16:Qn(t.type)),t)}function qr(t,r,l,d){if(50<xo)throw xo=0,kc=null,Error(n(185));mn(t,l,d),((dt&2)===0||t!==qt)&&(t===qt&&((dt&2)===0&&(_i|=l),Lt===4&&Js(t,Gt)),ur(t,d),l===1&&dt===0&&(r.mode&1)===0&&(ya=St()+500,ai&&qs()))}function ur(t,r){var l=t.callbackNode;Lo(t,r);var d=Vn(t,t===qt?Gt:0);if(d===0)l!==null&&Io(l),t.callbackNode=null,t.callbackPriority=0;else if(r=d&-d,t.callbackPriority!==r){if(l!=null&&Io(l),r===1)t.tag===0?M0(nh.bind(null,t)):zu(nh.bind(null,t)),I0(function(){(dt&6)===0&&qs()}),l=null;else{switch($o(d)){case 1:l=Ds;break;case 4:l=ar;break;case 16:l=Ps;break;case 536870912:l=ds;break;default:l=Ps}l=mh(l,sh.bind(null,t))}t.callbackPriority=r,t.callbackNode=l}}function sh(t,r){if(Di=-1,Pi=0,(dt&6)!==0)throw Error(n(327));var l=t.callbackNode;if(ba()&&t.callbackNode!==l)return null;var d=Vn(t,t===qt?Gt:0);if(d===0)return null;if((d&30)!==0||(d&t.expiredLanes)!==0||r)r=Ii(t,d);else{r=d;var p=dt;dt|=2;var g=oh();(qt!==t||Gt!==r)&&(js=null,ya=St()+500,En(t,r));do try{sg();break}catch(U){ah(t,U)}while(!0);zl(),ki.current=g,dt=p,It!==null?r=0:(qt=null,Gt=0,r=Lt)}if(r!==0){if(r===2&&(p=Ar(t),p!==0&&(d=p,r=_c(t,p))),r===1)throw l=fo,En(t,0),Js(t,d),ur(t,St()),l;if(r===6)Js(t,d);else{if(p=t.current.alternate,(d&30)===0&&!tg(p)&&(r=Ii(t,d),r===2&&(g=Ar(t),g!==0&&(d=g,r=_c(t,g))),r===1))throw l=fo,En(t,0),Js(t,d),ur(t,St()),l;switch(t.finishedWork=p,t.finishedLanes=d,r){case 0:case 1:throw Error(n(345));case 2:Tn(t,dr,js);break;case 3:if(Js(t,d),(d&130023424)===d&&(r=Nc+500-St(),10<r)){if(Vn(t,0)!==0)break;if(p=t.suspendedLanes,(p&d)!==d){sr(),t.pingedLanes|=t.suspendedLanes&p;break}t.timeoutHandle=Il(Tn.bind(null,t,dr,js),r);break}Tn(t,dr,js);break;case 4:if(Js(t,d),(d&4194240)===d)break;for(r=t.eventTimes,p=-1;0<d;){var T=31-gr(d);g=1<<T,T=r[T],T>p&&(p=T),d&=~g}if(d=p,d=St()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*eg(d/1960))-d,10<d){t.timeoutHandle=Il(Tn.bind(null,t,dr,js),d);break}Tn(t,dr,js);break;case 5:Tn(t,dr,js);break;default:throw Error(n(329))}}}return ur(t,St()),t.callbackNode===l?sh.bind(null,t):null}function _c(t,r){var l=go;return t.current.memoizedState.isDehydrated&&(En(t,r).flags|=256),t=Ii(t,r),t!==2&&(r=dr,dr=l,r!==null&&Cc(r)),t}function Cc(t){dr===null?dr=t:dr.push.apply(dr,t)}function tg(t){for(var r=t;;){if(r.flags&16384){var l=r.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var p=l[d],g=p.getSnapshot;p=p.value;try{if(!Lr(g(),p))return!1}catch{return!1}}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Js(t,r){for(r&=~jc,r&=~_i,t.suspendedLanes|=r,t.pingedLanes&=~r,t=t.expirationTimes;0<r;){var l=31-gr(r),d=1<<l;t[l]=-1,r&=~d}}function nh(t){if((dt&6)!==0)throw Error(n(327));ba();var r=Vn(t,0);if((r&1)===0)return ur(t,St()),null;var l=Ii(t,r);if(t.tag!==0&&l===2){var d=Ar(t);d!==0&&(r=d,l=_c(t,d))}if(l===1)throw l=fo,En(t,0),Js(t,r),ur(t,St()),l;if(l===6)throw Error(n(345));return t.finishedWork=t.current.alternate,t.finishedLanes=r,Tn(t,dr,js),ur(t,St()),null}function Ec(t,r){var l=dt;dt|=1;try{return t(r)}finally{dt=l,dt===0&&(ya=St()+500,ai&&qs())}}function Cn(t){Gs!==null&&Gs.tag===0&&(dt&6)===0&&ba();var r=dt;dt|=1;var l=Pr.transition,d=mt;try{if(Pr.transition=null,mt=1,t)return t()}finally{mt=d,Pr.transition=l,dt=r,(dt&6)===0&&qs()}}function Tc(){wr=xa.current,wt(xa)}function En(t,r){t.finishedWork=null,t.finishedLanes=0;var l=t.timeoutHandle;if(l!==-1&&(t.timeoutHandle=-1,P0(l)),It!==null)for(l=It.return;l!==null;){var d=l;switch(Fl(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&si();break;case 3:pa(),wt(ir),wt(Yt),Ql();break;case 5:Jl(d);break;case 4:pa();break;case 13:wt(_t);break;case 19:wt(_t);break;case 10:Hl(d.type._context);break;case 22:case 23:Tc()}l=l.return}if(qt=t,It=t=Ys(t.current,null),Gt=wr=r,Lt=0,fo=null,jc=_i=_n=0,dr=go=null,Nn!==null){for(r=0;r<Nn.length;r++)if(l=Nn[r],d=l.interleaved,d!==null){l.interleaved=null;var p=d.next,g=l.pending;if(g!==null){var T=g.next;g.next=p,d.next=T}l.pending=d}Nn=null}return t}function ah(t,r){do{var l=It;try{if(zl(),fi.current=bi,gi){for(var d=Ct.memoizedState;d!==null;){var p=d.queue;p!==null&&(p.pending=null),d=d.next}gi=!1}if(kn=0,Bt=Mt=Ct=null,lo=!1,co=0,wc.current=null,l===null||l.return===null){Lt=1,fo=r,It=null;break}e:{var g=t,T=l.return,U=l,W=r;if(r=Gt,U.flags|=32768,W!==null&&typeof W=="object"&&typeof W.then=="function"){var ae=W,be=U,we=be.tag;if((be.mode&1)===0&&(we===0||we===11||we===15)){var ye=be.alternate;ye?(be.updateQueue=ye.updateQueue,be.memoizedState=ye.memoizedState,be.lanes=ye.lanes):(be.updateQueue=null,be.memoizedState=null)}var De=Dm(T);if(De!==null){De.flags&=-257,Pm(De,T,U,g,r),De.mode&1&&Tm(g,ae,r),r=De,W=ae;var Oe=r.updateQueue;if(Oe===null){var Me=new Set;Me.add(W),r.updateQueue=Me}else Oe.add(W);break e}else{if((r&1)===0){Tm(g,ae,r),Dc();break e}W=Error(n(426))}}else if(jt&&U.mode&1){var Dt=Dm(T);if(Dt!==null){(Dt.flags&65536)===0&&(Dt.flags|=256),Pm(Dt,T,U,g,r),Bl(fa(W,U));break e}}g=W=fa(W,U),Lt!==4&&(Lt=2),go===null?go=[g]:go.push(g),g=T;do{switch(g.tag){case 3:g.flags|=65536,r&=-r,g.lanes|=r;var X=Cm(g,W,r);em(g,X);break e;case 1:U=W;var V=g.type,Z=g.stateNode;if((g.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(Vs===null||!Vs.has(Z)))){g.flags|=65536,r&=-r,g.lanes|=r;var Se=Em(g,U,r);em(g,Se);break e}}g=g.return}while(g!==null)}lh(l)}catch($e){r=$e,It===l&&l!==null&&(It=l=l.return);continue}break}while(!0)}function oh(){var t=ki.current;return ki.current=bi,t===null?bi:t}function Dc(){(Lt===0||Lt===3||Lt===2)&&(Lt=4),qt===null||(_n&268435455)===0&&(_i&268435455)===0||Js(qt,Gt)}function Ii(t,r){var l=dt;dt|=2;var d=oh();(qt!==t||Gt!==r)&&(js=null,En(t,r));do try{rg();break}catch(p){ah(t,p)}while(!0);if(zl(),dt=l,ki.current=d,It!==null)throw Error(n(261));return qt=null,Gt=0,Lt}function rg(){for(;It!==null;)ih(It)}function sg(){for(;It!==null&&!pl();)ih(It)}function ih(t){var r=uh(t.alternate,t,wr);t.memoizedProps=t.pendingProps,r===null?lh(t):It=r,wc.current=null}function lh(t){var r=t;do{var l=r.alternate;if(t=r.return,(r.flags&32768)===0){if(l=J0(l,r,wr),l!==null){It=l;return}}else{if(l=Y0(l,r),l!==null){l.flags&=32767,It=l;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Lt=6,It=null;return}}if(r=r.sibling,r!==null){It=r;return}It=r=t}while(r!==null);Lt===0&&(Lt=5)}function Tn(t,r,l){var d=mt,p=Pr.transition;try{Pr.transition=null,mt=1,ng(t,r,l,d)}finally{Pr.transition=p,mt=d}return null}function ng(t,r,l,d){do ba();while(Gs!==null);if((dt&6)!==0)throw Error(n(327));l=t.finishedWork;var p=t.finishedLanes;if(l===null)return null;if(t.finishedWork=null,t.finishedLanes=0,l===t.current)throw Error(n(177));t.callbackNode=null,t.callbackPriority=0;var g=l.lanes|l.childLanes;if(cu(t,g),t===qt&&(It=qt=null,Gt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Ei||(Ei=!0,mh(Ps,function(){return ba(),null})),g=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||g){g=Pr.transition,Pr.transition=null;var T=mt;mt=1;var U=dt;dt|=4,wc.current=null,X0(t,l),Xm(l,t),S0(Dl),ms=!!Tl,Dl=Tl=null,t.current=l,Z0(l),Fa(),dt=U,mt=T,Pr.transition=g}else t.current=l;if(Ei&&(Ei=!1,Gs=t,Ti=p),g=t.pendingLanes,g===0&&(Vs=null),gl(l.stateNode),ur(t,St()),r!==null)for(d=t.onRecoverableError,l=0;l<r.length;l++)p=r[l],d(p.value,{componentStack:p.stack,digest:p.digest});if(Ci)throw Ci=!1,t=Sc,Sc=null,t;return(Ti&1)!==0&&t.tag!==0&&ba(),g=t.pendingLanes,(g&1)!==0?t===kc?xo++:(xo=0,kc=t):xo=0,qs(),null}function ba(){if(Gs!==null){var t=$o(Ti),r=Pr.transition,l=mt;try{if(Pr.transition=null,mt=16>t?16:t,Gs===null)var d=!1;else{if(t=Gs,Gs=null,Ti=0,(dt&6)!==0)throw Error(n(331));var p=dt;for(dt|=4,Re=t.current;Re!==null;){var g=Re,T=g.child;if((Re.flags&16)!==0){var U=g.deletions;if(U!==null){for(var W=0;W<U.length;W++){var ae=U[W];for(Re=ae;Re!==null;){var be=Re;switch(be.tag){case 0:case 11:case 15:po(8,be,g)}var we=be.child;if(we!==null)we.return=be,Re=we;else for(;Re!==null;){be=Re;var ye=be.sibling,De=be.return;if(Gm(be),be===ae){Re=null;break}if(ye!==null){ye.return=De,Re=ye;break}Re=De}}}var Oe=g.alternate;if(Oe!==null){var Me=Oe.child;if(Me!==null){Oe.child=null;do{var Dt=Me.sibling;Me.sibling=null,Me=Dt}while(Me!==null)}}Re=g}}if((g.subtreeFlags&2064)!==0&&T!==null)T.return=g,Re=T;else e:for(;Re!==null;){if(g=Re,(g.flags&2048)!==0)switch(g.tag){case 0:case 11:case 15:po(9,g,g.return)}var X=g.sibling;if(X!==null){X.return=g.return,Re=X;break e}Re=g.return}}var V=t.current;for(Re=V;Re!==null;){T=Re;var Z=T.child;if((T.subtreeFlags&2064)!==0&&Z!==null)Z.return=T,Re=Z;else e:for(T=V;Re!==null;){if(U=Re,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:Si(9,U)}}catch($e){Tt(U,U.return,$e)}if(U===T){Re=null;break e}var Se=U.sibling;if(Se!==null){Se.return=U.return,Re=Se;break e}Re=U.return}}if(dt=p,qs(),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(dn,t)}catch{}d=!0}return d}finally{mt=l,Pr.transition=r}}return!1}function ch(t,r,l){r=fa(l,r),r=Cm(t,r,1),t=Hs(t,r,1),r=sr(),t!==null&&(mn(t,1,r),ur(t,r))}function Tt(t,r,l){if(t.tag===3)ch(t,t,l);else for(;r!==null;){if(r.tag===3){ch(r,t,l);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Vs===null||!Vs.has(d))){t=fa(l,t),t=Em(r,t,1),r=Hs(r,t,1),t=sr(),r!==null&&(mn(r,1,t),ur(r,t));break}}r=r.return}}function ag(t,r,l){var d=t.pingCache;d!==null&&d.delete(r),r=sr(),t.pingedLanes|=t.suspendedLanes&l,qt===t&&(Gt&l)===l&&(Lt===4||Lt===3&&(Gt&130023424)===Gt&&500>St()-Nc?En(t,0):jc|=l),ur(t,r)}function dh(t,r){r===0&&((t.mode&1)===0?r=1:(r=Wn,Wn<<=1,(Wn&130023424)===0&&(Wn=4194304)));var l=sr();t=bs(t,r),t!==null&&(mn(t,r,l),ur(t,l))}function og(t){var r=t.memoizedState,l=0;r!==null&&(l=r.retryLane),dh(t,l)}function ig(t,r){var l=0;switch(t.tag){case 13:var d=t.stateNode,p=t.memoizedState;p!==null&&(l=p.retryLane);break;case 19:d=t.stateNode;break;default:throw Error(n(314))}d!==null&&d.delete(r),dh(t,l)}var uh;uh=function(t,r,l){if(t!==null)if(t.memoizedProps!==r.pendingProps||ir.current)cr=!0;else{if((t.lanes&l)===0&&(r.flags&128)===0)return cr=!1,K0(t,r,l);cr=(t.flags&131072)!==0}else cr=!1,jt&&(r.flags&1048576)!==0&&Hu(r,ii,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;ji(t,r),t=r.pendingProps;var p=ia(r,Yt.current);ha(r,l),p=ec(null,r,d,t,p,l);var g=tc();return r.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,lr(d)?(g=!0,ni(r)):g=!1,r.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Gl(r),p.updater=vi,r.stateNode=p,p._reactInternals=r,ic(r,d,t,l),r=uc(null,r,d,!0,g,l)):(r.tag=0,jt&&g&&Ll(r),rr(null,r,p,l),r=r.child),r;case 16:d=r.elementType;e:{switch(ji(t,r),t=r.pendingProps,p=d._init,d=p(d._payload),r.type=d,p=r.tag=cg(d),t=$r(d,t),p){case 0:r=dc(null,r,d,t,l);break e;case 1:r=Lm(null,r,d,t,l);break e;case 11:r=Im(null,r,d,t,l);break e;case 14:r=Rm(null,r,d,$r(d.type,t),l);break e}throw Error(n(306,d,""))}return r;case 0:return d=r.type,p=r.pendingProps,p=r.elementType===d?p:$r(d,p),dc(t,r,d,p,l);case 1:return d=r.type,p=r.pendingProps,p=r.elementType===d?p:$r(d,p),Lm(t,r,d,p,l);case 3:e:{if(Fm(r),t===null)throw Error(n(387));d=r.pendingProps,g=r.memoizedState,p=g.element,Zu(t,r),hi(r,d,null,l);var T=r.memoizedState;if(d=T.element,g.isDehydrated)if(g={element:d,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){p=fa(Error(n(423)),r),r=$m(t,r,d,l,p);break e}else if(d!==p){p=fa(Error(n(424)),r),r=$m(t,r,d,l,p);break e}else for(vr=$s(r.stateNode.containerInfo.firstChild),br=r,jt=!0,Fr=null,l=Qu(r,null,d,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(da(),d===p){r=ws(t,r,l);break e}rr(t,r,d,l)}r=r.child}return r;case 5:return rm(r),t===null&&Ul(r),d=r.type,p=r.pendingProps,g=t!==null?t.memoizedProps:null,T=p.children,Pl(d,p)?T=null:g!==null&&Pl(d,g)&&(r.flags|=32),Mm(t,r),rr(t,r,T,l),r.child;case 6:return t===null&&Ul(r),null;case 13:return Um(t,r,l);case 4:return Kl(r,r.stateNode.containerInfo),d=r.pendingProps,t===null?r.child=ua(r,null,d,l):rr(t,r,d,l),r.child;case 11:return d=r.type,p=r.pendingProps,p=r.elementType===d?p:$r(d,p),Im(t,r,d,p,l);case 7:return rr(t,r,r.pendingProps,l),r.child;case 8:return rr(t,r,r.pendingProps.children,l),r.child;case 12:return rr(t,r,r.pendingProps.children,l),r.child;case 10:e:{if(d=r.type._context,p=r.pendingProps,g=r.memoizedProps,T=p.value,gt(di,d._currentValue),d._currentValue=T,g!==null)if(Lr(g.value,T)){if(g.children===p.children&&!ir.current){r=ws(t,r,l);break e}}else for(g=r.child,g!==null&&(g.return=r);g!==null;){var U=g.dependencies;if(U!==null){T=g.child;for(var W=U.firstContext;W!==null;){if(W.context===d){if(g.tag===1){W=vs(-1,l&-l),W.tag=2;var ae=g.updateQueue;if(ae!==null){ae=ae.shared;var be=ae.pending;be===null?W.next=W:(W.next=be.next,be.next=W),ae.pending=W}}g.lanes|=l,W=g.alternate,W!==null&&(W.lanes|=l),Wl(g.return,l,r),U.lanes|=l;break}W=W.next}}else if(g.tag===10)T=g.type===r.type?null:g.child;else if(g.tag===18){if(T=g.return,T===null)throw Error(n(341));T.lanes|=l,U=T.alternate,U!==null&&(U.lanes|=l),Wl(T,l,r),T=g.sibling}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===r){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}rr(t,r,p.children,l),r=r.child}return r;case 9:return p=r.type,d=r.pendingProps.children,ha(r,l),p=Tr(p),d=d(p),r.flags|=1,rr(t,r,d,l),r.child;case 14:return d=r.type,p=$r(d,r.pendingProps),p=$r(d.type,p),Rm(t,r,d,p,l);case 15:return Am(t,r,r.type,r.pendingProps,l);case 17:return d=r.type,p=r.pendingProps,p=r.elementType===d?p:$r(d,p),ji(t,r),r.tag=1,lr(d)?(t=!0,ni(r)):t=!1,ha(r,l),km(r,d,p),ic(r,d,p,l),uc(null,r,d,!0,t,l);case 19:return qm(t,r,l);case 22:return Om(t,r,l)}throw Error(n(156,r.tag))};function mh(t,r){return cn(t,r)}function lg(t,r,l,d){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,r,l,d){return new lg(t,r,l,d)}function Pc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cg(t){if(typeof t=="function")return Pc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===he)return 11;if(t===z)return 14}return 2}function Ys(t,r){var l=t.alternate;return l===null?(l=Ir(t.tag,r,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=r,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&14680064,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,r=t.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l}function Ri(t,r,l,d,p,g){var T=2;if(d=t,typeof t=="function")Pc(t)&&(T=1);else if(typeof t=="string")T=5;else e:switch(t){case A:return Dn(l.children,p,g,r);case Q:T=8,p|=8;break;case G:return t=Ir(12,l,r,p|2),t.elementType=G,t.lanes=g,t;case P:return t=Ir(13,l,r,p),t.elementType=P,t.lanes=g,t;case L:return t=Ir(19,l,r,p),t.elementType=L,t.lanes=g,t;case se:return Ai(l,p,g,r);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case re:T=10;break e;case le:T=9;break e;case he:T=11;break e;case z:T=14;break e;case ee:T=16,d=null;break e}throw Error(n(130,t==null?t:typeof t,""))}return r=Ir(T,l,r,p),r.elementType=t,r.type=d,r.lanes=g,r}function Dn(t,r,l,d){return t=Ir(7,t,d,r),t.lanes=l,t}function Ai(t,r,l,d){return t=Ir(22,t,d,r),t.elementType=se,t.lanes=l,t.stateNode={isHidden:!1},t}function Ic(t,r,l){return t=Ir(6,t,null,r),t.lanes=l,t}function Rc(t,r,l){return r=Ir(4,t.children!==null?t.children:[],t.key,r),r.lanes=l,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}function dg(t,r,l,d,p){this.tag=r,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fo(0),this.expirationTimes=Fo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fo(0),this.identifierPrefix=d,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Ac(t,r,l,d,p,g,T,U,W){return t=new dg(t,r,l,U,W),r===1?(r=1,g===!0&&(r|=8)):r=0,g=Ir(3,null,null,r),t.current=g,g.stateNode=t,g.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gl(g),t}function ug(t,r,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:d==null?null:""+d,children:t,containerInfo:r,implementation:l}}function hh(t){if(!t)return Bs;t=t._reactInternals;e:{if(Ut(t)!==t||t.tag!==1)throw Error(n(170));var r=t;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(lr(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(n(171))}if(t.tag===1){var l=t.type;if(lr(l))return Bu(t,l,r)}return r}function ph(t,r,l,d,p,g,T,U,W){return t=Ac(l,d,!0,t,p,g,T,U,W),t.context=hh(null),l=t.current,d=sr(),p=Ks(l),g=vs(d,p),g.callback=r??null,Hs(l,g,p),t.current.lanes=p,mn(t,p,d),ur(t,d),t}function Oi(t,r,l,d){var p=r.current,g=sr(),T=Ks(p);return l=hh(l),r.context===null?r.context=l:r.pendingContext=l,r=vs(g,T),r.payload={element:t},d=d===void 0?null:d,d!==null&&(r.callback=d),t=Hs(p,r,T),t!==null&&(qr(t,p,T,g),mi(t,p,T)),T}function Mi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fh(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<r?l:r}}function Oc(t,r){fh(t,r),(t=t.alternate)&&fh(t,r)}function mg(){return null}var gh=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mc(t){this._internalRoot=t}Li.prototype.render=Mc.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(n(409));Oi(t,r,null,null)},Li.prototype.unmount=Mc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Cn(function(){Oi(null,t,null,null)}),r[fs]=null}};function Li(t){this._internalRoot=t}Li.prototype.unstable_scheduleHydration=function(t){if(t){var r=hn();t={blockedOn:null,target:t,priority:r};for(var l=0;l<Mr.length&&r!==0&&r<Mr[l].priority;l++);Mr.splice(l,0,t),l===0&&za(t)}};function Lc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Fi(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xh(){}function hg(t,r,l,d,p){if(p){if(typeof d=="function"){var g=d;d=function(){var ae=Mi(T);g.call(ae)}}var T=ph(r,d,t,0,null,!1,!1,"",xh);return t._reactRootContainer=T,t[fs]=T.current,eo(t.nodeType===8?t.parentNode:t),Cn(),T}for(;p=t.lastChild;)t.removeChild(p);if(typeof d=="function"){var U=d;d=function(){var ae=Mi(W);U.call(ae)}}var W=Ac(t,0,!1,null,null,!1,!1,"",xh);return t._reactRootContainer=W,t[fs]=W.current,eo(t.nodeType===8?t.parentNode:t),Cn(function(){Oi(r,W,l,d)}),W}function $i(t,r,l,d,p){var g=l._reactRootContainer;if(g){var T=g;if(typeof p=="function"){var U=p;p=function(){var W=Mi(T);U.call(W)}}Oi(r,T,t,p)}else T=hg(l,r,t,p,d);return Mi(T)}Uo=function(t){switch(t.tag){case 3:var r=t.stateNode;if(r.current.memoizedState.isDehydrated){var l=un(r.pendingLanes);l!==0&&(Ua(r,l|1),ur(r,St()),(dt&6)===0&&(ya=St()+500,qs()))}break;case 13:Cn(function(){var d=bs(t,1);if(d!==null){var p=sr();qr(d,t,1,p)}}),Oc(t,1)}},Gn=function(t){if(t.tag===13){var r=bs(t,134217728);if(r!==null){var l=sr();qr(r,t,134217728,l)}Oc(t,134217728)}},Ba=function(t){if(t.tag===13){var r=Ks(t),l=bs(t,r);if(l!==null){var d=sr();qr(l,t,r,d)}Oc(t,r)}},hn=function(){return mt},Bo=function(t,r){var l=mt;try{return mt=t,r()}finally{mt=l}},qn=function(t,r,l){switch(r){case"input":if(pr(t,l),r=l.name,l.type==="radio"&&r!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<l.length;r++){var d=l[r];if(d!==t&&d.form===t.form){var p=ri(d);if(!p)throw Error(n(90));nt(d),pr(d,p)}}}break;case"textarea":$n(t,l);break;case"select":r=l.value,r!=null&&Jr(t,!!l.multiple,r,!1)}},ie=Ec,qe=Cn;var pg={usingClientEntryPoint:!1,Events:[so,aa,ri,ne,Ee,Ec]},yo={findFiberByHostInstance:bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fg={bundleType:yo.bundleType,version:yo.version,rendererPackageName:yo.rendererPackageName,rendererConfig:yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=La(t),t===null?null:t.stateNode},findFiberByHostInstance:yo.findFiberByHostInstance||mg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ui.isDisabled&&Ui.supportsFiber)try{dn=Ui.inject(fg),_r=Ui}catch{}}return mr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pg,mr.createPortal=function(t,r){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lc(r))throw Error(n(200));return ug(t,r,null,l)},mr.createRoot=function(t,r){if(!Lc(t))throw Error(n(299));var l=!1,d="",p=gh;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(p=r.onRecoverableError)),r=Ac(t,1,!1,null,null,l,!1,d,p),t[fs]=r.current,eo(t.nodeType===8?t.parentNode:t),new Mc(r)},mr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(n(188)):(t=Object.keys(t).join(","),Error(n(268,t)));return t=La(r),t=t===null?null:t.stateNode,t},mr.flushSync=function(t){return Cn(t)},mr.hydrate=function(t,r,l){if(!Fi(r))throw Error(n(200));return $i(null,t,r,!0,l)},mr.hydrateRoot=function(t,r,l){if(!Lc(t))throw Error(n(405));var d=l!=null&&l.hydratedSources||null,p=!1,g="",T=gh;if(l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(T=l.onRecoverableError)),r=ph(r,null,t,1,l??null,p,!1,g,T),t[fs]=r.current,eo(t),d)for(t=0;t<d.length;t++)l=d[t],p=l._getVersion,p=p(l._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[l,p]:r.mutableSourceEagerHydrationData.push(l,p);return new Li(r)},mr.render=function(t,r,l){if(!Fi(r))throw Error(n(200));return $i(null,t,r,!1,l)},mr.unmountComponentAtNode=function(t){if(!Fi(t))throw Error(n(40));return t._reactRootContainer?(Cn(function(){$i(null,null,t,!1,function(){t._reactRootContainer=null,t[fs]=null})}),!0):!1},mr.unstable_batchedUpdates=Ec,mr.unstable_renderSubtreeIntoContainer=function(t,r,l,d){if(!Fi(l))throw Error(n(200));if(t==null||t._reactInternals===void 0)throw Error(n(38));return $i(t,r,l,!1,d)},mr.version="18.3.1-next-f1338f8080-20240426",mr}var kh;function Sg(){if(kh)return Uc.exports;kh=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(s){console.error(s)}}return a(),Uc.exports=Ng(),Uc.exports}var _h;function kg(){if(_h)return Bi;_h=1;var a=Sg();return Bi.createRoot=a.createRoot,Bi.hydrateRoot=a.hydrateRoot,Bi}var _g=kg();const Yp=il(_g),Ch={appName:"CuraSoft",male:"",female:"",other:"","common.edit":"","common.cancel":"","common.save":"","common.delete":"","common.confirmDelete":"           .","common.saveChanges":" ","common.closeForm":" ","common.close":"","common.unknownPatient":"  ","common.unknownDentist":"   ","common.unknownTreatment":"  ","common.unknownMaterial":"  ","common.na":" ","common.sendWhatsApp":" ","common.print":"  ","auth.config.title":"   ","auth.config.message":"        Supabase URL  Key  .","auth.config.instructions":"      `backend_setup.md`   Supabase    (`SUPABASE_URL`  `SUPABASE_ANON_KEY`)     .","auth.login.welcome":" !    .","auth.login.email":" ","auth.login.button":" ","auth.login.error":"      .","auth.login.noAccount":"     ","auth.signup.title":"  ","auth.signup.button":" ","auth.signup.success":"   !       .","auth.signup.backToLogin":"     ","auth.loading":" ...","auth.logout.button":" ","auth.login.title":" ","auth.login.subtitle":"      ","auth.login.username":" ","auth.login.password":" ","auth.login.loginButton":" ","auth.login.createButton":"  ","auth.login.processing":" ...","auth.login.toggleLogin":" ","auth.login.toggleCreate":"  ","auth.login.usernamePlaceholder":"  ","auth.login.passwordPlaceholder":"  ","auth.login.newUsernamePlaceholder":"   ","auth.login.errorGeneric":"  .       .","auth.clinicSelection.title":" ","auth.clinicSelection.subtitle":"     ","auth.clinicSelection.name":"","auth.clinicSelection.address":"","sidebar.dashboard":" ","sidebar.patients":"","sidebar.scheduler":"","sidebar.doctors":"","sidebar.reports":"","sidebar.settings":"","sidebar.suppliers":"","sidebar.inventory":"","sidebar.labCases":" ","sidebar.expenses":"","sidebar.treatmentDefinitions":" ","sidebar.doctorAccounts":" ","sidebar.group.records":"","sidebar.group.appointments":"","sidebar.group.materialsLabs":" ","sidebar.group.suppliers":"","sidebar.group.finance":"","sidebar.group.reports":"","sidebar.group.settings":"","sidebar.group.userManagement":" ","sidebar.userManagement":" ","sidebar.drAdmin":". ","sidebar.clinicManager":" ","sidebar.adminProfile":"  ","dashboard.title":" ","dashboard.totalPatients":" ","dashboard.appointmentsToday":" ","dashboard.upcomingAppointments":" ","dashboard.todaysSchedule":" ","dashboard.noAppointmentsToday":"     .","dashboard.todaysRevenue":" ","dashboard.todaysExpenses":" ","dashboard.newPatientsThisMonth":"   ","dashboard.upcomingWeekAppointments":" ","dashboard.atAGlance":" ","dashboard.pendingLabCases":"   ","dashboard.lowStockItems":"  ","dashboard.noPendingLabCases":"     .","dashboard.noLowStockItems":"    .","dashboard.doctorDailyPerformance":"  ","dashboard.totalEarnings":" ","dashboard.noEarningsToday":"    .","dashboard.monthlyRevenue":" ","dashboard.monthlyExpenses":" ","dashboard.netProfit":" ","dashboard.outstandingBalance":" ","dashboard.pendingPayments":" ","dashboard.doctorsEarningsThisMonth":"   ","dashboard.thisMonth":" ","dashboard.dailyNetProfit":"  ","dashboard.dailyExpenses":" ","dashboard.doctorsDues":" ","dashboard.netToday":" ","dashboard.nextAppointment":" ","dashboard.noUpcomingAppointments":"   ","appointmentCard.ariaLabel":"  {{patientName}}   {{dentistName}}  {{reason}}  {{date}}  {{time}}","appointmentStatus.SCHEDULED":"","appointmentStatus.CONFIRMED":"","appointmentStatus.COMPLETED":"","appointmentStatus.CANCELLED":"","patientManagement.title":" ","patientList.searchPatients":"  ...","patientList.searchPatientsAriaLabel":"        ","patientList.addNewPatient":"  ","patientList.viewDetails":" ","patientList.noPatientsFound":"    .","patientList.lastVisit":" ","patientList.whatsappMessage":" {{patientName}}     .","patientList.sendWhatsAppAriaLabel":"    {{patientName}}","patientDetails.closeAriaLabel":"  ","patientDetails.tabDetails":"","patientDetails.tabDentalChart":" ","patientDetails.tabTreatmentRecords":" ","patientDetails.tabPrescriptions":"","patientDetails.tabFinancials":"","patientDetails.addTreatmentRecord":"  ","patientDetails.addPrescription":" ","patientDetails.dob":" ","patientDetails.gender":"","patientDetails.phone":"","patientDetails.email":" ","patientDetails.address":"","patientDetails.insurance":"","patientDetails.policyNumber":" ","patientDetails.emergencyContact":"    ","patientDetails.emergencyContactName":"   ","patientDetails.emergencyContactPhone":" ","patientDetails.allergies":"","patientDetails.currentMedications":" ","patientDetails.medicalHistory":" ","patientDetails.unstructuredNotes":"  ( )","patientDetails.patientImages":" ","patientDetails.personalInfo":" ","patientDetails.medicalInfo":" ","patientDetails.insuranceProvider":" ","financials.totalSpent":" ","financials.breakdown":'    " ".',"financials.addPayment":" ","financials.addDiscount":" ","financials.patientBalance":" ","financials.totalCharges":" ","financials.totalPaid":" ","financials.outstandingBalance":" ","financials.paidInFull":" ","financials.overpaid":" ","financials.transactions":" ","financials.charges":" ()","financials.payments":"","financials.noTransactions":"    .","addPaymentModal.title":"  ","addPaymentModal.amount":"","addPaymentModal.paymentDate":" ","addPaymentModal.paymentMethod":" ","addPaymentModal.notes":"","addPaymentModal.savePayment":" ","addPaymentModal.notesPlaceholder":"   ()","addPaymentModal.alertPositiveAmount":"       .","addPaymentModal.alertExceedsBalance":"     {{balance}}.","paymentMethod.Cash":"","paymentMethod.CreditCard":" ","paymentMethod.BankTransfer":" ","paymentMethod.Other":"","paymentMethod.Discount":"","addDiscountModal.title":" ","addDiscountModal.amount":" ","addDiscountModal.password":" ","addDiscountModal.passwordPlaceholder":"   ","addDiscountModal.passwordIncorrect":"   .","addDiscountModal.saveDiscount":" ","addDiscountModal.notes":" ( )","addPatientModal.title":"  ","addPatientModal.editTitle":"  ","addPatientModal.closeAriaLabel":"   ","addPatientModal.fullName":" ","addPatientModal.dob":" ","addPatientModal.phone":" ","addPatientModal.email":"  ","addPatientModal.gender":"","addPatientModal.address":"","addPatientModal.insuranceProvider":" ","addPatientModal.policyNumber":" ","addPatientModal.emergencyContactName":"   ","addPatientModal.emergencyContactPhone":"   ","addPatientModal.allergies":"","addPatientModal.allergiesPlaceholder":":   ","addPatientModal.currentMedications":" ","addPatientModal.currentMedicationsPlaceholder":":  (  )","addPatientModal.medicalHistory":" ","addPatientModal.medicalHistoryPlaceholder":"       ","addPatientModal.initialTreatmentNotes":"  ","addPatientModal.initialTreatmentNotesPlaceholder":"         .","addPatientModal.patientImages":" ","addPatientModal.savePatient":" ","addPatientModal.alertFillRequired":"    (     ).","appointmentScheduler.title":" ","scheduler.previousWeek":" ","scheduler.nextWeek":" ","scheduler.newAppointment":" ","scheduler.editAppointment":" ","scheduler.appointmentDetails":" ","scheduler.status":"","scheduler.dateTime":" ","scheduler.duration":"","scheduler.minutes":"","scheduler.showFrom":" ","scheduler.to":"","addAppointmentModal.alertFillAllFields":"    .","addAppointmentModal.title":" ","addAppointmentModal.closeAriaLabel":"   ","addAppointmentModal.patient":"","addAppointmentModal.selectPatient":" ","addAppointmentModal.dentist":" ","addAppointmentModal.selectDentist":"  ","addAppointmentModal.startTime":" ","addAppointmentModal.endTime":" ","addAppointmentModal.reasonForVisit":" ","addAppointmentModal.reasonPlaceholder":":   ...","addAppointmentModal.schedule":" ","reminders.reminderTime":" ","reminders.none":"","reminders.1_hour_before":" ","reminders.2_hours_before":" ","reminders.1_day_before":" ","reminders.toggleNotifications":" ","reminders.pendingReminders":" ","reminders.noPendingReminders":"   .","reminders.sendReminder":" ","reminders.whatsappMessage":" {{patientName}}          {{date}}  {{time}}.  .","notifications.patientAdded":"   .","notifications.patientUpdated":"    .","notifications.treatmentAdded":"    .","notifications.paymentAdded":"   .","notifications.discountAdded":"   .","notifications.lowStockAlert":"  ","notifications.labCaseDueAlert":"   ","notifications.lowStockMessage":"{{itemName}}    (: {{count}}).","notifications.labCaseDueMessage":" {{caseType}}  {{patientName}}   {{date}}.","notifications.backupSuccess":"    !","notifications.backupError":" .     .","notifications.restoreSuccess":"   !","notifications.restoreError":" .      .","notifications.invoiceAdded":"   .","notifications.invoiceUpdated":"   .","notifications.invoicePaid":"   .","notifications.paymentRecorded":"   .","notifications.inventoryItemAdded":"    .","notifications.inventoryItemUpdated":"    .","notifications.labCaseAdded":"    .","notifications.labCaseUpdated":"    .","toothStatus.HEALTHY":"","toothStatus.FILLING":"","toothStatus.CROWN":"","toothStatus.MISSING":"","toothStatus.IMPLANT":"","toothStatus.ROOT_CANAL":" ","toothStatus.CAVITY":"","dentalChart.toothAriaLabel":" {{toothId}} : {{status}}","dentalChart.upperRight":" ","dentalChart.upperLeft":" ","dentalChart.lowerRight":" ","dentalChart.lowerLeft":" ","editToothModal.title":"  {{toothId}}","editToothModal.status":"","editToothModal.notes":"","editToothModal.addNotesPlaceholder":" ...","doctorManagement.title":" ","doctorList.addNewDoctor":"  ","doctorList.viewDetails":" ","doctorDetails.closeAriaLabel":"  ","doctorDetails.tabDetails":"","doctorDetails.tabTreatments":"","doctorDetails.tabFinancials":"","doctorDetails.fullName":" ","doctorDetails.specialty":"","doctorDetails.colorTag":" ","doctorDetails.selectColorAriaLabel":"  {{color}}","doctorDetails.appointmentSchedule":" ","doctorDetails.noAppointmentsFound":"    .","doctorDetails.financialSummary":" ","doctorDetails.totalRevenueGenerated":"  ","doctorDetails.totalEarnings":" ","doctorDetails.totalPaymentsReceived":"  ","doctorDetails.netBalance":" ","doctorDetails.treatmentsPerformed":" ","doctorDetails.noTreatmentsFound":"     .","doctorDetails.transactions":" ","doctorDetails.earnings":" ()","doctorDetails.payments":"","doctorDetails.noTransactions":"    .","addDoctorModal.title":"  ","addDoctorModal.closeAriaLabel":"   ","addDoctorModal.fullName":" ","addDoctorModal.specialty":"","addDoctorModal.colorTag":" ","addDoctorModal.saveDoctor":" ","suppliersManagement.title":" ","inventoryManagement.title":" ","labCasesManagement.title":"  ","expensesManagement.title":" ","treatmentDefinitionsManagement.title":"  ","suppliers.editSupplier":" ","suppliers.suppliersList":" ","suppliers.addSupplier":" ","suppliers.viewDetails":" ","suppliers.editSupplierAriaLabel":"  {{name}}","suppliers.noSuppliersAdded":"    .","suppliers.addNewSupplier":"  ","suppliers.supplierName":" ","suppliers.contactPerson":" ","suppliers.phone":"","suppliers.email":" ","suppliers.supplierType":" ","supplierType.materialSupplier":" ","supplierType.dentalLab":" ","supplierDetails.contactInfo":" ","supplierDetails.financialSummary":" ","invoices.title":"","invoices.addInvoice":" ","invoices.editInvoice":" ","invoices.invoice":"","invoices.date":"","invoices.due":" ","invoices.paid":"","invoices.remaining":"","invoices.confirmPayRemaining":"       {{amount}}  ","invoices.viewAttachment":" ","invoices.payRemaining":" ","invoices.noInvoices":"    .","invoices.totalBilled":" ","invoices.totalPaid":" ","invoices.outstandingBalance":" ","invoices.invoiceNumber":" ","invoices.amount":"","invoices.attachInvoice":"  ","invoices.billed":" ","invoices.paidAmount":" ","inventory.editItem":" ","inventory.addNewItem":"  ","inventory.itemName":" ","inventory.description":"","inventory.descriptionPlaceholder":"  ...","inventory.supplier":"","inventory.selectSupplier":" ","inventory.currentStock":" ","inventory.unitCost":" ","inventory.inventoryItems":" ","inventory.addItem":" ","inventory.addItemPlaceholder":"  ...","inventory.stock":"","inventory.editItemAriaLabel":"  {{name}}","inventory.minStockLevel":"  ","inventory.expiryDate":"  ","inventory.printReport":"  ","inventoryReport.title":"  ","inventoryReport.itemName":" ","inventoryReport.supplier":"","inventoryReport.stock":" ","inventoryReport.minStock":" ","inventoryReport.unitCost":" ","inventoryReport.totalValue":" ","inventoryReport.expiryDate":" ","inventoryReport.status":"","inventoryStatus.ok":"","inventoryStatus.lowStock":" ","inventoryStatus.expiresSoon":" ","inventoryStatus.expired":" ","inventoryStatus.outOfStock":" ","expenses.editExpense":" ","expenses.addNewExpense":"  ","expenses.date":"","expenses.description":"","expenses.descriptionPlaceholder":":    ","expenses.amount":"","expenses.category":"","expenses.selectSupplier":"  ()","expenses.noSupplier":" ","expenses.applyToInvoice":"   ()","expenses.paymentOnAccount":"  ","expenses.clinicExpenses":" ","expenses.addExpense":" ","expenses.noExpensesRecorded":"   .","expenses.supplier":"","expenses.editExpenseAriaLabel":" : {{description}}","expenseCategory.RENT":"","expenseCategory.SALARIES":"","expenseCategory.UTILITIES":" ( )","expenseCategory.LAB_FEES":" ","expenseCategory.SUPPLIES":"","expenseCategory.MARKETING":"","expenseCategory.MISC":"","labCases.editCase":" ","labCases.addNewCase":"  ","labCases.patient":"","labCases.selectPatient":" ","labCases.dentalLab":" ","labCases.selectDentalLab":" ","labCases.caseType":" ","labCases.caseTypePlaceholder":":    ","labCases.sentDate":" ","labCases.dueDate":" ","labCases.returnDate":" ","labCases.labCost":" ","labCases.cost":"","labCases.status":"","labCases.selectStatus":" ","labCases.notes":"","labCases.notesPlaceholder":":   A2","labCases.labCaseTracker":"  ","labCases.addCase":" ","labCases.noCasesRecorded":"    .","labCases.lab":"","labCases.due":"","labCases.editCaseAriaLabel":"  {{caseType}}  {{patientName}}","labCases.alertFillAllFields":"    .","labCaseStatus.DRAFT":"","labCaseStatus.SENT_TO_LAB":" ","labCaseStatus.RECEIVED_FROM_LAB":"  ","labCaseStatus.FITTED_TO_PATIENT":" ","labCaseStatus.CANCELLED":"","treatments.editTreatment":" ","treatments.addNewTreatment":"  ","treatments.treatmentName":" ","treatments.description":"","treatments.descriptionPlaceholder":"  ...","treatments.basePrice":" ","treatments.doctorPercentage":" ","treatments.clinicPercentage":" ","treatments.auto":"","treatments.manageTreatments":"  ","treatments.addTreatment":" ","treatments.noTreatmentsAdded":"    .","treatments.doctor":"","treatments.clinic":"","treatments.editTreatmentAriaLabel":"  {{name}}","addTreatmentRecord.title":"   ","addTreatmentRecord.date":"","addTreatmentRecord.dentist":"","addTreatmentRecord.selectDentist":" ","addTreatmentRecord.treatment":"","addTreatmentRecord.selectTreatment":" ","addTreatmentRecord.notes":"","addTreatmentRecord.notesPlaceholder":"   ...","addTreatmentRecord.inventoryItemsUsed":"   ","addTreatmentRecord.addItem":" ","addTreatmentRecord.addItemPlaceholder":"  ...","addTreatmentRecord.stock":"","addTreatmentRecord.costSummary":" ","addTreatmentRecord.baseTreatmentPrice":"  ","addTreatmentRecord.totalMaterialCost":"  ","addTreatmentRecord.totalPatientCost":"  ","addTreatmentRecord.doctorShare":" ","addTreatmentRecord.clinicShare":" ","addTreatmentRecord.saveRecord":" ","addTreatmentRecord.alertFillFields":"   .","editTreatmentRecord.title":"  ","editTreatmentRecord.customPrice":" ","editTreatmentRecord.updatedShares":" ","editTreatmentRecord.saveChanges":" ","editTreatmentRecord.priceMustBePositive":"      .","editTreatmentRecord.priceUpdated":"    .","editTreatmentRecord.originalPrice":" ","editTreatmentRecord.treatmentName":" ","addTreatmentRecord.decreaseQuantityAria":"  {{itemName}}","addTreatmentRecord.increaseQuantityAria":"  {{itemName}}","addTreatmentRecord.quantityAria":" {{itemName}}","addTreatmentRecord.removeItemAria":" {{itemName}}","treatmentRecordList.noRecords":"     .","treatmentRecordList.noNotes":"  .","treatmentRecordList.materialsUsed":" ","reports.title":"","reports.categoryDaily":"","reports.categoryMonthly":"","reports.categoryPatient":"","reports.categoryDoctor":"","reports.categorySupplier":"","reports.categoryLab":"","reports.categoryFinancial":"","reports.categoryInventory":"","reports.tabDailySummary":" ","reports.tabDailyAppointments":" ","reports.tabDailyRevenue":" ","reports.tabMonthlyOverview":" ","reports.tabMonthlyPerformance":" ","reports.tabPatientHistory":" ","reports.tabPatientFinancials":" ","reports.tabDoctorPerformance":" ","reports.tabDoctorEarnings":" ","reports.tabSupplierTransactions":" ","reports.tabSupplierStatements":" ","reports.tabLabTracking":" ","reports.tabLabCosts":" ","reports.tabFinancialOverview":" ","reports.tabProfitLoss":" ","reports.tabCashFlow":" ","reports.tabInventoryStatus":" ","reports.tabPatientStatistics":" ","reports.tabFinancialSummary":" ","reports.tabAppointmentOverview":"   ","reports.tabInventoryReport":" ","reports.tabTreatmentPerformance":" ","reports.tabLabCasesReport":"  ","reports.tabPaymentsReport":" ","reports.tabSupplierInvoicesReport":"  ","reports.tabDentistsReport":" ","reports.tabSuppliersReport":" ","reports.paymentsReport.totalPayments":" ","reports.paymentsReport.totalAmount":" ","reports.supplierInvoicesReport.totalInvoices":" ","reports.supplierInvoicesReport.totalAmount":" ","reports.dentistsReport.totalDentists":" ","reports.suppliersReport.totalSuppliers":" ","reports.dateRange":" ","reports.startDate":" ","reports.endDate":" ","reports.filterByPatient":"  ","reports.filterByDoctor":"  ","reports.filterBySupplier":"  ","reports.filterByDentist":"  ","reports.filterByLab":"  ","reports.noDataAvailable":"    .","reports.printReport":" ","reports.dailySummary.totalAppointments":" ","reports.dailySummary.totalRevenue":" ","reports.dailySummary.totalPatients":" ","reports.dailySummary.totalTreatments":" ","reports.doctorEarnings.description":"    ","reports.labCosts.description":"    ","reports.profitLoss.description":"   ","reports.cashFlow.description":"   ","reports.inventoryStatus.description":"  ","reports.monthlyOverview.totalRevenue":"  ","reports.monthlyOverview.totalExpenses":"  ","reports.monthlyOverview.netProfit":"  ","reports.monthlyOverview.totalPatients":"  ","reports.patientStats.totalPatients":" ","reports.patientStats.genderDistribution":" ","reports.patientStats.ageDistribution":" ","reports.patientStats.ageGroup":"","reports.patientStats.newPatientsThisPeriod":"    ","reports.financialSummary.totalIncome":" ","reports.financialSummary.totalExpenses":" ","reports.financialSummary.netProfit":" ","reports.financialSummary.incomeByTreatment":"  ","reports.financialSummary.expensesByCategory":"  ","reports.appointmentOverview.totalAppointments":" ","reports.appointmentOverview.completedAppointments":" ","reports.appointmentOverview.cancelledAppointments":" ","reports.appointmentOverview.completionRate":" ","reports.appointmentOverview.appointmentsByDentist":"  ","reports.inventoryReport.totalValue":"  ","reports.inventoryReport.lowStockItems":"  ","reports.inventoryReport.allInventoryItems":"  ","reports.inventoryReport.itemName":" ","reports.inventoryReport.currentStock":" ","reports.inventoryReport.unitCost":" ","reports.treatmentPerformance.allTreatmentPerformance":"  ","reports.treatmentPerformance.treatment":"","reports.treatmentPerformance.count":"","reports.treatmentPerformance.averagePrice":" ","reports.treatmentPerformance.totalRevenue":" ","reports.treatmentPerformance.totalClinicShare":"  ","reports.treatmentPerformance.totalDoctorShare":"  ","reports.treatmentPerformance.mostProfitable":" ","reports.treatmentPerformance.top5ByRevenue":" 5   ","reports.treatmentPerformance.top5ByFrequency":" 5   ","settings.title":"","settings.backup.title":"  ","settings.backup.description":"      (  )   JSON.      .","settings.backup.button":"  ","settings.restore.title":" ","settings.restore.description":"      .        .","settings.restore.warning":"     .","settings.restore.button":"  ","settings.restore.confirm":"!           .      ","settings.dangerZone.title":" ","settings.dangerZone.description":"      .   .","settings.clear.title":"  ","settings.clear.description":"             .","settings.clear.button":"  ","settings.clear.confirm":"!      .      ","settings.sampleData.title":"  ","settings.sampleData.description":"            .","settings.sampleData.button":"  ","settings.sampleData.confirm":"          .","settings.sampleData.success":"    !","settings.sampleData.error":"   .","settings.clear.success":"   !    .","settings.clear.error":"  .","patientReport.clinicAddress":"    01017755577","patientReport.title":"  ","patientReport.generatedOn":"  : {{date}}","patientReport.demographics.title":" ","patientReport.demographics.name":"","patientReport.demographics.phone":"","patientReport.demographics.dob":" ","patientReport.demographics.email":" ","patientReport.demographics.gender":"","patientReport.demographics.address":"","patientReport.emergencyAndInsurance.title":" ","patientReport.emergencyAndInsurance.insuranceProvider":" ","patientReport.emergencyAndInsurance.policyNumber":" ","patientReport.medicalInfo.title":" ","patientReport.medicalInfo.allergies":"","patientReport.medicalInfo.medications":" ","patientReport.medicalInfo.medicalHistory":" ","patientReport.dentalChart.title":" ","patientReport.dentalChart.allHealthy":"    .","patientReport.dentalChart.tooth":"","patientReport.dentalChart.status":"","patientReport.dentalChart.notes":"","patientReport.treatmentHistory.title":" ","patientReport.treatmentHistory.date":"","patientReport.treatmentHistory.treatment":"","patientReport.treatmentHistory.dentist":"","patientReport.treatmentHistory.notes":"","patientReport.treatmentHistory.cost":"","patientReport.treatmentHistory.noRecords":"   .","patientReport.financials.title":" ","patientReport.financials.paymentDate":" ","patientReport.financials.paymentMethod":" ","patientReport.financials.notes":"","patientReport.financials.amount":"","patientReport.financials.noPayments":"   .","patientReport.footer":" AlAfandy","patientInvoice.title":" ","patientInvoice.invoiceNumber":" ","patientInvoice.date":"","patientInvoice.billTo":" ","patientInvoice.treatmentDetails":" ","patientInvoice.paymentDetails":" ","patientInvoice.balanceDue":" ","patientInvoice.thankYou":"    .","suppliers.supplierDetails":" ","supplierStatement.financialTitle":"   ","supplierStatement.caseTitle":"    ","supplierStatement.statementDetails":"  ","supplierStatement.caseDetails":"  ","supplierStatement.totalCost":" ","supplierStatement.noPaymentsRecorded":"     .","supplierStatement.notDentalLab":"     .","supplierStatement.selectDentalLab":"     ' '   .","supplierStatement.totalCases":" ","addDoctorPaymentModal.title":"  ","addDoctorPaymentModal.paymentDate":" ","addDoctorPaymentModal.amount":"","addDoctorPaymentModal.notes":"","addDoctorPaymentModal.notesPlaceholder":"   ()","addDoctorPaymentModal.savePayment":" ","addDoctorPaymentModal.alertPositiveAmount":"       .","reports.expenseBreakdown":"   ","reports.ageGroup.0-17":"0-17 ","reports.ageGroup.18-29":"18-29 ","reports.ageGroup.30-49":"30-49 ","reports.ageGroup.50+":"50   ","reports.ageGroup.0-18":"0-18 ","reports.ageGroup.19-35":"19-35 ","reports.ageGroup.36-55":"36-55 ","reports.ageGroup.56+":"56   ","reports.years":"","reports.categoryByDentist":" ","reports.categoryByPatient":" ","reports.categoryBySupplier":" ","reports.categoryByLab":" ","reports.kpi.title":" ","reports.kpi.totalRevenue":" ","reports.kpi.totalExpenses":" ","reports.kpi.netProfit":" ","reports.kpi.totalAppointments":" ","reports.kpi.completionRate":" ","reports.charts.monthlyRevenue":" ","reports.charts.dailyRevenue":" ","reports.dailyRevenue.title":" ","reports.dailyRevenue.date":"","reports.dailyRevenue.amount":"","reports.monthlySummary.title":" ","reports.monthlySummary.month":"","reports.monthlySummary.revenue":"","reports.monthlySummary.appointments":"","reports.financialOverview.expenseBreakdown":"   ","reports.financialOverview.title":"  ","reports.financialOverview.totalRevenue":" ","reports.financialOverview.totalExpenses":" ","reports.financialOverview.netProfit":" ","reports.financialOverview.totalPayments":" ","reports.financialOverview.revenueVsExpenses":"  ","reports.financialOverview.expenses":"","reports.financialOverview.revenue":"","reports.financialOverview.recentPayments":" ","reports.financialOverview.patient":"","reports.financialOverview.amount":"","reports.financialOverview.date":"","reports.financialOverview.description":"","reports.financialOverview.category":"","reports.financialOverview.recentExpenses":" ","reports.patientStats.title":" ","reports.patientStats.newPatients":" ","reports.patientStats.activePatients":" ","reports.patientStats.topPatients":" ","reports.patientStats.patientName":" ","reports.patientStats.totalSpent":" ","reports.patientStats.lastVisit":" ","reports.doctorPerformance.title":" ","reports.doctorPerformance.totalDoctors":" ","reports.doctorPerformance.avgRevenuePerDoctor":"   ","reports.doctorPerformance.detailedPerformance":" ","reports.doctorPerformance.doctorName":" ","reports.doctorPerformance.totalTreatments":" ","reports.doctorPerformance.avgTreatmentValue":"  ","reports.doctorPerformance.specialty":"","reports.doctorPerformance.appointmentsByDoctor":"  ","reports.doctorPerformance.totalAppointments":" ","reports.doctorPerformance.completionRate":" ","reports.doctorPerformance.revenueBySpecialty":"  ","reports.filters":"","reports.dateRangePresets":"  ","reports.presets.today":"","reports.presets.last7Days":" 7 ","reports.presets.last30Days":" 30 ","reports.presets.last90Days":" 90 ","reports.presets.thisMonth":" ","reports.presets.lastMonth":" ","reports.categoryOverview":" ","reports.subtitle":"  ","reports.labCasesReport.allLabCases":"  ","reports.paymentsReport.allPayments":" ","reports.supplierInvoicesReport.allSupplierInvoices":"  ","reports.dentistsReport.allDentists":" ","reports.suppliersReport.allSuppliers":" ","reports.dailyFinancialSummary.title":"  ","reports.dailyFinancialSummary.subtitle":"    ","reports.dailyFinancialSummary.todaysRevenue":" ","reports.dailyFinancialSummary.todaysExpenses":" ","reports.dailyFinancialSummary.todaysProfit":" ","reports.dailyFinancialSummary.pendingPayments":" ","reports.dailyFinancialSummary.overdueInvoices":" ","reports.dailyFinancialSummary.todaysPayments":" ","reports.dailyFinancialSummary.todaysExpensesList":" ","expense.description":"","expense.amount":"","expense.category":"","common.date":"","reports.overview":" ","reports.overviewDescription":"      ","reports.patientList":" ","reports.doctorList":" ","reports.supplierList":" ","reports.patientReports":" ","reports.doctorReports":" ","reports.supplierReports":" ","reports.totalRevenue":" ","reports.totalPaid":" ","reports.outstandingBalance":" ","reports.treatmentCount":" ","reports.totalEarnings":" ","reports.totalPaymentsReceived":"  ","reports.netBalance":" ","reports.totalPurchases":" ","reports.totalExpenses":" ","reports.totalValue":" ","reports.itemCount":" ","reports.expenseCount":" ","reports.financialOverview":" ","reports.netProfit":" ","patientReport.summary":"","patientReport.totalRevenue":" ","patientReport.totalPaid":" ","doctorReport.title":" ","doctorReport.summary":"","doctorReport.totalEarnings":" ","doctorReport.totalPaymentsReceived":"  ","supplierReport.title":" ","supplierReport.summary":"","supplierReport.totalPurchases":" ","supplierReport.totalExpenses":" ","reports.dailyFinancialSummary.revenueTrend":" ","reports.dailyFinancialSummary.expensesBreakdown":" ","reports.selectDate":" ","reports.monthlyFinancialSummary.title":"  ","reports.monthlyFinancialSummary.subtitle":"    ","reports.monthlyFinancialSummary.thisMonthRevenue":" ","reports.monthlyFinancialSummary.thisMonthExpenses":" ","reports.monthlyFinancialSummary.clinicProfitThisMonth":"   ","reports.monthlyFinancialSummary.monthlyAverages":" ","reports.monthlyFinancialSummary.growthRates":" ","reports.monthlyFinancialSummary.revenueChart":" ","reports.monthlyFinancialSummary.expenseBreakdown":" ","reports.monthlyFinancialSummary.profitTrend":" ","reports.monthlyFinancialSummary.monthlyPayments":" ","reports.monthlyFinancialSummary.monthlyExpenses":" ","reports.selectMonth":" ","reports.quarterlyAnnualOverview.title":"    ","reports.quarterlyAnnualOverview.subtitle":"      ","reports.quarterlyAnnualOverview.totalRevenue":" ","reports.quarterlyAnnualOverview.totalExpenses":" ","reports.quarterlyAnnualOverview.cumulativeProfit":" ","reports.quarterlyAnnualOverview.yearOverYear":" ","reports.quarterlyAnnualOverview.comparisonChart":" ","reports.quarterlyAnnualOverview.trendChart":" ","reports.quarterlyAnnualOverview.seasonalTrends":" ","reports.quarterlyAnnualOverview.periodPayments":" ","reports.quarterlyAnnualOverview.periodExpenses":" ","reports.viewType":" ","reports.quarterly":" ","reports.annual":"","reports.selectQuarter":" ","reports.selectYear":" ","reports.revenue":"","reports.expenses":"","reports.profit":"","reports.dailyRevenue":" ","reports.dailyExpenses":" ","labCase.patientName":" ","payment.patientName":" ","payment.amount":"","payment.method":" ","payment.date":"","payment.notes":"","supplierInvoice.supplierName":" ","supplierInvoice.invoiceNumber":" ","supplierInvoice.totalAmount":" ","supplierInvoice.date":"","supplierInvoice.status":"","dentist.name":"","dentist.specialty":"","supplier.name":"","supplier.contactPerson":" ","supplier.phone":"","supplier.email":" ","supplierInvoiceStatus.PAID":"","supplierInvoiceStatus.UNPAID":" ","supplierInvoiceStatus.PARTIALLY_PAID":" ","common.unknownSupplier":"  ","common.update":"","common.add":"","common.select":"","common.accessDenied":"  ","common.unknown":" ","common.view":"","common.viewDetails":" ","common.patients":"","common.doctors":"","financialAccounts.title":" ","financialAccounts.tabs.revenue":"","financialAccounts.tabs.expenses":"","financialAccounts.tabs.balances":"","financialAccounts.export":"","financialAccounts.print":"","financialSummary.totalRevenue":" ","financialSummary.totalPayments":" ","financialSummary.totalExpenses":" ","financialSummary.doctorPayments":" ","financialSummary.supplierInvoices":" ","financialSummary.unpaidInvoices":"  ","financialSummary.netProfit":" ","financialSummary.cashFlow":" ","revenueTab.totalRevenue":" ","revenueTab.treatmentRevenue":" ","revenueTab.paymentRevenue":" ","revenueTab.revenueChart":" ","revenueTab.revenueDetails":" ","revenueTab.noRevenueData":"    .","expensesTab.totalExpenses":" ","expensesTab.operatingExpenses":" ","expensesTab.doctorPayments":" ","expensesTab.supplierInvoices":" ","expensesTab.expensesByCategory":"  ","expensesTab.expensesDetails":" ","expensesTab.noExpensesData":"    .","balancesTab.netProfit":" ","balancesTab.cashFlow":" ","balancesTab.unpaidInvoices":"  ","balancesTab.paidInvoices":" ","balancesTab.balanceSheet":" ","balancesTab.assets":"","balancesTab.liabilities":"","balancesTab.equity":" ","balancesTab.cashAndEquivalents":"  ","balancesTab.accountsReceivable":" ","balancesTab.totalAssets":" ","balancesTab.accountsPayable":" ","balancesTab.otherLiabilities":" ","balancesTab.totalLiabilities":" ","balancesTab.supplierInvoices":" ","balancesTab.noInvoices":"   .","balancesTab.invoiceNumber":" ","balancesTab.supplier":"","balancesTab.invoiceDate":" ","balancesTab.dueDate":" ","balancesTab.amount":"","balancesTab.status":"","financialFilters.title":"","financialFilters.clearAll":" ","financialFilters.dateRange":" ","financialFilters.selectPreset":"  ","financialFilters.today":"","financialFilters.thisWeek":" ","financialFilters.thisMonth":" ","financialFilters.thisYear":" ","financialFilters.custom":"","financialFilters.startDate":" ","financialFilters.endDate":" ","financialFilters.dentist":"","financialFilters.supplier":"","financialFilters.category":"","financialTable.date":"","financialTable.description":"","financialTable.type":"","financialTable.category":"","financialTable.amount":"","financialTable.showing":"","financialTable.entries":"","financialCharts.noData":"   ","financialCharts.total":"","financialAccounts.accountDetails.selectAccount":" ","financialAccounts.accountDetails.accountType":" ","financialAccounts.accountDetails.selectEntity":" /","financialAccounts.accountDetails.accountTypes.patient":"","financialAccounts.accountDetails.accountTypes.doctor":"","financialAccounts.accountDetails.accountTypes.supplier":"","financialAccounts.accountDetails.accountTypes.clinic":"","financialAccounts.accountDetails.clinicAccount":" ","financialAccounts.accountDetails.accountSummary":" ","financialAccounts.accountDetails.totalDebit":" ","financialAccounts.accountDetails.totalCredit":" ","financialAccounts.accountDetails.balance":"","financialAccounts.accountDetails.transactions":"","financialAccounts.accountDetails.columns.date":"","financialAccounts.accountDetails.columns.description":"","financialAccounts.accountDetails.columns.debit":"","financialAccounts.accountDetails.columns.credit":"","financialAccounts.accountDetails.columns.balance":"","financialAccounts.accountDetails.transactionTypes.payment":"","financialAccounts.accountDetails.transactionTypes.treatment":"","financialAccounts.accountDetails.transactionTypes.treatmentRevenue":" ","financialAccounts.accountDetails.transactionTypes.doctorPayment":" ","financialAccounts.accountDetails.transactionTypes.invoice":"","financialAccounts.accountDetails.transactionTypes.expense":"","financialAccounts.accountDetails.transactionTypes.clinicRevenue":" ","financialAccounts.accountDetails.noTransactions":"    .","patientModal.tabs.basicInfo":" ","patientModal.tabs.medicalHistory":" ","patientModal.tabs.emergencyInsurance":" ","patientModal.tabs.imagesNotes":" ","validation.required":"  .","validation.fixErrors":"    .","validation.fixAllErrors":"     .","prescriptionList.noPrescriptions":"    .","prescriptionList.noPrescriptionsFound":"     .","prescriptionList.items":"","prescriptionList.noNotes":"  .","prescriptionList.searchAndFilters":" ","prescriptionList.searchPlaceholder":"     ...","prescriptionList.search":"","prescriptionList.doctor":"","prescriptionList.allDoctors":" ","prescriptionList.patient":"","prescriptionList.medications":"","prescriptionList.dosage":"","prescriptionList.quantity":"","prescriptionList.instructions":"","prescriptionModal.title":"  ","prescriptionModal.editTitle":" ","prescriptionModal.closeAriaLabel":"  ","prescriptionModal.dentist":"","prescriptionModal.selectDentist":" ","prescriptionModal.prescriptionDate":" ","prescriptionModal.notes":"","prescriptionModal.notesPlaceholder":"   ...","prescriptionModal.medications":"","prescriptionModal.addMedication":" ","prescriptionModal.medicationName":" ","prescriptionModal.medicationNamePlaceholder":"  ...","prescriptionModal.dosage":"","prescriptionModal.dosagePlaceholder":": 500  2 ...","prescriptionModal.quantity":"","prescriptionModal.instructions":" ","prescriptionModal.instructionsPlaceholder":":     ...","prescriptionModal.noMedications":"    .","prescriptionModal.savePrescription":" ","prescriptionModal.createPrescription":" ","prescriptionModal.alertFillRequired":"    .","prescriptionModal.alertAtLeastOneItem":"     .","prescriptionDetails.title":" ","prescriptionDetails.closeAriaLabel":"  ","prescriptionDetails.patientInfo":" ","prescriptionDetails.patientName":" ","prescriptionDetails.patientId":" ","prescriptionDetails.patientPhone":"","prescriptionDetails.prescriptionInfo":" ","prescriptionDetails.dentist":"","prescriptionDetails.date":"","prescriptionDetails.prescriptionId":" ","prescriptionDetails.notes":"","prescriptionDetails.medications":"","prescriptionDetails.dosage":"","prescriptionDetails.quantity":"","prescriptionDetails.instructions":" ","prescriptionDetails.noMedications":"   .","financialAccounts.accountDetails.title":" "},Cg={appName:"CuraSoft",male:"Male",female:"Female",other:"Other","common.edit":"Edit","common.cancel":"Cancel","common.save":"Save","common.delete":"Delete","common.confirmDelete":"Are you sure you want to delete? This action cannot be undone.","common.saveChanges":"Save Changes","common.closeForm":"Close Form","common.close":"Close","common.unknownPatient":"Unknown Patient","common.unknownDentist":"Unknown Dentist","common.unknownTreatment":"Unknown Treatment","common.unknownMaterial":"Unknown Material","common.na":"N/A","common.sendWhatsApp":"Send WhatsApp","common.print":"Print Full Report","auth.config.title":"Backend Not Configured","auth.config.message":"The application cannot connect to the backend because the Supabase URL and Key are missing.","auth.config.instructions":"Please follow the instructions in the `backend_setup.md` file to create a Supabase project and add the required secrets (`SUPABASE_URL` and `SUPABASE_ANON_KEY`) to your environment.","auth.login.welcome":"Welcome! Please log in to continue.","auth.login.email":"Email Address","auth.login.button":"Log In","auth.login.error":"Invalid login credentials.","auth.login.noAccount":"Don't have an account? Sign up","auth.signup.title":"Create a New Account","auth.signup.button":"Sign Up","auth.signup.success":"Account created successfully! Please check your email to confirm.","auth.signup.backToLogin":"Already have an account? Log In","auth.loading":"Loading...","auth.logout.button":"Log Out","auth.login.title":"CuraSoft Clinic","auth.login.subtitle":"Login to access your clinic management system","auth.login.username":"Username","auth.login.password":"Password","auth.login.loginButton":"Log In","auth.login.createButton":"Create New Account","auth.login.processing":"Processing...","auth.login.toggleLogin":"Log In","auth.login.toggleCreate":"Create New Account","auth.login.usernamePlaceholder":"Enter username","auth.login.passwordPlaceholder":"Enter password","auth.login.newUsernamePlaceholder":"Enter new username","auth.login.errorGeneric":"Login failed. Please check your username and password.","auth.clinicSelection.title":"Select Clinic","auth.clinicSelection.subtitle":"Select the clinic you want to work on","auth.clinicSelection.name":"Name","auth.clinicSelection.address":"Address","sidebar.dashboard":"Dashboard","sidebar.patients":"Patients","sidebar.scheduler":"Scheduler","sidebar.doctors":"Doctors","sidebar.reports":"Reports","sidebar.settings":"Settings","sidebar.suppliers":"Suppliers","sidebar.inventory":"Inventory","sidebar.labCases":"Lab Cases","sidebar.expenses":"Expenses","sidebar.treatmentDefinitions":"Treatment Settings","sidebar.doctorAccounts":"Doctor Accounts","sidebar.drAdmin":"Dr. Admin","sidebar.clinicManager":"Clinic Manager","sidebar.adminProfile":"Admin Profile","dashboard.title":"Dashboard","dashboard.totalPatients":"Total Patients","dashboard.appointmentsToday":"Appointments Today","dashboard.upcomingAppointments":"Upcoming Appointments","dashboard.todaysSchedule":"Today's Schedule","dashboard.noAppointmentsToday":"No appointments scheduled for today.","dashboard.todaysRevenue":"Today's Revenue","dashboard.newPatientsThisMonth":"New Patients This Month","dashboard.upcomingWeekAppointments":"Upcoming Week Appointments","dashboard.atAGlance":"At A Glance","dashboard.pendingLabCases":"Pending Lab Cases","dashboard.lowStockItems":"Low Stock Items","dashboard.noPendingLabCases":"No pending lab cases.","dashboard.noLowStockItems":"No low stock items.","dashboard.doctorDailyPerformance":"Doctor Daily Performance","dashboard.totalEarnings":"Total Earnings","dashboard.noEarningsToday":"No earnings recorded today.","dashboard.monthlyRevenue":"Monthly Revenue","dashboard.monthlyExpenses":"Monthly Expenses","dashboard.netProfit":"Net Profit","dashboard.outstandingBalance":"Outstanding Balance","dashboard.pendingPayments":"Pending payments","dashboard.thisMonth":"This month","dashboard.dailyNetProfit":"Daily Net Profit","dashboard.dailyExpenses":"Daily Expenses","dashboard.doctorsDues":"Doctors' Dues","dashboard.netToday":"Net Today","dashboard.nextAppointment":"Next Appointment","dashboard.noUpcomingAppointments":"No upcoming appointments","appointmentCard.ariaLabel":"Appointment for {{patientName}} with Doctor {{dentistName}} for {{reason}} on {{date}} at {{time}}","appointmentStatus.SCHEDULED":"Scheduled","appointmentStatus.CONFIRMED":"Confirmed","appointmentStatus.COMPLETED":"Completed","appointmentStatus.CANCELLED":"Cancelled","patientManagement.title":"Patient Management","patientList.searchPatients":"Search Patients...","patientList.searchPatientsAriaLabel":"Search for patient by name, phone or email","patientList.addNewPatient":"Add New Patient","patientList.viewDetails":"View Details","patientList.noPatientsFound":"No patients found.","patientList.lastVisit":"Last Visit","patientList.whatsappMessage":"Hello {{patientName}}, this is CuraSoft Dental Clinic.","patientList.sendWhatsAppAriaLabel":"Send WhatsApp message to {{patientName}}","patientDetails.closeAriaLabel":"Close patient details","patientDetails.tabDetails":"Details","patientDetails.tabDentalChart":"Dental Chart","patientDetails.tabTreatmentRecords":"Treatment Records","patientDetails.tabPrescriptions":"Prescriptions","patientDetails.tabFinancials":"Financials","patientDetails.addTreatmentRecord":"Add Treatment Record","patientDetails.addPrescription":"Add Prescription","patientDetails.dob":"Date of Birth","patientDetails.gender":"Gender","patientDetails.phone":"Phone","patientDetails.email":"Email","patientDetails.address":"Address","patientDetails.insurance":"Insurance","patientDetails.policyNumber":"Policy Number","patientDetails.emergencyContact":"Emergency Contact","patientDetails.emergencyContactName":"Emergency Contact Name","patientDetails.emergencyContactPhone":"Emergency Contact Phone","patientDetails.allergies":"Allergies","patientDetails.currentMedications":"Current Medications","patientDetails.medicalHistory":"Medical History","patientDetails.unstructuredNotes":"Treatment Notes (unstructured)","financials.totalSpent":"Total Spent","financials.breakdown":"Details available in Treatment Records section.","financials.addPayment":"Add Payment","financials.addDiscount":"Add Discount","financials.patientBalance":"Patient Balance","financials.totalCharges":"Total Charges","financials.totalPaid":"Total Paid","financials.outstandingBalance":"Outstanding Balance","financials.paidInFull":"Paid in Full","financials.overpaid":"Credit Balance","financials.transactions":"Financial Transactions","financials.charges":"Charges (Treatments)","financials.payments":"Payments","financials.noTransactions":"No financial transactions recorded.","addPaymentModal.title":"Add New Payment","addPaymentModal.amount":"Amount","addPaymentModal.paymentDate":"Payment Date","addPaymentModal.paymentMethod":"Payment Method","addPaymentModal.notes":"Notes","addPaymentModal.savePayment":"Save Payment","addPaymentModal.notesPlaceholder":"Notes about the payment (optional)","addPaymentModal.alertPositiveAmount":"Payment amount must be greater than zero.","addPaymentModal.alertExceedsBalance":"Payment amount exceeds outstanding balance of {{balance}}.","paymentMethod.Cash":"Cash","paymentMethod.CreditCard":"Credit Card","paymentMethod.BankTransfer":"Bank Transfer","paymentMethod.Other":"Other","paymentMethod.Discount":"Discount","addDiscountModal.title":"Apply Discount","addDiscountModal.amount":"Discount Amount","addDiscountModal.password":"Password","addDiscountModal.passwordPlaceholder":"Enter password to approve","addDiscountModal.passwordIncorrect":"Incorrect password.","addDiscountModal.saveDiscount":"Apply Discount","addDiscountModal.notes":"Notes (reason for discount)","addPatientModal.title":"Add New Patient","addPatientModal.editTitle":"Edit Patient Details","addPatientModal.closeAriaLabel":"Close add patient form","addPatientModal.fullName":"Full Name","addPatientModal.dob":"Date of Birth","addPatientModal.phone":"Phone Number","addPatientModal.email":"Email Address","addPatientModal.gender":"Gender","addPatientModal.address":"Address","addPatientModal.insuranceProvider":"Insurance Provider","addPatientModal.policyNumber":"Policy Number","addPatientModal.emergencyContactName":"Emergency Contact Name","addPatientModal.emergencyContactPhone":"Emergency Contact Phone","addPatientModal.allergies":"Allergies","addPatientModal.allergiesPlaceholder":"E.g., Penicillin allergy","addPatientModal.currentMedications":"Current Medications","addPatientModal.currentMedicationsPlaceholder":"E.g., Amlodipine (for blood pressure)","addPatientModal.medicalHistory":"Medical History","addPatientModal.medicalHistoryPlaceholder":"Record any chronic conditions or past surgeries","addPatientModal.initialTreatmentNotes":"Initial Treatment Notes","addPatientModal.initialTreatmentNotesPlaceholder":"Any important notes about initial dental condition or previous treatments.","addPatientModal.savePatient":"Save Patient","addPatientModal.alertFillRequired":"Please fill in all required fields (Full Name, Date of Birth, Phone Number).","appointmentScheduler.title":"Appointment Scheduler","scheduler.previousWeek":"Previous Month","scheduler.nextWeek":"Next Month","scheduler.newAppointment":"New Appointment","scheduler.editAppointment":"Edit Appointment","scheduler.appointmentDetails":"Appointment Details","scheduler.status":"Status","scheduler.dateTime":"Date & Time","scheduler.duration":"Duration","scheduler.minutes":"minutes","scheduler.showFrom":"Show from","scheduler.to":"to","addAppointmentModal.alertFillAllFields":"Please fill in all required fields.","addAppointmentModal.title":"New Appointment","addAppointmentModal.closeAriaLabel":"Close new appointment form","addAppointmentModal.patient":"Patient","addAppointmentModal.selectPatient":"Select a patient","addAppointmentModal.dentist":"Dentist","addAppointmentModal.selectDentist":"Select a dentist","addAppointmentModal.startTime":"Start Time","addAppointmentModal.endTime":"End Time","addAppointmentModal.reasonForVisit":"Reason for Visit","addAppointmentModal.reasonPlaceholder":"E.g., Annual check-up, filling...","addAppointmentModal.schedule":"Schedule Appointment","reminders.reminderTime":"Reminder Time","reminders.none":"None","reminders.1_hour_before":"1 Hour Before","reminders.2_hours_before":"2 Hours Before","reminders.1_day_before":"1 Day Before","reminders.toggleNotifications":"Toggle Notifications","reminders.pendingReminders":"Pending Reminders","reminders.noPendingReminders":"No pending reminders.","reminders.sendReminder":"Send Reminder","reminders.whatsappMessage":"Hello {{patientName}}, this is a reminder from CuraSoft Dental Clinic for your appointment on {{date}} at {{time}}. We look forward to seeing you.","notifications.patientAdded":"Patient added successfully.","notifications.patientUpdated":"Patient details updated successfully.","notifications.treatmentAdded":"Treatment record added successfully.","notifications.paymentAdded":"Payment added successfully.","notifications.prescriptionAdded":"Prescription added successfully.","notifications.discountAdded":"Discount applied successfully.","notifications.lowStockAlert":"Low Stock Alert","notifications.labCaseDueAlert":"Lab Case Due Alert","notifications.lowStockMessage":"{{itemName}} is running low ({{count}} remaining).","notifications.labCaseDueMessage":"{{caseType}} case for patient {{patientName}} is due on {{date}}.","notifications.backupSuccess":"Backup created successfully!","notifications.backupError":"Operation failed. Could not create backup.","notifications.restoreSuccess":"Data restored successfully!","notifications.restoreError":"Restore failed. The selected file might be invalid.","notifications.invoiceAdded":"Invoice added successfully.","notifications.invoiceUpdated":"Invoice updated successfully.","notifications.invoicePaid":"Invoice marked as paid.","notifications.paymentRecorded":"Payment recorded successfully.","notifications.inventoryItemAdded":"Inventory item added successfully.","notifications.inventoryItemUpdated":"Inventory item updated successfully.","notifications.labCaseAdded":"Lab case added successfully.","notifications.labCaseUpdated":"Lab case updated successfully.","toothStatus.HEALTHY":"Healthy","toothStatus.FILLING":"Filling","toothStatus.CROWN":"Crown","toothStatus.MISSING":"Missing","toothStatus.IMPLANT":"Implant","toothStatus.ROOT_CANAL":"Root Canal","toothStatus.CAVITY":"Cavity","dentalChart.toothAriaLabel":"Tooth {{toothId}}, status: {{status}}","dentalChart.upperRight":"Upper Right","dentalChart.upperLeft":"Upper Left","dentalChart.lowerRight":"Lower Right","dentalChart.lowerLeft":"Lower Left","editToothModal.title":"Edit Tooth {{toothId}}","editToothModal.status":"Status","editToothModal.notes":"Notes","editToothModal.addNotesPlaceholder":"Add notes...","doctorManagement.title":"Doctor Management","doctorList.addNewDoctor":"Add New Doctor","doctorList.viewDetails":"View Details","doctorDetails.closeAriaLabel":"Close doctor details","doctorDetails.tabDetails":"Details","doctorDetails.tabTreatments":"Treatments","doctorDetails.tabFinancials":"Financials","doctorDetails.fullName":"Full Name","doctorDetails.specialty":"Specialty","doctorDetails.colorTag":"Color Tag","doctorDetails.selectColorAriaLabel":"Select color {{color}}","doctorDetails.appointmentSchedule":"Appointment Schedule","doctorDetails.noAppointmentsFound":"No appointments found.","doctorDetails.financialSummary":"Financial Summary","doctorDetails.totalRevenueGenerated":"Total Revenue Generated","doctorDetails.totalEarnings":"Total Earnings","doctorDetails.totalPaymentsReceived":"Total Payments Received","doctorDetails.netBalance":"Net Balance","doctorDetails.treatmentsPerformed":"Treatments Performed","doctorDetails.noTreatmentsFound":"No treatment records found.","doctorDetails.transactions":"Financial Transactions","doctorDetails.earnings":"Earnings (Treatments)","doctorDetails.payments":"Payments","doctorDetails.noTransactions":"No financial transactions recorded.","addDoctorModal.title":"Add New Doctor","addDoctorModal.closeAriaLabel":"Close add doctor form","addDoctorModal.fullName":"Full Name","addDoctorModal.specialty":"Specialty","addDoctorModal.colorTag":"Color Tag","addDoctorModal.saveDoctor":"Save Doctor","suppliersManagement.title":"Suppliers Management","inventoryManagement.title":"Inventory Management","labCasesManagement.title":"Lab Cases Management","expensesManagement.title":"Expenses Management","treatmentDefinitionsManagement.title":"Treatment Definitions Management","suppliers.editSupplier":"Edit Supplier","suppliers.suppliersList":"Suppliers List","suppliers.addSupplier":"Add Supplier","suppliers.viewDetails":"View Details","suppliers.editSupplierAriaLabel":"Edit supplier {{name}}","suppliers.noSuppliersAdded":"No suppliers added yet.","suppliers.addNewSupplier":"Add New Supplier","suppliers.supplierName":"Supplier Name","suppliers.contactPerson":"Contact Person","suppliers.phone":"Phone","suppliers.email":"Email","suppliers.supplierType":"Supplier Type","supplierType.materialSupplier":"Material Supplier","supplierType.dentalLab":"Dental Lab","supplierDetails.contactInfo":"Contact Information","supplierDetails.financialSummary":"Financial Summary","invoices.title":"Invoices","invoices.addInvoice":"Add Invoice","invoices.editInvoice":"Edit Invoice","invoices.invoice":"Invoice","invoices.date":"Date","invoices.due":"Due Date","invoices.paid":"Paid","invoices.remaining":"Remaining","invoices.confirmPayRemaining":"Are you sure you want to pay the remaining {{amount}} for this invoice?","invoices.viewAttachment":"View Attachment","invoices.payRemaining":"Pay Remaining","invoices.noInvoices":"No invoices for this supplier.","invoices.totalBilled":"Total Billed","invoices.totalPaid":"Total Paid","invoices.outstandingBalance":"Outstanding Balance","invoices.invoiceNumber":"Invoice Number","invoices.amount":"Amount","invoices.attachInvoice":"Attach Invoice Image","invoices.billed":"Billed Amount","invoices.paidAmount":"Paid Amount","inventory.editItem":"Edit Item","inventory.addNewItem":"Add New Item","inventory.itemName":"Item Name","inventory.description":"Description","inventory.descriptionPlaceholder":"Short description of the item...","inventory.supplier":"Supplier","inventory.selectSupplier":"Select a supplier","inventory.currentStock":"Current Stock","inventory.unitCost":"Unit Cost","inventory.inventoryItems":"Inventory Items","inventory.addItem":"Add Item","inventory.addItemPlaceholder":"Select an item to add...","inventory.stock":"Stock","inventory.editItemAriaLabel":"Edit item {{name}}","inventory.minStockLevel":"Min Stock Level","inventory.expiryDate":"Expiry Date","inventory.printReport":"Print Inventory Report","inventoryReport.title":"Inventory Report","inventoryReport.itemName":"Item Name","inventoryReport.supplier":"Supplier","inventoryReport.stock":"Current Stock","inventoryReport.minStock":"Min Stock","inventoryReport.unitCost":"Unit Cost","inventoryReport.totalValue":"Total Value","inventoryReport.expiryDate":"Expiry Date","inventoryReport.status":"Status","inventoryStatus.ok":"OK","inventoryStatus.lowStock":"Low Stock","inventoryStatus.expiresSoon":"Expires Soon","inventoryStatus.expired":"Expired","inventoryStatus.outOfStock":"Out of Stock","expenses.editExpense":"Edit Expense","expenses.addNewExpense":"Add New Expense","expenses.date":"Date","expenses.description":"Description","expenses.descriptionPlaceholder":"E.g., May Electricity Bill","expenses.amount":"Amount","expenses.category":"Category","expenses.selectSupplier":"Link to Supplier (optional)","expenses.noSupplier":"No Supplier","expenses.applyToInvoice":"Apply to Invoice (optional)","expenses.paymentOnAccount":"Payment on Account","expenses.clinicExpenses":"Clinic Expenses","expenses.addExpense":"Add Expense","expenses.noExpensesRecorded":"No expenses recorded.","expenses.supplier":"Supplier","expenses.editExpenseAriaLabel":"Edit expense: {{description}}","labCases.editCase":"Edit Case","labCases.addNewCase":"Add New Case","labCases.patient":"Patient","labCases.selectPatient":"Select Patient","labCases.dentalLab":"Dental Lab","labCases.selectDentalLab":"Select Lab","labCases.caseType":"Case Type","labCases.caseTypePlaceholder":"E.g., Zirconia Crown, E-Max Veneer","labCases.sentDate":"Sent Date","labCases.dueDate":"Due Date","labCases.returnDate":"Return Date","labCases.labCost":"Lab Cost","labCases.cost":"Cost","labCases.status":"Status","labCases.selectStatus":"Select Status","labCases.notes":"Notes","labCases.notesPlaceholder":"E.g., Desired shade A2","labCases.labCaseTracker":"Lab Case Tracker","labCases.addCase":"Add Case","labCases.noCasesRecorded":"No lab cases recorded.","labCases.lab":"Lab","labCases.due":"Due","labCases.editCaseAriaLabel":"Edit case {{caseType}} for patient {{patientName}}","labCases.alertFillAllFields":"Please fill in all required fields.","labCaseStatus.DRAFT":"Draft","labCaseStatus.SENT_TO_LAB":"Sent to Lab","labCaseStatus.RECEIVED_FROM_LAB":"Received from Lab","labCaseStatus.FITTED_TO_PATIENT":"Fitted to Patient","labCaseStatus.CANCELLED":"Cancelled","treatments.editTreatment":"Edit Treatment","treatments.addNewTreatment":"Add New Treatment","treatments.treatmentName":"Treatment Name","treatments.description":"Description","treatments.descriptionPlaceholder":"Short description of the treatment...","treatments.basePrice":"Base Price","treatments.doctorPercentage":"Doctor Percentage","treatments.clinicPercentage":"Clinic Percentage","treatments.auto":"Auto","treatments.manageTreatments":"Manage Treatments & Pricing","treatments.addTreatment":"Add Treatment","treatments.noTreatmentsAdded":"No treatments added yet.","treatments.doctor":"Doctor","treatments.clinic":"Clinic","treatments.editTreatmentAriaLabel":"Edit treatment {{name}}","addTreatmentRecord.title":"Add New Treatment Record","addTreatmentRecord.date":"Date","addTreatmentRecord.dentist":"Dentist","addTreatmentRecord.selectDentist":"Select a dentist","addTreatmentRecord.treatment":"Treatment","addTreatmentRecord.selectTreatment":"Select a treatment","addTreatmentRecord.notes":"Notes","addTreatmentRecord.notesPlaceholder":"Additional details about the session...","addTreatmentRecord.inventoryItemsUsed":"Inventory Items Used","addTreatmentRecord.addItem":"Add Item","addTreatmentRecord.addItemPlaceholder":"Select an item to add...","addTreatmentRecord.stock":"Stock","addTreatmentRecord.costSummary":"Cost Summary","addTreatmentRecord.baseTreatmentPrice":"Base Treatment Price","addTreatmentRecord.totalMaterialCost":"Total Material Cost","addTreatmentRecord.totalPatientCost":"Total Patient Cost","addTreatmentRecord.doctorShare":"Doctor Share","addTreatmentRecord.clinicShare":"Clinic Share","addTreatmentRecord.saveRecord":"Save Record","addTreatmentRecord.alertFillFields":"Please select a dentist and a treatment.","editTreatmentRecord.title":"Edit Treatment Price","editTreatmentRecord.customPrice":"Custom Price","editTreatmentRecord.updatedShares":"Updated Shares","editTreatmentRecord.saveChanges":"Save Changes","editTreatmentRecord.priceMustBePositive":"Price must be greater than zero.","editTreatmentRecord.priceUpdated":"Treatment price updated successfully.","editTreatmentRecord.originalPrice":"Original Price","editTreatmentRecord.treatmentName":"Treatment Name","addTreatmentRecord.decreaseQuantityAria":"Decrease quantity of {{itemName}}","addTreatmentRecord.increaseQuantityAria":"Increase quantity of {{itemName}}","addTreatmentRecord.quantityAria":"Quantity of {{itemName}}","addTreatmentRecord.removeItemAria":"Remove {{itemName}}","treatmentRecordList.noRecords":"No treatment records for this patient.","treatmentRecordList.noNotes":"No notes.","treatmentRecordList.materialsUsed":"Materials Used","reports.title":"Reports","reports.categoryDaily":"Daily","reports.categoryMonthly":"Monthly","reports.categoryPatient":"Patient","reports.categoryDoctor":"Doctor","reports.categorySupplier":"Supplier","reports.categoryLab":"Lab","reports.categoryFinancial":"Financial","reports.categoryInventory":"Inventory","reports.tabDailySummary":"Daily Summary","reports.tabDailyAppointments":"Daily Appointments","reports.tabDailyRevenue":"Daily Revenue","reports.tabMonthlyOverview":"Monthly Overview","reports.tabMonthlyPerformance":"Monthly Performance","reports.tabPatientHistory":"Patient History","reports.tabPatientFinancials":"Patient Financials","reports.tabDoctorPerformance":"Doctor Performance","reports.tabDoctorEarnings":"Doctor Earnings","reports.tabSupplierTransactions":"Supplier Transactions","reports.tabSupplierStatements":"Supplier Statements","reports.tabLabTracking":"Lab Tracking","reports.tabLabCosts":"Lab Costs","reports.tabFinancialOverview":"Financial Overview","reports.tabProfitLoss":"Profit & Loss","reports.tabCashFlow":"Cash Flow","reports.tabInventoryStatus":"Inventory Status","reports.tabPatientStatistics":"Patient Statistics","reports.tabFinancialSummary":"Financial Summary","reports.tabAppointmentOverview":"Appointment Overview","reports.tabInventoryReport":"Inventory Report","reports.tabTreatmentPerformance":"Treatment Performance","reports.dateRange":"Date Range","reports.startDate":"Start Date","reports.endDate":"End Date","reports.filterByPatient":"Filter by Patient","reports.filterByDoctor":"Filter by Doctor","reports.filterBySupplier":"Filter by Supplier","reports.filterByDentist":"Filter by Dentist","reports.filterByLab":"Filter by Lab","reports.noDataAvailable":"No data available to display.","reports.printReport":"Print Report","reports.dailySummary.totalAppointments":"Total Appointments","reports.dailySummary.totalRevenue":"Total Revenue","reports.dailySummary.totalPatients":"Total Patients","reports.dailySummary.totalTreatments":"Total Treatments","reports.doctorEarnings.description":"Detailed report of doctor earnings and payments","reports.labCosts.description":"Detailed analysis of lab costs and profits","reports.profitLoss.description":"Detailed profit and loss report","reports.cashFlow.description":"Cash flow analysis for the clinic","reports.inventoryStatus.description":"Inventory status and alerts","reports.monthlyOverview.totalRevenue":"Monthly Total Revenue","reports.monthlyOverview.totalExpenses":"Monthly Total Expenses","reports.monthlyOverview.netProfit":"Monthly Net Profit","reports.monthlyOverview.totalPatients":"Monthly Total Patients","reports.patientStats.totalPatients":"Total Patients","reports.patientStats.genderDistribution":"Gender Distribution","reports.patientStats.ageDistribution":"Age Distribution","reports.patientStats.ageGroup":"Group","reports.patientStats.newPatientsThisPeriod":"New Patients in This Period","reports.financialSummary.totalIncome":"Total Income","reports.financialSummary.totalExpenses":"Total Expenses","reports.financialSummary.netProfit":"Net Profit","reports.financialSummary.incomeByTreatment":"Income by Treatment","reports.financialSummary.expensesByCategory":"Expenses by Category","reports.appointmentOverview.totalAppointments":"Total Appointments","reports.appointmentOverview.completedAppointments":"Completed Appointments","reports.appointmentOverview.cancelledAppointments":"Cancelled Appointments","reports.appointmentOverview.completionRate":"Completion Rate","reports.appointmentOverview.appointmentsByDentist":"Appointments by Dentist","reports.inventoryReport.totalValue":"Total Inventory Value","reports.inventoryReport.lowStockItems":"Low Stock Items","reports.inventoryReport.allInventoryItems":"All Inventory Items","reports.inventoryReport.itemName":"Item Name","reports.inventoryReport.currentStock":"Current Stock","reports.inventoryReport.unitCost":"Unit Cost","reports.treatmentPerformance.allTreatmentPerformance":"All Treatment Performance","reports.treatmentPerformance.treatment":"Treatment","reports.treatmentPerformance.count":"Count","reports.treatmentPerformance.averagePrice":"Average Price","reports.treatmentPerformance.totalRevenue":"Total Revenue","reports.treatmentPerformance.totalClinicShare":"Total Clinic Share","reports.treatmentPerformance.totalDoctorShare":"Total Doctor Share","reports.treatmentPerformance.mostProfitable":"Most Profitable","reports.treatmentPerformance.top5ByRevenue":"Top 5 Treatments by Revenue","reports.treatmentPerformance.top5ByFrequency":"Top 5 Treatments by Frequency","settings.title":"Settings","settings.backup.title":"Data Backup","settings.backup.description":"Save a copy of all your clinic data (patients, appointments, etc.) to a JSON file. Keep this file in a safe place.","settings.backup.button":"Download Backup","settings.restore.title":"Restore Data","settings.restore.description":"Restore your clinic data from a backup file. This will overwrite all current data.","settings.restore.warning":"This action cannot be undone.","settings.restore.button":"Upload Restore File","settings.restore.confirm":"Warning! All current data will be replaced by the data in backup file. Are you sure you want to proceed?","settings.dangerZone.title":"Danger Zone","settings.dangerZone.description":"The following actions are permanent and cannot be undone. Please proceed with caution.","settings.clear.title":"Clear All Data","settings.clear.description":"This will permanently delete all clinic data and reset the application to its initial state.","settings.clear.button":"Clear Data Now","settings.clear.confirm":"Warning! All clinic data will be permanently deleted. Are you sure you want to proceed?","settings.clear.success":"Data cleared successfully! The application will reload.","settings.clear.error":"Failed to clear data.","patientReport.clinicAddress":"Zagazig, Salah Salem St., 01017755577","patientReport.title":"Full Patient Report","patientReport.generatedOn":"Generated On: {{date}}","patientReport.demographics.title":"Demographics","patientReport.demographics.name":"Name","patientReport.demographics.phone":"Phone","patientReport.demographics.dob":"Date of Birth","patientReport.demographics.email":"Email","patientReport.demographics.gender":"Gender","patientReport.demographics.address":"Address","patientReport.emergencyAndInsurance.title":"Emergency & Insurance","patientReport.emergencyAndInsurance.insuranceProvider":"Insurance Provider","patientReport.emergencyAndInsurance.policyNumber":"Policy Number","patientReport.medicalInfo.title":"Medical Information","patientReport.medicalInfo.allergies":"Allergies","patientReport.medicalInfo.medications":"Current Medications","patientReport.medicalInfo.medicalHistory":"Medical History","patientReport.dentalChart.title":"Dental Chart","patientReport.dentalChart.allHealthy":"All teeth are healthy.","patientReport.dentalChart.tooth":"Tooth","patientReport.dentalChart.status":"Status","patientReport.dentalChart.notes":"Notes","patientReport.treatmentHistory.title":"Treatment History","patientReport.treatmentHistory.date":"Date","patientReport.treatmentHistory.treatment":"Treatment","patientReport.treatmentHistory.dentist":"Dentist","patientReport.treatmentHistory.notes":"Notes","patientReport.treatmentHistory.cost":"Cost","patientReport.treatmentHistory.noRecords":"No treatment records.","patientReport.financials.title":"Financial Summary","patientReport.financials.paymentDate":"Payment Date","patientReport.financials.paymentMethod":"Payment Method","patientReport.financials.notes":"Notes","patientReport.financials.amount":"Amount","patientReport.financials.noPayments":"No payments recorded.","patientInvoice.title":"Patient Invoice","patientInvoice.invoiceNumber":"Invoice Number","patientInvoice.date":"Date","patientInvoice.billTo":"Bill To","patientInvoice.treatmentDetails":"Treatment Details","patientInvoice.paymentDetails":"Payment Details","patientInvoice.balanceDue":"Balance Due","patientInvoice.thankYou":"Thank you for trusting CuraSoft Clinic.","suppliers.supplierDetails":"Supplier Details","supplierStatement.financialTitle":"Supplier Financial Statement","supplierStatement.caseTitle":"Supplier Lab Case Statement","supplierStatement.statementDetails":"Statement Details","supplierStatement.caseDetails":"Lab Case Details","supplierStatement.totalCost":"Total Cost","supplierStatement.noPaymentsRecorded":"No payments recorded for this supplier.","supplierStatement.notDentalLab":"This report is only for Dental Labs.","supplierStatement.selectDentalLab":"Please select a 'Dental Lab' type supplier to view this report.","supplierStatement.totalCases":"Total Cases","addDoctorPaymentModal.title":"Add Doctor Payment","addDoctorPaymentModal.paymentDate":"Payment Date","addDoctorPaymentModal.amount":"Amount","addDoctorPaymentModal.notes":"Notes","addDoctorPaymentModal.notesPlaceholder":"Notes about the payment (optional)","addDoctorPaymentModal.savePayment":"Save Payment","financialAccounts.title":"Financial Accounts","financialAccounts.tabs.revenue":"Revenue","financialAccounts.tabs.expenses":"Expenses","financialAccounts.tabs.balances":"Balances","financialAccounts.tabs.accountDetails":"Account Details","financialAccounts.export":"Export","financialAccounts.print":"Print","financialSummary.title":"Financial Summary","revenueTab.totalRevenue":"Total Revenue","revenueTab.treatmentRevenue":"Treatment Revenue","revenueTab.paymentRevenue":"Payment Revenue","revenueTab.revenueChart":"Revenue Chart","revenueTab.revenueDetails":"Revenue Details","revenueTab.noRevenueData":"No revenue data available.","expensesTab.totalExpenses":"Total Expenses","expensesTab.operatingExpenses":"Operating Expenses","expensesTab.doctorPayments":"Doctor Payments","expensesTab.supplierInvoices":"Supplier Invoices","expensesTab.expensesByCategory":"Expenses by Category","expensesTab.expensesDetails":"Expenses Details","expensesTab.noExpensesData":"No expenses data available.","balancesTab.netProfit":"Net Profit","balancesTab.cashFlow":"Cash Flow","balancesTab.unpaidInvoices":"Unpaid Invoices","balancesTab.paidInvoices":"Paid Invoices","balancesTab.balanceSheet":"Balance Sheet","balancesTab.assets":"Assets","balancesTab.liabilities":"Liabilities","balancesTab.equity":"Equity","balancesTab.cashAndEquivalents":"Cash and Equivalents","balancesTab.accountsReceivable":"Accounts Receivable","balancesTab.totalAssets":"Total Assets","balancesTab.accountsPayable":"Accounts Payable","balancesTab.otherLiabilities":"Other Liabilities","balancesTab.totalLiabilities":"Total Liabilities","balancesTab.supplierInvoices":"Supplier Invoices","balancesTab.noInvoices":"No invoices available.","balancesTab.invoiceNumber":"Invoice #","balancesTab.supplier":"Supplier","balancesTab.invoiceDate":"Invoice Date","balancesTab.dueDate":"Due Date","balancesTab.amount":"Amount","balancesTab.status":"Status","financialFilters.title":"Filters","financialFilters.clearAll":"Clear All","financialFilters.startDate":"Start Date","financialFilters.endDate":"End Date","financialFilters.dentist":"Dentist","financialFilters.supplier":"Supplier","financialFilters.category":"Category","financialTable.date":"Date","financialTable.description":"Description","financialTable.type":"Type","financialTable.category":"Category","financialTable.amount":"Amount","financialTable.showing":"Showing","financialTable.entries":"entries","financialCharts.noData":"No data available","financialCharts.total":"Total","supplierInvoiceStatus.UNPAID":"Unpaid","supplierInvoiceStatus.PAID":"Paid","common.accessDenied":"Access Denied","common.all":"All","common.select":"Select","patientModal.tabs.basicInfo":"Basic Info","patientModal.tabs.medicalHistory":"Medical History","patientModal.tabs.emergencyInsurance":"Emergency & Insurance","patientModal.tabs.imagesNotes":"Images & Notes","validation.required":"This field is required.","validation.fixErrors":"Please fix the errors before proceeding.","validation.fixAllErrors":"Please fix all errors before saving.","common.unknown":"Unknown","prescriptionList.noPrescriptions":"No prescriptions found for this patient.","prescriptionList.noPrescriptionsFound":"No prescriptions found matching the current filters.","prescriptionList.items":"items","prescriptionList.noNotes":"No notes.","prescriptionList.searchAndFilters":"Search & Filters","prescriptionList.searchPlaceholder":"Search by patient, doctor, or medication name...","prescriptionList.search":"Search","prescriptionList.doctor":"Doctor","prescriptionList.allDoctors":"All Doctors","prescriptionList.patient":"Patient","prescriptionList.medications":"Medications","prescriptionList.dosage":"Dosage","prescriptionList.quantity":"Quantity","prescriptionList.instructions":"Instructions","prescriptionModal.title":"Add New Prescription","prescriptionModal.editTitle":"Edit Prescription","prescriptionModal.closeAriaLabel":"Close prescription form","prescriptionModal.dentist":"Dentist","prescriptionModal.selectDentist":"Select a dentist","prescriptionModal.prescriptionDate":"Prescription Date","prescriptionModal.notes":"Notes","prescriptionModal.notesPlaceholder":"Additional notes about the prescription...","prescriptionModal.medications":"Medications","prescriptionModal.addMedication":"Add Medication","prescriptionModal.medicationName":"Medication Name","prescriptionModal.medicationNamePlaceholder":"Enter medication name...","prescriptionModal.dosage":"Dosage","prescriptionModal.dosagePlaceholder":"E.g., 500mg, 2 tablets...","prescriptionModal.quantity":"Quantity","prescriptionModal.instructions":"Instructions","prescriptionModal.instructionsPlaceholder":"E.g., Take twice daily after meals...","prescriptionModal.noMedications":"No medications added yet.","prescriptionModal.savePrescription":"Save Prescription","prescriptionModal.createPrescription":"Create Prescription","prescriptionModal.alertFillRequired":"Please fill in all required fields.","prescriptionModal.alertAtLeastOneItem":"Please add at least one medication.","prescriptionDetails.title":"Prescription Details","prescriptionDetails.closeAriaLabel":"Close prescription details","prescriptionDetails.patientInfo":"Patient Information","prescriptionDetails.patientName":"Patient Name","prescriptionDetails.patientId":"Patient ID","prescriptionDetails.patientPhone":"Phone","prescriptionDetails.prescriptionInfo":"Prescription Information","prescriptionDetails.dentist":"Dentist","prescriptionDetails.date":"Date","prescriptionDetails.prescriptionId":"Prescription ID","prescriptionDetails.notes":"Notes","prescriptionDetails.medications":"Medications","prescriptionDetails.dosage":"Dosage","prescriptionDetails.quantity":"Quantity","prescriptionDetails.instructions":"Instructions","prescriptionDetails.noMedications":"No medications prescribed."};var Pd=function(a,s){return Pd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},Pd(a,s)};function Qp(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");Pd(a,s);function n(){this.constructor=a}a.prototype=s===null?Object.create(s):(n.prototype=s.prototype,new n)}var tl=function(){return tl=Object.assign||function(s){for(var n,o=1,i=arguments.length;o<i;o++){n=arguments[o];for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(s[c]=n[c])}return s},tl.apply(this,arguments)};function Pa(a,s){var n={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&s.indexOf(o)<0&&(n[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(a);i<o.length;i++)s.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(a,o[i])&&(n[o[i]]=a[o[i]]);return n}function Xp(a,s,n,o){var i=arguments.length,c=i<3?s:o===null?o=Object.getOwnPropertyDescriptor(s,n):o,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,s,n,o);else for(var m=a.length-1;m>=0;m--)(u=a[m])&&(c=(i<3?u(c):i>3?u(s,n,c):u(s,n))||c);return i>3&&c&&Object.defineProperty(s,n,c),c}function Zp(a,s){return function(n,o){s(n,o,a)}}function ef(a,s,n,o,i,c){function u(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var m=o.kind,h=m==="getter"?"get":m==="setter"?"set":"value",y=!s&&a?o.static?a:a.prototype:null,b=s||(y?Object.getOwnPropertyDescriptor(y,o.name):{}),f,x=!1,v=n.length-1;v>=0;v--){var N={};for(var k in o)N[k]=k==="access"?{}:o[k];for(var k in o.access)N.access[k]=o.access[k];N.addInitializer=function(w){if(x)throw new TypeError("Cannot add initializers after decoration has completed");c.push(u(w||null))};var C=(0,n[v])(m==="accessor"?{get:b.get,set:b.set}:b[h],N);if(m==="accessor"){if(C===void 0)continue;if(C===null||typeof C!="object")throw new TypeError("Object expected");(f=u(C.get))&&(b.get=f),(f=u(C.set))&&(b.set=f),(f=u(C.init))&&i.unshift(f)}else(f=u(C))&&(m==="field"?i.unshift(f):b[h]=f)}y&&Object.defineProperty(y,o.name,b),x=!0}function tf(a,s,n){for(var o=arguments.length>2,i=0;i<s.length;i++)n=o?s[i].call(a,n):s[i].call(a);return o?n:void 0}function rf(a){return typeof a=="symbol"?a:"".concat(a)}function sf(a,s,n){return typeof s=="symbol"&&(s=s.description?"[".concat(s.description,"]"):""),Object.defineProperty(a,"name",{configurable:!0,value:n?"".concat(n," ",s):s})}function nf(a,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,s)}function Fe(a,s,n,o){function i(c){return c instanceof n?c:new n(function(u){u(c)})}return new(n||(n=Promise))(function(c,u){function m(b){try{y(o.next(b))}catch(f){u(f)}}function h(b){try{y(o.throw(b))}catch(f){u(f)}}function y(b){b.done?c(b.value):i(b.value).then(m,h)}y((o=o.apply(a,s||[])).next())})}function af(a,s){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,i,c,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=m(0),u.throw=m(1),u.return=m(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function m(y){return function(b){return h([y,b])}}function h(y){if(o)throw new TypeError("Generator is already executing.");for(;u&&(u=0,y[0]&&(n=0)),n;)try{if(o=1,i&&(c=y[0]&2?i.return:y[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,y[1])).done)return c;switch(i=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,i=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){n.label=y[1];break}if(y[0]===6&&n.label<c[1]){n.label=c[1],c=y;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(y);break}c[2]&&n.ops.pop(),n.trys.pop();continue}y=s.call(a,n)}catch(b){y=[6,b],i=0}finally{o=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}var ll=Object.create?(function(a,s,n,o){o===void 0&&(o=n);var i=Object.getOwnPropertyDescriptor(s,n);(!i||("get"in i?!s.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return s[n]}}),Object.defineProperty(a,o,i)}):(function(a,s,n,o){o===void 0&&(o=n),a[o]=s[n]});function of(a,s){for(var n in a)n!=="default"&&!Object.prototype.hasOwnProperty.call(s,n)&&ll(s,a,n)}function rl(a){var s=typeof Symbol=="function"&&Symbol.iterator,n=s&&a[s],o=0;if(n)return n.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&o>=a.length&&(a=void 0),{value:a&&a[o++],done:!a}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yd(a,s){var n=typeof Symbol=="function"&&a[Symbol.iterator];if(!n)return a;var o=n.call(a),i,c=[],u;try{for(;(s===void 0||s-- >0)&&!(i=o.next()).done;)c.push(i.value)}catch(m){u={error:m}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(u)throw u.error}}return c}function lf(){for(var a=[],s=0;s<arguments.length;s++)a=a.concat(Yd(arguments[s]));return a}function cf(){for(var a=0,s=0,n=arguments.length;s<n;s++)a+=arguments[s].length;for(var o=Array(a),i=0,s=0;s<n;s++)for(var c=arguments[s],u=0,m=c.length;u<m;u++,i++)o[i]=c[u];return o}function df(a,s,n){if(n||arguments.length===2)for(var o=0,i=s.length,c;o<i;o++)(c||!(o in s))&&(c||(c=Array.prototype.slice.call(s,0,o)),c[o]=s[o]);return a.concat(c||Array.prototype.slice.call(s))}function Ta(a){return this instanceof Ta?(this.v=a,this):new Ta(a)}function uf(a,s,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(a,s||[]),i,c=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",u),i[Symbol.asyncIterator]=function(){return this},i;function u(v){return function(N){return Promise.resolve(N).then(v,f)}}function m(v,N){o[v]&&(i[v]=function(k){return new Promise(function(C,w){c.push([v,k,C,w])>1||h(v,k)})},N&&(i[v]=N(i[v])))}function h(v,N){try{y(o[v](N))}catch(k){x(c[0][3],k)}}function y(v){v.value instanceof Ta?Promise.resolve(v.value.v).then(b,f):x(c[0][2],v)}function b(v){h("next",v)}function f(v){h("throw",v)}function x(v,N){v(N),c.shift(),c.length&&h(c[0][0],c[0][1])}}function mf(a){var s,n;return s={},o("next"),o("throw",function(i){throw i}),o("return"),s[Symbol.iterator]=function(){return this},s;function o(i,c){s[i]=a[i]?function(u){return(n=!n)?{value:Ta(a[i](u)),done:!1}:c?c(u):u}:c}}function hf(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=a[Symbol.asyncIterator],n;return s?s.call(a):(a=typeof rl=="function"?rl(a):a[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(c){n[c]=a[c]&&function(u){return new Promise(function(m,h){u=a[c](u),i(m,h,u.done,u.value)})}}function i(c,u,m,h){Promise.resolve(h).then(function(y){c({value:y,done:m})},u)}}function pf(a,s){return Object.defineProperty?Object.defineProperty(a,"raw",{value:s}):a.raw=s,a}var Eg=Object.create?(function(a,s){Object.defineProperty(a,"default",{enumerable:!0,value:s})}):function(a,s){a.default=s},Id=function(a){return Id=Object.getOwnPropertyNames||function(s){var n=[];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(n[n.length]=o);return n},Id(a)};function ff(a){if(a&&a.__esModule)return a;var s={};if(a!=null)for(var n=Id(a),o=0;o<n.length;o++)n[o]!=="default"&&ll(s,a,n[o]);return Eg(s,a),s}function gf(a){return a&&a.__esModule?a:{default:a}}function xf(a,s,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof s=="function"?a!==s||!o:!s.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(a):o?o.value:s.get(a)}function yf(a,s,n,o,i){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof s=="function"?a!==s||!i:!s.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?i.call(a,n):i?i.value=n:s.set(a,n),n}function bf(a,s){if(s===null||typeof s!="object"&&typeof s!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof a=="function"?s===a:a.has(s)}function vf(a,s,n){if(s!=null){if(typeof s!="object"&&typeof s!="function")throw new TypeError("Object expected.");var o,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=s[Symbol.asyncDispose]}if(o===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=s[Symbol.dispose],n&&(i=o)}if(typeof o!="function")throw new TypeError("Object not disposable.");i&&(o=function(){try{i.call(this)}catch(c){return Promise.reject(c)}}),a.stack.push({value:s,dispose:o,async:n})}else n&&a.stack.push({async:!0});return s}var Tg=typeof SuppressedError=="function"?SuppressedError:function(a,s,n){var o=new Error(n);return o.name="SuppressedError",o.error=a,o.suppressed=s,o};function wf(a){function s(c){a.error=a.hasError?new Tg(c,a.error,"An error was suppressed during disposal."):c,a.hasError=!0}var n,o=0;function i(){for(;n=a.stack.pop();)try{if(!n.async&&o===1)return o=0,a.stack.push(n),Promise.resolve().then(i);if(n.dispose){var c=n.dispose.call(n.value);if(n.async)return o|=2,Promise.resolve(c).then(i,function(u){return s(u),i()})}else o|=1}catch(u){s(u)}if(o===1)return a.hasError?Promise.reject(a.error):Promise.resolve();if(a.hasError)throw a.error}return i()}function jf(a,s){return typeof a=="string"&&/^\.\.?\//.test(a)?a.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(n,o,i,c,u){return o?s?".jsx":".js":i&&(!c||!u)?n:i+c+"."+u.toLowerCase()+"js"}):a}const Dg={__extends:Qp,__assign:tl,__rest:Pa,__decorate:Xp,__param:Zp,__esDecorate:ef,__runInitializers:tf,__propKey:rf,__setFunctionName:sf,__metadata:nf,__awaiter:Fe,__generator:af,__createBinding:ll,__exportStar:of,__values:rl,__read:Yd,__spread:lf,__spreadArrays:cf,__spreadArray:df,__await:Ta,__asyncGenerator:uf,__asyncDelegator:mf,__asyncValues:hf,__makeTemplateObject:pf,__importStar:ff,__importDefault:gf,__classPrivateFieldGet:xf,__classPrivateFieldSet:yf,__classPrivateFieldIn:bf,__addDisposableResource:vf,__disposeResources:wf,__rewriteRelativeImportExtension:jf},Pg=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:vf,get __assign(){return tl},__asyncDelegator:mf,__asyncGenerator:uf,__asyncValues:hf,__await:Ta,__awaiter:Fe,__classPrivateFieldGet:xf,__classPrivateFieldIn:bf,__classPrivateFieldSet:yf,__createBinding:ll,__decorate:Xp,__disposeResources:wf,__esDecorate:ef,__exportStar:of,__extends:Qp,__generator:af,__importDefault:gf,__importStar:ff,__makeTemplateObject:pf,__metadata:nf,__param:Zp,__propKey:rf,__read:Yd,__rest:Pa,__rewriteRelativeImportExtension:jf,__runInitializers:tf,__setFunctionName:sf,__spread:lf,__spreadArray:df,__spreadArrays:cf,__values:rl,default:Dg},Symbol.toStringTag,{value:"Module"})),Ig="modulepreload",Rg=function(a){return"/"+a},Eh={},Ia=function(s,n,o){let i=Promise.resolve();if(n&&n.length>0){let y=function(b){return Promise.all(b.map(f=>Promise.resolve(f).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var u=y;document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),h=m?.nonce||m?.getAttribute("nonce");i=y(n.map(b=>{if(b=Rg(b),b in Eh)return;Eh[b]=!0;const f=b.endsWith(".css"),x=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${x}`))return;const v=document.createElement("link");if(v.rel=f?"stylesheet":Ig,f||(v.as="script"),v.crossOrigin="",v.href=b,h&&v.setAttribute("nonce",h),document.head.appendChild(v),f)return new Promise((N,k)=>{v.addEventListener("load",N),v.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${b}`)))})}))}function c(m){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=m,window.dispatchEvent(h),!h.defaultPrevented)throw m}return i.then(m=>{for(const h of m||[])h.status==="rejected"&&c(h.reason);return s().catch(c)})},Ag=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...n)=>Ia(async()=>{const{default:o}=await Promise.resolve().then(()=>Ln);return{default:o}},void 0).then(({default:o})=>o(...n)):s=fetch,(...n)=>s(...n)};class Qd extends Error{constructor(s,n="FunctionsError",o){super(s),this.name=n,this.context=o}}class Th extends Qd{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Dh extends Qd{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Ph extends Qd{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var Rd;(function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"})(Rd||(Rd={}));class Og{constructor(s,{headers:n={},customFetch:o,region:i=Rd.Any}={}){this.url=s,this.headers=n,this.region=i,this.fetch=Ag(o)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s){return Fe(this,arguments,void 0,function*(n,o={}){var i;try{const{headers:c,method:u,body:m,signal:h}=o;let y={},{region:b}=o;b||(b=this.region);const f=new URL(`${this.url}/${n}`);b&&b!=="any"&&(y["x-region"]=b,f.searchParams.set("forceFunctionRegion",b));let x;m&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",x=m):typeof m=="string"?(y["Content-Type"]="text/plain",x=m):typeof FormData<"u"&&m instanceof FormData?x=m:(y["Content-Type"]="application/json",x=JSON.stringify(m)):x=m;const v=yield this.fetch(f.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),c),body:x,signal:h}).catch(w=>{throw w.name==="AbortError"?w:new Th(w)}),N=v.headers.get("x-relay-error");if(N&&N==="true")throw new Dh(v);if(!v.ok)throw new Ph(v);let k=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),C;return k==="application/json"?C=yield v.json():k==="application/octet-stream"||k==="application/pdf"?C=yield v.blob():k==="text/event-stream"?C=v:k==="multipart/form-data"?C=yield v.formData():C=yield v.text(),{data:C,error:null,response:v}}catch(c){return c instanceof Error&&c.name==="AbortError"?{data:null,error:new Th(c)}:{data:null,error:c,response:c instanceof Ph||c instanceof Dh?c.context:void 0}}})}}var er={};const Ra=Gd(Pg);var qi={},zi={},Hi={},Wi={},Vi={},Mg=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Da=Mg();const Lg=Da.fetch,Nf=Da.fetch.bind(Da),Sf=Da.Headers,Fg=Da.Request,$g=Da.Response,Ln=Object.freeze(Object.defineProperty({__proto__:null,Headers:Sf,Request:Fg,Response:$g,default:Nf,fetch:Lg},Symbol.toStringTag,{value:"Module"})),Ug=Gd(Ln);var Gi={},Ih;function kf(){if(Ih)return Gi;Ih=1,Object.defineProperty(Gi,"__esModule",{value:!0});class a extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Gi.default=a,Gi}var Rh;function _f(){if(Rh)return Vi;Rh=1,Object.defineProperty(Vi,"__esModule",{value:!0});const a=Ra,s=a.__importDefault(Ug),n=a.__importDefault(kf());class o{constructor(c){var u,m;this.shouldThrowOnError=!1,this.method=c.method,this.url=c.url,this.headers=new Headers(c.headers),this.schema=c.schema,this.body=c.body,this.shouldThrowOnError=(u=c.shouldThrowOnError)!==null&&u!==void 0?u:!1,this.signal=c.signal,this.isMaybeSingle=(m=c.isMaybeSingle)!==null&&m!==void 0?m:!1,c.fetch?this.fetch=c.fetch:typeof fetch>"u"?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(c,u){return this.headers=new Headers(this.headers),this.headers.set(c,u),this}then(c,u){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const m=this.fetch;let h=m(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async y=>{var b,f,x,v;let N=null,k=null,C=null,w=y.status,j=y.statusText;if(y.ok){if(this.method!=="HEAD"){const _=await y.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((b=this.headers.get("Accept"))===null||b===void 0)&&b.includes("application/vnd.pgrst.plan+text"))?k=_:k=JSON.parse(_))}const M=(f=this.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),I=(x=y.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");M&&I&&I.length>1&&(C=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(k)&&(k.length>1?(N={code:"PGRST116",details:`Results contain ${k.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},k=null,C=null,w=406,j="Not Acceptable"):k.length===1?k=k[0]:k=null)}else{const M=await y.text();try{N=JSON.parse(M),Array.isArray(N)&&y.status===404&&(k=[],N=null,w=200,j="OK")}catch{y.status===404&&M===""?(w=204,j="No Content"):N={message:M}}if(N&&this.isMaybeSingle&&(!((v=N?.details)===null||v===void 0)&&v.includes("0 rows"))&&(N=null,w=200,j="OK"),N&&this.shouldThrowOnError)throw new n.default(N)}return{error:N,data:k,count:C,status:w,statusText:j}});return this.shouldThrowOnError||(h=h.catch(y=>{var b,f,x;return{error:{message:`${(b=y?.name)!==null&&b!==void 0?b:"FetchError"}: ${y?.message}`,details:`${(f=y?.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(x=y?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),h.then(c,u)}returns(){return this}overrideTypes(){return this}}return Vi.default=o,Vi}var Ah;function Cf(){if(Ah)return Wi;Ah=1,Object.defineProperty(Wi,"__esModule",{value:!0});const s=Ra.__importDefault(_f());class n extends s.default{select(i){let c=!1;const u=(i??"*").split("").map(m=>/\s/.test(m)&&!c?"":(m==='"'&&(c=!c),m)).join("");return this.url.searchParams.set("select",u),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:c=!0,nullsFirst:u,foreignTable:m,referencedTable:h=m}={}){const y=h?`${h}.order`:"order",b=this.url.searchParams.get(y);return this.url.searchParams.set(y,`${b?`${b},`:""}${i}.${c?"asc":"desc"}${u===void 0?"":u?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:c,referencedTable:u=c}={}){const m=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(m,`${i}`),this}range(i,c,{foreignTable:u,referencedTable:m=u}={}){const h=typeof m>"u"?"offset":`${m}.offset`,y=typeof m>"u"?"limit":`${m}.limit`;return this.url.searchParams.set(h,`${i}`),this.url.searchParams.set(y,`${c-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:c=!1,settings:u=!1,buffers:m=!1,wal:h=!1,format:y="text"}={}){var b;const f=[i?"analyze":null,c?"verbose":null,u?"settings":null,m?"buffers":null,h?"wal":null].filter(Boolean).join("|"),x=(b=this.headers.get("Accept"))!==null&&b!==void 0?b:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${y}; for="${x}"; options=${f};`),y==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Wi.default=n,Wi}var Oh;function Xd(){if(Oh)return Hi;Oh=1,Object.defineProperty(Hi,"__esModule",{value:!0});const s=Ra.__importDefault(Cf());class n extends s.default{eq(i,c){return this.url.searchParams.append(i,`eq.${c}`),this}neq(i,c){return this.url.searchParams.append(i,`neq.${c}`),this}gt(i,c){return this.url.searchParams.append(i,`gt.${c}`),this}gte(i,c){return this.url.searchParams.append(i,`gte.${c}`),this}lt(i,c){return this.url.searchParams.append(i,`lt.${c}`),this}lte(i,c){return this.url.searchParams.append(i,`lte.${c}`),this}like(i,c){return this.url.searchParams.append(i,`like.${c}`),this}likeAllOf(i,c){return this.url.searchParams.append(i,`like(all).{${c.join(",")}}`),this}likeAnyOf(i,c){return this.url.searchParams.append(i,`like(any).{${c.join(",")}}`),this}ilike(i,c){return this.url.searchParams.append(i,`ilike.${c}`),this}ilikeAllOf(i,c){return this.url.searchParams.append(i,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(i,c){return this.url.searchParams.append(i,`ilike(any).{${c.join(",")}}`),this}is(i,c){return this.url.searchParams.append(i,`is.${c}`),this}in(i,c){const u=Array.from(new Set(c)).map(m=>typeof m=="string"&&new RegExp("[,()]").test(m)?`"${m}"`:`${m}`).join(",");return this.url.searchParams.append(i,`in.(${u})`),this}contains(i,c){return typeof c=="string"?this.url.searchParams.append(i,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(i,`cs.{${c.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(c)}`),this}containedBy(i,c){return typeof c=="string"?this.url.searchParams.append(i,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(i,`cd.{${c.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(c)}`),this}rangeGt(i,c){return this.url.searchParams.append(i,`sr.${c}`),this}rangeGte(i,c){return this.url.searchParams.append(i,`nxl.${c}`),this}rangeLt(i,c){return this.url.searchParams.append(i,`sl.${c}`),this}rangeLte(i,c){return this.url.searchParams.append(i,`nxr.${c}`),this}rangeAdjacent(i,c){return this.url.searchParams.append(i,`adj.${c}`),this}overlaps(i,c){return typeof c=="string"?this.url.searchParams.append(i,`ov.${c}`):this.url.searchParams.append(i,`ov.{${c.join(",")}}`),this}textSearch(i,c,{config:u,type:m}={}){let h="";m==="plain"?h="pl":m==="phrase"?h="ph":m==="websearch"&&(h="w");const y=u===void 0?"":`(${u})`;return this.url.searchParams.append(i,`${h}fts${y}.${c}`),this}match(i){return Object.entries(i).forEach(([c,u])=>{this.url.searchParams.append(c,`eq.${u}`)}),this}not(i,c,u){return this.url.searchParams.append(i,`not.${c}.${u}`),this}or(i,{foreignTable:c,referencedTable:u=c}={}){const m=u?`${u}.or`:"or";return this.url.searchParams.append(m,`(${i})`),this}filter(i,c,u){return this.url.searchParams.append(i,`${c}.${u}`),this}}return Hi.default=n,Hi}var Mh;function Ef(){if(Mh)return zi;Mh=1,Object.defineProperty(zi,"__esModule",{value:!0});const s=Ra.__importDefault(Xd());class n{constructor(i,{headers:c={},schema:u,fetch:m}){this.url=i,this.headers=new Headers(c),this.schema=u,this.fetch=m}select(i,c){const{head:u=!1,count:m}=c??{},h=u?"HEAD":"GET";let y=!1;const b=(i??"*").split("").map(f=>/\s/.test(f)&&!y?"":(f==='"'&&(y=!y),f)).join("");return this.url.searchParams.set("select",b),m&&this.headers.append("Prefer",`count=${m}`),new s.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:c,defaultToNull:u=!0}={}){var m;const h="POST";if(c&&this.headers.append("Prefer",`count=${c}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const y=i.reduce((b,f)=>b.concat(Object.keys(f)),[]);if(y.length>0){const b=[...new Set(y)].map(f=>`"${f}"`);this.url.searchParams.set("columns",b.join(","))}}return new s.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}upsert(i,{onConflict:c,ignoreDuplicates:u=!1,count:m,defaultToNull:h=!0}={}){var y;const b="POST";if(this.headers.append("Prefer",`resolution=${u?"ignore":"merge"}-duplicates`),c!==void 0&&this.url.searchParams.set("on_conflict",c),m&&this.headers.append("Prefer",`count=${m}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((x,v)=>x.concat(Object.keys(v)),[]);if(f.length>0){const x=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",x.join(","))}}return new s.default({method:b,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}update(i,{count:c}={}){var u;const m="PATCH";return c&&this.headers.append("Prefer",`count=${c}`),new s.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}delete({count:i}={}){var c;const u="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new s.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return zi.default=n,zi}var Lh;function Bg(){if(Lh)return qi;Lh=1,Object.defineProperty(qi,"__esModule",{value:!0});const a=Ra,s=a.__importDefault(Ef()),n=a.__importDefault(Xd());class o{constructor(c,{headers:u={},schema:m,fetch:h}={}){this.url=c,this.headers=new Headers(u),this.schemaName=m,this.fetch=h}from(c){const u=new URL(`${this.url}/${c}`);return new s.default(u,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new o(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,u={},{head:m=!1,get:h=!1,count:y}={}){var b;let f;const x=new URL(`${this.url}/rpc/${c}`);let v;m||h?(f=m?"HEAD":"GET",Object.entries(u).filter(([k,C])=>C!==void 0).map(([k,C])=>[k,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([k,C])=>{x.searchParams.append(k,C)})):(f="POST",v=u);const N=new Headers(this.headers);return y&&N.set("Prefer",`count=${y}`),new n.default({method:f,url:x,headers:N,schema:this.schemaName,body:v,fetch:(b=this.fetch)!==null&&b!==void 0?b:fetch})}}return qi.default=o,qi}var Fh;function qg(){if(Fh)return er;Fh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.PostgrestError=er.PostgrestBuilder=er.PostgrestTransformBuilder=er.PostgrestFilterBuilder=er.PostgrestQueryBuilder=er.PostgrestClient=void 0;const a=Ra,s=a.__importDefault(Bg());er.PostgrestClient=s.default;const n=a.__importDefault(Ef());er.PostgrestQueryBuilder=n.default;const o=a.__importDefault(Xd());er.PostgrestFilterBuilder=o.default;const i=a.__importDefault(Cf());er.PostgrestTransformBuilder=i.default;const c=a.__importDefault(_f());er.PostgrestBuilder=c.default;const u=a.__importDefault(kf());return er.PostgrestError=u.default,er.default={PostgrestClient:s.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:c.default,PostgrestError:u.default},er}var zg=qg();const Hg=il(zg),{PostgrestClient:Wg,PostgrestQueryBuilder:Oj,PostgrestFilterBuilder:Mj,PostgrestTransformBuilder:Lj,PostgrestBuilder:Fj,PostgrestError:$j}=Hg;class Vg{static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const o=n.node,i=parseInt(o.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let n=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(n+=`

Suggested solution: ${s.workaround}`),new Error(n)}static createWebSocket(s,n){const o=this.getWebSocketConstructor();return new o(s,n)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const Gg="2.76.1",Kg=`realtime-js/${Gg}`,Jg="1.0.0",Ad=1e4,Yg=1e3,Qg=100;var wo;(function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"})(wo||(wo={}));var Ft;(function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"})(Ft||(Ft={}));var Vr;(function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"})(Vr||(Vr={}));var Od;(function(a){a.websocket="websocket"})(Od||(Od={}));var An;(function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"})(An||(An={}));class Xg{constructor(){this.HEADER_LENGTH=1}decode(s,n){return s.constructor===ArrayBuffer?n(this._binaryDecode(s)):n(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){const n=new DataView(s),o=new TextDecoder;return this._decodeBroadcast(s,n,o)}_decodeBroadcast(s,n,o){const i=n.getUint8(1),c=n.getUint8(2);let u=this.HEADER_LENGTH+2;const m=o.decode(s.slice(u,u+i));u=u+i;const h=o.decode(s.slice(u,u+c));u=u+c;const y=JSON.parse(o.decode(s.slice(u,s.byteLength)));return{ref:null,topic:m,event:h,payload:y}}}class Tf{constructor(s,n){this.callback=s,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xt;(function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"})(xt||(xt={}));const $h=(a,s,n={})=>{var o;const i=(o=n.skipTypes)!==null&&o!==void 0?o:[];return s?Object.keys(s).reduce((c,u)=>(c[u]=Zg(u,a,s,i),c),{}):{}},Zg=(a,s,n,o)=>{const i=s.find(m=>m.name===a),c=i?.type,u=n[a];return c&&!o.includes(c)?Df(c,u):Md(u)},Df=(a,s)=>{if(a.charAt(0)==="_"){const n=a.slice(1,a.length);return sx(s,n)}switch(a){case xt.bool:return ex(s);case xt.float4:case xt.float8:case xt.int2:case xt.int4:case xt.int8:case xt.numeric:case xt.oid:return tx(s);case xt.json:case xt.jsonb:return rx(s);case xt.timestamp:return nx(s);case xt.abstime:case xt.date:case xt.daterange:case xt.int4range:case xt.int8range:case xt.money:case xt.reltime:case xt.text:case xt.time:case xt.timestamptz:case xt.timetz:case xt.tsrange:case xt.tstzrange:return Md(s);default:return Md(s)}},Md=a=>a,ex=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},tx=a=>{if(typeof a=="string"){const s=parseFloat(a);if(!Number.isNaN(s))return s}return a},rx=a=>{if(typeof a=="string")try{return JSON.parse(a)}catch(s){return console.log(`JSON parse error: ${s}`),a}return a},sx=(a,s)=>{if(typeof a!="string")return a;const n=a.length-1,o=a[n];if(a[0]==="{"&&o==="}"){let c;const u=a.slice(1,n);try{c=JSON.parse("["+u+"]")}catch{c=u?u.split(","):[]}return c.map(m=>Df(s,m))}return a},nx=a=>typeof a=="string"?a.replace(" ","T"):a,Pf=a=>{const s=new URL(a);return s.protocol=s.protocol.replace(/^ws/i,"http"),s.pathname=s.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),s.pathname===""||s.pathname==="/"?s.pathname="/api/broadcast":s.pathname=s.pathname+"/api/broadcast",s.href};class zc{constructor(s,n,o={},i=Ad){this.channel=s,this.event=n,this.payload=o,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,n){var o;return this._hasReceived(s)&&n((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:s,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:n}){this.recHooks.filter(o=>o.status===s).forEach(o=>o.callback(n))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var Uh;(function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"})(Uh||(Uh={}));class jo{constructor(s,n){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},i=>{const{onJoin:c,onLeave:u,onSync:m}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jo.syncState(this.state,i,c,u),this.pendingDiffs.forEach(h=>{this.state=jo.syncDiff(this.state,h,c,u)}),this.pendingDiffs=[],m()}),this.channel._on(o.diff,{},i=>{const{onJoin:c,onLeave:u,onSync:m}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=jo.syncDiff(this.state,i,c,u),m())}),this.onJoin((i,c,u)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:c,newPresences:u})}),this.onLeave((i,c,u)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:c,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,n,o,i){const c=this.cloneDeep(s),u=this.transformState(n),m={},h={};return this.map(c,(y,b)=>{u[y]||(h[y]=b)}),this.map(u,(y,b)=>{const f=c[y];if(f){const x=b.map(C=>C.presence_ref),v=f.map(C=>C.presence_ref),N=b.filter(C=>v.indexOf(C.presence_ref)<0),k=f.filter(C=>x.indexOf(C.presence_ref)<0);N.length>0&&(m[y]=N),k.length>0&&(h[y]=k)}else m[y]=b}),this.syncDiff(c,{joins:m,leaves:h},o,i)}static syncDiff(s,n,o,i){const{joins:c,leaves:u}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return o||(o=()=>{}),i||(i=()=>{}),this.map(c,(m,h)=>{var y;const b=(y=s[m])!==null&&y!==void 0?y:[];if(s[m]=this.cloneDeep(h),b.length>0){const f=s[m].map(v=>v.presence_ref),x=b.filter(v=>f.indexOf(v.presence_ref)<0);s[m].unshift(...x)}o(m,b,h)}),this.map(u,(m,h)=>{let y=s[m];if(!y)return;const b=h.map(f=>f.presence_ref);y=y.filter(f=>b.indexOf(f.presence_ref)<0),s[m]=y,i(m,y,h),y.length===0&&delete s[m]}),s}static map(s,n){return Object.getOwnPropertyNames(s).map(o=>n(o,s[o]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((n,o)=>{const i=s[o];return"metas"in i?n[o]=i.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):n[o]=i,n},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Bh;(function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"})(Bh||(Bh={}));var No;(function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"})(No||(No={}));var Ns;(function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"})(Ns||(Ns={}));class Zd{constructor(s,n={config:{}},o){var i,c;if(this.topic=s,this.params=n,this.socket=o,this.bindings={},this.state=Ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new zc(this,Vr.join,this.params,this.timeout),this.rejoinTimer=new Tf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(u=>u.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ft.closed,this.socket._remove(this)}),this._onError(u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vr.reply,{},(u,m)=>{this._trigger(this._replyEventName(m),u)}),this.presence=new jo(this),this.broadcastEndpointURL=Pf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(s,n=this.timeout){var o,i,c;if(this.socket.isConnected()||this.socket.connect(),this.state==Ft.closed){const{config:{broadcast:u,presence:m,private:h}}=this.params,y=(i=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(v=>v.filter))!==null&&i!==void 0?i:[],b=!!this.bindings[No.PRESENCE]&&this.bindings[No.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,f={},x={broadcast:u,presence:Object.assign(Object.assign({},m),{enabled:b}),postgres_changes:y,private:h};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(v=>s?.(Ns.CHANNEL_ERROR,v)),this._onClose(()=>s?.(Ns.CLOSED)),this.updateJoinPayload(Object.assign({config:x},f)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:v})=>{var N;if(this.socket.setAuth(),v===void 0){s?.(Ns.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,C=(N=k?.length)!==null&&N!==void 0?N:0,w=[];for(let j=0;j<C;j++){const D=k[j],{filter:{event:M,schema:I,table:_,filter:A}}=D,Q=v&&v[j];if(Q&&Q.event===M&&Q.schema===I&&Q.table===_&&Q.filter===A)w.push(Object.assign(Object.assign({},D),{id:Q.id}));else{this.unsubscribe(),this.state=Ft.errored,s?.(Ns.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,s&&s(Ns.SUBSCRIBED);return}}).receive("error",v=>{this.state=Ft.errored,s?.(Ns.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{s?.(Ns.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,n={}){return await this.send({type:"presence",event:"track",payload:s},n.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,n,o){return this.state===Ft.joined&&s===No.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(s,n,o)}async httpSend(s,n,o={}){var i;const c=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(n==null)return Promise.reject("Payload is required for httpSend()");const u={method:"POST",headers:{Authorization:c,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})},m=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(i=o.timeout)!==null&&i!==void 0?i:this.timeout);if(m.status===202)return{success:!0};let h=m.statusText;try{const y=await m.json();h=y.error||y.message||h}catch{}return Promise.reject(new Error(h))}async send(s,n={}){var o,i;if(!this._canPush()&&s.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:c,payload:u}=s,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:u,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(o=n.timeout)!==null&&o!==void 0?o:this.timeout);return await((i=y.body)===null||i===void 0?void 0:i.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var u,m,h;const y=this._push(s.type,s,n.timeout||this.timeout);s.type==="broadcast"&&!(!((h=(m=(u=this.params)===null||u===void 0?void 0:u.config)===null||m===void 0?void 0:m.broadcast)===null||h===void 0)&&h.ack)&&c("ok"),y.receive("ok",()=>c("ok")),y.receive("error",()=>c("error")),y.receive("timeout",()=>c("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=Ft.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vr.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(i=>{o=new zc(this,Vr.leave,{},s),o.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o?.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ft.closed,this.bindings={}}async _fetchWithTimeout(s,n,o){const i=new AbortController,c=setTimeout(()=>i.abort(),o),u=await this.socket.fetch(s,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(c),u}_push(s,n,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new zc(this,s,n,o);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>Qg){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(s,n,o){return n}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,n,o){var i,c;const u=s.toLocaleLowerCase(),{close:m,error:h,leave:y,join:b}=Vr;if(o&&[m,h,y,b].indexOf(u)>=0&&o!==this._joinRef())return;let x=this._onMessage(u,n,o);if(n&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(v=>{var N,k,C;return((N=v.filter)===null||N===void 0?void 0:N.event)==="*"||((C=(k=v.filter)===null||k===void 0?void 0:k.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===u}).map(v=>v.callback(x,o)):(c=this.bindings[u])===null||c===void 0||c.filter(v=>{var N,k,C,w,j,D;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in v){const M=v.id,I=(N=v.filter)===null||N===void 0?void 0:N.event;return M&&((k=n.ids)===null||k===void 0?void 0:k.includes(M))&&(I==="*"||I?.toLocaleLowerCase()===((C=n.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const M=(j=(w=v?.filter)===null||w===void 0?void 0:w.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return M==="*"||M===((D=n?.event)===null||D===void 0?void 0:D.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===u}).map(v=>{if(typeof x=="object"&&"ids"in x){const N=x.data,{schema:k,table:C,commit_timestamp:w,type:j,errors:D}=N;x=Object.assign(Object.assign({},{schema:k,table:C,commit_timestamp:w,eventType:j,new:{},old:{},errors:D}),this._getPayloadRecords(N))}v.callback(x,o)})}_isClosed(){return this.state===Ft.closed}_isJoined(){return this.state===Ft.joined}_isJoining(){return this.state===Ft.joining}_isLeaving(){return this.state===Ft.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,n,o){const i=s.toLocaleLowerCase(),c={type:i,filter:n,callback:o};return this.bindings[i]?this.bindings[i].push(c):this.bindings[i]=[c],this}_off(s,n){const o=s.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(i=>{var c;return!(((c=i.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===o&&Zd.isEqual(i.filter,n))})),this}static isEqual(s,n){if(Object.keys(s).length!==Object.keys(n).length)return!1;for(const o in s)if(s[o]!==n[o])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(Vr.close,{},s)}_onError(s){this._on(Vr.error,{},n=>s(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ft.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const n={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(n.new=$h(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(n.old=$h(s.columns,s.old_record)),n}}const Hc=()=>{},Ki={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ax=[1e3,2e3,5e3,1e4],ox=1e4,ix=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class lx{constructor(s,n){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ad,this.transport=null,this.heartbeatIntervalMs=Ki.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Hc,this.ref=0,this.reconnectTimer=null,this.logger=Hc,this.conn=null,this.sendBuffer=[],this.serializer=new Xg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let c;return i?c=i:typeof fetch>"u"?c=(...u)=>Ia(async()=>{const{default:m}=await Promise.resolve().then(()=>Ln);return{default:m}},void 0).then(({default:m})=>m(...u)).catch(m=>{throw new Error(`Failed to load @supabase/node-fetch: ${m.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...u)=>c(...u)},!(!((o=n?.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${s}/${Od.websocket}`,this.httpEndpoint=Pf(s),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Vg.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const n=s.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Jg}))}disconnect(s,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},s?this.conn.close(s,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const n=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const s=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,n,o){this.logger(s,n,o)}connectionState(){switch(this.conn&&this.conn.readyState){case wo.connecting:return An.Connecting;case wo.open:return An.Open;case wo.closing:return An.Closing;default:return An.Closed}}isConnected(){return this.connectionState()===An.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,n={config:{}}){const o=`realtime:${s}`,i=this.getChannels().find(c=>c.topic===o);if(i)return i;{const c=new Zd(`realtime:${s}`,n,this);return this.channels.push(c),c}}push(s){const{topic:n,event:o,payload:i,ref:c}=s,u=()=>{this.encode(s,m=>{var h;(h=this.conn)===null||h===void 0||h.send(m)})};this.log("push",`${n} ${o} (${c})`,i),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(Yg,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ki.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let n=this.channels.find(o=>o.topic===s&&(o._isJoined()||o._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${s}"`),n.unsubscribe())}_remove(s){this.channels=this.channels.filter(n=>n.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(y){this.log("error","error in heartbeat callback",y)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:o,event:i,payload:c,ref:u}=n,m=u?`(${u})`:"",h=c.status||"";this.log("receive",`${h} ${o} ${i} ${m}`.trim(),c),this.channels.filter(y=>y._isMember(o)).forEach(y=>y._trigger(i,c,u)),this._triggerStateCallbacks("message",n)})}_clearTimer(s){var n;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(s){var n;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(Vr.error))}_appendParams(s,n){if(Object.keys(n).length===0)return s;const o=s.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${s}${o}${i}`}_workerObjectUrl(s){let n;if(s)n=s;else{const o=new Blob([ix],{type:"application/javascript"});n=URL.createObjectURL(o)}return n}_setConnectionState(s,n=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(s=null){let n;s?n=s:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(o=>{const i={access_token:n,version:Kg};n&&o.updateJoinPayload(i),o.joinedOnce&&o._isJoined()&&o._push(Vr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${s}`,n)})}_triggerStateCallbacks(s,n){try{this.stateChangeCallbacks[s].forEach(o=>{try{o(n)}catch(i){this.log("error",`error in ${s} callback`,i)}})}catch(o){this.log("error",`error triggering ${s} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new Tf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ki.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var n,o,i,c,u,m,h,y,b;if(this.transport=(n=s?.transport)!==null&&n!==void 0?n:null,this.timeout=(o=s?.timeout)!==null&&o!==void 0?o:Ad,this.heartbeatIntervalMs=(i=s?.heartbeatIntervalMs)!==null&&i!==void 0?i:Ki.HEARTBEAT_INTERVAL,this.worker=(c=s?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(u=s?.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(m=s?.heartbeatCallback)!==null&&m!==void 0?m:Hc,s?.params&&(this.params=s.params),s?.logger&&(this.logger=s.logger),(s?.logLevel||s?.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=s?.reconnectAfterMs)!==null&&h!==void 0?h:(f=>ax[f-1]||ox),this.encode=(y=s?.encode)!==null&&y!==void 0?y:((f,x)=>x(JSON.stringify(f))),this.decode=(b=s?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s?.workerUrl}}}class eu extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}}function Et(a){return typeof a=="object"&&a!==null&&"__isStorageError"in a}class cx extends eu{constructor(s,n,o){super(s),this.name="StorageApiError",this.status=n,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ld extends eu{constructor(s,n){super(s),this.name="StorageUnknownError",this.originalError=n}}const tu=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...n)=>Ia(async()=>{const{default:o}=await Promise.resolve().then(()=>Ln);return{default:o}},void 0).then(({default:o})=>o(...n)):s=fetch,(...n)=>s(...n)},dx=()=>Fe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ia(()=>Promise.resolve().then(()=>Ln),void 0)).Response:Response}),Fd=a=>{if(Array.isArray(a))return a.map(n=>Fd(n));if(typeof a=="function"||a!==Object(a))return a;const s={};return Object.entries(a).forEach(([n,o])=>{const i=n.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));s[i]=Fd(o)}),s},ux=a=>{if(typeof a!="object"||a===null)return!1;const s=Object.getPrototypeOf(a);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},Wc=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),mx=(a,s,n)=>Fe(void 0,void 0,void 0,function*(){const o=yield dx();a instanceof o&&!n?.noResolveJson?a.json().then(i=>{const c=a.status||500,u=i?.statusCode||c+"";s(new cx(Wc(i),c,u))}).catch(i=>{s(new Ld(Wc(i),i))}):s(new Ld(Wc(a),a))}),hx=(a,s,n,o)=>{const i={method:a,headers:s?.headers||{}};return a==="GET"||!o?i:(ux(o)?(i.headers=Object.assign({"Content-Type":"application/json"},s?.headers),i.body=JSON.stringify(o)):i.body=o,s?.duplex&&(i.duplex=s.duplex),Object.assign(Object.assign({},i),n))};function Eo(a,s,n,o,i,c){return Fe(this,void 0,void 0,function*(){return new Promise((u,m)=>{a(n,hx(s,o,i,c)).then(h=>{if(!h.ok)throw h;return o?.noResolveJson?h:h.json()}).then(h=>u(h)).catch(h=>mx(h,m,o))})})}function So(a,s,n,o){return Fe(this,void 0,void 0,function*(){return Eo(a,"GET",s,n,o)})}function Wr(a,s,n,o,i){return Fe(this,void 0,void 0,function*(){return Eo(a,"POST",s,o,i,n)})}function $d(a,s,n,o,i){return Fe(this,void 0,void 0,function*(){return Eo(a,"PUT",s,o,i,n)})}function px(a,s,n,o){return Fe(this,void 0,void 0,function*(){return Eo(a,"HEAD",s,Object.assign(Object.assign({},n),{noResolveJson:!0}),o)})}function ru(a,s,n,o,i){return Fe(this,void 0,void 0,function*(){return Eo(a,"DELETE",s,o,i,n)})}class fx{constructor(s,n){this.downloadFn=s,this.shouldThrowOnError=n}then(s,n){return this.execute().then(s,n)}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}}var If;class gx{constructor(s,n){this.downloadFn=s,this.shouldThrowOnError=n,this[If]="BlobDownloadBuilder",this.promise=null}asStream(){return new fx(this.downloadFn,this.shouldThrowOnError)}then(s,n){return this.getPromise().then(s,n)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Fe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}}If=Symbol.toStringTag;const xx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class yx{constructor(s,n={},o,i){this.shouldThrowOnError=!1,this.url=s,this.headers=n,this.bucketId=o,this.fetch=tu(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(s,n,o,i){return Fe(this,void 0,void 0,function*(){try{let c;const u=Object.assign(Object.assign({},qh),i);let m=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(u.upsert)});const h=u.metadata;typeof Blob<"u"&&o instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),h&&c.append("metadata",this.encodeMetadata(h)),c.append("",o)):typeof FormData<"u"&&o instanceof FormData?(c=o,c.append("cacheControl",u.cacheControl),h&&c.append("metadata",this.encodeMetadata(h))):(c=o,m["cache-control"]=`max-age=${u.cacheControl}`,m["content-type"]=u.contentType,h&&(m["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),i?.headers&&(m=Object.assign(Object.assign({},m),i.headers));const y=this._removeEmptyFolders(n),b=this._getFinalPath(y),f=yield(s=="PUT"?$d:Wr)(this.fetch,`${this.url}/object/${b}`,c,Object.assign({headers:m},u?.duplex?{duplex:u.duplex}:{}));return{data:{path:y,id:f.Id,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Et(c))return{data:null,error:c};throw c}})}upload(s,n,o){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,n,o)})}uploadToSignedUrl(s,n,o,i){return Fe(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(s),u=this._getFinalPath(c),m=new URL(this.url+`/object/upload/sign/${u}`);m.searchParams.set("token",n);try{let h;const y=Object.assign({upsert:qh.upsert},i),b=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&o instanceof Blob?(h=new FormData,h.append("cacheControl",y.cacheControl),h.append("",o)):typeof FormData<"u"&&o instanceof FormData?(h=o,h.append("cacheControl",y.cacheControl)):(h=o,b["cache-control"]=`max-age=${y.cacheControl}`,b["content-type"]=y.contentType);const f=yield $d(this.fetch,m.toString(),h,{headers:b});return{data:{path:c,fullPath:f.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(Et(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(s,n){return Fe(this,void 0,void 0,function*(){try{let o=this._getFinalPath(s);const i=Object.assign({},this.headers);n?.upsert&&(i["x-upsert"]="true");const c=yield Wr(this.fetch,`${this.url}/object/upload/sign/${o}`,{},{headers:i}),u=new URL(this.url+c.url),m=u.searchParams.get("token");if(!m)throw new eu("No token returned by API");return{data:{signedUrl:u.toString(),path:s,token:m},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}})}update(s,n,o){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,n,o)})}move(s,n,o){return Fe(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}copy(s,n,o){return Fe(this,void 0,void 0,function*(){try{return{data:{path:(yield Wr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:n,destinationBucket:o?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}createSignedUrl(s,n,o){return Fe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(s),c=yield Wr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},o?.transform?{transform:o.transform}:{}),{headers:this.headers});const u=o?.download?`&download=${o.download===!0?"":o.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${u}`)},{data:c,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}createSignedUrls(s,n,o){return Fe(this,void 0,void 0,function*(){try{const i=yield Wr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:s},{headers:this.headers}),c=o?.download?`&download=${o.download===!0?"":o.download}`:"";return{data:i.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${c}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}download(s,n){const i=typeof n?.transform<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString(n?.transform||{}),u=c?`?${c}`:"",m=this._getFinalPath(s),h=()=>So(this.fetch,`${this.url}/${i}/${m}${u}`,{headers:this.headers,noResolveJson:!0});return new gx(h,this.shouldThrowOnError)}info(s){return Fe(this,void 0,void 0,function*(){const n=this._getFinalPath(s);try{const o=yield So(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Fd(o),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}})}exists(s){return Fe(this,void 0,void 0,function*(){const n=this._getFinalPath(s);try{return yield px(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Et(o)&&o instanceof Ld){const i=o.originalError;if([400,404].includes(i?.status))return{data:!1,error:o}}throw o}})}getPublicUrl(s,n){const o=this._getFinalPath(s),i=[],c=n?.download?`download=${n.download===!0?"":n.download}`:"";c!==""&&i.push(c);const m=typeof n?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(n?.transform||{});h!==""&&i.push(h);let y=i.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${m}/public/${o}${y}`)}}}remove(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield ru(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}list(s,n,o){return Fe(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},xx),n),{prefix:s||""});return{data:yield Wr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},o),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}listV2(s,n){return Fe(this,void 0,void 0,function*(){try{const o=Object.assign({},s);return{data:yield Wr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,o,{headers:this.headers},n),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const n=[];return s.width&&n.push(`width=${s.width}`),s.height&&n.push(`height=${s.height}`),s.resize&&n.push(`resize=${s.resize}`),s.format&&n.push(`format=${s.format}`),s.quality&&n.push(`quality=${s.quality}`),n.join("&")}}const Rf="2.76.1",Af={"X-Client-Info":`storage-js/${Rf}`};class bx{constructor(s,n={},o,i){this.shouldThrowOnError=!1;const c=new URL(s);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),n),this.fetch=tu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Fe(this,void 0,void 0,function*(){try{return{data:yield So(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Et(s))return{data:null,error:s};throw s}})}getBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield So(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}createBucket(s){return Fe(this,arguments,void 0,function*(n,o={public:!1}){try{return{data:yield Wr(this.fetch,`${this.url}/bucket`,{id:n,name:n,type:o.type,public:o.public,file_size_limit:o.fileSizeLimit,allowed_mime_types:o.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}})}updateBucket(s,n){return Fe(this,void 0,void 0,function*(){try{return{data:yield $d(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}})}emptyBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}deleteBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield ru(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}}class vx{constructor(s,n={},o){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),n),this.fetch=tu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/bucket`,{name:s},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}listBuckets(s){return Fe(this,void 0,void 0,function*(){try{const n=new URLSearchParams;s?.limit!==void 0&&n.set("limit",s.limit.toString()),s?.offset!==void 0&&n.set("offset",s.offset.toString()),s?.sortColumn&&n.set("sortColumn",s.sortColumn),s?.sortOrder&&n.set("sortOrder",s.sortOrder),s?.search&&n.set("search",s.search);const o=n.toString(),i=o?`${this.url}/bucket?${o}`:`${this.url}/bucket`,c=yield So(this.fetch,i,{headers:this.headers});return{data:Array.isArray(c)?c.filter(m=>m.type==="ANALYTICS"):[],error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}deleteBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield ru(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Et(n))return{data:null,error:n};throw n}})}}const su={"X-Client-Info":`storage-js/${Rf}`,"Content-Type":"application/json"};class Of extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Nr(a){return typeof a=="object"&&a!==null&&"__isStorageVectorsError"in a}class Vc extends Of{constructor(s,n,o){super(s),this.name="StorageVectorsApiError",this.status=n,this.statusCode=o}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wx extends Of{constructor(s,n){super(s),this.name="StorageVectorsUnknownError",this.originalError=n}}var zh;(function(a){a.InternalError="InternalError",a.S3VectorConflictException="S3VectorConflictException",a.S3VectorNotFoundException="S3VectorNotFoundException",a.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",a.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",a.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(zh||(zh={}));const nu=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...n)=>Ia(async()=>{const{default:o}=await Promise.resolve().then(()=>Ln);return{default:o}},void 0).then(({default:o})=>o(...n)):s=fetch,(...n)=>s(...n)},jx=a=>{if(typeof a!="object"||a===null)return!1;const s=Object.getPrototypeOf(a);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},Hh=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),Nx=(a,s,n)=>Fe(void 0,void 0,void 0,function*(){if(a&&typeof a=="object"&&"status"in a&&"ok"in a&&typeof a.status=="number"&&!n?.noResolveJson){const i=a.status||500,c=a;if(typeof c.json=="function")c.json().then(u=>{const m=u?.statusCode||u?.code||i+"";s(new Vc(Hh(u),i,m))}).catch(()=>{const u=i+"",m=c.statusText||`HTTP ${i} error`;s(new Vc(m,i,u))});else{const u=i+"",m=c.statusText||`HTTP ${i} error`;s(new Vc(m,i,u))}}else s(new wx(Hh(a),a))}),Sx=(a,s,n,o)=>{const i={method:a,headers:s?.headers||{}};return o?(jx(o)?(i.headers=Object.assign({"Content-Type":"application/json"},s?.headers),i.body=JSON.stringify(o)):i.body=o,Object.assign(Object.assign({},i),n)):i};function kx(a,s,n,o,i,c){return Fe(this,void 0,void 0,function*(){return new Promise((u,m)=>{a(n,Sx(s,o,i,c)).then(h=>{if(!h.ok)throw h;if(o?.noResolveJson)return h;const y=h.headers.get("content-type");return!y||!y.includes("application/json")?{}:h.json()}).then(h=>u(h)).catch(h=>Nx(h,m,o))})})}function Sr(a,s,n,o,i){return Fe(this,void 0,void 0,function*(){return kx(a,"POST",s,o,i,n)})}class _x{constructor(s,n={},o){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},su),n),this.fetch=nu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(s){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/CreateIndex`,s,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}getIndex(s,n){return Fe(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:s,indexName:n},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Nr(o))return{data:null,error:o};throw o}})}listIndexes(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/ListIndexes`,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}deleteIndex(s,n){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:s,indexName:n},{headers:this.headers}))||{},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Nr(o))return{data:null,error:o};throw o}})}}class Cx{constructor(s,n={},o){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},su),n),this.fetch=nu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(s){return Fe(this,void 0,void 0,function*(){try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Sr(this.fetch,`${this.url}/PutVectors`,s,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}getVectors(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetVectors`,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}listVectors(s){return Fe(this,void 0,void 0,function*(){try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:yield Sr(this.fetch,`${this.url}/ListVectors`,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}queryVectors(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/QueryVectors`,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}deleteVectors(s){return Fe(this,void 0,void 0,function*(){try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Sr(this.fetch,`${this.url}/DeleteVectors`,s,{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}}class Ex{constructor(s,n={},o){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},su),n),this.fetch=nu(o)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}getBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:s},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}listBuckets(){return Fe(this,arguments,void 0,function*(s={}){try{return{data:yield Sr(this.fetch,`${this.url}/ListVectorBuckets`,s,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}deleteBucket(s){return Fe(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nr(n))return{data:null,error:n};throw n}})}}class Tx extends Ex{constructor(s,n={}){super(s,n.headers||{},n.fetch)}from(s){return new Dx(this.url,this.headers,s,this.fetch)}}class Dx extends _x{constructor(s,n,o,i){super(s,n,i),this.vectorBucketName=o}createIndex(s){const n=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Fe(this,void 0,void 0,function*(){return n.createIndex.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const s=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Fe(this,arguments,void 0,function*(n={}){return s.listIndexes.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}getIndex(s){const n=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Fe(this,void 0,void 0,function*(){return n.getIndex.call(this,this.vectorBucketName,s)})}deleteIndex(s){const n=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Fe(this,void 0,void 0,function*(){return n.deleteIndex.call(this,this.vectorBucketName,s)})}index(s){return new Px(this.url,this.headers,this.vectorBucketName,s,this.fetch)}}class Px extends Cx{constructor(s,n,o,i,c){super(s,n,c),this.vectorBucketName=o,this.indexName=i}putVectors(s){const n=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Fe(this,void 0,void 0,function*(){return n.putVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(s){const n=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Fe(this,void 0,void 0,function*(){return n.getVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const s=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Fe(this,arguments,void 0,function*(n={}){return s.listVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(s){const n=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Fe(this,void 0,void 0,function*(){return n.queryVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(s){const n=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Fe(this,void 0,void 0,function*(){return n.deleteVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Ix extends bx{constructor(s,n={},o,i){super(s,n,o,i)}from(s){return new yx(this.url,this.headers,s,this.fetch)}get vectors(){return new Tx(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new vx(this.url+"/iceberg",this.headers,this.fetch)}}const Rx="2.76.1";let vo="";typeof Deno<"u"?vo="deno":typeof document<"u"?vo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vo="react-native":vo="node";const Ax={"X-Client-Info":`supabase-js-${vo}/${Rx}`},Ox={headers:Ax},Mx={schema:"public"},Lx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Fx={},$x=a=>{let s;return a?s=a:typeof fetch>"u"?s=Nf:s=fetch,(...n)=>s(...n)},Ux=()=>typeof Headers>"u"?Sf:Headers,Bx=(a,s,n)=>{const o=$x(n),i=Ux();return async(c,u)=>{var m;const h=(m=await s())!==null&&m!==void 0?m:a;let y=new i(u?.headers);return y.has("apikey")||y.set("apikey",a),y.has("Authorization")||y.set("Authorization",`Bearer ${h}`),o(c,Object.assign(Object.assign({},u),{headers:y}))}};function qx(a){return a.endsWith("/")?a:a+"/"}function zx(a,s){var n,o;const{db:i,auth:c,realtime:u,global:m}=a,{db:h,auth:y,realtime:b,global:f}=s,x={db:Object.assign(Object.assign({},h),i),auth:Object.assign(Object.assign({},y),c),realtime:Object.assign(Object.assign({},b),u),storage:{},global:Object.assign(Object.assign(Object.assign({},f),m),{headers:Object.assign(Object.assign({},(n=f?.headers)!==null&&n!==void 0?n:{}),(o=m?.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return a.accessToken?x.accessToken=a.accessToken:delete x.accessToken,x}function Hx(a){const s=a?.trim();if(!s)throw new Error("supabaseUrl is required.");if(!s.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(qx(s))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Mf="2.76.1",ka=30*1e3,Ud=3,Gc=Ud*ka,Wx="http://localhost:9999",Vx="supabase.auth.token",Gx={"X-Client-Info":`gotrue-js/${Mf}`},Bd="X-Supabase-Api-Version",Lf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Kx=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jx=600*1e3;class ko extends Error{constructor(s,n,o){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=o}}function Je(a){return typeof a=="object"&&a!==null&&"__isAuthError"in a}class Yx extends ko{constructor(s,n,o){super(s,n,o),this.name="AuthApiError",this.status=n,this.code=o}}function Qx(a){return Je(a)&&a.name==="AuthApiError"}class On extends ko{constructor(s,n){super(s),this.name="AuthUnknownError",this.originalError=n}}class tn extends ko{constructor(s,n,o,i){super(s,o,i),this.name=n,this.status=o}}class Zs extends tn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Xx(a){return Je(a)&&a.name==="AuthSessionMissingError"}class va extends tn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ji extends tn{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class Yi extends tn{constructor(s,n=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zx(a){return Je(a)&&a.name==="AuthImplicitGrantRedirectError"}class Wh extends tn{constructor(s,n=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class qd extends tn{constructor(s,n){super(s,"AuthRetryableFetchError",n,void 0)}}function Kc(a){return Je(a)&&a.name==="AuthRetryableFetchError"}class Vh extends tn{constructor(s,n,o){super(s,"AuthWeakPasswordError",n,"weak_password"),this.reasons=o}}class zd extends tn{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const sl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Gh=` 	
\r=`.split(""),ey=(()=>{const a=new Array(128);for(let s=0;s<a.length;s+=1)a[s]=-1;for(let s=0;s<Gh.length;s+=1)a[Gh[s].charCodeAt(0)]=-2;for(let s=0;s<sl.length;s+=1)a[sl[s].charCodeAt(0)]=s;return a})();function Kh(a,s,n){if(a!==null)for(s.queue=s.queue<<8|a,s.queuedBits+=8;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(sl[o]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const o=s.queue>>s.queuedBits-6&63;n(sl[o]),s.queuedBits-=6}}function Ff(a,s,n){const o=ey[a];if(o>-1)for(s.queue=s.queue<<6|o,s.queuedBits+=6;s.queuedBits>=8;)n(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}}function Jh(a){const s=[],n=u=>{s.push(String.fromCodePoint(u))},o={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},c=u=>{sy(u,o,n)};for(let u=0;u<a.length;u+=1)Ff(a.charCodeAt(u),i,c);return s.join("")}function ty(a,s){if(a<=127){s(a);return}else if(a<=2047){s(192|a>>6),s(128|a&63);return}else if(a<=65535){s(224|a>>12),s(128|a>>6&63),s(128|a&63);return}else if(a<=1114111){s(240|a>>18),s(128|a>>12&63),s(128|a>>6&63),s(128|a&63);return}throw new Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}function ry(a,s){for(let n=0;n<a.length;n+=1){let o=a.charCodeAt(n);if(o>55295&&o<=56319){const i=(o-55296)*1024&65535;o=(a.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}ty(o,s)}}function sy(a,s,n){if(s.utf8seq===0){if(a<=127){n(a);return}for(let o=1;o<6;o+=1)if((a>>7-o&1)===0){s.utf8seq=o;break}if(s.utf8seq===2)s.codepoint=a&31;else if(s.utf8seq===3)s.codepoint=a&15;else if(s.utf8seq===4)s.codepoint=a&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(a<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|a&63,s.utf8seq-=1,s.utf8seq===0&&n(s.codepoint)}}function Ca(a){const s=[],n={queue:0,queuedBits:0},o=i=>{s.push(i)};for(let i=0;i<a.length;i+=1)Ff(a.charCodeAt(i),n,o);return new Uint8Array(s)}function ny(a){const s=[];return ry(a,n=>s.push(n)),new Uint8Array(s)}function Mn(a){const s=[],n={queue:0,queuedBits:0},o=i=>{s.push(i)};return a.forEach(i=>Kh(i,n,o)),Kh(null,n,o),s.join("")}function ay(a){return Math.round(Date.now()/1e3)+a}function oy(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const s=Math.random()*16|0;return(a=="x"?s:s&3|8).toString(16)})}const jr=()=>typeof window<"u"&&typeof document<"u",Pn={tested:!1,writable:!1},$f=()=>{if(!jr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Pn.tested)return Pn.writable;const a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),Pn.tested=!0,Pn.writable=!0}catch{Pn.tested=!0,Pn.writable=!1}return Pn.writable};function iy(a){const s={},n=new URL(a);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,c)=>{s[c]=i})}catch{}return n.searchParams.forEach((o,i)=>{s[i]=o}),s}const Uf=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...n)=>Ia(async()=>{const{default:o}=await Promise.resolve().then(()=>Ln);return{default:o}},void 0).then(({default:o})=>o(...n)):s=fetch,(...n)=>s(...n)},ly=a=>typeof a=="object"&&a!==null&&"status"in a&&"ok"in a&&"json"in a&&typeof a.json=="function",_a=async(a,s,n)=>{await a.setItem(s,JSON.stringify(n))},In=async(a,s)=>{const n=await a.getItem(s);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Xs=async(a,s)=>{await a.removeItem(s)};class cl{constructor(){this.promise=new cl.promiseConstructor((s,n)=>{this.resolve=s,this.reject=n})}}cl.promiseConstructor=Promise;function Jc(a){const s=a.split(".");if(s.length!==3)throw new zd("Invalid JWT structure");for(let o=0;o<s.length;o++)if(!Kx.test(s[o]))throw new zd("JWT not in base64url format");return{header:JSON.parse(Jh(s[0])),payload:JSON.parse(Jh(s[1])),signature:Ca(s[2]),raw:{header:s[0],payload:s[1]}}}async function cy(a){return await new Promise(s=>{setTimeout(()=>s(null),a)})}function dy(a,s){return new Promise((o,i)=>{(async()=>{for(let c=0;c<1/0;c++)try{const u=await a(c);if(!s(c,null,u)){o(u);return}}catch(u){if(!s(c,u)){i(u);return}}})()})}function uy(a){return("0"+a.toString(16)).substr(-2)}function my(){const s=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=n.length;let i="";for(let c=0;c<56;c++)i+=n.charAt(Math.floor(Math.random()*o));return i}return crypto.getRandomValues(s),Array.from(s,uy).join("")}async function hy(a){const n=new TextEncoder().encode(a),o=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(o);return Array.from(i).map(c=>String.fromCharCode(c)).join("")}async function py(a){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a;const n=await hy(a);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wa(a,s,n=!1){const o=my();let i=o;n&&(i+="/PASSWORD_RECOVERY"),await _a(a,`${s}-code-verifier`,i);const c=await py(o);return[c,o===c?"plain":"s256"]}const fy=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gy(a){const s=a.headers.get(Bd);if(!s||!s.match(fy))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function xy(a){if(!a)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(a<=s)throw new Error("JWT has expired")}function yy(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const by=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ja(a){if(!by.test(a))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yc(){const a={};return new Proxy(a,{get:(s,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Yh(a){return JSON.parse(JSON.stringify(a))}const Rn=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),vy=[502,503,504];async function Qh(a){var s;if(!ly(a))throw new qd(Rn(a),0);if(vy.includes(a.status))throw new qd(Rn(a),a.status);let n;try{n=await a.json()}catch(c){throw new On(Rn(c),c)}let o;const i=gy(a);if(i&&i.getTime()>=Lf["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?o=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(o=n.error_code),o){if(o==="weak_password")throw new Vh(Rn(n),a.status,((s=n.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(o==="session_not_found")throw new Zs}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((c,u)=>c&&typeof u=="string",!0))throw new Vh(Rn(n),a.status,n.weak_password.reasons);throw new Yx(Rn(n),a.status||500,o)}const wy=(a,s,n,o)=>{const i={method:a,headers:s?.headers||{}};return a==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s?.headers),i.body=JSON.stringify(o),Object.assign(Object.assign({},i),n))};async function ot(a,s,n,o){var i;const c=Object.assign({},o?.headers);c[Bd]||(c[Bd]=Lf["2024-01-01"].name),o?.jwt&&(c.Authorization=`Bearer ${o.jwt}`);const u=(i=o?.query)!==null&&i!==void 0?i:{};o?.redirectTo&&(u.redirect_to=o.redirectTo);const m=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",h=await jy(a,s,n+m,{headers:c,noResolveJson:o?.noResolveJson},{},o?.body);return o?.xform?o?.xform(h):{data:Object.assign({},h),error:null}}async function jy(a,s,n,o,i,c){const u=wy(s,o,i,c);let m;try{m=await a(n,Object.assign({},u))}catch(h){throw console.error(h),new qd(Rn(h),0)}if(m.ok||await Qh(m),o?.noResolveJson)return m;try{return await m.json()}catch(h){await Qh(h)}}function Hr(a){var s;let n=null;ky(a)&&(n=Object.assign({},a),a.expires_at||(n.expires_at=ay(a.expires_in)));const o=(s=a.user)!==null&&s!==void 0?s:a;return{data:{session:n,user:o},error:null}}function Xh(a){const s=Hr(a);return!s.error&&a.weak_password&&typeof a.weak_password=="object"&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&typeof a.weak_password.message=="string"&&a.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0)&&(s.data.weak_password=a.weak_password),s}function en(a){var s;return{data:{user:(s=a.user)!==null&&s!==void 0?s:a},error:null}}function Ny(a){return{data:a,error:null}}function Sy(a){const{action_link:s,email_otp:n,hashed_token:o,redirect_to:i,verification_type:c}=a,u=Pa(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),m={action_link:s,email_otp:n,hashed_token:o,redirect_to:i,verification_type:c},h=Object.assign({},u);return{data:{properties:m,user:h},error:null}}function Zh(a){return a}function ky(a){return a.access_token&&a.refresh_token&&a.expires_in}const Qc=["global","local","others"];class _y{constructor({url:s="",headers:n={},fetch:o}){this.url=s,this.headers=n,this.fetch=Uf(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(s,n=Qc[0]){if(Qc.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qc.join(", ")}`);try{return await ot(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(o){if(Je(o))return{data:null,error:o};throw o}}async inviteUserByEmail(s,n={}){try{return await ot(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:en})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async generateLink(s){try{const{options:n}=s,o=Pa(s,["options"]),i=Object.assign(Object.assign({},o),n);return"newEmail"in o&&(i.new_email=o?.newEmail,delete i.newEmail),await ot(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Sy,redirectTo:n?.redirectTo})}catch(n){if(Je(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(s){try{return await ot(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:en})}catch(n){if(Je(n))return{data:{user:null},error:n};throw n}}async listUsers(s){var n,o,i,c,u,m,h;try{const y={nextPage:null,lastPage:0,total:0},b=await ot(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s?.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(c=(i=s?.perPage)===null||i===void 0?void 0:i.toString())!==null&&c!==void 0?c:""},xform:Zh});if(b.error)throw b.error;const f=await b.json(),x=(u=b.headers.get("x-total-count"))!==null&&u!==void 0?u:0,v=(h=(m=b.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(N=>{const k=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(N.split(";")[1].split("=")[1]);y[`${C}Page`]=k}),y.total=parseInt(x)),{data:Object.assign(Object.assign({},f),y),error:null}}catch(y){if(Je(y))return{data:{users:[]},error:y};throw y}}async getUserById(s){ja(s);try{return await ot(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:en})}catch(n){if(Je(n))return{data:{user:null},error:n};throw n}}async updateUserById(s,n){ja(s);try{return await ot(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:n,headers:this.headers,xform:en})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async deleteUser(s,n=!1){ja(s);try{return await ot(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:n},xform:en})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async _listFactors(s){ja(s.userId);try{const{data:n,error:o}=await ot(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:o}}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _deleteFactor(s){ja(s.userId),ja(s.id);try{return{data:await ot(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _listOAuthClients(s){var n,o,i,c,u,m,h;try{const y={nextPage:null,lastPage:0,total:0},b=await ot(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(n=s?.page)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:"",per_page:(c=(i=s?.perPage)===null||i===void 0?void 0:i.toString())!==null&&c!==void 0?c:""},xform:Zh});if(b.error)throw b.error;const f=await b.json(),x=(u=b.headers.get("x-total-count"))!==null&&u!==void 0?u:0,v=(h=(m=b.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(N=>{const k=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(N.split(";")[1].split("=")[1]);y[`${C}Page`]=k}),y.total=parseInt(x)),{data:Object.assign(Object.assign({},f),y),error:null}}catch(y){if(Je(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(s){try{return await ot(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:s,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _getOAuthClient(s){try{return await ot(this.fetch,"GET",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(s){try{return await ot(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${s}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(s){try{return await ot(this.fetch,"POST",`${this.url}/admin/oauth/clients/${s}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}}function ep(a={}){return{getItem:s=>a[s]||null,setItem:(s,n)=>{a[s]=n},removeItem:s=>{delete a[s]}}}const Na={debug:!!(globalThis&&$f()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Bf extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class Cy extends Bf{}async function Ey(a,s,n){Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,s);const o=new globalThis.AbortController;return s>0&&setTimeout(()=>{o.abort(),Na.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(a,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async i=>{if(i){Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,i.name);try{return await n()}finally{Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,i.name)}}else{if(s===0)throw Na.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new Cy(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(Na.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function Ty(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function qf(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw new Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}function Dy(a){return parseInt(a,16)}function Py(a){const s=new TextEncoder().encode(a);return"0x"+Array.from(s,o=>o.toString(16).padStart(2,"0")).join("")}function Iy(a){var s;const{chainId:n,domain:o,expirationTime:i,issuedAt:c=new Date,nonce:u,notBefore:m,requestId:h,resources:y,scheme:b,uri:f,version:x}=a;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(u&&u.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${u}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((s=a.statement)===null||s===void 0)&&s.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`)}const v=qf(a.address),N=b?`${b}://${o}`:o,k=a.statement?`${a.statement}
`:"",C=`${N} wants you to sign in with your Ethereum account:
${v}

${k}`;let w=`URI: ${f}
Version: ${x}
Chain ID: ${n}${u?`
Nonce: ${u}`:""}
Issued At: ${c.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),m&&(w+=`
Not Before: ${m.toISOString()}`),h&&(w+=`
Request ID: ${h}`),y){let j=`
Resources:`;for(const D of y){if(!D||typeof D!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${D}`);j+=`
- ${D}`}w+=j}return`${C}
${w}`}class Rt extends Error{constructor({message:s,code:n,cause:o,name:i}){var c;super(s,{cause:o}),this.__isWebAuthnError=!0,this.name=(c=i??(o instanceof Error?o.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=n}}class nl extends Rt{constructor(s,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:s}),this.name="WebAuthnUnknownError",this.originalError=n}}function Ry({error:a,options:s}){var n,o,i;const{publicKey:c}=s;if(!c)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Rt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if(a.name==="ConstraintError"){if(((n=c.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Rt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});if(s.mediation==="conditional"&&((o=c.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Rt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});if(((i=c.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Rt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else{if(a.name==="InvalidStateError")return new Rt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});if(a.name==="NotAllowedError")return new Rt({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="NotSupportedError")return c.pubKeyCredParams.filter(m=>m.type==="public-key").length===0?new Rt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}):new Rt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});if(a.name==="SecurityError"){const u=window.location.hostname;if(zf(u)){if(c.rp.id!==u)return new Rt({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new Rt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if(a.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}function Ay({error:a,options:s}){const{publicKey:n}=s;if(!n)throw Error("options was missing required publicKey property");if(a.name==="AbortError"){if(s.signal instanceof AbortSignal)return new Rt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else{if(a.name==="NotAllowedError")return new Rt({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});if(a.name==="SecurityError"){const o=window.location.hostname;if(zf(o)){if(n.rpId!==o)return new Rt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a})}else if(a.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}class Oy{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const s=new AbortController;return this.controller=s,s.signal}cancelCeremony(){if(this.controller){const s=new Error("Manually cancelling existing WebAuthn API call");s.name="AbortError",this.controller.abort(s),this.controller=void 0}}}const My=new Oy;function Ly(a){if(!a)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(a);const{challenge:s,user:n,excludeCredentials:o}=a,i=Pa(a,["challenge","user","excludeCredentials"]),c=Ca(s).buffer,u=Object.assign(Object.assign({},n),{id:Ca(n.id).buffer}),m=Object.assign(Object.assign({},i),{challenge:c,user:u});if(o&&o.length>0){m.excludeCredentials=new Array(o.length);for(let h=0;h<o.length;h++){const y=o[h];m.excludeCredentials[h]=Object.assign(Object.assign({},y),{id:Ca(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return m}function Fy(a){if(!a)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(a);const{challenge:s,allowCredentials:n}=a,o=Pa(a,["challenge","allowCredentials"]),i=Ca(s).buffer,c=Object.assign(Object.assign({},o),{challenge:i});if(n&&n.length>0){c.allowCredentials=new Array(n.length);for(let u=0;u<n.length;u++){const m=n[u];c.allowCredentials[u]=Object.assign(Object.assign({},m),{id:Ca(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return c}function $y(a){var s;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const n=a;return{id:a.id,rawId:a.id,response:{attestationObject:Mn(new Uint8Array(a.response.attestationObject)),clientDataJSON:Mn(new Uint8Array(a.response.clientDataJSON))},type:"public-key",clientExtensionResults:a.getClientExtensionResults(),authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function Uy(a){var s;if("toJSON"in a&&typeof a.toJSON=="function")return a.toJSON();const n=a,o=a.getClientExtensionResults(),i=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:Mn(new Uint8Array(i.authenticatorData)),clientDataJSON:Mn(new Uint8Array(i.clientDataJSON)),signature:Mn(new Uint8Array(i.signature)),userHandle:i.userHandle?Mn(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(s=n.authenticatorAttachment)!==null&&s!==void 0?s:void 0}}function zf(a){return a==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}function tp(){var a,s;return!!(jr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.create)=="function"&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.get)=="function")}async function By(a){try{const s=await navigator.credentials.create(a);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new nl("Browser returned unexpected credential type",s)}:{data:null,error:new nl("Empty credential response",s)}}catch(s){return{data:null,error:Ry({error:s,options:a})}}}async function qy(a){try{const s=await navigator.credentials.get(a);return s?s instanceof PublicKeyCredential?{data:s,error:null}:{data:null,error:new nl("Browser returned unexpected credential type",s)}:{data:null,error:new nl("Empty credential response",s)}}catch(s){return{data:null,error:Ay({error:s,options:a})}}}const zy={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Hy={userVerification:"preferred",hints:["security-key"]};function al(...a){const s=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),n=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),o={};for(const i of a)if(i)for(const c in i){const u=i[c];if(u!==void 0)if(Array.isArray(u))o[c]=u;else if(n(u))o[c]=u;else if(s(u)){const m=o[c];s(m)?o[c]=al(m,u):o[c]=al(u)}else o[c]=u}return o}function Wy(a,s){return al(zy,a,s||{})}function Vy(a,s){return al(Hy,a,s||{})}class Gy{constructor(s){this.client=s,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(s){return this.client.mfa.enroll(Object.assign(Object.assign({},s),{factorType:"webauthn"}))}async _challenge({factorId:s,webauthn:n,friendlyName:o,signal:i},c){try{const{data:u,error:m}=await this.client.mfa.challenge({factorId:s,webauthn:n});if(!u)return{data:null,error:m};const h=i??My.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:y}=u.webauthn.credential_options.publicKey;y.name||(y.name=`${y.id}:${o}`),y.displayName||(y.displayName=y.name)}switch(u.webauthn.type){case"create":{const y=Wy(u.webauthn.credential_options.publicKey,c?.create),{data:b,error:f}=await By({publicKey:y,signal:h});return b?{data:{factorId:s,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:f}}case"request":{const y=Vy(u.webauthn.credential_options.publicKey,c?.request),{data:b,error:f}=await qy(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:y,signal:h}));return b?{data:{factorId:s,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:f}}}}catch(u){return Je(u)?{data:null,error:u}:{data:null,error:new On("Unexpected error in challenge",u)}}}async _verify({challengeId:s,factorId:n,webauthn:o}){return this.client.mfa.verify({factorId:n,challengeId:s,webauthn:o})}async _authenticate({factorId:s,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:i}},c){if(!n)return{data:null,error:new ko("rpId is required for WebAuthn authentication")};try{if(!tp())return{data:null,error:new On("Browser does not support WebAuthn",null)};const{data:u,error:m}=await this.challenge({factorId:s,webauthn:{rpId:n,rpOrigins:o},signal:i},{request:c});if(!u)return{data:null,error:m};const{webauthn:h}=u;return this._verify({factorId:s,challengeId:u.challengeId,webauthn:{type:h.type,rpId:n,rpOrigins:o,credential_response:h.credential_response}})}catch(u){return Je(u)?{data:null,error:u}:{data:null,error:new On("Unexpected error in authenticate",u)}}}async _register({friendlyName:s,rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:i},c){if(!n)return{data:null,error:new ko("rpId is required for WebAuthn registration")};try{if(!tp())return{data:null,error:new On("Browser does not support WebAuthn",null)};const{data:u,error:m}=await this._enroll({friendlyName:s});if(!u)return await this.client.mfa.listFactors().then(b=>{var f;return(f=b.data)===null||f===void 0?void 0:f.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===s&&x.status!=="unverified")}).then(b=>b?this.client.mfa.unenroll({factorId:b?.id}):void 0),{data:null,error:m};const{data:h,error:y}=await this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:n,rpOrigins:o},signal:i},{create:c});return h?this._verify({factorId:u.id,challengeId:h.challengeId,webauthn:{rpId:n,rpOrigins:o,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:y}}catch(u){return Je(u)?{data:null,error:u}:{data:null,error:new On("Unexpected error in register",u)}}}}Ty();const Ky={url:Wx,storageKey:Vx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rp(a,s,n){return await n()}const Sa={};class _o{get jwks(){var s,n;return(n=(s=Sa[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(s){Sa[this.storageKey]=Object.assign(Object.assign({},Sa[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,n;return(n=(s=Sa[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){Sa[this.storageKey]=Object.assign(Object.assign({},Sa[this.storageKey]),{cachedAt:s})}constructor(s){var n,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_o.nextInstanceID,_o.nextInstanceID+=1,this.instanceID>0&&jr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Ky),s);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new _y({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Uf(i.fetch),this.lock=i.lock||rp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:jr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Ey:this.lock=rp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Gy(this)},this.persistSession?(i.storage?this.storage=i.storage:$f()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ep(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=ep(this.memoryStorage)),jr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}_debug(...s){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Mf}) ${new Date().toISOString()}`,...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{const n=iy(window.location.href);let o="none";if(this._isImplicitGrantCallback(n)?o="implicit":await this._isPKCECallback(n)&&(o="pkce"),jr()&&this.detectSessionInUrl&&o!=="none"){const{data:i,error:c}=await this._getSessionFromURL(n,o);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),Zx(c)){const h=(s=c.details)===null||s===void 0?void 0:s.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:u,redirectType:m}=i;return this._debug("#_initialize()","detected session in URL",u,"redirect type",m),await this._saveSession(u),setTimeout(async()=>{m==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Je(n)?{error:n}:{error:new On("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var n,o,i;try{const c=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(n=s?.options)===null||n===void 0?void 0:n.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(i=s?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Hr}),{data:u,error:m}=c;if(m||!u)return{data:{user:null,session:null},error:m};const h=u.session,y=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:y,session:h},error:null}}catch(c){if(Je(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(s){var n,o,i;try{let c;if("email"in s){const{email:b,password:f,options:x}=s;let v=null,N=null;this.flowType==="pkce"&&([v,N]=await wa(this.storage,this.storageKey)),c=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:b,password:f,data:(n=x?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:v,code_challenge_method:N},xform:Hr})}else if("phone"in s){const{phone:b,password:f,options:x}=s;c=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:(o=x?.data)!==null&&o!==void 0?o:{},channel:(i=x?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Hr})}else throw new Ji("You must provide either an email or phone number and a password");const{data:u,error:m}=c;if(m||!u)return{data:{user:null,session:null},error:m};const h=u.session,y=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:y,session:h},error:null}}catch(c){if(Je(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(s){try{let n;if("email"in s){const{email:c,password:u,options:m}=s;n=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:u,gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Xh})}else if("phone"in s){const{phone:c,password:u,options:m}=s;n=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:u,gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Xh})}else throw new Ji("You must provide either an email or phone number and a password");const{data:o,error:i}=n;return i?{data:{user:null,session:null},error:i}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new va}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:i})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(s){var n,o,i,c;return await this._handleProviderSignIn(s.provider,{redirectTo:(n=s.options)===null||n===void 0?void 0:n.redirectTo,scopes:(o=s.options)===null||o===void 0?void 0:o.scopes,queryParams:(i=s.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(c=s.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:n}=s;switch(n){case"ethereum":return await this.signInWithEthereum(s);case"solana":return await this.signInWithSolana(s);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(s){var n,o,i,c,u,m,h,y,b,f,x;let v,N;if("message"in s)v=s.message,N=s.signature;else{const{chain:k,wallet:C,statement:w,options:j}=s;let D;if(jr())if(typeof C=="object")D=C;else{const G=window;if("ethereum"in G&&typeof G.ethereum=="object"&&"request"in G.ethereum&&typeof G.ethereum.request=="function")D=G.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!j?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=C}const M=new URL((n=j?.url)!==null&&n!==void 0?n:window.location.href),I=await D.request({method:"eth_requestAccounts"}).then(G=>G).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const _=qf(I[0]);let A=(o=j?.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!A){const G=await D.request({method:"eth_chainId"});A=Dy(G)}const Q={domain:M.host,address:_,statement:w,uri:M.href,version:"1",chainId:A,nonce:(i=j?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(u=(c=j?.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&u!==void 0?u:new Date,expirationTime:(m=j?.signInWithEthereum)===null||m===void 0?void 0:m.expirationTime,notBefore:(h=j?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(y=j?.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(b=j?.signInWithEthereum)===null||b===void 0?void 0:b.resources};v=Iy(Q),N=await D.request({method:"personal_sign",params:[Py(v),_]})}try{const{data:k,error:C}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:N},!((f=s.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(x=s.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Hr});if(C)throw C;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new va}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:C})}catch(k){if(Je(k))return{data:{user:null,session:null},error:k};throw k}}async signInWithSolana(s){var n,o,i,c,u,m,h,y,b,f,x,v;let N,k;if("message"in s)N=s.message,k=s.signature;else{const{chain:C,wallet:w,statement:j,options:D}=s;let M;if(jr())if(typeof w=="object")M=w;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))M=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=w}const I=new URL((n=D?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in M&&M.signIn){const _=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},D?.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),j?{statement:j}:null));let A;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")A=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)A=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)N=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),k=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${I.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(i=(o=D?.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((c=D?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${D.signInWithSolana.notBefore}`]:[],...!((u=D?.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${D.signInWithSolana.expirationTime}`]:[],...!((m=D?.signInWithSolana)===null||m===void 0)&&m.chainId?[`Chain ID: ${D.signInWithSolana.chainId}`]:[],...!((h=D?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${D.signInWithSolana.nonce}`]:[],...!((y=D?.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${D.signInWithSolana.requestId}`]:[],...!((f=(b=D?.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||f===void 0)&&f.length?["Resources",...D.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const _=await M.signMessage(new TextEncoder().encode(N),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=_}}try{const{data:C,error:w}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:Mn(k)},!((x=s.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(v=s.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Hr});if(w)throw w;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new va}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:w})}catch(C){if(Je(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(s){const n=await In(this.storage,`${this.storageKey}-code-verifier`),[o,i]=(n??"").split("/");try{const{data:c,error:u}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:o},xform:Hr});if(await Xs(this.storage,`${this.storageKey}-code-verifier`),u)throw u;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new va}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:i??null}),error:u})}catch(c){if(Je(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(s){try{const{options:n,provider:o,token:i,access_token:c,nonce:u}=s,m=await ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:i,access_token:c,nonce:u,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Hr}),{data:h,error:y}=m;return y?{data:{user:null,session:null},error:y}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new va}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:y})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(s){var n,o,i,c,u;try{if("email"in s){const{email:m,options:h}=s;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await wa(this.storage,this.storageKey));const{error:f}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:m,data:(n=h?.data)!==null&&n!==void 0?n:{},create_user:(o=h?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:y,code_challenge_method:b},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in s){const{phone:m,options:h}=s,{data:y,error:b}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:m,data:(i=h?.data)!==null&&i!==void 0?i:{},create_user:(c=h?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(u=h?.channel)!==null&&u!==void 0?u:"sms"}});return{data:{user:null,session:null,messageId:y?.message_id},error:b}}throw new Ji("You must provide either an email or phone number.")}catch(m){if(Je(m))return{data:{user:null,session:null},error:m};throw m}}async verifyOtp(s){var n,o;try{let i,c;"options"in s&&(i=(n=s.options)===null||n===void 0?void 0:n.redirectTo,c=(o=s.options)===null||o===void 0?void 0:o.captchaToken);const{data:u,error:m}=await ot(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:c}}),redirectTo:i,xform:Hr});if(m)throw m;if(!u)throw new Error("An error occurred on token verification.");const h=u.session,y=u.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:y,session:h},error:null}}catch(i){if(Je(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(s){var n,o,i;try{let c=null,u=null;return this.flowType==="pkce"&&([c,u]=await wa(this.storage,this.storageKey)),await ot(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(o=(n=s.options)===null||n===void 0?void 0:n.redirectTo)!==null&&o!==void 0?o:void 0}),!((i=s?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:u}),headers:this.headers,xform:Ny})}catch(c){if(Je(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)throw o;if(!n)throw new Zs;const{error:i}=await ot(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(s){if(Je(s))return{data:{user:null,session:null},error:s};throw s}}async resend(s){try{const n=`${this.url}/resend`;if("email"in s){const{email:o,type:i,options:c}=s,{error:u}=await ot(this.fetch,"POST",n,{headers:this.headers,body:{email:o,type:i,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:u}}else if("phone"in s){const{phone:o,type:i,options:c}=s,{data:u,error:m}=await ot(this.fetch,"POST",n,{headers:this.headers,body:{phone:o,type:i,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return{data:{user:null,session:null,messageId:u?.message_id},error:m}}throw new Ji("You must provide either an email or phone number and a type")}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(s,n){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await o,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=n();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await s(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const n=await In(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?s=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const o=s.expires_at?s.expires_at*1e3-Date.now()<Gc:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",s.expires_at),!o){if(this.userStorage){const u=await In(this.userStorage,this.storageKey+"-user");u?.user?s.user=u.user:s.user=Yc()}if(this.storage.isServer&&s.user){let u=this.suppressGetSessionWarning;s=new Proxy(s,{get:(h,y,b)=>(!u&&y==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),u=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,y,b))})}return{data:{session:s},error:null}}const{data:i,error:c}=await this._callRefreshToken(s.refresh_token);return c?{data:{session:null},error:c}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(s){return s?await this._getUser(s):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(s){try{return s?await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:en}):await this._useSession(async n=>{var o,i,c;const{data:u,error:m}=n;if(m)throw m;return!(!((o=u.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Zs}:await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(i=u.session)===null||i===void 0?void 0:i.access_token)!==null&&c!==void 0?c:void 0,xform:en})})}catch(n){if(Je(n))return Xx(n)&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(s,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,n))}async _updateUser(s,n={}){try{return await this._useSession(async o=>{const{data:i,error:c}=o;if(c)throw c;if(!i.session)throw new Zs;const u=i.session;let m=null,h=null;this.flowType==="pkce"&&s.email!=null&&([m,h]=await wa(this.storage,this.storageKey));const{data:y,error:b}=await ot(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:m,code_challenge_method:h}),jwt:u.access_token,xform:en});if(b)throw b;return u.user=y.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}})}catch(o){if(Je(o))return{data:{user:null},error:o};throw o}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new Zs;const n=Date.now()/1e3;let o=n,i=!0,c=null;const{payload:u}=Jc(s.access_token);if(u.exp&&(o=u.exp,i=o<=n),i){const{data:m,error:h}=await this._callRefreshToken(s.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!m)return{data:{user:null,session:null},error:null};c=m}else{const{data:m,error:h}=await this._getUser(s.access_token);if(h)throw h;c={access_token:s.access_token,refresh_token:s.refresh_token,user:m.user,token_type:"bearer",expires_in:o-n,expires_at:o},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(n){if(Je(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async n=>{var o;if(!s){const{data:u,error:m}=n;if(m)throw m;s=(o=u.session)!==null&&o!==void 0?o:void 0}if(!s?.refresh_token)throw new Zs;const{data:i,error:c}=await this._callRefreshToken(s.refresh_token);return c?{data:{user:null,session:null},error:c}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Je(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(s,n){try{if(!jr())throw new Yi("No browser detected.");if(s.error||s.error_description||s.error_code)throw new Yi(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Wh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yi("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new Wh("No code detected.");const{data:j,error:D}=await this._exchangeCodeForSession(s.code);if(D)throw D;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:i,access_token:c,refresh_token:u,expires_in:m,expires_at:h,token_type:y}=s;if(!c||!m||!u||!y)throw new Yi("No session defined in URL");const b=Math.round(Date.now()/1e3),f=parseInt(m);let x=b+f;h&&(x=parseInt(h));const v=x-b;v*1e3<=ka&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${f}s`);const N=x-f;b-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,x,b):b-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,x,b);const{data:k,error:C}=await this._getUser(c);if(C)throw C;const w={provider_token:o,provider_refresh_token:i,access_token:c,expires_in:f,expires_at:x,refresh_token:u,token_type:y,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:s.type},error:null}}catch(o){if(Je(o))return{data:{session:null,redirectType:null},error:o};throw o}}_isImplicitGrantCallback(s){return!!(s.access_token||s.error_description)}async _isPKCECallback(s){const n=await In(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&n)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async n=>{var o;const{data:i,error:c}=n;if(c)return{error:c};const u=(o=i.session)===null||o===void 0?void 0:o.access_token;if(u){const{error:m}=await this.admin.signOut(u,s);if(m&&!(Qx(m)&&(m.status===404||m.status===401||m.status===403)))return{error:m}}return s!=="others"&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(s){const n=oy(),o={id:n,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,o),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:o}}}async _emitInitialSession(s){return await this._useSession(async n=>{var o,i;try{const{data:{session:c},error:u}=n;if(u)throw u;await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",s,"session",c)}catch(c){await((i=this.stateChangeEmitters.get(s))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",c),console.error(c)}})}async resetPasswordForEmail(s,n={}){let o=null,i=null;this.flowType==="pkce"&&([o,i]=await wa(this.storage,this.storageKey,!0));try{return await ot(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:o,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(c){if(Je(c))return{data:null,error:c};throw c}}async getUserIdentities(){var s;try{const{data:n,error:o}=await this.getUser();if(o)throw o;return{data:{identities:(s=n.user.identities)!==null&&s!==void 0?s:[]},error:null}}catch(n){if(Je(n))return{data:null,error:n};throw n}}async linkIdentity(s){return"token"in s?this.linkIdentityIdToken(s):this.linkIdentityOAuth(s)}async linkIdentityOAuth(s){var n;try{const{data:o,error:i}=await this._useSession(async c=>{var u,m,h,y,b;const{data:f,error:x}=c;if(x)throw x;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(u=s.options)===null||u===void 0?void 0:u.redirectTo,scopes:(m=s.options)===null||m===void 0?void 0:m.scopes,queryParams:(h=s.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await ot(this.fetch,"GET",v,{headers:this.headers,jwt:(b=(y=f.session)===null||y===void 0?void 0:y.access_token)!==null&&b!==void 0?b:void 0})});if(i)throw i;return jr()&&!(!((n=s.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(o?.url),{data:{provider:s.provider,url:o?.url},error:null}}catch(o){if(Je(o))return{data:{provider:s.provider,url:null},error:o};throw o}}async linkIdentityIdToken(s){return await this._useSession(async n=>{var o;try{const{error:i,data:{session:c}}=n;if(i)throw i;const{options:u,provider:m,token:h,access_token:y,nonce:b}=s,f=await ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=c?.access_token)!==null&&o!==void 0?o:void 0,body:{provider:m,id_token:h,access_token:y,nonce:b,link_identity:!0,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Hr}),{data:x,error:v}=f;return v?{data:{user:null,session:null},error:v}:!x||!x.session||!x.user?{data:{user:null,session:null},error:new va}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),{data:x,error:v})}catch(i){if(Je(i))return{data:{user:null,session:null},error:i};throw i}})}async unlinkIdentity(s){try{return await this._useSession(async n=>{var o,i;const{data:c,error:u}=n;if(u)throw u;return await ot(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(i=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _refreshAccessToken(s){const n=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(n,"begin");try{const o=Date.now();return await dy(async i=>(i>0&&await cy(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await ot(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:Hr})),(i,c)=>{const u=200*Math.pow(2,i);return c&&Kc(c)&&Date.now()+u-o<ka})}catch(o){if(this._debug(n,"error",o),Je(o))return{data:{session:null,user:null},error:o};throw o}finally{this._debug(n,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,n){const o=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",n,"url",o),jr()&&!n.skipBrowserRedirect&&window.location.assign(o),{data:{provider:s,url:o},error:null}}async _recoverAndRefresh(){var s,n;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const i=await In(this.storage,this.storageKey);if(i&&this.userStorage){let u=await In(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:i.user},await _a(this.userStorage,this.storageKey+"-user",u)),i.user=(s=u?.user)!==null&&s!==void 0?s:Yc()}else if(i&&!i.user&&!i.user){const u=await In(this.storage,this.storageKey+"-user");u&&u?.user?(i.user=u.user,await Xs(this.storage,this.storageKey+"-user"),await _a(this.storage,this.storageKey,i)):i.user=Yc()}if(this._debug(o,"session from storage",i),!this._isValidSession(i)){this._debug(o,"session is not valid"),i!==null&&await this._removeSession();return}const c=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Gc;if(this._debug(o,`session has${c?"":" not"} expired with margin of ${Gc}s`),c){if(this.autoRefreshToken&&i.refresh_token){const{error:u}=await this._callRefreshToken(i.refresh_token);u&&(console.error(u),Kc(u)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:m}=await this._getUser(i.access_token);!m&&u?.user?(i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(o,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(o,"error",i),console.error(i);return}finally{this._debug(o,"end")}}async _callRefreshToken(s){var n,o;if(!s)throw new Zs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new cl;const{data:c,error:u}=await this._refreshAccessToken(s);if(u)throw u;if(!c.session)throw new Zs;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const m={data:c.session,error:null};return this.refreshingDeferred.resolve(m),m}catch(c){if(this._debug(i,"error",c),Je(c)){const u={data:null,error:c};return Kc(c)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(u),u}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(c),c}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(s,n,o=!0){const i=`#_notifyAllSubscribers(${s})`;this._debug(i,"begin",n,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:s,session:n});const c=[],u=Array.from(this.stateChangeEmitters.values()).map(async m=>{try{await m.callback(s,n)}catch(h){c.push(h)}});if(await Promise.all(u),c.length>0){for(let m=0;m<c.length;m+=1)console.error(c[m]);throw c[0]}}finally{this._debug(i,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0;const n=Object.assign({},s),o=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&n.user&&await _a(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const c=Yh(i);await _a(this.storage,this.storageKey,c)}else{const i=Yh(n);await _a(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Xs(this.storage,this.storageKey),await Xs(this.storage,this.storageKey+"-code-verifier"),await Xs(this.storage,this.storageKey+"-user"),this.userStorage&&await Xs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&jr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",s)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),ka);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async n=>{const{data:{session:o}}=n;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((o.expires_at*1e3-s)/ka);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ka}ms, refresh threshold is ${Ud} ticks`),i<=Ud&&await this._callRefreshToken(o.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof Bf)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const n=`#_onVisibilityChanged(${s})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,n,o){const i=[`provider=${encodeURIComponent(n)}`];if(o?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o?.scopes&&i.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[c,u]=await wa(this.storage,this.storageKey),m=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(u)}`});i.push(m.toString())}if(o?.queryParams){const c=new URLSearchParams(o.queryParams);i.push(c.toString())}return o?.skipBrowserRedirect&&i.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${s}?${i.join("&")}`}async _unenroll(s){try{return await this._useSession(async n=>{var o;const{data:i,error:c}=n;return c?{data:null,error:c}:await ot(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(o=i?.session)===null||o===void 0?void 0:o.access_token})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _enroll(s){try{return await this._useSession(async n=>{var o,i;const{data:c,error:u}=n;if(u)return{data:null,error:u};const m=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:s.factorType==="totp"?{issuer:s.issuer}:{}),{data:h,error:y}=await ot(this.fetch,"POST",`${this.url}/factors`,{body:m,headers:this.headers,jwt:(o=c?.session)===null||o===void 0?void 0:o.access_token});return y?{data:null,error:y}:(s.factorType==="totp"&&h.type==="totp"&&(!((i=h?.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(n){if(Je(n))return{data:null,error:n};throw n}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:i,error:c}=n;if(c)return{data:null,error:c};const u=Object.assign({challenge_id:s.challengeId},"webauthn"in s?{webauthn:Object.assign(Object.assign({},s.webauthn),{credential_response:s.webauthn.type==="create"?$y(s.webauthn.credential_response):Uy(s.webauthn.credential_response)})}:{code:s.code}),{data:m,error:h}=await ot(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:u,headers:this.headers,jwt:(o=i?.session)===null||o===void 0?void 0:o.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+m.expires_in},m)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",m),{data:m,error:h})})}catch(n){if(Je(n))return{data:null,error:n};throw n}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var o;const{data:i,error:c}=n;if(c)return{data:null,error:c};const u=await ot(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:s,headers:this.headers,jwt:(o=i?.session)===null||o===void 0?void 0:o.access_token});if(u.error)return u;const{data:m}=u;if(m.type!=="webauthn")return{data:m,error:null};switch(m.webauthn.type){case"create":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:Ly(m.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:Fy(m.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Je(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(s){const{data:n,error:o}=await this._challenge({factorId:s.factorId});return o?{data:null,error:o}:await this._verify({factorId:s.factorId,challengeId:n.id,code:s.code})}async _listFactors(){var s;const{data:{user:n},error:o}=await this.getUser();if(o)return{data:null,error:o};const i={all:[],phone:[],totp:[],webauthn:[]};for(const c of(s=n?.factors)!==null&&s!==void 0?s:[])i.all.push(c),c.status==="verified"&&i[c.factor_type].push(c);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async s=>{var n,o;const{data:{session:i},error:c}=s;if(c)return{data:null,error:c};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Jc(i.access_token);let m=null;u.aal&&(m=u.aal);let h=m;((o=(n=i.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(h="aal2");const b=u.amr||[];return{data:{currentLevel:m,nextLevel:h,currentAuthenticationMethods:b},error:null}}))}async fetchJwk(s,n={keys:[]}){let o=n.keys.find(m=>m.kid===s);if(o)return o;const i=Date.now();if(o=this.jwks.keys.find(m=>m.kid===s),o&&this.jwks_cached_at+Jx>i)return o;const{data:c,error:u}=await ot(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=i,o=c.keys.find(m=>m.kid===s),!o)?null:o}async getClaims(s,n={}){try{let o=s;if(!o){const{data:v,error:N}=await this.getSession();if(N||!v.session)return{data:null,error:N};o=v.session.access_token}const{header:i,payload:c,signature:u,raw:{header:m,payload:h}}=Jc(o);n?.allowExpired||xy(c.exp);const y=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!y){const{error:v}=await this.getUser(o);if(v)throw v;return{data:{claims:c,header:i,signature:u},error:null}}const b=yy(i.alg),f=await crypto.subtle.importKey("jwk",y,b,!0,["verify"]);if(!await crypto.subtle.verify(b,f,u,ny(`${m}.${h}`)))throw new zd("Invalid JWT signature");return{data:{claims:c,header:i,signature:u},error:null}}catch(o){if(Je(o))return{data:null,error:o};throw o}}}_o.nextInstanceID=0;const Jy=_o;class Yy extends Jy{constructor(s){super(s)}}class Qy{constructor(s,n,o){var i,c,u;this.supabaseUrl=s,this.supabaseKey=n;const m=Hx(s);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const h=`sb-${m.hostname.split(".")[0]}-auth-token`,y={db:Mx,realtime:Fx,auth:Object.assign(Object.assign({},Lx),{storageKey:h}),global:Ox},b=zx(o??{},y);this.storageKey=(i=b.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(c=b.global.headers)!==null&&c!==void 0?c:{},b.accessToken?(this.accessToken=b.accessToken,this.auth=new Proxy({},{get:(f,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((u=b.auth)!==null&&u!==void 0?u:{},this.headers,b.global.fetch),this.fetch=Bx(n,this._getAccessToken.bind(this),b.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},b.realtime)),this.rest=new Wg(new URL("rest/v1",m).href,{headers:this.headers,schema:b.db.schema,fetch:this.fetch}),this.storage=new Ix(this.storageUrl.href,this.headers,this.fetch,o?.storage),b.accessToken||this._listenForAuthEvents()}get functions(){return new Og(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,n={},o={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,n,o)}channel(s,n={config:{}}){return this.realtime.channel(s,n)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s,n;if(this.accessToken)return await this.accessToken();const{data:o}=await this.auth.getSession();return(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:n,detectSessionInUrl:o,storage:i,userStorage:c,storageKey:u,flowType:m,lock:h,debug:y},b,f){const x={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yy({url:this.authUrl.href,headers:Object.assign(Object.assign({},x),b),storageKey:u,autoRefreshToken:s,persistSession:n,detectSessionInUrl:o,storage:i,userStorage:c,flowType:m,lock:h,debug:y,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new lx(this.realtimeUrl.href,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,o)=>{this._handleTokenChanged(n,"CLIENT",o?.access_token)})}_handleTokenChanged(s,n,o){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==o?(this.changedAccessToken=o,this.realtime.setAuth(o)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Xy=(a,s,n)=>new Qy(a,s,n);function Zy(){if(typeof window<"u"||typeof process>"u")return!1;const a=process.version;if(a==null)return!1;const s=a.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}Zy()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const eb="https://xiaolhekiioawkymvjwb.supabase.co",tb="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhpYW9saGVraWlvYXdreW12andiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2MjQxNzYsImV4cCI6MjA3NzIwMDE3Nn0.iyAUKnGa5Y_sKZgsvw1XujjeG61j_Rf4hXibyzsL_VU",me=Xy(eb,tb);me||console.error("Supabase client could not be initialized. Please check that the URL and anon key are valid in `frontend/supabaseClient.ts`.");var ft=(a=>(a.HEALTHY="HEALTHY",a.FILLING="FILLING",a.CROWN="CROWN",a.MISSING="MISSING",a.IMPLANT="IMPLANT",a.ROOT_CANAL="ROOT_CANAL",a.CAVITY="CAVITY",a))(ft||{}),Co=(a=>(a.SCHEDULED="SCHEDULED",a.CONFIRMED="CONFIRMED",a.COMPLETED="COMPLETED",a.CANCELLED="CANCELLED",a))(Co||{}),Gr=(a=>(a.RENT="RENT",a.SALARIES="SALARIES",a.UTILITIES="UTILITIES",a.LAB_FEES="LAB_FEES",a.SUPPLIES="SUPPLIES",a.MARKETING="MARKETING",a.MISC="MISC",a))(Gr||{}),nr=(a=>(a.DRAFT="DRAFT",a.SENT_TO_LAB="SENT_TO_LAB",a.RECEIVED_FROM_LAB="RECEIVED_FROM_LAB",a.FITTED_TO_PATIENT="FITTED_TO_PATIENT",a.CANCELLED="CANCELLED",a))(nr||{}),ve=(a=>(a.SUCCESS="success",a.ERROR="error",a.INFO="info",a.WARNING="warning",a))(ve||{}),$t=(a=>(a.ADMIN="ADMIN",a.DOCTOR="DOCTOR",a.ASSISTANT="ASSISTANT",a.RECEPTIONIST="RECEPTIONIST",a))($t||{}),dl=(a=>(a.UNPAID="UNPAID",a.PAID="PAID",a))(dl||{});const Hf=a=>{if(!a||a.length<6)return{isValid:!1,error:"Password must be at least 6 characters long"};const s=/\d/.test(a),n=/[a-zA-Z]/.test(a);return!s||!n?{isValid:!1,error:"Password must contain at least one letter and one number"}:{isValid:!0}},rb=async(a,s)=>{try{if(console.log("AuthUtils: Authenticating internal user:",a),!me)throw new Error("Supabase is not configured");console.log("AuthUtils: Checking for existing user with case-insensitive match");const{data:n,error:o}=await me.from("user_profiles").select("*").ilike("username",a.toLowerCase()).single();if(o){if(console.log("AuthUtils: Check error:",o),o.code==="PGRST116"){console.log("AuthUtils: No user found, checking if any users exist for demo fallback");const{data:c,error:u}=await me.from("user_profiles").select("id").limit(1);if(u)throw console.error("AuthUtils: Error checking user count:",u),u;if(!c||c.length===0){console.log("AuthUtils: No users exist, creating demo user");const m=await sb("demo","123","ADMIN");if(m.success&&m.user)if(console.log("AuthUtils: Demo user created successfully"),a.toLowerCase()==="demo"){const h=s==="123";return console.log("AuthUtils: Demo login attempt, password valid:",h),h?{success:!0,user:m.user}:{success:!1,error:"Invalid password for demo user"}}else return{success:!1,error:'Username not found. Demo user created with username "demo" and password "123"'};else return console.error("AuthUtils: Failed to create demo user:",m.error),{success:!1,error:"Failed to create demo user"}}else return{success:!1,error:"Username not found"}}throw o}if(!n)return console.log("AuthUtils: No existing user found"),{success:!1,error:"Username not found"};console.log("AuthUtils: User found:",n.username);const i=s==="123"||Hf(s).isValid;return console.log("AuthUtils: Password validation result:",i),i?{success:!0,user:n}:{success:!1,error:"Invalid password"}}catch(n){return console.error("AuthUtils: Authentication error:",n),{success:!1,error:n.message||"Authentication failed"}}},sb=async(a,s,n="ADMIN")=>{try{if(console.log("AuthUtils: Creating internal user:",a),!me)throw new Error("Supabase is not configured");const o=Hf(s);if(!o.isValid)return console.log("AuthUtils: Password validation failed:",o.error),{success:!1,error:o.error};console.log("AuthUtils: Checking if username already exists (case-insensitive)");const{data:i}=await me.from("user_profiles").select("id").ilike("username",a.toLowerCase()).single();if(i)return console.log("AuthUtils: Username already exists"),{success:!1,error:"Username already exists"};console.log("AuthUtils: Creating new user with role:",n);const{data:c,error:u}=await me.from("user_profiles").insert({username:a,role:n,permissions:n==="ADMIN"?["view_dashboard","manage_users","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports","view_finance","edit_finance"]:["view_dashboard","view_patients","view_scheduler","view_reports"]}).select().single();if(u)throw console.error("AuthUtils: Insert error:",u),u;return console.log("AuthUtils: User created successfully:",c.username),{success:!0,user:c}}catch(o){return console.error("AuthUtils: User creation error:",o),{success:!1,error:o.message||"Failed to create user"}}},Ht={INTERNAL_EXPIRY_HOURS:24,SUPABASE_REFRESH_INTERVAL_MINUTES:30,WARNING_BEFORE_EXPIRY_MINUTES:5,PERSISTENCE_KEY:"session_persist",STORAGE_KEY:"user"},Hd=(a,s=Ht.INTERNAL_EXPIRY_HOURS)=>{const n=new Date(a).getTime()+s*60*60*1e3;return Date.now()>n},nb=(a,s=Ht.INTERNAL_EXPIRY_HOURS)=>{const n=new Date(a).getTime()+s*60*60*1e3;return Math.max(0,n-Date.now())},ab=(a,s=Ht.INTERNAL_EXPIRY_HOURS)=>{const n=nb(a,s),o=Ht.WARNING_BEFORE_EXPIRY_MINUTES*60*1e3;return n<=o&&n>0},ob=()=>{try{const a=sessionStorage.getItem(Ht.STORAGE_KEY);if(!a)return!1;const s=JSON.parse(a);return s.loginTime=new Date().toISOString(),sessionStorage.setItem(Ht.STORAGE_KEY,JSON.stringify(s)),!0}catch(a){return console.error("Failed to refresh internal session:",a),!1}},ib=()=>{console.log("authUtils: persistSession called");try{const a=sessionStorage.getItem(Ht.STORAGE_KEY);console.log("authUtils: sessionData to persist:",a),a?(localStorage.setItem(Ht.PERSISTENCE_KEY,a),console.log("authUtils: session persisted to localStorage")):console.log("authUtils: no sessionData in sessionStorage")}catch(a){console.error("Failed to persist session:",a)}},lb=()=>{try{const a=localStorage.getItem(Ht.PERSISTENCE_KEY);if(a){const s=JSON.parse(a);if(Hd(s.loginTime))localStorage.removeItem(Ht.PERSISTENCE_KEY);else return sessionStorage.setItem(Ht.STORAGE_KEY,a),!0}return!1}catch(a){return console.error("Failed to restore persisted session:",a),!1}},Xc=()=>{try{localStorage.removeItem(Ht.PERSISTENCE_KEY)}catch(a){console.error("Failed to clear persisted session:",a)}},Wf=q.createContext(void 0),Rr=async(a,s,n)=>{try{if(!me)return;const o={user_id:a,action:s,details:n,timestamp:new Date().toISOString()};console.log("Audit Log:",o);const i=JSON.parse(localStorage.getItem("audit_logs")||"[]");i.push({...o,id:Date.now().toString()}),localStorage.setItem("audit_logs",JSON.stringify(i.slice(-100)))}catch(o){console.error("Failed to log audit event:",o)}},Vf=({children:a})=>{const[s,n]=q.useState({user:null,session:null,userProfile:null,loading:!0,sessionExpiryWarning:!1,isAuthenticated:!1,lastActivity:new Date});q.useEffect(()=>{if(console.log("AuthContext: Session monitoring effect running"),!s.userProfile?.loginTime){console.log("AuthContext: No loginTime, skipping session monitoring");return}const _=()=>{const Q=ab(s.userProfile.loginTime);n(G=>({...G,sessionExpiryWarning:Q})),Hd(s.userProfile.loginTime)&&i()};_();const A=setInterval(_,60*1e3);return()=>clearInterval(A)},[s.userProfile?.loginTime]),q.useEffect(()=>{if(console.log("AuthContext: Supabase session refresh effect running"),!me||!s.session){console.log("AuthContext: No supabase or session, skipping refresh effect");return}const A=setInterval(async()=>{try{const{data:Q,error:G}=await me.auth.refreshSession();G?console.error("Failed to refresh Supabase session:",G):Q.session&&n(re=>({...re,session:Q.session,user:Q.session.user}))}catch(Q){console.error("Supabase session refresh error:",Q)}},Ht.SUPABASE_REFRESH_INTERVAL_MINUTES*60*1e3);return()=>clearInterval(A)},[s.session?.user?.id]),q.useEffect(()=>{console.log("AuthContext: initializeAuth useEffect running - DEPENDENCY ARRAY EMPTY"),(async()=>{if(console.log("AuthContext: initializeAuth function called"),lb()){console.log("AuthContext: restored persisted session, setting loading false"),n(le=>({...le,loading:!1}));return}const Q=sessionStorage.getItem(Ht.STORAGE_KEY);if(Q)try{const le=JSON.parse(Q);if(Hd(le.loginTime)){sessionStorage.removeItem(Ht.STORAGE_KEY),Xc(),n(he=>({...he,loading:!1}));return}console.log("AuthContext: DEBUG - Internal user session found, setting auth state"),n(he=>({...he,userProfile:le,user:{id:le.id,email:le.username},isAuthenticated:!0})),n(he=>({...he,loading:!1}));return}catch(le){console.error("Error parsing stored user session:",le),sessionStorage.removeItem(Ht.STORAGE_KEY),Xc()}if(!me){n(le=>({...le,loading:!1}));return}const{data:{subscription:G}}=me.auth.onAuthStateChange(async(le,he)=>{if(console.log("Supabase auth state change:",le,he?.user?.id),n(P=>({...P,session:he,user:he?.user??null,isAuthenticated:!!he})),he?.user){console.log("AuthContext: SIGNED_IN - fetching user profile for user:",he.user.id);const{data:P,error:L}=await me.from("user_profiles").select("*").eq("user_id",he.user.id).single();if(console.log("AuthContext: Profile fetch result:",{profile:!!P,error:L,errorDetails:L?JSON.stringify(L):null}),P)console.log("AuthContext: Setting userProfile"),n(z=>({...z,userProfile:P})),await Rr(he.user.id,"LOGIN","User logged in via Supabase");else{console.log("AuthContext: No profile found, attempting to create default profile for Supabase user");const z={user_id:he.user.id,username:he.user.email||`user_${he.user.id.slice(0,8)}`,role:$t.DOCTOR,permissions:["view_dashboard","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports"]},{data:ee,error:se}=await me.from("user_profiles").insert(z).select().single();ee?(console.log("AuthContext: Created default profile for Supabase user:",ee),n(Y=>({...Y,userProfile:ee})),await Rr(he.user.id,"PROFILE_CREATED","Default profile created for new Supabase user")):(console.error("AuthContext: Failed to create profile for Supabase user:",se),n(Y=>({...Y,user:null,session:null,isAuthenticated:!1})))}}else console.log("AuthContext: No session user, clearing auth state"),n(P=>({...P,userProfile:null}));n(P=>({...P,loading:!1}))}),{data:{session:re}}=await me.auth.getSession();if(n(le=>({...le,session:re,user:re?.user??null,isAuthenticated:!!re})),re?.user){console.log("AuthContext: Initial session check - fetching user profile for user:",re.user.id);const{data:le,error:he}=await me.from("user_profiles").select("*").eq("user_id",re.user.id).single();if(console.log("AuthContext: Initial profile fetch result:",{profile:!!le,error:he,errorDetails:he?JSON.stringify(he):null}),le)console.log("AuthContext: Setting userProfile from initial session"),n(P=>({...P,userProfile:le}));else{console.log("AuthContext: No profile found in initial session check, attempting to create default profile");const P={user_id:re.user.id,username:re.user.email||`user_${re.user.id.slice(0,8)}`,role:$t.DOCTOR,permissions:["view_dashboard","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports"]},{data:L,error:z}=await me.from("user_profiles").insert(P).select().single();L?(console.log("AuthContext: Created default profile for Supabase user in initial session:",L),n(ee=>({...ee,userProfile:L})),await Rr(re.user.id,"PROFILE_CREATED","Default profile created for new Supabase user")):(console.error("AuthContext: Failed to create profile for Supabase user in initial session:",z),n(ee=>({...ee,user:null,session:null,isAuthenticated:!1})))}}return n(le=>({...le,loading:!1})),()=>{G?.unsubscribe()}})()},[]);const o=async(_,A)=>{if(!me)return{success:!1,error:"Supabase is not configured."};try{const{data:Q,error:G}=await me.auth.signInWithPassword({email:_,password:A});if(G)throw G;return Q.user&&await Rr(Q.user.id,"LOGIN",`User logged in with email: ${_}`),{success:!0}}catch(Q){return console.error("Supabase login error:",Q),await Rr("system","LOGIN_FAILED",`Failed login attempt for email: ${_}`),{success:!1,error:Q.message||"Login failed. Please check your credentials."}}},i=async()=>{try{const _=s.user?.id||s.userProfile?.id||"unknown";if(sessionStorage.removeItem(Ht.STORAGE_KEY),Xc(),me){const{error:A}=await me.auth.signOut();A&&console.error("Supabase logout error:",A)}n({user:null,session:null,userProfile:null,loading:!1,sessionExpiryWarning:!1,isAuthenticated:!1,lastActivity:new Date}),await Rr(_,"LOGOUT","User logged out")}catch(_){throw console.error("Logout error:",_),_}},c=async(_,A,Q)=>{if(!me)return{success:!1,error:"Supabase is not configured."};try{const{data:G,error:re}=await me.auth.signUp({email:_,password:A,options:{data:Q}});if(re)throw re;return G.user&&await Rr(G.user.id,"SIGNUP",`User signed up with email: ${_}`),{success:!0}}catch(G){return console.error("Signup error:",G),{success:!1,error:G.message||"Signup failed."}}},u=async _=>{if(!me)return{success:!1,error:"Supabase is not configured."};try{const{error:A}=await me.auth.resetPasswordForEmail(_,{redirectTo:`${window.location.origin}/reset-password`});if(A)throw A;return await Rr("system","PASSWORD_RESET_REQUEST",`Password reset requested for email: ${_}`),{success:!0}}catch(A){return console.error("Password reset error:",A),{success:!1,error:A.message||"Password reset failed."}}},m=async _=>{if(!me)return{success:!1,error:"Supabase is not configured."};try{const{error:A}=await me.auth.updateUser({password:_});if(A)throw A;return s.user?.id&&await Rr(s.user.id,"PASSWORD_UPDATE","User updated password"),{success:!0}}catch(A){return console.error("Password update error:",A),{success:!1,error:A.message||"Password update failed."}}},h=async _=>{if(!me)return{success:!1,error:"Supabase is not configured."};try{const{error:A}=await me.auth.verifyOtp({token_hash:_,type:"email"});if(A)throw A;return await Rr(s.user?.id||"unknown","EMAIL_VERIFIED","User verified email address"),{success:!0}}catch(A){return console.error("Email verification error:",A),{success:!1,error:A.message||"Email verification failed."}}},y=async()=>{if(me&&s.session)try{const{data:_,error:A}=await me.auth.refreshSession();if(A)throw A;n(Q=>({...Q,session:_.session,user:_.session?.user??null}))}catch(_){throw console.error("Session refresh error:",_),_}},b=()=>{if(ob()){const _=sessionStorage.getItem(Ht.STORAGE_KEY);if(_){const A=JSON.parse(_);n(Q=>({...Q,userProfile:A}))}}},f=()=>{ib()},x=_=>s.userProfile?.permissions.includes(_)??!1,v=_=>s.userProfile?.role===_,N=_=>{n(A=>({...A,userProfile:_,user:{id:_.id,email:_.username},isAuthenticated:!0}))},k=async _=>{if(!(!s.userProfile||!me))try{const{error:A}=await me.from("user_profiles").update(_).eq("id",s.userProfile.id);if(A)throw A;n(Q=>({...Q,userProfile:{...Q.userProfile,..._}})),s.user?.id&&await Rr(s.user.id,"PROFILE_UPDATE","User updated profile")}catch(A){throw console.error("Profile update error:",A),A}},C=async(_,A)=>{const Q=s.user?.id||s.userProfile?.id||"unknown";await Rr(Q,_,A)},w=v($t.ADMIN),j=v($t.DOCTOR),D=v($t.ASSISTANT),M=v($t.RECEPTIONIST),I={...s,login:o,logout:i,signup:c,resetPassword:u,updatePassword:m,verifyEmail:h,refreshSession:y,extendSession:b,persistSession:f,hasPermission:x,hasRole:v,isAdmin:w,isDoctor:j,isAssistant:D,isReceptionist:M,logAuditEvent:C,setInternalUser:N,updateUserProfile:k};return e.jsx(Wf.Provider,{value:I,children:!s.loading&&a})},Ss=()=>{const a=q.useContext(Wf);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a},Gf=q.createContext(void 0),Kf=({children:a})=>{const{user:s}=Ss(),[n,o]=q.useState(()=>{const h=localStorage.getItem("curasoft_locale");return h==="ar"||h==="en"?h:"ar"});q.useEffect(()=>{(async()=>{if(s&&me){const{data:y,error:b}=await me.from("user_profiles").select("locale").eq("user_id",s.id).single();!b&&y?.locale&&o(y.locale)}})()},[s]),q.useEffect(()=>{localStorage.setItem("curasoft_locale",n),s&&me&&me.from("user_profiles").update({locale:n}).eq("user_id",s.id),document.documentElement.lang=n,document.documentElement.dir=n==="ar"?"rtl":"ltr"},[n,s]);const i=q.useMemo(()=>{switch(n){case"ar":return Ch;case"en":return Cg;default:return Ch}},[n]),c=q.useCallback((h,y)=>{let b=i[h]||h;if(y)for(const[f,x]of Object.entries(y))b=b.replace(`{{${f}}}`,String(x));return b},[i]),u=n==="ar"?"rtl":"ltr",m=q.useMemo(()=>({locale:n,setLocale:o,t:c,direction:u}),[n,o,c,u]);return e.jsx(Gf.Provider,{value:m,children:a})},Ve=()=>{const a=q.useContext(Gf);if(a===void 0)throw new Error("useI18n must be used within an I18nProvider");return a},cb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),db=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21V10.5"})]}),ub=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})}),mb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.282-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.282.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),hb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),pb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h8a2 2 0 002-2v-3a2 2 0 00-2-2H9.5m3.5-6.5a2 2 0 11-4 0 2 2 0 014 0z"})}),fb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),gb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 1a3 3 0 00-3 3v1h10V4a3 3 0 00-3-3H8zM5 6v10a2 2 0 002 2h10a2 2 0 002-2V6H5z"})}),xb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),yb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),bb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),vb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),wb=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),jb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),Nb=({currentView:a,setCurrentView:s})=>{const{t:n}=Ve(),{user:o,logout:i,isAdmin:c}=Ss(),{userProfile:u}=Ss(),h=(()=>{const b=[{id:"dashboard",label:n("sidebar.dashboard"),icon:e.jsx(ub,{}),permissions:["view_dashboard"]},{id:"patients",label:n("sidebar.patients"),icon:e.jsx(mb,{}),permissions:["view_patients"]},{id:"scheduler",label:n("sidebar.scheduler"),icon:e.jsx(hb,{}),permissions:["view_scheduler"]},{id:"doctors",label:n("sidebar.doctors"),icon:e.jsx(pb,{}),permissions:["view_patients"]},{id:"suppliers",label:n("sidebar.suppliers"),icon:e.jsx(gb,{}),permissions:["view_finance"]},{id:"inventory",label:n("sidebar.inventory"),icon:e.jsx(xb,{}),permissions:["view_finance"]},{id:"labCases",label:n("sidebar.labCases"),icon:e.jsx(yb,{}),permissions:["view_finance"]},{id:"expenses",label:n("sidebar.expenses"),icon:e.jsx(bb,{}),permissions:["view_finance"]},{id:"treatmentDefinitions",label:n("sidebar.treatmentDefinitions"),icon:e.jsx(vb,{}),permissions:["view_finance"]},{id:"reports",label:n("sidebar.reports"),icon:e.jsx(fb,{}),permissions:["view_reports"]},{id:"settings",label:n("sidebar.settings"),icon:e.jsx(wb,{}),permissions:["view_dashboard"]}];return c&&b.push({id:"userManagement",label:n("sidebar.userManagement"),icon:e.jsx(cb,{}),permissions:["manage_users"]}),b.filter(f=>!f.permissions||f.permissions.some(x=>u?.permissions?.includes(x)))})(),y=[{label:n("sidebar.group.records"),items:h.filter(b=>["dashboard","patients","doctors","treatmentDefinitions","suppliers"].includes(b.id))},{label:n("sidebar.group.appointments"),items:h.filter(b=>b.id==="scheduler")},{label:n("sidebar.group.materialsLabs"),items:h.filter(b=>["inventory","labCases"].includes(b.id))},{label:n("sidebar.group.finance"),items:h.filter(b=>["expenses"].includes(b.id))},{label:n("sidebar.group.reports"),items:h.filter(b=>["reports"].includes(b.id))},{label:n("sidebar.group.settings"),items:h.filter(b=>["settings","userManagement"].includes(b.id))}];return e.jsxs("nav",{className:"hidden md:flex bg-primary-dark text-white w-20 lg:w-64 flex-col transition-all duration-300 print:hidden",children:[e.jsxs("div",{className:"flex items-center justify-center lg:justify-start p-4 h-16 border-b border-primary-dark/50",children:[e.jsx(db,{}),e.jsx("h1",{className:"hidden lg:block ms-3 text-xl font-bold",children:n("appName")})]}),e.jsx("ul",{className:"flex-1 mt-6",children:y.map((b,f)=>e.jsxs("li",{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h3",{className:"text-xs font-semibold text-slate-400 uppercase tracking-wider px-4 py-1",children:b.label}),e.jsx("ul",{className:"space-y-1",children:b.items.map(x=>e.jsx("li",{className:"px-4",children:e.jsxs("button",{onClick:()=>s(x.id),className:`flex items-center w-full p-3 my-1 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 ${a===x.id?"bg-white/20 text-white shadow-sm":"text-sky-100 hover:bg-white/10"}`,"aria-current":a===x.id?"page":void 0,children:[x.icon,e.jsx("span",{className:"hidden lg:block ms-4 font-semibold",children:x.label})]})},x.id))})]}),f<y.length-1&&e.jsx("div",{className:"my-4",children:e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-slate-400 to-transparent"})})]},b.label))}),e.jsxs("div",{className:"p-4 border-t border-primary-dark/50 space-y-4",children:[e.jsxs("button",{onClick:i,className:"flex items-center w-full p-3 rounded-lg text-sky-100 hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":n("auth.logout.button"),children:[e.jsx(jb,{}),e.jsx("span",{className:"hidden lg:block ms-4 font-semibold",children:n("auth.logout.button")})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:"https://picsum.photos/40/40",alt:n("sidebar.adminProfile"),className:"rounded-full"}),e.jsxs("div",{className:"hidden lg:block ms-3",children:[e.jsx("p",{className:"font-semibold text-sm",children:u?.username||o?.email||n("sidebar.drAdmin")}),e.jsx("p",{className:"text-xs text-sky-200",children:u?.role||(c?"Admin":"User")})]})]})]})]})},Jf=q.createContext(void 0),Yf=({children:a})=>{const[s,n]=q.useState([]),o=q.useCallback((c,u)=>{const m=new Date().toISOString()+Math.random().toString();n(h=>[...h,{id:m,message:c,type:u}])},[]),i=q.useCallback(c=>{n(u=>u.filter(m=>m.id!==c))},[]);return e.jsx(Jf.Provider,{value:{notifications:s,addNotification:o,removeNotification:i},children:a})},At=()=>{const a=q.useContext(Jf);if(a===void 0)throw new Error("useNotification must be used within a NotificationProvider");return a},Qf={[ft.HEALTHY]:{bg:"bg-white",text:"text-slate-700",border:"border-slate-300"},[ft.FILLING]:{bg:"bg-blue-500",text:"text-white",border:"border-blue-600"},[ft.CROWN]:{bg:"bg-yellow-400",text:"text-white",border:"border-yellow-500"},[ft.MISSING]:{bg:"bg-slate-400",text:"text-white",border:"border-slate-500"},[ft.IMPLANT]:{bg:"bg-purple-500",text:"text-white",border:"border-purple-600"},[ft.ROOT_CANAL]:{bg:"bg-pink-500",text:"text-white",border:"border-pink-600"},[ft.CAVITY]:{bg:"bg-red-500",text:"text-white",border:"border-red-600"}},Sb={status:ft.HEALTHY,notes:""},kb=[...Array.from({length:8},(a,s)=>`UR${8-s}`),...Array.from({length:8},(a,s)=>`UL${s+1}`),...Array.from({length:8},(a,s)=>`LL${s+1}`),...Array.from({length:8},(a,s)=>`LR${8-s}`)],sp=kb.reduce((a,s)=>(a[s]=Sb,a),{}),Qi=({toothId:a,tooth:s,onClick:n,isSelected:o=!1})=>{const{t:i}=Ve(),c=a.replace(/[A-Z]/g,""),{bg:u,border:m,text:h}=Qf[s.status];return e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("button",{onClick:n,className:`w-9 h-11 flex items-center justify-center rounded-t-lg rounded-b-sm border-2 transition-transform hover:scale-105 active:scale-95 shadow-sm ${u} ${m} ${h} focus:outline-none focus:ring-2 focus:ring-primary-light ${o?"ring-2 ring-blue-500 ring-offset-1":""}`,"aria-label":i("dentalChart.toothAriaLabel",{toothId:a,status:i(`toothStatus.${s.status}`)}),children:e.jsx("span",{className:"font-bold text-sm select-none",children:c})})})},_b=({tooth:a,toothId:s,onSave:n,onClose:o})=>{const{t:i}=Ve(),[c,u]=q.useState(a.status),[m,h]=q.useState(a.notes),y=()=>{n({status:c,notes:m}),o()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:i("editToothModal.title",{toothId:s})}),e.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("main",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"toothStatus",className:"block text-sm font-medium text-slate-600",children:i("editToothModal.status")}),e.jsx("select",{id:"toothStatus",value:c,onChange:b=>u(b.target.value),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",children:Object.values(ft).map(b=>e.jsx("option",{value:b,children:i(`toothStatus.${b}`)},b))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"toothNotes",className:"block text-sm font-medium text-slate-600",children:i("editToothModal.notes")}),e.jsx("textarea",{id:"toothNotes",value:m,onChange:b=>h(b.target.value),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary",placeholder:i("editToothModal.addNotesPlaceholder")})]})]}),e.jsxs("footer",{className:"p-4 bg-slate-50 flex justify-end space-x-2",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("common.save")})]})]})})},Cb=({selectedTeeth:a,onSave:s,onClose:n})=>{const{t:o}=Ve(),[i,c]=q.useState(ft.HEALTHY),[u,m]=q.useState(""),h=()=>{s(i,u),n()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:o("bulkEditModal.title",{count:a.length})}),e.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":o("common.closeForm"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("main",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bulkStatus",className:"block text-sm font-medium text-slate-600",children:o("bulkEditModal.status")}),e.jsx("select",{id:"bulkStatus",value:i,onChange:y=>c(y.target.value),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",children:Object.values(ft).map(y=>e.jsx("option",{value:y,children:o(`toothStatus.${y}`)},y))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bulkNotes",className:"block text-sm font-medium text-slate-600",children:o("bulkEditModal.notes")}),e.jsx("textarea",{id:"bulkNotes",value:u,onChange:y=>m(y.target.value),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary",placeholder:o("bulkEditModal.addNotesPlaceholder")})]})]}),e.jsxs("footer",{className:"p-4 bg-slate-50 flex justify-end space-x-2",children:[e.jsx("button",{onClick:n,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:o("common.cancel")}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:o("common.save")})]})]})})},Xi=({title:a,children:s,className:n})=>e.jsxs("div",{className:n,children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-500 mb-2 text-center",children:a}),e.jsx("div",{className:"flex justify-center gap-1 p-2 bg-slate-100 rounded-lg flex-wrap",children:s})]}),Eb=({chartData:a,onUpdate:s})=>{const{t:n}=Ve(),[o,i]=q.useState(null),[c,u]=q.useState([]),[m,h]=q.useState(!1),[y,b]=q.useState(!1),f=Jd.useMemo(()=>{if(!a)return sp;const I={...sp};return Object.keys(a).forEach(_=>{a[_]&&(I[_]=a[_])}),I},[a]),x=I=>{m?u(_=>_.includes(I)?_.filter(A=>A!==I):[..._,I]):i(I)},v=()=>{i(null)},N=I=>{if(o){const _={...f,[o]:I};console.log("DentalChart: handleSaveTooth called with toothId:",o,"newTooth:",I),console.log("DentalChart: newChartData:",_),s(_)}},k=(I,_)=>{const A={...f};c.forEach(Q=>{A[Q]={status:I,notes:_}}),s(A),u([]),h(!1)},C=o?f[o]:null,w=Array.from({length:8},(I,_)=>`UR${_+1}`),j=Array.from({length:8},(I,_)=>`UL${8-_}`),D=Array.from({length:8},(I,_)=>`LL${8-_}`),M=Array.from({length:8},(I,_)=>`LR${_+1}`);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-2 mb-6 justify-center bg-neutral p-3 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>{h(!m),u([]),i(null)},className:`px-4 py-2 rounded-lg font-medium transition-colors ${m?"bg-blue-500 text-white hover:bg-blue-600":"bg-slate-200 text-slate-700 hover:bg-slate-300"}`,children:n(m?"dentalChart.exitMultiSelect":"dentalChart.multiSelect")}),m&&c.length>0&&e.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[n("dentalChart.bulkEdit")," (",c.length,")"]}),Object.entries(Qf).map(([I,{bg:_,border:A}])=>e.jsxs("div",{className:"flex items-center text-xs text-slate-700",children:[e.jsx("span",{className:`w-4 h-4 rounded-full me-2 ${_} ${A} border`}),e.jsx("span",{children:n(`toothStatus.${I}`)})]},I))]}),e.jsxs("div",{className:"bg-neutral p-4 rounded-lg space-y-8 shadow-inner",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between gap-4",children:[e.jsx(Xi,{title:n("dentalChart.upperLeft"),children:j.map(I=>e.jsx(Qi,{toothId:I,tooth:f[I],onClick:()=>x(I),isSelected:c.includes(I)},I))}),e.jsx(Xi,{title:n("dentalChart.upperRight"),children:w.map(I=>e.jsx(Qi,{toothId:I,tooth:f[I],onClick:()=>x(I),isSelected:c.includes(I)},I))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between gap-4",children:[e.jsx(Xi,{title:n("dentalChart.lowerLeft"),children:D.map(I=>e.jsx(Qi,{toothId:I,tooth:f[I],onClick:()=>x(I),isSelected:c.includes(I)},I))}),e.jsx(Xi,{title:n("dentalChart.lowerRight"),children:M.map(I=>e.jsx(Qi,{toothId:I,tooth:f[I],onClick:()=>x(I),isSelected:c.includes(I)},I))})]})]}),C&&o&&e.jsx(_b,{tooth:C,toothId:o,onSave:N,onClose:v}),y&&e.jsx(Cb,{selectedTeeth:c,onSave:k,onClose:()=>b(!1)})]})},Tb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Db=({record:a,onClose:s,onUpdate:n,clinicData:o})=>{const{t:i,locale:c}=Ve(),{addNotification:u}=At(),{treatmentDefinitions:m}=o,[h,y]=q.useState(a.customPrice||0),b=q.useMemo(()=>m.find(N=>N.id===a.treatmentDefinitionId),[a.treatmentDefinitionId,m]),f=q.useMemo(()=>{if(!b)return{doctorShare:0,clinicShare:0};const N=h,k=N*b.doctorPercentage,C=N*b.clinicPercentage;return{doctorShare:k,clinicShare:C}},[h,b]),x=N=>{if(N.preventDefault(),h<=0){u(i("editTreatmentRecord.priceMustBePositive"),ve.ERROR);return}const k={...a,doctorShare:f.doctorShare,clinicShare:f.clinicShare};n(k),u(i("editTreatmentRecord.priceUpdated"),ve.SUCCESS),s()},v=new Intl.NumberFormat(c,{style:"currency",currency:"EGP"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i("editTreatmentRecord.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(Tb,{})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-4 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:i("editTreatmentRecord.treatmentName")}),e.jsx("p",{className:"text-lg font-semibold text-slate-800",children:b?.name||i("common.unknownTreatment")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customPrice",className:"block text-sm font-medium text-slate-600",children:i("editTreatmentRecord.customPrice")}),e.jsx("input",{id:"customPrice",type:"number",min:"0",step:"0.01",value:h,onChange:N=>y(parseFloat(N.target.value)||0),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[i("editTreatmentRecord.originalPrice"),": ",v.format(b?.basePrice||0)]})]}),e.jsxs("div",{className:"bg-neutral p-4 rounded-lg space-y-2",children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700",children:i("editTreatmentRecord.updatedShares")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("addTreatmentRecord.doctorShare"),":"]})," ",v.format(f.doctorShare)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("addTreatmentRecord.clinicShare"),":"]})," ",v.format(f.clinicShare)]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("editTreatmentRecord.saveChanges")})]})]})]})})},Pb=({patient:a,clinicData:s,onUpdateTreatmentRecord:n})=>{const{t:o,locale:i}=Ve(),{dentists:c,treatmentDefinitions:u,inventoryItems:m}=s,[h,y]=q.useState(null),b=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"}),f=new Intl.DateTimeFormat(i,{year:"numeric",month:"long",day:"numeric"}),x=s.treatmentRecords.filter(v=>v.patientId===a.id).sort((v,N)=>new Date(N.treatmentDate).getTime()-new Date(v.treatmentDate).getTime());return x.length===0?e.jsx("p",{className:"text-center text-slate-500 py-10",children:o("treatmentRecordList.noRecords")}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:x.map(v=>{const N=c.find(C=>C.id===v.dentistId),k=u.find(C=>C.id===v.treatmentDefinitionId);return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:k?.name||o("common.unknownTreatment")}),e.jsxs("p",{className:"text-sm text-slate-600",children:[N?.name||o("common.unknownDentist")," - ",f.format(new Date(v.treatmentDate))]})]}),e.jsx("span",{className:"font-bold text-xl text-primary",children:k?b.format(k.basePrice):" "})]}),e.jsx("p",{className:"text-sm text-slate-700 mb-3 whitespace-pre-wrap",children:v.notes||o("treatmentRecordList.noNotes")}),v.inventoryItemsUsed.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral rounded-lg",children:[e.jsxs("p",{className:"font-semibold text-sm text-slate-700 mb-1",children:[o("treatmentRecordList.materialsUsed"),":"]}),e.jsx("ul",{className:"list-disc list-inside text-xs text-slate-600 space-y-1",children:v.inventoryItemsUsed.map((C,w)=>{const j=m.find(D=>D.id===C.inventoryItemId);return e.jsxs("li",{children:[j?.name||o("common.unknownMaterial")," x ",C.quantity," (",b.format(C.cost),")"]},w)})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 text-sm font-medium",children:[e.jsx("button",{onClick:()=>y(v),className:"bg-amber-500 text-white px-3 py-1 rounded-lg hover:bg-amber-600 text-xs focus:outline-none focus:ring-2 focus:ring-amber-400",children:o("common.edit")}),e.jsxs("div",{className:"flex",children:[e.jsxs("p",{className:"text-blue-700 me-4",children:[o("addTreatmentRecord.doctorShare"),": ",e.jsx("strong",{className:"text-base",children:b.format(v.doctorShare)})]}),e.jsxs("p",{className:"text-green-700",children:[o("addTreatmentRecord.clinicShare"),": ",e.jsx("strong",{className:"text-base",children:b.format(v.clinicShare)})]})]})]})]},v.id)})}),h&&e.jsx(Db,{record:h,onClose:()=>y(null),onUpdate:v=>{n(a.id,v),y(null)},clinicData:s})]})},np=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Ib=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 12H4"})}),Rb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),Ab=({patientId:a,onClose:s,onAdd:n,clinicData:o})=>{const{t:i,locale:c}=Ve(),{addNotification:u}=At(),{dentists:m,treatmentDefinitions:h,inventoryItems:y,updateInventoryItem:b}=o,[f,x]=q.useState({dentistId:"",treatmentDate:new Date().toISOString().split("T")[0],treatmentDefinitionId:"",notes:"",selectedInventoryItems:[],affectedTeeth:[],labId:""}),v=q.useMemo(()=>h.find(I=>I.id===f.treatmentDefinitionId),[f.treatmentDefinitionId,h]),N=q.useMemo(()=>{let I=0;const _=[];f.selectedInventoryItems.forEach(re=>{const le=y.find(he=>he.id===re.inventoryItemId);if(le&&re.quantity>0){const he=le.unitCost*re.quantity;I+=he,_.push({inventoryItemId:re.inventoryItemId,quantity:re.quantity,cost:he})}});const A=v?.basePrice||0,Q=A*(v?.doctorPercentage||0),G=A*(v?.clinicPercentage||0)-I;return{doctorShare:Q,clinicShare:G,itemsUsedForRecord:_}},[f.selectedInventoryItems,y,v]),k=I=>{const{name:_,value:A}=I.target;x(Q=>({...Q,[_]:A}))},C=I=>{x(_=>_.selectedInventoryItems.some(A=>A.inventoryItemId===I)?_:{..._,selectedInventoryItems:[..._.selectedInventoryItems,{inventoryItemId:I,quantity:1}]})},w=(I,_)=>{x(A=>({...A,selectedInventoryItems:A.selectedInventoryItems.map(Q=>Q.inventoryItemId===I?{...Q,quantity:Math.max(0,_)}:Q)}))},j=I=>{x(_=>({..._,selectedInventoryItems:_.selectedInventoryItems.filter(A=>A.inventoryItemId!==I)}))},D=I=>{if(I.preventDefault(),!f.dentistId||!f.treatmentDefinitionId){u(i("addTreatmentRecord.alertFillFields"),ve.ERROR);return}if(f.selectedInventoryItems.forEach(_=>{const A=y.find(Q=>Q.id===_.inventoryItemId);A&&b({...A,currentStock:A.currentStock-_.quantity})}),f.labId){const _={patientId:a,labId:f.labId,caseType:v?.name||"Treatment Case",sentDate:f.treatmentDate,dueDate:new Date(new Date(f.treatmentDate).getTime()+6048e5).toISOString().split("T")[0],returnDate:"",status:nr.DRAFT,labCost:0,notes:f.notes||""};o.addLabCase(_)}n({dentistId:f.dentistId,treatmentDate:f.treatmentDate,treatmentDefinitionId:f.treatmentDefinitionId,notes:f.notes,inventoryItemsUsed:N.itemsUsedForRecord,doctorShare:N.doctorShare,clinicShare:N.clinicShare,affectedTeeth:f.affectedTeeth})},M=new Intl.NumberFormat(c,{style:"currency",currency:"EGP"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i("addTreatmentRecord.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(np,{})})]}),e.jsxs("form",{onSubmit:D,className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"treatmentDate",className:"block text-sm font-medium text-slate-600",children:i("addTreatmentRecord.date")}),e.jsx("input",{id:"treatmentDate",name:"treatmentDate",type:"date",value:f.treatmentDate,onChange:k,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dentistId",className:"block text-sm font-medium text-slate-600",children:i("addTreatmentRecord.dentist")}),e.jsxs("select",{id:"dentistId",name:"dentistId",value:f.dentistId,onChange:k,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:i("addTreatmentRecord.selectDentist")}),m.map(I=>e.jsx("option",{value:I.id,children:I.name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"treatmentDefinitionId",className:"block text-sm font-medium text-slate-600",children:i("addTreatmentRecord.treatment")}),e.jsxs("select",{id:"treatmentDefinitionId",name:"treatmentDefinitionId",value:f.treatmentDefinitionId,onChange:k,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:i("addTreatmentRecord.selectTreatment")}),h.map(I=>e.jsxs("option",{value:I.id,children:[I.name," (",M.format(I.basePrice),")"]},I.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"labId",className:"block text-sm font-medium text-slate-600",children:[i("labCases.dentalLab")," (",i("common.optional"),")"]}),e.jsxs("select",{id:"labId",name:"labId",value:f.labId,onChange:k,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:i("labCases.selectDentalLab")}),o.suppliers.filter(I=>I.type==="Dental Lab").map(I=>e.jsx("option",{value:I.id,children:I.name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-slate-600",children:i("addTreatmentRecord.notes")}),e.jsx("textarea",{id:"notes",name:"notes",value:f.notes,onChange:k,placeholder:i("addTreatmentRecord.notesPlaceholder"),className:"mt-1 p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"affectedTeeth",className:"block text-sm font-medium text-slate-600",children:i("addTreatmentRecord.affectedTeeth")}),e.jsx("select",{id:"affectedTeeth",multiple:!0,value:f.affectedTeeth,onChange:I=>{const _=Array.from(I.target.selectedOptions,A=>A.value);x(A=>({...A,affectedTeeth:_}))},className:"mt-1 p-2 border border-slate-300 rounded-lg w-full h-32 focus:ring-primary focus:border-primary",children:[...Array.from({length:8},(I,_)=>`UR${_+1}`),...Array.from({length:8},(I,_)=>`UL${_+1}`),...Array.from({length:8},(I,_)=>`LL${_+1}`),...Array.from({length:8},(I,_)=>`LR${_+1}`)].map(I=>e.jsx("option",{value:I,children:I},I))}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:i("addTreatmentRecord.affectedTeethHelp")})]}),e.jsxs("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700 mb-2",children:i("addTreatmentRecord.inventoryItemsUsed")}),e.jsx("div",{className:"space-y-2 mb-4",children:f.selectedInventoryItems.map(I=>{const _=y.find(A=>A.id===I.inventoryItemId);return _?e.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded-lg shadow-sm",children:[e.jsx("p",{className:"flex-1 text-sm text-slate-700",children:_.name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{type:"button",onClick:()=>w(I.inventoryItemId,I.quantity-1),className:"p-1 rounded-full bg-slate-200 hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("addTreatmentRecord.decreaseQuantityAria",{itemName:_.name}),children:e.jsx(Ib,{})}),e.jsx("input",{type:"number",min:"0",value:I.quantity,onChange:A=>w(I.inventoryItemId,parseFloat(A.target.value)),className:"w-16 text-center border border-slate-300 rounded-lg p-1 text-sm focus:ring-primary focus:border-primary","aria-label":i("addTreatmentRecord.quantityAria",{itemName:_.name})}),e.jsx("button",{type:"button",onClick:()=>w(I.inventoryItemId,I.quantity+1),className:"p-1 rounded-full bg-slate-200 hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("addTreatmentRecord.increaseQuantityAria",{itemName:_.name}),children:e.jsx(Rb,{})})]}),e.jsx("button",{type:"button",onClick:()=>j(I.inventoryItemId),className:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-300","aria-label":i("addTreatmentRecord.removeItemAria",{itemName:_.name}),children:e.jsx(np,{})})]},I.inventoryItemId):null})}),e.jsx("label",{htmlFor:"add-inventory-item",className:"sr-only",children:i("addTreatmentRecord.addItem")}),e.jsxs("select",{id:"add-inventory-item",onChange:I=>C(I.target.value),value:"",className:"p-2 border border-slate-300 rounded-lg w-full text-slate-600 focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:i("addTreatmentRecord.addItemPlaceholder")}),y.filter(I=>!f.selectedInventoryItems.some(_=>_.inventoryItemId===I.id)).map(I=>e.jsxs("option",{value:I.id,children:[I.name," (",i("addTreatmentRecord.stock"),": ",I.currentStock,")"]},I.id))]})]}),e.jsxs("div",{className:"bg-neutral p-4 rounded-lg space-y-2 shadow-inner",children:[e.jsx("h3",{className:"text-md font-semibold text-slate-700",children:i("addTreatmentRecord.costSummary")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("addTreatmentRecord.baseTreatmentPrice"),":"]})," ",M.format(v?.basePrice||0)]}),e.jsxs("p",{className:"text-sm text-blue-700",children:[i("addTreatmentRecord.doctorShare"),": ",e.jsx("strong",{className:"text-base",children:M.format(N.doctorShare)})]}),e.jsxs("p",{className:"text-sm text-green-700",children:[i("addTreatmentRecord.clinicShare"),": ",e.jsx("strong",{className:"text-base",children:M.format(N.clinicShare)})]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("addTreatmentRecord.saveRecord")})]})]})]})})},Ob=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Mb=({patientId:a,clinicData:s,onClose:n,onAdd:o})=>{const{t:i}=Ve(),{addNotification:c}=At(),[u,m]=q.useState({patientId:a,date:new Date().toISOString().split("T")[0],amount:0,method:"Cash",notes:"",treatmentRecordId:"",clinicShare:0,doctorShare:0}),h=f=>{const{name:x,value:v}=f.target;m(N=>({...N,[x]:x==="amount"?parseFloat(v):v}))},y=f=>{if(f.preventDefault(),u.amount<=0){c(i("addPaymentModal.alertPositiveAmount"),ve.ERROR);return}if(!u.treatmentRecordId){c("Please select a treatment record",ve.ERROR);return}const v=s.treatmentRecords.filter(w=>w.patientId===a).reduce((w,j)=>{const D=s.treatmentDefinitions.find(M=>M.id===j.treatmentDefinitionId);return w+(D?D.basePrice:0)},0),N=s.payments.filter(w=>w.patientId===a).reduce((w,j)=>w+j.amount,0),k=v-N;if(k<=0){c("     ",ve.ERROR);return}if(u.amount>k){c(`    : ${k.toFixed(2)}`,ve.ERROR);return}const C=s.treatmentRecords.find(w=>w.id===u.treatmentRecordId);if(C){const w=s.treatmentDefinitions.find(j=>j.id===C.treatmentDefinitionId);if(w){const j=u.amount*w.doctorPercentage,D=u.amount-j;u.clinicShare=D,u.doctorShare=j}}o(u),n()},b=["Cash","Credit Card","Bank Transfer","Other","Discount"];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i("addPaymentModal.title")}),e.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(Ob,{})})]}),e.jsxs("form",{onSubmit:y,className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addPaymentModal.paymentDate")}),e.jsx("input",{id:"paymentDate",name:"date",type:"date",value:u.date,onChange:h,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addPaymentModal.amount")}),e.jsx("input",{id:"amount",name:"amount",type:"number",step:"0.01",value:u.amount,onChange:h,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,min:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"treatmentRecord",className:"block text-sm font-medium text-slate-600 mb-1",children:"Treatment Record"}),e.jsxs("select",{id:"treatmentRecord",name:"treatmentRecordId",value:u.treatmentRecordId,onChange:h,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:"Select a treatment record"}),s.treatmentRecords.filter(f=>f.patientId===a).map(f=>{const x=s.treatmentDefinitions.find(v=>v.id===f.treatmentDefinitionId);return e.jsxs("option",{value:f.id,children:[x?.name||"Unknown Treatment"," - ",new Date(f.treatmentDate).toLocaleDateString()]},f.id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addPaymentModal.paymentMethod")}),e.jsx("select",{id:"paymentMethod",name:"method",value:u.method,onChange:h,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:b.filter(f=>f!=="Discount").map(f=>e.jsx("option",{value:f,children:i(`paymentMethod.${f}`)},f))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addPaymentModal.notes")}),e.jsx("textarea",{id:"notes",name:"notes",value:u.notes||"",onChange:h,placeholder:i("addPaymentModal.notesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("addPaymentModal.savePayment")})]})]})]})})},Lb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Fb=({patientId:a,clinicData:s,onClose:n,onAdd:o})=>{const{t:i}=Ve(),{addNotification:c}=At(),[u,m]=q.useState({patientId:a,date:new Date().toISOString().split("T")[0],amount:0,method:"Discount",notes:"",treatmentRecordId:"",clinicShare:0,doctorShare:0}),[h,y]=q.useState(""),b=x=>{const{name:v,value:N}=x.target;v==="amount"?m(k=>({...k,[v]:parseFloat(N)})):v==="approvalPassword"?y(N):m(k=>({...k,[v]:N}))},f=x=>{if(x.preventDefault(),u.amount<=0){c(i("addPaymentModal.alertPositiveAmount"),ve.WARNING);return}const N=s.treatmentRecords.filter(w=>w.patientId===a).reduce((w,j)=>{const D=s.treatmentDefinitions.find(M=>M.id===j.treatmentDefinitionId);return w+(D?D.basePrice:0)},0),k=s.payments.filter(w=>w.patientId===a).reduce((w,j)=>w+j.amount,0),C=N-k;if(C<=0){c("     ",ve.ERROR);return}if(u.amount>C){c(`    : ${C.toFixed(2)}`,ve.ERROR);return}if(h!=="123"){c(i("addDiscountModal.passwordIncorrect"),ve.ERROR);return}o(u),n(),c(i("notifications.discountAdded"),ve.SUCCESS)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i("addDiscountModal.title")}),e.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(Lb,{})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"discountAmount",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDiscountModal.amount")}),e.jsx("input",{id:"discountAmount",name:"amount",type:"number",step:"0.01",value:u.amount,onChange:b,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,min:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"discountNotes",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDiscountModal.notes")}),e.jsx("textarea",{id:"discountNotes",name:"notes",value:u.notes||"",onChange:b,placeholder:i("addDiscountModal.notes"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"approvalPassword",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDiscountModal.password")}),e.jsx("input",{id:"approvalPassword",name:"approvalPassword",type:"password",value:h,onChange:b,placeholder:i("addDiscountModal.passwordPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("addDiscountModal.saveDiscount")})]})]})]})})},Kr=(a,s)=>{console.log("openPrintWindow called with title:",a);const n=window.open("","_blank","height=800,width=1000");if(!n){console.error("Failed to open print window - popup blocked or failed"),alert("Please allow popups for this website to print reports.");return}console.log("Print window opened successfully"),n.document.title=a,n.document.write(`
        <!DOCTYPE html>
        <html dir="rtl" lang="ar">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>${a}</title>
            <script src="https://cdn.tailwindcss.com"><\/script>
            <script>
                tailwind.config = {
                    corePlugins: {
                        preflight: false,
                    }
                }
            <\/script>
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap');
                body {
                    font-family: 'Cairo', sans-serif;
                    direction: rtl;
                    margin: 0;
                    padding: 20px;
                    background-color: white;
                }
                @media print {
                    body {
                        margin: 0;
                        padding: 10mm;
                    }
                    .no-print { display: none; }
                }
                /* Ensure Arabic text renders properly */
                * {
                    text-rendering: optimizeLegibility;
                    box-sizing: border-box;
                }
                /* Force RTL for all elements */
                * {
                    direction: rtl !important;
                }
                .print-content {
                    min-height: 100vh;
                    background-color: white;
                }
            </style>
        </head>
        <body>
            <div id="print-root" class="print-content">
                <div id="print-content" class="min-h-screen bg-white p-4">
                    <div class="text-center py-10">
                        <p class="text-lg">   ...</p>
                        <div class="mt-4">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"></div>
                        </div>
                    </div>
                </div>
            </div>
        </body>
        </html>
    `),n.document.close(),setTimeout(()=>{console.log("Setting up print content rendering...");const o=n.document.getElementById("print-root");if(!o){console.error("Failed to create print root element");return}console.log("Print root element found"),o.innerHTML='<div id="print-content" class="min-h-screen bg-white"></div>';const i=n.document.getElementById("print-content");if(!i){console.error("Failed to create content root element");return}const c=Yp.createRoot(i);console.log("React root created, rendering component..."),c.render(e.jsx(Jd.StrictMode,{children:e.jsx(Vf,{children:e.jsx(Kf,{children:e.jsx(Yf,{children:s})})})})),console.log("Component rendered successfully");const u=(m=0)=>{try{console.log(`Starting print content check, attempt ${m+1}`);const h=n.document.getElementById("print-content")||n.document.getElementById("prescription-print-content")||n.document.getElementById("print-root"),y=h&&(h.innerHTML.includes('data-prescription-loaded="true"')||h.innerHTML.includes("prescription-print-content")||h.innerHTML.includes("PrintablePrescription")||h.innerHTML.includes("")||h.innerHTML.includes("  ")||h.children.length>0&&!h.innerHTML.includes(" ")||h.innerHTML.length>100&&!h.innerHTML.includes(" "));console.log(`Print check attempt ${m+1}:`,{contentFound:!!h,contentId:h?.id,innerHTMLLength:h?.innerHTML?.length||0,hasChildren:h?.children?.length||0,hasPrescriptionContent:y,innerHTML:h?.innerHTML?.substring(0,200)+"..."}),y?(console.log("Print content loaded successfully:",h.innerHTML.length,"characters"),console.log("Triggering print dialog..."),setTimeout(()=>{n.focus(),n.print(),console.log("Print dialog triggered")},500)):m<30?(console.warn("Print content not loaded yet, retrying..."),setTimeout(()=>u(m+1),500)):(console.error("Print content failed to load after maximum attempts"),console.error("Final content state:",h?.innerHTML),alert("    .    ."))}catch(h){console.error("Print failed:",h),alert("   .    .")}};setTimeout(()=>{console.log("Starting print content check..."),u()},2e3)},200)},$b=`
@media print {
  @page {
    size: A4;
    margin: 1cm;
  }
  body {
    font-size: 12pt;
    line-height: 1.4;
  }
  .text-4xl { font-size: 24pt; }
  .text-3xl { font-size: 20pt; }
  .text-2xl { font-size: 16pt; }
  .text-xl { font-size: 14pt; }
  .text-md { font-size: 12pt; }
  .text-sm { font-size: 10pt; }
  .p-8 { padding: 20pt; }
  .p-6 { padding: 15pt; }
  .p-4 { padding: 10pt; }
  .p-3 { padding: 8pt; }
  .p-2 { padding: 5pt; }
  .mb-10 { margin-bottom: 25pt; }
  .mb-4 { margin-bottom: 10pt; }
  .mb-2 { margin-bottom: 5pt; }
  .mt-12 { margin-top: 30pt; }
  .mt-6 { margin-top: 15pt; }
  .mt-4 { margin-top: 10pt; }
  .mt-2 { margin-top: 5pt; }
  .border { border-width: 1pt; }
  .border-b { border-bottom-width: 1pt; }
  .border-collapse { border-collapse: collapse; }
  .break-inside-avoid { break-inside: avoid; }
}
`,Ub=({patient:a,clinicData:s})=>{const{t:n,locale:o}=Ve(),{treatmentRecords:i,payments:c,treatmentDefinitions:u,dentists:m,clinicInfo:h}=s,y=new Intl.DateTimeFormat(o,{year:"numeric",month:"long",day:"numeric"}),b=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),f=q.useMemo(()=>i.filter(N=>N.patientId===a.id).sort((N,k)=>new Date(N.treatmentDate).getTime()-new Date(k.treatmentDate).getTime()),[i,a.id]),x=q.useMemo(()=>c.filter(N=>N.patientId===a.id).sort((N,k)=>new Date(N.date).getTime()-new Date(k.date).getTime()),[c,a.id]),v=q.useMemo(()=>{const N=f.reduce((w,j)=>w+j.totalTreatmentCost,0),k=x.reduce((w,j)=>w+j.amount,0),C=N-k;return{totalCharges:N,totalPaid:k,outstandingBalance:C}},[f,x]);return e.jsxs("div",{className:"p-8 bg-white text-slate-900 min-h-screen",dir:"rtl",children:[e.jsx("style",{children:$b}),e.jsxs("header",{className:"flex justify-between items-start mb-10",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800",children:h.name||n("appName")}),e.jsx("p",{className:"text-md text-slate-600",children:h.address||n("patientReport.clinicAddress")}),e.jsx("p",{className:"text-sm text-slate-600",children:h.phone&&`Phone: ${h.phone}`}),e.jsx("p",{className:"text-sm text-slate-600",children:h.email&&`Email: ${h.email}`})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-dark mb-2",children:n("patientInvoice.title")}),e.jsxs("p",{className:"text-md text-slate-700",children:[e.jsxs("strong",{children:[n("patientInvoice.invoiceNumber"),":"]})," ",a.id,"-INV-",new Date().getFullYear()]}),e.jsxs("p",{className:"text-md text-slate-700",children:[e.jsxs("strong",{children:[n("patientInvoice.date"),":"]})," ",y.format(new Date)]})]})]}),e.jsxs("section",{className:"mb-10 p-6 border rounded-lg bg-neutral-light shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:n("patientInvoice.billTo")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.name"),":"]})," ",a.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.phone"),":"]})," ",a.phone]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.dob"),":"]})," ",y.format(new Date(a.dob))]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.email"),":"]})," ",a.email||"-"]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("strong",{children:[n("patientReport.demographics.address"),":"]})," ",a.address||"-"]})]})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4",children:n("patientInvoice.treatmentDetails")}),f.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.date")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.treatment")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.dentist")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.cost")})]})}),e.jsxs("tbody",{children:[f.map(N=>{const k=u.find(w=>w.id===N.treatmentDefinitionId),C=m.find(w=>w.id===N.dentistId);return e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(new Date(N.treatmentDate))}),e.jsx("td",{className:"p-3 border border-slate-300",children:k?.name||n("common.unknownTreatment")}),e.jsx("td",{className:"p-3 border border-slate-300",children:C?.name||n("common.unknownDentist")}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format(N.totalTreatmentCost)})]},N.id)}),e.jsxs("tr",{className:"bg-slate-50 font-bold",children:[e.jsxs("td",{colSpan:3,className:"p-3 text-right border border-slate-300",children:[n("financials.totalCharges"),":"]}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format(v.totalCharges)})]})]})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("patientReport.treatmentHistory.noRecords")})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4",children:n("patientInvoice.paymentDetails")}),x.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.paymentDate")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.paymentMethod")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.notes")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.amount")})]})}),e.jsxs("tbody",{children:[x.map(N=>e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(new Date(N.date))}),e.jsx("td",{className:"p-3 border border-slate-300",children:n(`paymentMethod.${N.method}`)}),e.jsx("td",{className:"p-3 border border-slate-300",children:N.notes||"-"}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format(N.amount)})]},N.id)),e.jsxs("tr",{className:"bg-slate-50 font-bold",children:[e.jsxs("td",{colSpan:3,className:"p-3 text-right border border-slate-300",children:[n("financials.totalPaid"),":"]}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format(v.totalPaid)})]})]})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("patientReport.financials.noPayments")})]}),e.jsx("section",{className:"flex justify-end mt-12 mb-10",children:e.jsxs("div",{className:"w-full max-w-sm p-6 bg-blue-50 rounded-lg shadow-md border-primary-light",children:[e.jsx("h3",{className:"text-xl font-bold text-primary-dark mb-4",children:n("patientInvoice.balanceDue")}),e.jsx("p",{className:"text-4xl font-extrabold text-primary-dark",children:b.format(v.outstandingBalance)})]})}),e.jsxs("footer",{className:"text-center mt-12 text-slate-600 text-sm",children:[e.jsx("p",{className:"mb-2",children:n("patientInvoice.thankYou")}),e.jsx("p",{children:n("patientReport.footer")})]})]})},Bb=`
@media print {
  @page {
    size: A4;
    margin: 1cm;
  }
  body {
    font-size: 12pt;
    line-height: 1.4;
  }
  .text-4xl { font-size: 24pt; }
  .text-3xl { font-size: 20pt; }
  .text-2xl { font-size: 16pt; }
  .text-xl { font-size: 14pt; }
  .text-md { font-size: 12pt; }
  .text-sm { font-size: 10pt; }
  .p-8 { padding: 20pt; }
  .p-6 { padding: 15pt; }
  .p-4 { padding: 10pt; }
  .p-3 { padding: 8pt; }
  .p-2 { padding: 5pt; }
  .mb-10 { margin-bottom: 25pt; }
  .mb-4 { margin-bottom: 10pt; }
  .mb-2 { margin-bottom: 5pt; }
  .mt-12 { margin-top: 30pt; }
  .mt-6 { margin-top: 15pt; }
  .mt-4 { margin-top: 10pt; }
  .mt-2 { margin-top: 5pt; }
  .border { border-width: 1pt; }
  .border-b { border-bottom-width: 1pt; }
  .border-collapse { border-collapse: collapse; }
  .break-inside-avoid { break-inside: avoid; }
}
`,qb=({patient:a,clinicData:s})=>{const{t:n,locale:o}=Ve(),{treatmentRecords:i,payments:c,treatmentDefinitions:u,dentists:m,clinicInfo:h}=s,y=new Intl.DateTimeFormat(o,{year:"numeric",month:"long",day:"numeric"}),b=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),f=q.useMemo(()=>i.filter(C=>C.patientId===a.id).sort((C,w)=>new Date(C.treatmentDate).getTime()-new Date(w.treatmentDate).getTime()),[i,a.id]),x=q.useMemo(()=>c.filter(C=>C.patientId===a.id).sort((C,w)=>new Date(C.date).getTime()-new Date(w.date).getTime()),[c,a.id]),v=q.useMemo(()=>{const C=f.reduce((D,M)=>D+((M.doctorShare||0)+(M.clinicShare||0)),0),w=x.reduce((D,M)=>D+(M.amount||0),0),j=C-w;return{totalCharges:C,totalPaid:w,outstandingBalance:j}},[f,x]),N={[ft.HEALTHY]:0,[ft.FILLING]:0,[ft.CROWN]:0,[ft.MISSING]:0,[ft.IMPLANT]:0,[ft.ROOT_CANAL]:0,[ft.CAVITY]:0};for(const C in a.dentalChart){const w=a.dentalChart[C].status;N.hasOwnProperty(w)&&N[w]++}const k=q.useMemo(()=>{const C=[],w=Object.entries(N).filter(([,j])=>j>0);return w.length>0?w.forEach(([j,D])=>{D>0&&C.push(`${n(`toothStatus.${j}`)}: ${D}`)}):C.push(n("patientReport.dentalChart.allHealthy")),C},[N,n]);return e.jsxs("div",{className:"p-8 bg-white text-slate-900 min-h-screen",dir:"rtl",children:[e.jsx("style",{children:Bb}),e.jsxs("header",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-2",children:h.name||n("appName")}),e.jsx("p",{className:"text-md text-slate-600",children:h.address||n("patientReport.clinicAddress")}),e.jsx("p",{className:"text-sm text-slate-600",children:h.phone&&`Phone: ${h.phone}`}),e.jsx("p",{className:"text-sm text-slate-600",children:h.email&&`Email: ${h.email}`}),e.jsx("h2",{className:"text-3xl font-bold text-primary-dark mt-6 mb-2",children:n("patientReport.title")}),e.jsx("p",{className:"text-md text-slate-700",children:n("patientReport.generatedOn",{date:y.format(new Date)})})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.demographics.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.name"),":"]})," ",a.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.phone"),":"]})," ",a.phone]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.dob"),":"]})," ",y.format(new Date(a.dob))]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.email"),":"]})," ",a.email||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.demographics.gender"),":"]})," ",n(a.gender.toLowerCase())]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("strong",{children:[n("patientReport.demographics.address"),":"]})," ",a.address||"-"]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.emergencyAndInsurance.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.emergencyContactName"),":"]})," ",a.emergencyContactName||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.emergencyContactPhone"),":"]})," ",a.emergencyContactPhone||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.emergencyAndInsurance.insuranceProvider"),":"]})," ",a.insuranceProvider||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.emergencyAndInsurance.policyNumber"),":"]})," ",a.insurancePolicyNumber||"-"]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.medicalInfo.title")}),e.jsxs("div",{className:"space-y-3 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.medicalInfo.allergies"),":"]})," ",e.jsx("span",{className:"whitespace-pre-wrap",children:a.allergies||n("common.na")})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.medicalInfo.medications"),":"]})," ",e.jsx("span",{className:"whitespace-pre-wrap",children:a.medications||n("common.na")})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientReport.medicalInfo.medicalHistory"),":"]})," ",e.jsx("span",{className:"whitespace-pre-wrap",children:a.medicalHistory||n("common.na")})]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("patientDetails.unstructuredNotes"),":"]})," ",e.jsx("span",{className:"whitespace-pre-wrap",children:a.treatmentNotes||n("common.na")})]})]})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.dentalChart.title")}),e.jsxs("div",{className:"space-y-2 text-md text-slate-700",children:[k.map((C,w)=>e.jsx("p",{children:C},w)),e.jsxs("table",{className:"w-full text-sm border-collapse border border-slate-400 mt-4",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:n("patientReport.dentalChart.tooth")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:n("patientReport.dentalChart.status")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:n("patientReport.dentalChart.notes")})]})}),e.jsxs("tbody",{children:[Object.entries(a.dentalChart).filter(([,C])=>C.status!==ft.HEALTHY||C.notes).map(([C,w])=>e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:C}),e.jsx("td",{className:"p-2 border border-slate-300",children:n(`toothStatus.${w.status}`)}),e.jsx("td",{className:"p-2 border border-slate-300",children:w.notes||"-"})]},C)),Object.entries(a.dentalChart).filter(([,C])=>C.status===ft.HEALTHY&&!C.notes).length===Object.keys(a.dentalChart).length&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-2 text-center text-slate-500 border border-slate-300",children:n("patientReport.dentalChart.allHealthy")})})]})]})]})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.treatmentHistory.title")}),f.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.date")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.treatment")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.dentist")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.treatmentHistory.cost")})]})}),e.jsx("tbody",{children:f.map(C=>{const w=u.find(D=>D.id===C.treatmentDefinitionId),j=m.find(D=>D.id===C.dentistId);return e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(new Date(C.treatmentDate))}),e.jsx("td",{className:"p-3 border border-slate-300",children:w?.name||n("common.unknownTreatment")}),e.jsx("td",{className:"p-3 border border-slate-300",children:j?.name||n("common.unknownDentist")}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format((C.doctorShare||0)+(C.clinicShare||0))})]},C.id)})})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("patientReport.treatmentHistory.noRecords")})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("patientReport.financials.title")}),x.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.paymentDate")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.paymentMethod")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.notes")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("patientReport.financials.amount")})]})}),e.jsx("tbody",{children:x.map(C=>e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(new Date(C.date))}),e.jsx("td",{className:"p-3 border border-slate-300",children:n(`paymentMethod.${C.method}`)}),e.jsx("td",{className:"p-3 border border-slate-300",children:C.notes||"-"}),e.jsx("td",{className:"p-3 border border-slate-300",children:b.format(C.amount)})]},C.id))})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("patientReport.financials.noPayments")}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("div",{className:"w-full max-w-sm p-4 bg-neutral-light rounded-lg shadow-sm border border-slate-200",children:[e.jsxs("p",{className:"text-md text-slate-700",children:[e.jsxs("strong",{children:[n("financials.totalCharges"),":"]})," ",b.format(v.totalCharges)]}),e.jsxs("p",{className:"text-md text-slate-700",children:[e.jsxs("strong",{children:[n("financials.totalPaid"),":"]})," ",b.format(v.totalPaid)]}),e.jsxs("p",{className:"text-xl font-bold text-primary-dark mt-2",children:[e.jsxs("strong",{children:[n("financials.outstandingBalance"),":"]})," ",b.format(v.outstandingBalance)]})]})})]}),e.jsx("footer",{className:"text-center mt-12 text-slate-600 text-sm",children:e.jsx("p",{children:n("patientReport.footer")})})]})},zb=()=>{const a={};return["UR","UL","LL","LR"].forEach(n=>{for(let o=1;o<=8;o++)a[`${n}${o}`]={status:ft.HEALTHY,notes:""}}),a},ul=()=>{const{user:a}=Ss(),{addNotification:s}=At(),[n,o]=q.useState([]),[i,c]=q.useState([]),[u,m]=q.useState([]),[h,y]=q.useState([]),[b,f]=q.useState([]),[x,v]=q.useState([]),[N,k]=q.useState([]),[C,w]=q.useState([]),[j,D]=q.useState([]),[M,I]=q.useState([]),[_,A]=q.useState([]),[Q,G]=q.useState([]),[re,le]=q.useState([]),[he,P]=q.useState([]),L=q.useCallback(async()=>{if(console.log("useClinicData fetchData called - user:",!!a,"supabase:",!!me),!a||!me){console.log("useClinicData fetchData early return - missing prerequisites"),console.log("useClinicData fetchData prerequisites check:",{user:!!a,supabase:!!me,userId:a?.id});return}console.log("useClinicData: Fetching data from all tables");const fe=["patients","dentists","appointments","suppliers","inventory_items","expenses","treatment_definitions","treatment_records","lab_cases","payments","supplier_invoices","doctor_payments","prescriptions","prescription_items"].map(lt=>me.from(lt).select("*")),oe=await Promise.all(fe),[ne,Ee,ie,qe,Te,Ue,tt,ze,pt,rt,yt,at,Kt,kr]=oe;if(console.log("Data fetch results:",{patients:ne.data?.length||0,dentists:Ee.data?.length||0,appointments:ie.data?.length||0,suppliers:qe.data?.length||0,inventoryItems:Te.data?.length||0,expenses:Ue.data?.length||0,treatmentDefinitions:tt.data?.length||0,treatmentRecords:ze.data?.length||0,labCases:pt.data?.length||0,payments:rt.data?.length||0,supplierInvoices:yt.data?.length||0,doctorPayments:at.data?.length||0,prescriptions:Kt.data?.length||0,prescriptionItems:kr.data?.length||0}),ie.data&&(console.log("Appointments data sample:",ie.data.slice(0,2)),console.log("Appointments columns check:",Object.keys(ie.data[0]||{})),ie.data[0]&&!("reminder_sent"in ie.data[0])&&console.error("CRITICAL: reminder_sent column missing from appointments table response")),ie.error&&console.error("Appointments fetch error:",ie.error),ne.data){console.log("Setting patients data:",ne.data.length);const lt=ne.data.map(de=>({id:de.id,name:de.name,dob:de.dob,gender:de.gender,phone:de.phone,email:de.email,address:de.address,medicalHistory:de.medical_history,treatmentNotes:de.treatment_notes,lastVisit:de.last_visit,allergies:de.allergies,medications:de.medications,insuranceProvider:de.insurance_provider,insurancePolicyNumber:de.insurance_policy_number,emergencyContactName:de.emergency_contact_name,emergencyContactPhone:de.emergency_contact_phone,dentalChart:de.dental_chart,images:de.images}));o(lt)}if(Ee.data&&(console.log("Setting dentists data:",Ee.data.length),c(Ee.data)),ie.data){console.log("Setting appointments data:",ie.data.length);const lt=ie.data.map(de=>({id:de.id,patientId:de.patient_id,dentistId:de.dentist_id,startTime:new Date(de.start_time),endTime:new Date(de.end_time),reason:de.reason,status:de.status,reminderTime:de.reminder_time,reminderSent:de.reminder_sent,userId:de.user_id,createdAt:de.created_at,updatedAt:de.updated_at}));m(lt)}if(qe.data&&(console.log("Setting suppliers data:",qe.data.length),y(qe.data)),Te.data){console.log("Setting inventory items data:",Te.data.length);const lt=Te.data.map(de=>({id:de.id,name:de.name,description:de.description,supplierId:de.supplier_id,currentStock:de.current_stock,unitCost:de.unit_cost,minStockLevel:de.min_stock_level,expiryDate:de.expiry_date}));f(lt)}if(Ue.data){console.log("Setting expenses data:",Ue.data.length);const lt=Ue.data.map(de=>({id:de.id,date:de.date,description:de.description,amount:de.amount,category:de.category,supplierId:de.supplier_id,supplierInvoiceId:de.supplier_invoice_id}));v(lt)}if(tt.data){console.log("Setting treatment definitions data:",tt.data.length);const lt=tt.data.map(de=>({id:de.id,name:de.name,description:de.description,basePrice:Number(de.base_price)||0,doctorPercentage:Number(de.doctor_percentage)||0,clinicPercentage:Number(de.clinic_percentage)||0}));k(lt)}if(ze.data){console.log("Setting treatment records data:",ze.data.length);const lt=ze.data.map(de=>({id:de.id,patientId:de.patient_id,dentistId:de.dentist_id,treatmentDate:de.treatment_date,treatmentDefinitionId:de.treatment_definition_id,notes:de.notes,inventoryItemsUsed:de.inventory_items_used,doctorShare:de.doctor_share,clinicShare:de.clinic_share,affectedTeeth:de.affected_teeth}));w(lt)}if(pt.data){console.log("Setting lab cases data:",pt.data.length);const lt=pt.data.map(de=>({id:de.id,patientId:de.patient_id,labId:de.lab_id,caseType:de.case_type,sentDate:de.sent_date,dueDate:de.due_date,returnDate:de.return_date,status:de.status,labCost:de.lab_cost,notes:de.notes}));D(lt)}if(rt.data){console.log("Setting payments data:",rt.data.length);const lt=rt.data.map(de=>({id:de.id,patientId:de.patient_id,date:de.date,amount:de.amount,method:de.method,notes:de.notes,treatmentRecordId:de.treatment_record_id,clinicShare:de.clinic_share,doctorShare:de.doctor_share}));I(lt)}if(yt.data){console.log("Setting supplier invoices data:",yt.data.length);const lt=yt.data.map(de=>({id:de.id,supplierId:de.supplier_id,invoiceNumber:de.invoice_number,invoiceDate:de.invoice_date,dueDate:de.due_date,amount:de.amount,status:de.status,items:de.items,invoiceImageUrl:de.invoice_image_url,payments:de.payments}));A(lt)}if(at.data){console.log("Setting doctor payments data:",at.data.length);const lt=at.data.map(de=>({id:de.id,dentistId:de.dentist_id,amount:de.amount,date:de.date,notes:de.notes}));G(lt)}if(Kt.data){console.log("Setting prescriptions data:",Kt.data.length);const lt=Kt.data.map(de=>({id:de.id,patientId:de.patient_id,dentistId:de.dentist_id,prescriptionDate:de.prescription_date,notes:de.notes,userId:de.user_id,createdAt:de.created_at,updatedAt:de.updated_at}));le(lt)}if(kr.data){console.log("Setting prescription items data:",kr.data.length);const lt=kr.data.map(de=>({id:de.id,prescriptionId:de.prescription_id,medicationName:de.medication_name,dosage:de.dosage,quantity:de.quantity,instructions:de.instructions,userId:de.user_id,createdAt:de.created_at,updatedAt:de.updated_at}));P(lt)}const Qr=oe.find(lt=>lt.error);Qr?(console.error("Error fetching data:",Qr),s(Qr?.error?.message||"Unknown error occurred",ve.ERROR)):console.log("All data fetched successfully")},[a,s]);q.useEffect(()=>{console.log("useClinicData useEffect triggered - supabase:",!!me,"user:",!!a),me&&a?(console.log("useClinicData: Calling fetchData from useEffect"),L()):(console.log("useClinicData: not calling fetchData due to missing prerequisites"),console.log("useClinicData useEffect prerequisites check:",{supabase:!!me,user:!!a,userId:a?.id}))},[L,a]),q.useEffect(()=>{(async()=>{if(!a||!me)return;const{data:fe,error:oe}=await me.from("clinic_settings").select("*").single();!oe&&fe?(console.log("Loading clinic settings from database:",fe),fe.clinic_info&&setClinicInfo(fe.clinic_info),fe.whatsapp_message_template&&setWhatsappMessageTemplate(fe.whatsapp_message_template),fe.reminder_message_template&&setReminderMessageTemplate(fe.reminder_message_template)):console.log("No clinic settings found in database, using defaults")})()},[a,me]);const z=async(H,fe,oe)=>{if(!me)return;const{id:ne,...Ee}=fe;console.log(`Updating data in table: ${H}`,{id:ne,updateData:Ee});const{error:ie}=await me.from(H).update(Ee).eq("id",ne);ie?(console.error(`Error updating data in ${H}:`,ie),s(ie.message,ve.ERROR)):(console.log(`Successfully updated data in ${H} for id: ${ne}`),oe(qe=>qe.map(Te=>Te.id===ne?fe:Te)),await L())},ee=async(H,fe,oe)=>{if(!me)return;console.log(`Deleting data from table: ${H}`,{id:fe});const{error:ne}=await me.from(H).delete().eq("id",fe);ne?(console.error(`Error deleting data from ${H}:`,ne),s(ne.message,ve.ERROR)):(console.log(`Successfully deleted data from ${H} for id: ${fe}`),oe(Ee=>Ee.filter(ie=>ie.id!==fe)),await L())},se=async H=>{await ee("patients",H,o)},Y=async H=>{await ee("dentists",H,c)},xe=async H=>{await ee("appointments",H,m)},ce=async H=>{await ee("suppliers",H,y)},B=async H=>{await ee("inventory_items",H,f)},F=async H=>{await ee("expenses",H,v)},ue=async H=>{await ee("treatment_definitions",H,k)},We=async H=>{await ee("treatment_records",H,w)},Ye=async H=>{await ee("lab_cases",H,D)},Qe=async H=>{await ee("payments",H,I)},Ne=async H=>{await ee("supplier_invoices",H,A)},Pe=async H=>{await ee("doctor_payments",H,G)},pe=async H=>{await ee("prescriptions",H,le)},Ce=async H=>{await ee("prescription_items",H,P)},Ie=async H=>{if(!a||!me)return;const fe={dentist_id:H.dentistId,amount:H.amount,date:H.date,notes:H.notes||null};console.log("Adding doctor payment with data:",fe);const{data:oe,error:ne}=await me.from("doctor_payments").insert(fe).select();if(ne)console.error("Error adding doctor payment:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),s(ne.message,ve.ERROR);else if(oe){console.log("Successfully added doctor payment:",oe);const Ee=oe.map(ie=>({id:ie.id,dentistId:ie.dentist_id,amount:ie.amount,date:ie.date,notes:ie.notes}));G(ie=>[...ie,...Ee])}},nt=async H=>{if(!me)return;const{id:fe,dentistId:oe,amount:ne,date:Ee,notes:ie}=H,qe={dentist_id:oe,amount:ne,date:Ee,notes:ie||null};console.log("Updating doctor payment data:",{id:fe,supabaseData:qe});const{error:Te}=await me.from("doctor_payments").update(qe).eq("id",fe);Te?(console.error("Error updating doctor payment:",Te),console.error("Error details:",Te.details,Te.hint,Te.code),s(Te.message,ve.ERROR)):(console.log(`Successfully updated doctor payment for id: ${fe}`),G(Ue=>Ue.map(tt=>tt.id===fe?H:tt)))},et=async H=>{if(!a||!me){console.error("User not authenticated or Supabase not configured"),s("User not authenticated",ve.ERROR);return}const fe={name:H.name,dob:H.dob,gender:H.gender,phone:H.phone,email:H.email||null,address:H.address||null,medical_history:H.medicalHistory||null,treatment_notes:H.treatmentNotes||null,last_visit:H.lastVisit||null,allergies:H.allergies||null,medications:H.medications||null,insurance_provider:H.insuranceProvider||null,insurance_policy_number:H.insurancePolicyNumber||null,emergency_contact_name:H.emergencyContactName||null,emergency_contact_phone:H.emergencyContactPhone||null,dental_chart:zb(),images:H.images||[],user_id:a.id};console.log("User ID:",a.id),console.log("Adding patient with data:",JSON.stringify(fe,null,2));const{data:oe,error:ne}=await me.from("patients").insert(fe).select();if(ne)console.error("Supabase error:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(`Failed to add patient: ${ne.message}`,ve.ERROR);else if(oe){console.log("Raw response from Supabase:",oe);const Ee=oe.map(ie=>({id:ie.id,name:ie.name,dob:ie.dob,gender:ie.gender,phone:ie.phone,email:ie.email,address:ie.address,medicalHistory:ie.medical_history,treatmentNotes:ie.treatment_notes,lastVisit:ie.last_visit,allergies:ie.allergies,medications:ie.medications,insuranceProvider:ie.insurance_provider,insurancePolicyNumber:ie.insurance_policy_number,emergencyContactName:ie.emergency_contact_name,emergencyContactPhone:ie.emergency_contact_phone,dentalChart:ie.dental_chart,images:ie.images}));o(ie=>[...ie,...Ee]),s("Patient added successfully",ve.SUCCESS)}},Nt=async H=>{if(!me)return;const{id:fe,name:oe,dob:ne,gender:Ee,phone:ie,email:qe,address:Te,medicalHistory:Ue,treatmentNotes:tt,lastVisit:ze,allergies:pt,medications:rt,insuranceProvider:yt,insurancePolicyNumber:at,emergencyContactName:Kt,emergencyContactPhone:kr,dentalChart:Qr,images:lt}=H,de={name:oe,dob:ne,gender:Ee,phone:ie,email:qe||null,address:Te||null,medical_history:Ue||null,treatment_notes:tt||null,last_visit:ze||null,allergies:pt||null,medications:rt||null,insurance_provider:yt||null,insurance_policy_number:at||null,emergency_contact_name:Kt||null,emergency_contact_phone:kr||null,dental_chart:Qr,images:lt||[]};console.log("useClinicData: updatePatient called with patient:",H),console.log("useClinicData: dentalChart data:",Qr),console.log("useClinicData: supabaseData:",de);const{error:Ut}=await me.from("patients").update(de).eq("id",fe);Ut?(console.error("Error updating patient:",Ut),console.error("Error details:",Ut.details,Ut.hint,Ut.code),s(Ut.message,ve.ERROR)):(console.log(`Successfully updated patient for id: ${fe}`),o(Es=>Es.map(ln=>ln.id===fe?H:ln)),await L())},He=async H=>{if(!a||!me)return;console.log("Adding doctor with data:",{...H,user_id:a.id});const{data:fe,error:oe}=await me.from("dentists").insert({...H,user_id:a.id}).select();oe?(console.error("Error adding doctor:",oe),console.error("Error details:",oe.details,oe.hint,oe.code),s(oe.message,ve.ERROR)):fe&&(console.log("Successfully added doctor:",fe),c(ne=>[...ne,...fe]))},ct=async H=>{await z("dentists",H,c)},pr=async H=>{if(!a||!me)return;const{patientId:fe,dentistId:oe,startTime:ne,endTime:Ee,reminderTime:ie,reason:qe,status:Te}=H,Ue={reason:qe,status:Te,patient_id:fe,dentist_id:oe,start_time:ne,end_time:Ee,reminder_time:ie,user_id:a.id};console.log("Adding appointment with data:",JSON.stringify(Ue,null,2));const{data:tt,error:ze}=await me.from("appointments").insert(Ue).select("*");if(ze?console.error("Add appointment error details:",{code:ze.code,message:ze.message,details:ze.details,hint:ze.hint}):tt&&console.log("Add appointment success - returned columns:",Object.keys(tt[0]||{})),ze)console.error("Error adding appointment:",ze),console.error("Error details:",ze.details,ze.hint,ze.code),s(ze.message,ve.ERROR);else if(tt){console.log("Successfully added appointment:",tt);const pt=tt.map(rt=>({id:rt.id,patientId:rt.patient_id,dentistId:rt.dentist_id,startTime:new Date(rt.start_time),endTime:new Date(rt.end_time),reason:rt.reason,status:rt.status,reminderTime:rt.reminder_time,reminderSent:!1,userId:rt.user_id,createdAt:rt.created_at,updatedAt:rt.updated_at}));m(rt=>[...rt,...pt])}},fr=async H=>{if(!a||!me)return;const{id:fe,patientId:oe,dentistId:ne,startTime:Ee,endTime:ie,reminderTime:qe,reminderSent:Te,...Ue}=H,tt={...Ue,patient_id:oe,dentist_id:ne,start_time:Ee,end_time:ie,reminder_time:qe},{error:ze}=await me.from("appointments").update(tt).eq("id",fe).select("*");ze?console.error("Update appointment error details:",{code:ze.code,message:ze.message,details:ze.details,hint:ze.hint}):console.log("Update appointment success"),ze?s(ze.message,ve.ERROR):m(pt=>pt.map(rt=>rt.id===fe?H:rt))},rn=async(H,fe)=>{if(!a||!me)return;const{dentistId:oe,treatmentDate:ne,treatmentDefinitionId:Ee,notes:ie,inventoryItemsUsed:qe,doctorShare:Te,clinicShare:Ue,affectedTeeth:tt}=fe,ze={patient_id:H,dentist_id:oe,treatment_date:ne,treatment_definition_id:Ee,notes:ie||null,inventory_items_used:qe,doctor_share:Number(Te)||0,clinic_share:Number(Ue)||0,affected_teeth:tt||[],user_id:a.id};console.log("Adding treatment record with data:",ze);const{data:pt,error:rt}=await me.from("treatment_records").insert(ze).select();if(rt)console.error("Error adding treatment record:",rt),console.error("Error details:",rt.details,rt.hint,rt.code),s(rt.message,ve.ERROR);else if(pt){console.log("Successfully added treatment record:",pt);const yt=pt.map(at=>({id:at.id,patientId:at.patient_id,dentistId:at.dentist_id,treatmentDate:at.treatment_date,treatmentDefinitionId:at.treatment_definition_id,notes:at.notes,inventoryItemsUsed:at.inventory_items_used,doctorShare:at.doctor_share,clinicShare:at.clinic_share,affectedTeeth:at.affected_teeth}));w(at=>[...at,...yt])}},ls=async(H,fe)=>{if(!me)return;const{id:oe,patientId:ne,dentistId:Ee,treatmentDate:ie,treatmentDefinitionId:qe,notes:Te,inventoryItemsUsed:Ue,doctorShare:tt,clinicShare:ze,affectedTeeth:pt}=fe,rt={patient_id:ne,dentist_id:Ee,treatment_date:ie,treatment_definition_id:qe,notes:Te||null,inventory_items_used:Ue,doctor_share:Number(tt)||0,clinic_share:Number(ze)||0,affected_teeth:pt||[]};console.log("Updating treatment record data:",{id:oe,supabaseData:rt});const{error:yt}=await me.from("treatment_records").update(rt).eq("id",oe);yt?(console.error("Error updating treatment record:",yt),console.error("Error details:",yt.details,yt.hint,yt.code),s(yt.message,ve.ERROR)):(console.log(`Successfully updated treatment record for id: ${oe}`),w(at=>at.map(Kt=>Kt.id===oe?fe:Kt)))},Jr=async H=>{if(!a||!me)return;let fe=0,oe=0;if(H.treatmentRecordId){const qe=C.find(Te=>Te.id===H.treatmentRecordId);if(qe){const Te=N.find(Ue=>Ue.id===qe.treatmentDefinitionId);Te&&(oe=H.amount*Te.doctorPercentage,fe=H.amount-oe)}}const ne={patient_id:H.patientId,date:H.date,amount:H.amount,method:H.method,notes:H.notes||null,treatment_record_id:H.treatmentRecordId||null,clinic_share:fe,doctor_share:oe,user_id:a.id};console.log("Adding payment with data:",ne);const{data:Ee,error:ie}=await me.from("payments").insert(ne).select();if(ie)console.error("Error adding payment:",ie),console.error("Error details:",ie.details,ie.hint,ie.code),s(ie.message,ve.ERROR);else if(Ee){console.log("Successfully added payment:",Ee);const qe=Ee.map(Te=>({id:Te.id,patientId:Te.patient_id,date:Te.date,amount:Te.amount,method:Te.method,notes:Te.notes,treatmentRecordId:Te.treatment_record_id,clinicShare:Te.clinic_share,doctorShare:Te.doctor_share}));if(I(Te=>[...Te,...qe]),oe>0&&H.treatmentRecordId){const Te=C.find(Ue=>Ue.id===H.treatmentRecordId);if(Te){const Ue={dentistId:Te.dentistId,amount:oe,date:H.date,notes:`Payment share from treatment on ${new Date(Te.treatmentDate).toLocaleDateString()}`};await Ie(Ue)}}}},sn=async H=>{if(!me)return;const{id:fe,patientId:oe,date:ne,amount:Ee,method:ie,notes:qe}=H,Te={patient_id:oe,date:ne,amount:Ee,method:ie,notes:qe||null};console.log("Updating payment data:",{id:fe,supabaseData:Te});const{error:Ue}=await me.from("payments").update(Te).eq("id",fe);Ue?(console.error("Error updating payment:",Ue),console.error("Error details:",Ue.details,Ue.hint,Ue.code),s(Ue.message,ve.ERROR)):(console.log(`Successfully updated payment for id: ${fe}`),I(tt=>tt.map(ze=>ze.id===fe?H:ze)))},nn=async H=>{if(!a||!me)return;const fe={name:H.name,contact_person:H.contactPerson||null,phone:H.phone||null,email:H.email||null,type:H.type,user_id:a.id};console.log("Adding supplier with data:",fe);const{data:oe,error:ne}=await me.from("suppliers").insert(fe).select();ne?(console.error("Error adding supplier:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR)):oe&&(console.log("Successfully added supplier:",oe),y(Ee=>[...Ee,...oe]),s("Supplier added successfully",ve.SUCCESS))},$n=async H=>{await z("suppliers",H,y)},Aa=async H=>{if(!a||!me)return;const fe={name:H.name,description:H.description||null,supplier_id:H.supplierId||null,current_stock:Number(H.currentStock)||0,unit_cost:Number(H.unitCost)||0,min_stock_level:Number(H.minStockLevel)||0,expiry_date:H.expiryDate||null,user_id:a.id};console.log("Adding inventory item with data:",JSON.stringify(fe,null,2));const{data:oe,error:ne}=await me.from("inventory_items").insert(fe).select();if(ne)console.error("Error adding inventory item:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR);else if(oe){console.log("Successfully added inventory item:",oe);const Ee=oe.map(ie=>({id:ie.id,name:ie.name,description:ie.description,supplierId:ie.supplier_id,currentStock:ie.current_stock,unitCost:ie.unit_cost,minStockLevel:ie.min_stock_level,expiryDate:ie.expiry_date}));f(ie=>[...ie,...Ee]),s("Inventory item added successfully",ve.SUCCESS)}},te=async H=>{if(!me)return;const{id:fe,name:oe,description:ne,supplierId:Ee,currentStock:ie,unitCost:qe,minStockLevel:Te,expiryDate:Ue}=H,tt={name:oe,description:ne||null,supplier_id:Ee||null,current_stock:Number(ie)||0,unit_cost:Number(qe)||0,min_stock_level:Number(Te)||0,expiry_date:Ue||null};console.log("Updating inventory item data:",{id:fe,supabaseData:tt});const{error:ze}=await me.from("inventory_items").update(tt).eq("id",fe);ze?(console.error("Error updating inventory item:",ze),console.error("Error details:",ze.details,ze.hint,ze.code),s(ze.message,ve.ERROR)):(console.log(`Successfully updated inventory item for id: ${fe}`),f(pt=>pt.map(rt=>rt.id===fe?H:rt)))},Xe=async H=>{if(!a||!me)return;const fe={date:H.date,description:H.description,amount:Number(H.amount)||0,category:H.category,supplier_id:H.supplierId||null,supplier_invoice_id:H.supplierInvoiceId||null,user_id:a.id};console.log("Adding expense with data:",fe);const{data:oe,error:ne}=await me.from("expenses").insert(fe).select();if(ne)console.error("Error adding expense:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR);else if(oe&&(console.log("Successfully added expense:",oe),v(Ee=>[...Ee,...oe]),s("Expense added successfully",ve.SUCCESS),H.supplierInvoiceId)){const Ee=oe[0].id,{data:ie,error:qe}=await me.from("supplier_invoices").select("*").eq("id",H.supplierInvoiceId).single();if(ie){const Te=[...ie.payments||[],{expenseId:Ee,amount:H.amount,date:H.date}];await z("supplier_invoices",{...ie,payments:Te},A)}}};return{patients:n,addPatient:et,updatePatient:Nt,deletePatient:se,dentists:i,addDoctor:He,updateDoctor:ct,deleteDoctor:Y,appointments:u,addAppointment:pr,updateAppointment:fr,deleteAppointment:xe,suppliers:h,addSupplier:nn,updateSupplier:$n,deleteSupplier:ce,inventoryItems:b,addInventoryItem:Aa,updateInventoryItem:te,deleteInventoryItem:B,expenses:x,addExpense:Xe,updateExpense:async H=>{await z("expenses",H,v)},deleteExpense:F,treatmentDefinitions:N,addTreatmentDefinition:async H=>{if(!a||!me)return;const fe={name:H.name,description:H.description||null,base_price:Number(H.basePrice)||0,doctor_percentage:Number(H.doctorPercentage)||0,clinic_percentage:Number(H.clinicPercentage)||0,user_id:a.id};console.log("Adding treatment definition with data:",fe);const{data:oe,error:ne}=await me.from("treatment_definitions").insert(fe).select();if(ne)console.error("Error adding treatment definition:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR);else if(oe){console.log("Successfully added treatment definition:",oe);const Ee=oe.map(ie=>({id:ie.id,name:ie.name,description:ie.description,basePrice:Number(ie.base_price)||0,doctorPercentage:Number(ie.doctor_percentage)||0,clinicPercentage:Number(ie.clinic_percentage)||0}));k(ie=>[...ie,...Ee]),s("Treatment definition added successfully",ve.SUCCESS)}},updateTreatmentDefinition:async H=>{if(!me)return;const{id:fe,name:oe,description:ne,basePrice:Ee,doctorPercentage:ie,clinicPercentage:qe}=H,Te={name:oe,description:ne||null,base_price:Number(Ee)||0,doctor_percentage:Number(ie)||0,clinic_percentage:Number(qe)||0};console.log("Updating treatment definition data:",{id:fe,supabaseData:Te});const{error:Ue}=await me.from("treatment_definitions").update(Te).eq("id",fe);Ue?(console.error("Error updating treatment definition:",Ue),console.error("Error details:",Ue.details,Ue.hint,Ue.code),s(Ue.message,ve.ERROR)):(console.log(`Successfully updated treatment definition for id: ${fe}`),k(tt=>tt.map(ze=>ze.id===fe?H:ze)))},deleteTreatmentDefinition:ue,treatmentRecords:C,addTreatmentRecord:rn,updateTreatmentRecord:ls,deleteTreatmentRecord:We,labCases:j,addLabCase:async H=>{if(!a||!me)return;const fe={patient_id:H.patientId,lab_id:H.labId,case_type:H.caseType,sent_date:H.sentDate,due_date:H.dueDate,return_date:H.returnDate||null,status:H.status,lab_cost:Number(H.labCost)||0,notes:H.notes||null,user_id:a.id};console.log("Adding lab case with data:",fe);const{data:oe,error:ne}=await me.from("lab_cases").insert(fe).select();if(ne)console.error("Error adding lab case:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR);else if(oe){console.log("Successfully added lab case:",oe);const Ee=oe.map(ie=>({id:ie.id,patientId:ie.patient_id,labId:ie.lab_id,caseType:ie.case_type,sentDate:ie.sent_date,dueDate:ie.due_date,returnDate:ie.return_date,status:ie.status,labCost:ie.lab_cost,notes:ie.notes}));D(ie=>[...ie,...Ee]),s("Lab case added successfully",ve.SUCCESS)}},updateLabCase:async H=>{if(!me)return;const{id:fe,patientId:oe,labId:ne,caseType:Ee,sentDate:ie,dueDate:qe,returnDate:Te,status:Ue,labCost:tt,notes:ze}=H,pt={patient_id:oe,lab_id:ne,case_type:Ee,sent_date:ie,due_date:qe,return_date:Te||null,status:Ue,lab_cost:Number(tt)||0,notes:ze||null};console.log("Updating lab case data:",{id:fe,supabaseData:pt});const{error:rt}=await me.from("lab_cases").update(pt).eq("id",fe);rt?(console.error("Error updating lab case:",rt),console.error("Error details:",rt.details,rt.hint,rt.code),s(rt.message,ve.ERROR)):(console.log(`Successfully updated lab case for id: ${fe}`),D(yt=>yt.map(at=>at.id===fe?H:at)))},deleteLabCase:Ye,payments:M,addPayment:Jr,updatePayment:sn,deletePayment:Qe,supplierInvoices:_,addSupplierInvoice:async H=>{if(!a||!me)return;const fe={supplier_id:H.supplierId,invoice_number:H.invoiceNumber||null,invoice_date:H.invoiceDate,due_date:H.dueDate||null,amount:Number(H.amount)||0,status:H.status,items:H.items||[],invoice_image_url:H.invoiceImageUrl||null,payments:[],user_id:a.id};console.log("Adding supplier invoice with data:",fe);const{data:oe,error:ne}=await me.from("supplier_invoices").insert(fe).select();ne?(console.error("Error adding supplier invoice:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),console.error("Full error object:",JSON.stringify(ne,null,2)),s(ne.message,ve.ERROR)):oe&&(console.log("Successfully added supplier invoice:",oe),A(Ee=>[...Ee,...oe]),s("Supplier invoice added successfully",ve.SUCCESS))},updateSupplierInvoice:async H=>{await z("supplier_invoices",H,A)},deleteSupplierInvoice:Ne,paySupplierInvoice:async H=>{if(!me)return;const fe=H.payments.reduce((Ee,ie)=>Ee+ie.amount,0),oe=H.amount-fe;if(oe<=0)return;const ne={date:new Date().toISOString().split("T")[0],description:`Payment for invoice #${H.invoiceNumber||H.id.slice(-4)}`,amount:oe,category:Gr.SUPPLIES,supplierId:H.supplierId,supplierInvoiceId:H.id};await Xe(ne)},doctorPayments:Q,addDoctorPayment:Ie,updateDoctorPayment:nt,deleteDoctorPayment:Pe,prescriptions:re,addPrescription:async H=>{if(!a||!me)return[];const fe={patient_id:H.patientId,dentist_id:H.dentistId,prescription_date:H.prescriptionDate,notes:H.notes||null,user_id:a.id};console.log("Adding prescription with data:",fe);const{data:oe,error:ne}=await me.from("prescriptions").insert(fe).select();if(ne)return console.error("Error adding prescription:",ne),console.error("Error details:",ne.details,ne.hint,ne.code),s(ne.message,ve.ERROR),[];if(oe){console.log("Successfully added prescription:",oe);const Ee=oe.map(ie=>({id:ie.id,patientId:ie.patient_id,dentistId:ie.dentist_id,prescriptionDate:ie.prescription_date,notes:ie.notes,userId:ie.user_id,createdAt:ie.created_at,updatedAt:ie.updated_at}));return le(ie=>[...ie,...Ee]),s("Prescription added successfully",ve.SUCCESS),Ee}return[]},updatePrescription:async H=>{if(!me)return;const{id:fe,patientId:oe,dentistId:ne,prescriptionDate:Ee,notes:ie}=H,qe={patient_id:oe,dentist_id:ne,prescription_date:Ee,notes:ie||null};console.log("Updating prescription data:",{id:fe,supabaseData:qe});const{error:Te}=await me.from("prescriptions").update(qe).eq("id",fe);Te?(console.error("Error updating prescription:",Te),console.error("Error details:",Te.details,Te.hint,Te.code),s(Te.message,ve.ERROR)):(console.log(`Successfully updated prescription for id: ${fe}`),le(Ue=>Ue.map(tt=>tt.id===fe?H:tt)),s("Prescription updated successfully",ve.SUCCESS))},deletePrescription:pe,prescriptionItems:he,addPrescriptionItem:async(H,fe)=>{if(!a||!me)return;const oe={prescription_id:H,medication_name:fe.medicationName,dosage:fe.dosage||null,quantity:fe.quantity,instructions:fe.instructions||null,user_id:a.id};console.log("Adding prescription item with data:",oe);const{data:ne,error:Ee}=await me.from("prescription_items").insert(oe).select();if(Ee)console.error("Error adding prescription item:",Ee),console.error("Error details:",Ee.details,Ee.hint,Ee.code),s(Ee.message,ve.ERROR);else if(ne){console.log("Successfully added prescription item:",ne);const ie=ne.map(qe=>({id:qe.id,prescriptionId:qe.prescription_id,medicationName:qe.medication_name,dosage:qe.dosage,quantity:qe.quantity,instructions:qe.instructions,userId:qe.user_id,createdAt:qe.created_at,updatedAt:qe.updated_at}));P(qe=>[...qe,...ie]),s("Prescription item added successfully",ve.SUCCESS)}},updatePrescriptionItem:async H=>{if(!me)return;const{id:fe,prescriptionId:oe,medicationName:ne,dosage:Ee,quantity:ie,instructions:qe}=H,Te={prescription_id:oe,medication_name:ne,dosage:Ee||null,quantity:ie,instructions:qe||null};console.log("Updating prescription item data:",{id:fe,supabaseData:Te});const{error:Ue}=await me.from("prescription_items").update(Te).eq("id",fe);Ue?(console.error("Error updating prescription item:",Ue),console.error("Error details:",Ue.details,Ue.hint,Ue.code),s(Ue.message,ve.ERROR)):(console.log(`Successfully updated prescription item for id: ${fe}`),P(tt=>tt.map(ze=>ze.id===fe?H:ze)),s("Prescription item updated successfully",ve.SUCCESS))},deletePrescriptionItem:Ce,restoreData:async H=>{if(console.warn("Restoring from local file will not sync to the cloud."),!(!a||!me))try{const fe=["patients","dentists","appointments","suppliers","inventory_items","expenses","treatment_definitions","treatment_records","lab_cases","payments","supplier_invoices"];for(const oe of fe)await me.from(oe).delete().eq("user_id",a.id);if(H.patients)for(const oe of H.patients){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("patients").insert(ne)}if(H.dentists)for(const oe of H.dentists){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("dentists").insert(ne)}if(H.appointments)for(const oe of H.appointments){const{patientId:ne,dentistId:Ee,startTime:ie,endTime:qe,reminderTime:Te,reminderSent:Ue,...tt}=oe,ze={...tt,patient_id:ne,dentist_id:Ee,start_time:ie,end_time:qe,reminder_time:Te,reminder_sent:Ue||!1,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("appointments").insert(ze)}if(H.suppliers)for(const oe of H.suppliers){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("suppliers").insert(ne)}if(H.inventoryItems)for(const oe of H.inventoryItems){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("inventory_items").insert(ne)}if(H.expenses)for(const oe of H.expenses){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("expenses").insert(ne)}if(H.treatmentDefinitions)for(const oe of H.treatmentDefinitions){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("treatment_definitions").insert(ne)}if(H.treatmentRecords)for(const oe of H.treatmentRecords){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("treatment_records").insert(ne)}if(H.labCases)for(const oe of H.labCases){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("lab_cases").insert(ne)}if(H.payments)for(const oe of H.payments){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("payments").insert(ne)}if(H.supplierInvoices)for(const oe of H.supplierInvoices){const ne={...oe,id:oe.id.startsWith("sample-")?void 0:oe.id,user_id:a.id};await me.from("supplier_invoices").insert(ne)}await L()}catch(fe){console.error("Restore failed:",fe),s("Failed to restore data",ve.ERROR)}}}},Hb=()=>e.jsx("style",{children:`
    @media print {
      @page {
        size: A4;
        margin: 1cm;
      }
      body {
        font-size: 12px;
        line-height: 1.4;
      }
      .print-header {
        margin-bottom: 1.5rem;
        page-break-after: avoid;
      }
      .print-section {
        margin-bottom: 1rem;
        page-break-inside: avoid;
      }
      table {
        font-size: 10px;
      }
      h1 {
        font-size: 18px;
      }
      h2, h3, h4 {
        font-size: 14px;
      }
    }
  `}),Wb=({prescription:a,patient:s,prescriptionItems:n,dentist:o})=>{const{t:i,locale:c}=Ve(),{clinicInfo:u}=ul(),m=new Intl.DateTimeFormat(c,{year:"numeric",month:"long",day:"numeric"});return console.log("PrintablePrescription rendering:",{prescription:a,patient:s,prescriptionItems:n,dentist:o,clinicInfo:u}),console.log("Prescription data validation:",{hasPrescription:!!a,hasPatient:!!s,hasDentist:!!o,prescriptionItemsCount:n?.length||0}),!a||!s||!o?(console.error("Missing required data for prescription print:",{prescription:a,patient:s,dentist:o}),console.error("Detailed missing data check:",{prescriptionId:a?.id,patientId:s?.id,dentistId:o?.id,prescriptionExists:!!a,patientExists:!!s,dentistExists:!!o}),e.jsx("div",{className:"p-4 bg-white text-slate-900 min-h-screen",dir:"rtl",id:"prescription-print-content",children:e.jsxs("div",{className:"text-center py-10",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"   "}),e.jsx("p",{className:"text-slate-700 mb-2",children:"   :"}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-1",children:[e.jsxs("li",{children:[": ",a?" ":" "]}),e.jsxs("li",{children:[": ",s?" ":" "]}),e.jsxs("li",{children:[": ",o?" ":" "]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-4",children:"      "})]})})):e.jsxs(e.Fragment,{children:[e.jsx(Hb,{}),e.jsxs("div",{className:"p-4 bg-white text-slate-900 min-h-screen",dir:"rtl",id:"prescription-print-content","data-prescription-loaded":"true",children:[e.jsxs("header",{className:"print-header text-center mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-1",children:u?.name||i("appName")}),e.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[u?.address&&e.jsx("p",{children:u.address}),e.jsxs("div",{className:"flex justify-center gap-4",children:[u?.phone&&e.jsxs("span",{children:[i("common.phone"),": ",u.phone]}),u?.email&&e.jsxs("span",{children:[i("common.email"),": ",u.email]})]})]})]}),e.jsx("h2",{className:"text-xl font-semibold text-slate-700 mb-2",children:i("prescriptionDetails.title")}),e.jsxs("p",{className:"text-md text-slate-600",children:[i("prescriptionDetails.prescriptionId"),": ",a.id.slice(-8)]})]}),e.jsx("main",{children:e.jsxs("div",{className:"print-section space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:i("prescriptionDetails.patientInfo")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("prescriptionDetails.patientName"),":"]})," ",s.name]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("prescriptionDetails.patientId"),":"]})," ",s.id.slice(-8)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("prescriptionDetails.patientPhone"),":"]})," ",s.phone]})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:i("prescriptionDetails.prescriptionInfo")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("prescriptionDetails.dentist"),":"]})," ",o?.name||i("common.unknownDentist")]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[i("prescriptionDetails.date"),":"]})," ",m.format(new Date(a.prescriptionDate))]})]})]}),a.notes&&e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:i("prescriptionDetails.notes")}),e.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.notes})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-4",children:i("prescriptionDetails.medications")}),n.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:i("prescriptionDetails.noMedications")}):e.jsx("div",{className:"space-y-4",children:n.map((h,y)=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:h.medicationName}),e.jsxs("span",{className:"text-sm text-slate-500",children:["#",y+1]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[h.dosage&&e.jsxs("div",{children:[e.jsxs("strong",{className:"text-slate-600",children:[i("prescriptionDetails.dosage"),":"]}),e.jsx("p",{className:"text-slate-800",children:h.dosage})]}),e.jsxs("div",{children:[e.jsxs("strong",{className:"text-slate-600",children:[i("prescriptionDetails.quantity"),":"]}),e.jsx("p",{className:"text-slate-800",children:h.quantity})]}),h.instructions&&e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("strong",{className:"text-slate-600",children:[i("prescriptionDetails.instructions"),":"]}),e.jsx("p",{className:"text-slate-800",children:h.instructions})]})]})]},h.id))})]}),e.jsx("div",{className:"mt-8 pt-4 border-t border-slate-200 text-center",children:e.jsx("p",{className:"text-sm text-slate-600",children:i("prescriptionDetails.footerNote")})})]})})]})]})},Vb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Gb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Kb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),Jb=({prescription:a,patient:s,prescriptions:n,prescriptionItems:o,dentists:i,onClose:c,onUpdate:u})=>{const{t:m,locale:h}=Ve(),y=new Intl.DateTimeFormat(h,{year:"numeric",month:"long",day:"numeric"}),b=i.find(v=>v.id===a.dentistId),f=o.filter(v=>v.prescriptionId===a.id),x=()=>{if(console.log("handlePrint called for prescription:",a.id),!b){console.error("No dentist found for prescription:",a.dentistId);return}console.log("Dentist found:",b.name),console.log("Prescription items:",f.length);const v=`${m("prescriptionDetails.title")} - ${s.name}`;console.log("Opening print window with title:",v),Kr(v,e.jsx(Wb,{prescription:a,patient:s,prescriptionItems:f,dentist:b}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-700",children:[m("prescriptionDetails.title")," #",a.id.slice(-8)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u&&e.jsxs("button",{onClick:()=>u(a),className:"flex items-center px-3 py-1 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-slate-300",children:[e.jsx(Gb,{})," ",m("common.edit")]}),e.jsxs("button",{onClick:x,className:"flex items-center px-3 py-1 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-slate-300",children:[e.jsx(Kb,{})," ",m("common.print")]}),e.jsx("button",{onClick:c,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":m("prescriptionDetails.closeAriaLabel"),children:e.jsx(Vb,{})})]})]}),e.jsxs("main",{className:"p-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:m("prescriptionDetails.patientInfo")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.patientName"),":"]})," ",s.name]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.patientId"),":"]})," ",s.id.slice(-8)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.patientPhone"),":"]})," ",s.phone]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:m("prescriptionDetails.prescriptionInfo")}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.dentist"),":"]})," ",b?.name||m("common.unknownDentist")]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.date"),":"]})," ",y.format(new Date(a.prescriptionDate))]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("strong",{children:[m("prescriptionDetails.prescriptionId"),":"]})," ",a.id.slice(-8)]})]})]}),a.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:m("prescriptionDetails.notes")}),e.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.notes})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-4",children:m("prescriptionDetails.medications")}),f.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:m("prescriptionDetails.noMedications")}):e.jsx("div",{className:"space-y-4",children:f.map((v,N)=>e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-lg",children:v.medicationName}),e.jsxs("span",{className:"text-sm text-slate-500",children:["#",N+1]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[v.dosage&&e.jsxs("div",{children:[e.jsxs("strong",{className:"text-slate-600",children:[m("prescriptionDetails.dosage"),":"]}),e.jsx("p",{className:"text-slate-800",children:v.dosage})]}),e.jsxs("div",{children:[e.jsxs("strong",{className:"text-slate-600",children:[m("prescriptionDetails.quantity"),":"]}),e.jsx("p",{className:"text-slate-800",children:v.quantity})]}),v.instructions&&e.jsxs("div",{className:"md:col-span-3",children:[e.jsxs("strong",{className:"text-slate-600",children:[m("prescriptionDetails.instructions"),":"]}),e.jsx("p",{className:"text-slate-800",children:v.instructions})]})]})]},v.id))})]}),e.jsx("div",{className:"mt-8 pt-4 border-t border-slate-200 flex justify-end",children:e.jsx("button",{onClick:c,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:m("common.close")})})]})]})})},Yb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 absolute start-3 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Qb=({patients:a,prescriptions:s,prescriptionItems:n,dentists:o,onUpdatePrescription:i})=>{const{t:c,locale:u}=Ve(),{clinicInfo:m}=ul(),[h,y]=q.useState(null),[b,f]=q.useState(""),[x,v]=q.useState({startDate:"",endDate:"",dentistId:""}),N=new Intl.DateTimeFormat(u,{year:"numeric",month:"long",day:"numeric"}),k=q.useMemo(()=>{let j=s;if(b.trim()){const D=b.toLowerCase().trim();j=j.filter(M=>{const I=a.find(Q=>Q.id===M.patientId),_=o.find(Q=>Q.id===M.dentistId),A=n.filter(Q=>Q.prescriptionId===M.id);return I?.name.toLowerCase().includes(D)||_?.name.toLowerCase().includes(D)||A.some(Q=>Q.medicationName.toLowerCase().includes(D))||M.notes?.toLowerCase().includes(D)})}return x.startDate&&(j=j.filter(D=>new Date(D.prescriptionDate)>=new Date(x.startDate))),x.endDate&&(j=j.filter(D=>new Date(D.prescriptionDate)<=new Date(x.endDate))),x.dentistId&&(j=j.filter(D=>D.dentistId===x.dentistId)),j.sort((D,M)=>new Date(M.prescriptionDate).getTime()-new Date(D.prescriptionDate).getTime())},[s,a,o,n,b,x]),C=(j,D)=>{v(M=>({...M,[j]:D}))},w=()=>{v({startDate:"",endDate:"",dentistId:""}),f("")};return k.length===0&&s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-10",children:c("prescriptionList.noPrescriptions")}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:c("prescriptionList.searchAndFilters")}),e.jsx("button",{onClick:w,className:"text-sm text-slate-600 hover:text-slate-800 underline",children:c("financialFilters.clearAll")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Yb,{}),e.jsx("input",{type:"text",placeholder:c("prescriptionList.searchPlaceholder"),value:b,onChange:j=>f(j.target.value),className:"w-full p-3 ps-10 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start-date",className:"block text-sm font-medium text-slate-700 mb-2",children:c("financialFilters.startDate")}),e.jsx("input",{type:"date",id:"start-date",value:x.startDate,onChange:j=>C("startDate",j.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"end-date",className:"block text-sm font-medium text-slate-700 mb-2",children:c("financialFilters.endDate")}),e.jsx("input",{type:"date",id:"end-date",value:x.endDate,onChange:j=>C("endDate",j.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dentist-filter",className:"block text-sm font-medium text-slate-700 mb-2",children:c("prescriptionList.doctor")}),e.jsxs("select",{id:"dentist-filter",value:x.dentistId,onChange:j=>C("dentistId",j.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:[e.jsx("option",{value:"",children:c("prescriptionList.allDoctors")}),o.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[b&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[c("prescriptionList.search"),": ",b,e.jsx("button",{onClick:()=>f(""),className:"ml-2 text-blue-600 hover:text-blue-800",children:""})]}),x.startDate&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800",children:[c("financialFilters.startDate"),": ",new Date(x.startDate).toLocaleDateString(),e.jsx("button",{onClick:()=>C("startDate",""),className:"ml-2 text-green-600 hover:text-green-800",children:""})]}),x.endDate&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800",children:[c("financialFilters.endDate"),": ",new Date(x.endDate).toLocaleDateString(),e.jsx("button",{onClick:()=>C("endDate",""),className:"ml-2 text-green-600 hover:text-green-800",children:""})]}),x.dentistId&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-800",children:[c("prescriptionList.doctor"),": ",o.find(j=>j.id===x.dentistId)?.name,e.jsx("button",{onClick:()=>C("dentistId",""),className:"ml-2 text-purple-600 hover:text-purple-800",children:""})]})]})]}),e.jsx("div",{className:"space-y-4",children:k.length>0?k.map(j=>{const D=a.find(_=>_.id===j.patientId),M=o.find(_=>_.id===j.dentistId),I=n.filter(_=>_.prescriptionId===j.id);return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-slate-800 text-lg",children:[c("prescriptionList.prescription")," #",j.id.slice(-8)]}),e.jsxs("p",{className:"text-sm text-slate-600",children:[c("prescriptionList.patient"),": ",D?.name||c("common.unknownPatient")," |",M?.name||c("common.unknownDentist")," |",N.format(new Date(j.prescriptionDate))]})]}),e.jsxs("span",{className:"text-sm text-slate-500",children:[I.length," ",c("prescriptionList.items")]})]}),e.jsx("p",{className:"text-sm text-slate-700 mb-3 whitespace-pre-wrap",children:j.notes||c("prescriptionList.noNotes")}),I.length>0&&e.jsxs("div",{className:"mt-3 p-3 bg-neutral rounded-lg",children:[e.jsxs("p",{className:"font-semibold text-sm text-slate-700 mb-1",children:[c("prescriptionList.medications"),":"]}),e.jsx("ul",{className:"list-disc list-inside text-xs text-slate-600 space-y-1",children:I.map((_,A)=>e.jsxs("li",{children:[_.medicationName," - ",c("prescriptionList.quantity"),": ",_.quantity,_.dosage&&` (${c("prescriptionList.dosage")}: ${_.dosage})`,_.instructions&&` - ${_.instructions}`]},A))})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:()=>y(j),className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark text-xs focus:outline-none focus:ring-2 focus:ring-primary-light",children:c("common.viewDetails")})})]},j.id)}):e.jsx("p",{className:"text-center text-slate-500 py-10",children:s.length===0?c("prescriptionList.noPrescriptions"):c("prescriptionList.noPrescriptionsFound")})}),h&&e.jsx(Jb,{prescription:h,patient:a.find(j=>j.id===h.patientId),prescriptions:s,prescriptionItems:n,dentists:o,onClose:()=>y(null),onUpdate:i?j=>{i(h.patientId,j),y(null)}:void 0})]})},Xb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Zb=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),ev=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),tv=({prescription:a,prescriptionItems:s=[],patient:n,dentists:o,onClose:i,onSave:c})=>{const{t:u}=Ve(),{addNotification:m}=At(),[h,y]=q.useState({dentistId:a?.dentistId||o[0]?.id||"",prescriptionDate:a?.prescriptionDate||new Date().toISOString().split("T")[0],notes:a?.notes||"",totalCost:a?.totalCost||0}),[b,f]=q.useState(s);q.useEffect(()=>{if(a&&s.length===0){const w=[{id:"mock-1",prescriptionId:a.id,medicationName:"Amoxicillin",dosage:"500mg",quantity:20,unitCost:.5,instructions:"Take 3 times daily after meals",userId:"",createdAt:"",updatedAt:""},{id:"mock-2",prescriptionId:a.id,medicationName:"Ibuprofen",dosage:"200mg",quantity:30,unitCost:.3,instructions:"Take as needed for pain",userId:"",createdAt:"",updatedAt:""}];f(w)}},[a,s]);const x=w=>{const{name:j,value:D}=w.target;y(M=>({...M,[j]:D}))},v=()=>{const w={id:`temp-${Date.now()}`,prescriptionId:a?.id||"",medicationName:"",dosage:"",quantity:1,unitCost:0,instructions:"",userId:"",createdAt:"",updatedAt:""};f(j=>[...j,w])},N=(w,j,D)=>{f(M=>M.map((I,_)=>_===w?{...I,[j]:D}:I))},k=w=>{f(j=>j.filter((D,M)=>M!==w))},C=w=>{if(w.preventDefault(),!h.dentistId||!h.prescriptionDate){m(u("prescriptionModal.alertFillRequired"),ve.ERROR);return}if(h.dentistId===""){m(u("prescriptionModal.alertSelectDentist"),ve.ERROR);return}const j=b.filter(D=>D.medicationName.trim()&&D.quantity>0);if(j.length===0){m(u("prescriptionModal.alertAtLeastOneItem"),ve.ERROR);return}c(h,j)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:u(a?"prescriptionModal.editTitle":"prescriptionModal.title")}),e.jsx("button",{onClick:i,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":u("prescriptionModal.closeAriaLabel"),children:e.jsx(Xb,{})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 overflow-y-auto flex-1 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dentistId",className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.dentist")}),e.jsxs("select",{id:"dentistId",name:"dentistId",value:h.dentistId,onChange:x,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:u("prescriptionModal.selectDentist")}),o.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"prescriptionDate",className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.prescriptionDate")}),e.jsx("input",{id:"prescriptionDate",name:"prescriptionDate",type:"date",value:h.prescriptionDate,onChange:x,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.notes")}),e.jsx("textarea",{id:"notes",name:"notes",value:h.notes,onChange:x,placeholder:u("prescriptionModal.notesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:u("prescriptionModal.medications")}),e.jsxs("button",{type:"button",onClick:v,className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center gap-2 text-sm",children:[e.jsx(Zb,{}),u("prescriptionModal.addMedication")]})]}),e.jsx("div",{className:"space-y-4",children:b.map((w,j)=>e.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-slate-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.medicationName")}),e.jsx("input",{type:"text",value:w.medicationName,onChange:D=>N(j,"medicationName",D.target.value),placeholder:u("prescriptionModal.medicationNamePlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.dosage")}),e.jsx("input",{type:"text",value:w.dosage||"",onChange:D=>N(j,"dosage",D.target.value),placeholder:u("prescriptionModal.dosagePlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.quantity")}),e.jsx("input",{type:"number",min:"1",value:w.quantity,onChange:D=>N(j,"quantity",parseInt(D.target.value)||1),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:u("prescriptionModal.instructions")}),e.jsx("input",{type:"text",value:w.instructions||"",onChange:D=>N(j,"instructions",D.target.value),placeholder:u("prescriptionModal.instructionsPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{type:"button",onClick:()=>k(j),className:"bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 flex items-center gap-2 text-sm",children:[e.jsx(ev,{}),u("common.remove")]})})]},w.id))}),b.length===0&&e.jsx("p",{className:"text-center text-slate-500 py-8",children:u("prescriptionModal.noMedications")})]}),e.jsxs("footer",{className:"pt-4 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:u("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:u(a?"prescriptionModal.savePrescription":"prescriptionModal.createPrescription")})]})]})]})})},rv=a=>{const s=a.toLowerCase();return s.includes("filling")?ft.FILLING:s.includes("crown")?ft.CROWN:s.includes("implant")?ft.IMPLANT:s.includes("root canal")||s.includes("endodontic")?ft.ROOT_CANAL:s.includes("extraction")||s.includes("removal")?ft.MISSING:s.includes("cavity")?ft.CAVITY:null},sv=({className:a="h-6 w-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),nv=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),ap=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})}),av=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V4m0 8v4m-4.003-4l-2.003 2.003m7.007-1.414L14.003 10m-3.414-1.414L9 5.586m4.003 2.828l3.004 3.004M9.879 16.121A3 3 0 1012.004 15H12v2.003V20m0-8c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),ov=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 19.5l15-15m-10.5 2.25a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zm10.5 10.5a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})}),iv=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),lv=({className:a="h-5 w-5 me-2"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),op=({className:a="h-8 w-8"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),ip=({className:a="h-4 w-4"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),cv=({className:a="h-4 w-4"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),dv=({className:a="h-5 w-5"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),uv=({className:a="h-5 w-5"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),mv=({className:a="h-5 w-5"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"})}),hv=a=>{if(!a)return null;const s=new Date(a),n=new Date;let o=n.getFullYear()-s.getFullYear();const i=n.getMonth()-s.getMonth();return(i<0||i===0&&n.getDate()<s.getDate())&&o--,o},pv=({patient:a,onClose:s,onEdit:n,clinicData:o})=>{const{t:i,locale:c}=Ve(),{addNotification:u}=At(),{updatePatient:m,addTreatmentRecord:h,addPayment:y,payments:b,treatmentRecords:f,prescriptions:x,prescriptionItems:v,addPrescription:N,updatePrescription:k,deletePrescription:C,addPrescriptionItem:w,updatePrescriptionItem:j,deletePrescriptionItem:D}=o,[M,I]=q.useState("details"),[_,A]=q.useState(!1),[Q,G]=q.useState(!1),[re,le]=q.useState(!1),[he,P]=q.useState(!1),[L,z]=q.useState([]);q.useEffect(()=>{z(o.dentists)},[o.dentists]);const ee=new Intl.DateTimeFormat(c,{year:"numeric",month:"long",day:"numeric"}),se=new Intl.NumberFormat(c,{style:"currency",currency:"EGP"}),Y=q.useMemo(()=>b.filter(Ne=>Ne.patientId===a.id).sort((Ne,Pe)=>new Date(Pe.date).getTime()-new Date(Ne.date).getTime()),[b,a.id]),xe=q.useMemo(()=>f.filter(Ne=>Ne.patientId===a.id).sort((Ne,Pe)=>new Date(Pe.treatmentDate).getTime()-new Date(Ne.treatmentDate).getTime()),[f,a.id]),ce=q.useMemo(()=>{const Ne=xe.reduce((Ce,Ie)=>Ce+(Ie.doctorShare+Ie.clinicShare),0),Pe=Y.reduce((Ce,Ie)=>Ce+Ie.amount,0),pe=Ne-Pe;return{totalCharges:Ne,totalPaid:Pe,outstandingBalance:pe}},[xe,Y]),B=q.useCallback(Ne=>{console.log("PatientDetailsModal: handleUpdateDentalChart called with:",Ne),console.log("PatientDetailsModal: current patient dentalChart:",a.dentalChart);const Pe={...a,dentalChart:Ne};m(Pe),u(i("notifications.patientUpdated"),ve.SUCCESS)},[a,m,u,i]),F=q.useCallback(Ne=>{if(h(a.id,Ne),Ne.affectedTeeth&&Ne.affectedTeeth.length>0){const Pe=o.treatmentDefinitions.find(pe=>pe.id===Ne.treatmentDefinitionId);if(Pe){const pe=rv(Pe.name);if(pe){const Ce={...a.dentalChart};Ne.affectedTeeth.forEach(Ie=>{Ce[Ie]&&(Ce[Ie]={...Ce[Ie],status:pe})}),m({...a,dentalChart:Ce})}}}m({...a,lastVisit:Ne.treatmentDate}),A(!1),u(i("notifications.treatmentAdded"),ve.SUCCESS)},[h,a,m,u,i,o.treatmentDefinitions]),ue=q.useCallback(Ne=>{y(Ne),G(!1),u(i("notifications.paymentAdded"),ve.SUCCESS)},[y,u,i]),We=()=>{Kr(i("patientInvoice.title"),e.jsx(Ub,{patient:a,clinicData:o}))},Ye=()=>{Kr(i("patientReport.title"),e.jsx(qb,{patient:a,clinicData:o}))},Qe=q.useCallback(async(Ne,Pe)=>{const pe=await N({...Ne,patientId:a.id});if(pe.length>0){const Ce=pe[0].id;for(const Ie of Pe)await w(Ce,Ie)}P(!1)},[a.id,N,w]);return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 p-4","aria-modal":"true",role:"dialog",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-6 border-b border-gray-200 bg-gray-50 flex justify-between items-center flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(op,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[a.dob&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(cv,{className:"w-4 h-4"}),e.jsxs("span",{children:[hv(a.dob)," years old"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ip,{className:"w-4 h-4"}),e.jsx("span",{children:a.phone})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-md hover:bg-gray-50 text-sm font-medium text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(nv,{className:"w-4 h-4"}),i("common.edit")]}),e.jsx("button",{onClick:s,className:"p-2 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500","aria-label":i("patientDetails.closeAriaLabel"),children:e.jsx(sv,{className:"w-5 h-5"})})]})]}),e.jsx("nav",{className:"border-b border-gray-200 bg-white flex-shrink-0",children:e.jsx("ul",{className:"flex overflow-x-auto p-1 text-sm font-medium",children:[{key:"details",label:"patientDetails.tabDetails"},{key:"chart",label:"patientDetails.tabDentalChart"},{key:"treatments",label:"patientDetails.tabTreatmentRecords"},{key:"prescriptions",label:"patientDetails.tabPrescriptions"},{key:"financials",label:"patientDetails.tabFinancials"}].map(({key:Ne,label:Pe})=>e.jsx("li",{children:e.jsx("button",{onClick:()=>I(Ne),className:`px-4 py-2 rounded-md transition-colors ${M===Ne?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"} focus:outline-none focus:ring-2 focus:ring-blue-500`,"aria-pressed":M===Ne,role:"tab",children:i(Pe)})},Ne))})}),e.jsxs("main",{className:"p-6 overflow-y-auto flex-1 bg-white",children:[M==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(op,{className:"h-5 w-5"}),i("patientDetails.personalInfo")]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.dob"),":"]}),e.jsx("span",{className:"font-medium",children:a.dob?ee.format(new Date(a.dob)):"No date"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.gender"),":"]}),e.jsx("span",{className:"font-medium",children:i(a.gender.toLowerCase())})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.phone"),":"]}),e.jsx("span",{className:"font-medium",children:a.phone})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.email"),":"]}),e.jsx("span",{className:"font-medium",children:a.email||"-"})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200",children:[e.jsxs("span",{className:"text-gray-600 block mb-1",children:[i("patientDetails.address"),":"]}),e.jsx("span",{className:"font-medium",children:a.address||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(mv,{className:"h-5 w-5"}),i("patientDetails.medicalInfo")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600 block mb-1",children:[i("patientDetails.medicalHistory"),":"]}),e.jsx("p",{className:"text-sm text-gray-700 bg-white p-2 rounded",children:a.medicalHistory||i("common.na")})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600 block mb-1",children:[i("patientDetails.allergies"),":"]}),e.jsx("p",{className:"text-sm text-gray-700 bg-white p-2 rounded",children:a.allergies||i("common.na")})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-600 block mb-1",children:[i("patientDetails.currentMedications"),":"]}),e.jsx("p",{className:"text-sm text-gray-700 bg-white p-2 rounded",children:a.medications||i("common.na")})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ip,{className:"h-5 w-5"}),i("patientDetails.emergencyContact")]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.emergencyContactName"),":"]}),e.jsx("span",{className:"font-medium",children:a.emergencyContactName||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.emergencyContactPhone"),":"]}),e.jsx("span",{className:"font-medium",children:a.emergencyContactPhone||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(dv,{className:"h-5 w-5"}),i("patientDetails.insurance")]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.insuranceProvider"),":"]}),e.jsx("span",{className:"font-medium",children:a.insuranceProvider||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:[i("patientDetails.policyNumber"),":"]}),e.jsx("span",{className:"font-medium",children:a.insurancePolicyNumber||"-"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(uv,{className:"h-5 w-5"}),i("patientDetails.unstructuredNotes")]}),e.jsx("p",{className:"text-gray-700 bg-white p-3 rounded",children:a.treatmentNotes||i("common.na")})]}),a.images&&a.images.length>0&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:i("patientDetails.patientImages")}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:a.images.map((Ne,Pe)=>e.jsx("div",{className:"relative",children:e.jsx("img",{src:Ne,alt:`Patient image ${Pe+1}`,className:"w-full h-32 object-cover rounded-lg"})},Pe))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:Ye,className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-gray-500",children:[e.jsx(lv,{className:"h-5 w-5"}),i("common.print")]})})]}),M==="chart"&&e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx(Eb,{chartData:a.dentalChart,onUpdate:B})}),M==="treatments"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>A(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(ap,{})," ",i("patientDetails.addTreatmentRecord")]})}),e.jsx(Pb,{patient:a,clinicData:o,onUpdateTreatmentRecord:async(Ne,Pe)=>{await o.updateTreatmentRecord(Ne,Pe)}})]}),M==="prescriptions"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>P(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(ap,{})," ",i("patientDetails.addPrescription")]})}),e.jsx(Qb,{patients:[a],prescriptions:x,prescriptionItems:v,dentists:L,onUpdatePrescription:async(Ne,Pe)=>{await k(Pe)}})]}),M==="financials"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:i("financials.patientBalance")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:i("financials.totalCharges")}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:se.format(ce.totalCharges)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:i("financials.totalPaid")}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:se.format(ce.totalPaid)})]}),e.jsxs("div",{className:`p-4 rounded-lg text-center ${ce.outstandingBalance>0?"bg-red-50 text-red-800":ce.outstandingBalance<0?"bg-green-50 text-green-800":"bg-blue-50 text-blue-800"}`,children:[e.jsx("p",{className:"text-sm font-medium",children:i("financials.outstandingBalance")}),e.jsx("p",{className:"text-xl font-semibold",children:se.format(ce.outstandingBalance)}),e.jsx("p",{className:"text-xs mt-1",children:ce.outstandingBalance>0?i("financials.amountDue"):ce.outstandingBalance<0?i("financials.overpaid"):i("financials.paidInFull")})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>G(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx(av,{})," ",i("financials.addPayment")]}),e.jsxs("button",{onClick:()=>le(!0),className:"bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[e.jsx(ov,{})," ",i("financials.addDiscount")]}),e.jsxs("button",{onClick:We,className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-gray-500",children:[e.jsx(iv,{})," ",i("patientInvoice.title")]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:i("financials.transactions")}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg max-h-96 overflow-y-auto",children:Y.length===0&&xe.length===0?e.jsx("p",{className:"text-center text-gray-500 py-4",children:i("financials.noTransactions")}):e.jsxs("div",{className:"space-y-3",children:[Y.map(Ne=>e.jsx("div",{className:"bg-white p-3 rounded-md border-l-4 border-green-500",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[i("financials.payments")," (",i(`paymentMethod.${Ne.method}`),")"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[ee.format(new Date(Ne.date)),Ne.notes&&e.jsxs("span",{className:"ml-2 text-gray-500",children:[" ",Ne.notes]})]})]}),e.jsx("span",{className:"font-semibold text-green-700",children:se.format(Ne.amount)})]})},Ne.id)),xe.map(Ne=>{const Pe=o.treatmentDefinitions.find(pe=>pe.id===Ne.treatmentDefinitionId);return e.jsx("div",{className:"bg-white p-3 rounded-md border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[i("financials.charges")," - ",Pe?.name||i("common.unknownTreatment")]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[ee.format(new Date(Ne.treatmentDate)),Ne.notes&&e.jsxs("span",{className:"ml-2 text-gray-500",children:[" ",Ne.notes.slice(0,50),"..."]})]})]}),e.jsx("span",{className:"font-semibold text-blue-700",children:se.format(Ne.doctorShare+Ne.clinicShare)})]})},Ne.id)})]})})]})]})]})]}),_&&e.jsx(Ab,{patientId:a.id,onClose:()=>A(!1),onAdd:F,clinicData:o}),Q&&e.jsx(Mb,{patientId:a.id,clinicData:o,onClose:()=>G(!1),onAdd:ue}),re&&e.jsx(Fb,{patientId:a.id,clinicData:o,onClose:()=>le(!1),onAdd:ue}),he&&e.jsx(tv,{patient:a,dentists:L,onClose:()=>P(!1),onSave:Qe})]})},fv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),gv=({patient:a,onClose:s,onSave:n})=>{const{t:o}=Ve(),{addNotification:i}=At(),[c,u]=q.useState("basic"),[m,h]=q.useState(a||{name:"",dob:"",gender:"Male",phone:"",email:"",address:"",medicalHistory:"",treatmentNotes:"",lastVisit:new Date().toISOString().split("T")[0],allergies:"",medications:"",insuranceProvider:"",insurancePolicyNumber:"",emergencyContactName:"",emergencyContactPhone:"",images:[]});q.useEffect(()=>{a&&!a.lastVisit&&h(j=>({...j,lastVisit:new Date().toISOString().split("T")[0]}))},[a]);const[y,b]=q.useState({}),f=j=>{const{name:D,value:M}=j.target;h(I=>({...I,[D]:M})),y[D]&&b(I=>({...I,[D]:""}))},x=j=>{const D=j.target.files;D&&Array.from(D).forEach(M=>{const I=new FileReader;I.onload=_=>{_.target?.result&&h(A=>({...A,images:[...A.images||[],_.target.result]}))},I.readAsDataURL(M)})},v=j=>{h(D=>({...D,images:D.images?.filter((M,I)=>I!==j)||[]}))},N=j=>{const D={};switch(j){case"basic":m.name?.trim()||(D.name=o("validation.required")),m.dob||(D.dob=o("validation.required")),m.phone?.trim()||(D.phone=o("validation.required"));break}return b(M=>({...M,...D})),Object.keys(D).length===0},k=j=>{N(c)?u(j):i(o("validation.fixErrors"),ve.ERROR)},C=j=>{j.preventDefault();const D=["basic","medical","emergency","images"];let M=!1;if(D.forEach(I=>{N(I)||(M=!0)}),M){i(o("validation.fixAllErrors"),ve.ERROR);return}n(m)},w=[{key:"basic",label:o("patientModal.tabs.basicInfo")},{key:"medical",label:o("patientModal.tabs.medicalHistory")},{key:"emergency",label:o("patientModal.tabs.emergencyInsurance")},{key:"images",label:o("patientModal.tabs.imagesNotes")}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl h-[80vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:o(a?"addPatientModal.editTitle":"addPatientModal.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":o("addPatientModal.closeAriaLabel"),children:e.jsx(fv,{})})]}),e.jsx("nav",{className:"border-b border-slate-200 bg-slate-50 flex-shrink-0",children:e.jsx("ul",{className:"-mb-px flex space-x-4 rtl:space-x-reverse overflow-x-auto text-sm font-medium text-center text-slate-500",children:w.map(({key:j,label:D})=>e.jsx("li",{children:e.jsx("button",{onClick:()=>k(j),className:`inline-block p-4 border-b-2 ${c===j?"border-primary text-primary":"border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:D})},j))})}),e.jsxs("form",{onSubmit:C,className:"p-6 overflow-y-auto flex-1 space-y-4",children:[c==="basic"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-600 mb-1",children:[o("addPatientModal.fullName")," *"]}),e.jsx("input",{id:"name",name:"name",value:m.name,onChange:f,placeholder:o("addPatientModal.fullName"),className:`p-2 border rounded-lg w-full focus:ring-primary focus:border-primary ${y.name?"border-red-500":"border-slate-300"}`,required:!0}),y.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.name})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"dob",className:"block text-sm font-medium text-slate-600 mb-1",children:[o("addPatientModal.dob")," *"]}),e.jsx("input",{id:"dob",name:"dob",type:"date",value:m.dob,onChange:f,className:`p-2 border rounded-lg w-full focus:ring-primary focus:border-primary ${y.dob?"border-red-500":"border-slate-300"}`,required:!0}),y.dob&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.dob})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"gender",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.gender")}),e.jsxs("select",{id:"gender",name:"gender",value:m.gender,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"Male",children:o("male")}),e.jsx("option",{value:"Female",children:o("female")}),e.jsx("option",{value:"Other",children:o("other")})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-slate-600 mb-1",children:[o("addPatientModal.phone")," *"]}),e.jsx("input",{id:"phone",name:"phone",type:"tel",value:m.phone,onChange:f,placeholder:o("addPatientModal.phone"),className:`p-2 border rounded-lg w-full focus:ring-primary focus:border-primary ${y.phone?"border-red-500":"border-slate-300"}`,required:!0}),y.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.phone})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.email")}),e.jsx("input",{id:"email",name:"email",type:"email",value:m.email,onChange:f,placeholder:o("addPatientModal.email"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.address")}),e.jsx("textarea",{id:"address",name:"address",value:m.address,onChange:f,placeholder:o("addPatientModal.address"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"})]})]})}),c==="medical"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"medicalHistory",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.medicalHistory")}),e.jsx("textarea",{id:"medicalHistory",name:"medicalHistory",value:m.medicalHistory,onChange:f,placeholder:o("addPatientModal.medicalHistoryPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"allergies",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.allergies")}),e.jsx("input",{id:"allergies",name:"allergies",value:m.allergies,onChange:f,placeholder:o("addPatientModal.allergiesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"medications",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.currentMedications")}),e.jsx("input",{id:"medications",name:"medications",value:m.medications,onChange:f,placeholder:o("addPatientModal.currentMedicationsPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]})]}),c==="emergency"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emergencyContactName",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.emergencyContactName")}),e.jsx("input",{id:"emergencyContactName",name:"emergencyContactName",value:m.emergencyContactName,onChange:f,placeholder:o("addPatientModal.emergencyContactName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"emergencyContactPhone",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.emergencyContactPhone")}),e.jsx("input",{id:"emergencyContactPhone",name:"emergencyContactPhone",type:"tel",value:m.emergencyContactPhone,onChange:f,placeholder:o("addPatientModal.emergencyContactPhone"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"insuranceProvider",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.insuranceProvider")}),e.jsx("input",{id:"insuranceProvider",name:"insuranceProvider",value:m.insuranceProvider,onChange:f,placeholder:o("addPatientModal.insuranceProvider"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"insurancePolicyNumber",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.policyNumber")}),e.jsx("input",{id:"insurancePolicyNumber",name:"insurancePolicyNumber",value:m.insurancePolicyNumber,onChange:f,placeholder:o("addPatientModal.policyNumber"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]})]})}),c==="images"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"treatmentNotes",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.initialTreatmentNotes")}),e.jsx("textarea",{id:"treatmentNotes",name:"treatmentNotes",value:m.treatmentNotes,onChange:f,placeholder:o("addPatientModal.initialTreatmentNotesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"images",className:"block text-sm font-medium text-slate-600 mb-1",children:o("addPatientModal.patientImages")}),e.jsx("input",{id:"images",name:"images",type:"file",multiple:!0,accept:"image/*",onChange:x,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),m.images&&m.images.length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:m.images.map((j,D)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:j,alt:`Patient image ${D+1}`,className:"w-full h-20 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>v(D),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs hover:bg-red-600",children:""})]},D))})]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:o("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:o("addPatientModal.savePatient")})]})]})]})})},xv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 absolute start-3 top-1/2 -translate-y-1/2 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),yv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),bv=({className:a="h-6 w-6 text-slate-400"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),vv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12.062 17.498a9.423 9.423 0 0 1-4.71-1.392l-5.13.84 1.09-4.992a9.423 9.423 0 0 1-1.282-5.024C2.03 3.018 6.54-1.5 12 .002c5.46 1.5 8.97 7.018 7.47 12.478a9.423 9.423 0 0 1-7.408 5.02z"})}),wv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),jv=a=>a.split(" ").map(s=>s[0]).join("").toUpperCase(),lp=["bg-sky-200","bg-emerald-200","bg-amber-200","bg-rose-200","bg-indigo-200","bg-teal-200"],Nv=a=>{const s=a.split("").reduce((n,o)=>n+o.charCodeAt(0),0);return lp[s%lp.length]},Sv=({patient:a,onSelect:s,onDelete:n,clinicData:o})=>{const{t:i}=Ve(),c=new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"short",day:"numeric"}),u=new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}),m=q.useMemo(()=>{const b=o.treatmentRecords.filter(x=>x.patientId===a.id).reduce((x,v)=>{const N=o.treatmentDefinitions.find(k=>k.id===v.treatmentDefinitionId);return x+(N?N.basePrice:0)},0),f=o.payments.filter(x=>x.patientId===a.id).reduce((x,v)=>x+v.amount,0);return b-f},[a.id,o.treatmentRecords,o.payments,o.treatmentDefinitions]),h=y=>{y.stopPropagation();let b=a.phone.replace(/[^0-9]/g,"");b.startsWith("0")&&(b=b.substring(1));const f=`20${b}`,x=o.whatsappMessageTemplate.replace(/\{patientName\}/g,a.name).replace(/\{clinicName\}/g,o.clinicInfo.name||" ").replace(/\{clinicAddress\}/g,o.clinicInfo.address||"").replace(/\{clinicPhone\}/g,o.clinicInfo.phone||""),v=`https://wa.me/${f}?text=${encodeURIComponent(x)}`;window.open(v,"_blank")};return e.jsxs("div",{onClick:s,className:"w-full border border-gray-200 rounded-lg p-4 flex justify-between items-center gap-4 hover:bg-gray-50 cursor-pointer focus-within:ring-2 focus-within:ring-blue-500",role:"button",tabIndex:0,onKeyDown:y=>y.key==="Enter"&&s(),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex-shrink-0 flex items-center justify-center ${Nv(a.id)}`,children:e.jsx("span",{className:"text-lg font-semibold text-gray-700",children:jv(a.name)})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-gray-900 truncate",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.phone}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[i("patientList.lastVisit"),": ",a.lastVisit?c.format(new Date(a.lastVisit)):"No visit date"]}),m>0&&e.jsxs("p",{className:"text-xs font-medium text-red-600 mt-1",children:["Outstanding: ",u.format(m)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:h,className:"p-2 text-green-600 hover:bg-green-50 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500","aria-label":i("patientList.sendWhatsAppAriaLabel",{patientName:a.name}),children:e.jsx(vv,{})}),e.jsx("button",{onClick:y=>{y.stopPropagation(),n()},className:"p-2 text-red-600 hover:bg-red-50 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":i("patientList.deletePatientAriaLabel",{patientName:a.name}),children:e.jsx(wv,{})}),e.jsx(bv,{className:"text-gray-400"})]})]})},kv=({clinicData:a})=>{const{patients:s,addPatient:n,updatePatient:o,deletePatient:i}=a,{addNotification:c}=At(),{t:u}=Ve(),[m,h]=q.useState(""),[y,b]=q.useState(null),[f,x]=q.useState(!1),[v,N]=q.useState(void 0),k=q.useCallback(j=>{"id"in j&&j.id?(o(j),c(u("notifications.patientUpdated"),ve.SUCCESS),y&&y.id===j.id&&b(j)):(n(j),c(u("notifications.patientAdded"),ve.SUCCESS)),x(!1),N(void 0)},[c,y,o,n,u]),C=q.useCallback(j=>{window.confirm(u("patientList.confirmDelete",{patientName:j.name}))&&(i(j.id),c(u("notifications.patientDeleted"),ve.SUCCESS),y&&y.id===j.id&&b(null))},[i,c,y,u]),w=q.useMemo(()=>{const j=m.toLowerCase().trim();return j?s.filter(D=>D.name.toLowerCase().includes(j)||D.phone.includes(j)||D.email.toLowerCase().includes(j)):s},[s,m]);return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mb-6",children:[e.jsxs("div",{className:"relative w-full sm:max-w-sm",children:[e.jsx(xv,{}),e.jsx("input",{type:"text",placeholder:u("patientList.searchPatients"),"aria-label":u("patientList.searchPatientsAriaLabel"),value:m,onChange:j=>h(j.target.value),className:"w-full p-3 pl-10 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("button",{onClick:()=>{N(void 0),x(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center justify-center w-full sm:w-auto focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx(yv,{}),u("patientList.addNewPatient")]})]}),e.jsx("div",{className:"space-y-4",children:w.length>0?w.map(j=>e.jsx(Sv,{patient:j,onSelect:()=>b(j),onDelete:()=>C(j),clinicData:a},j.id)):e.jsx("p",{className:"text-center text-gray-500 py-8",children:u("patientList.noPatientsFound")})}),f&&e.jsx(gv,{patient:v,onSave:k,onClose:()=>{x(!1),N(void 0)}}),y&&!f&&e.jsx(pv,{patient:y,onClose:()=>b(null),onEdit:()=>{N(y),x(!0),b(null)},clinicData:a})]})},zr=({title:a,value:s,icon:n,color:o,trend:i,subtitle:c,onClick:u,className:m})=>{const h=o.replace("bg-","").replace("-100",""),y="hover:bg-gray-50",b=`group-hover:text-${h}-800`;return e.jsxs("div",{className:`group bg-white p-5 rounded-lg shadow-md hover:shadow-lg flex items-center transition-all duration-200 hover:scale-[1.02] hover:-translate-y-1 border border-${h}-200 cursor-pointer hover:border-${h}-300 ${u?y:""} ${m||""}`,onClick:u,role:u?"button":void 0,tabIndex:u?0:void 0,onKeyDown:u?f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),u())}:void 0,"aria-label":u?`${a}: ${s}`:void 0,children:[e.jsx("div",{className:`p-3 rounded-full ${o} shadow-md transition-all duration-200 group-hover:scale-105 group-hover:shadow-lg border border-${h}-200`,children:e.jsx("div",{className:`transition-colors duration-200 ${b}`,children:n})}),e.jsxs("div",{className:"ms-4 flex-1",children:[e.jsx("p",{className:"text-sm text-slate-600 font-medium group-hover:text-slate-800 transition-colors",children:a}),e.jsx("p",{className:"text-xl font-bold text-slate-900 group-hover:text-slate-800 transition-colors",children:s}),c&&e.jsx("p",{className:"text-xs text-slate-500 mt-1 group-hover:text-slate-600 transition-colors",children:c}),i&&e.jsxs("div",{className:`flex items-center mt-1 text-xs font-medium ${i.isPositive?"text-green-600":"text-red-600"} group-hover:${i.isPositive?"text-green-700":"text-red-700"} transition-colors`,children:[e.jsx("svg",{className:`w-3 h-3 mr-1 transition-transform duration-200 group-hover:scale-105 ${i.isPositive?"":"rotate-180"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}),Math.abs(i.value),"%"]})]})]})},cp=({clinicData:a,setCurrentView:s})=>{const{t:n,locale:o}=Ve(),{patients:i,appointments:c,treatmentRecords:u,inventoryItems:m,labCases:h,dentists:y,payments:b,expenses:f,supplierInvoices:x,doctorPayments:v,prescriptions:N,prescriptionItems:k}=a,C=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),w=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),j=new Intl.DateTimeFormat(o,{day:"2-digit",month:"short"}),D=new Date;D.setHours(0,0,0,0);const M=c.filter(pe=>{const Ce=new Date(pe.startTime);return Ce.setHours(0,0,0,0),Ce.getTime()===D.getTime()}).length,I=q.useMemo(()=>b.filter(pe=>{const Ce=new Date(pe.date);return Ce.setHours(0,0,0,0),Ce.getTime()===D.getTime()}),[b,D]),_=q.useMemo(()=>I.reduce((pe,Ce)=>pe+Ce.amount,0),[I]),A=q.useMemo(()=>f.filter(pe=>{const Ce=new Date(pe.date);return Ce.setHours(0,0,0,0),Ce.getTime()===D.getTime()}).reduce((pe,Ce)=>pe+Ce.amount,0),[f,D]),Q=q.useMemo(()=>I.reduce((pe,Ce)=>pe+Ce.doctorShare,0),[I]),G=q.useMemo(()=>_-A-Q,[_,A,Q]),re=q.useMemo(()=>{const pe=u.reduce((Ie,nt)=>Ie+nt.doctorShare,0),Ce=v.reduce((Ie,nt)=>Ie+nt.amount,0);return pe-Ce},[u,v]),le=q.useMemo(()=>{const pe=new Date,Ce=c.filter(Ie=>new Date(Ie.startTime)>pe).sort((Ie,nt)=>new Date(Ie.startTime).getTime()-new Date(nt.startTime).getTime());return Ce.length>0?Ce[0]:null},[c]),he=q.useMemo(()=>{const pe=new Date,Ce=new Date(pe.getFullYear(),pe.getMonth(),1),Ie=new Date(pe.getFullYear(),pe.getMonth()+1,0);return b.filter(nt=>{const et=new Date(nt.date);return et>=Ce&&et<=Ie}).reduce((nt,et)=>nt+et.amount,0)},[b]);q.useMemo(()=>{const pe=u.reduce((Ie,nt)=>{const et=a.treatmentDefinitions.find(Nt=>Nt.id===nt.treatmentDefinitionId);return Ie+(et?et.basePrice:0)},0),Ce=b.reduce((Ie,nt)=>Ie+nt.amount,0);return pe-Ce},[u,b,a.treatmentDefinitions]);const P=q.useMemo(()=>{const pe=new Date,Ce=new Date(pe.getFullYear(),pe.getMonth(),1),Ie=new Date(pe.getFullYear(),pe.getMonth()+1,0);return f.filter(nt=>{const et=new Date(nt.date);return et>=Ce&&et<=Ie}).reduce((nt,et)=>nt+et.amount,0)},[f]);q.useMemo(()=>{const pe=new Date,Ce=new Date(pe.getFullYear(),pe.getMonth(),1),Ie=new Date(pe.getFullYear(),pe.getMonth()+1,0),nt=b.filter(et=>{const Nt=new Date(et.date);return Nt>=Ce&&Nt<=Ie}).reduce((et,Nt)=>et+Nt.doctorShare,0);return he-nt-P},[he,P,b]);const L=q.useMemo(()=>{const pe=u.reduce((Ie,nt)=>{const et=a.treatmentDefinitions.find(Nt=>Nt.id===nt.treatmentDefinitionId);return Ie+(et?et.basePrice:0)},0),Ce=b.reduce((Ie,nt)=>Ie+nt.amount,0);return Math.max(0,pe-Ce)},[u,b,a.treatmentDefinitions]),z=q.useMemo(()=>{const pe=new Date;return x.filter(Ce=>Ce.status==="UNPAID"&&Ce.dueDate&&new Date(Ce.dueDate)<pe).length},[x]),ee=q.useMemo(()=>{const pe=new Date,Ce=new Date(pe.getFullYear(),pe.getMonth(),1),Ie=new Date(pe.getFullYear(),pe.getMonth()+1,0);return i.filter(nt=>{const et=u.filter(ct=>ct.patientId===nt.id);if(et.length===0)return!1;const Nt=et.sort((ct,pr)=>new Date(ct.treatmentDate).getTime()-new Date(pr.treatmentDate).getTime())[0],He=new Date(Nt.treatmentDate);return He>=Ce&&He<=Ie}).length},[i,u]),se=q.useMemo(()=>{const pe=new Date,Ce=new Date;return Ce.setDate(pe.getDate()+7),c.filter(Ie=>new Date(Ie.startTime)>=pe&&new Date(Ie.startTime)<=Ce).sort((Ie,nt)=>new Date(Ie.startTime).getTime()-new Date(nt.startTime).getTime()).slice(0,10)},[c]),Y=q.useMemo(()=>h.filter(pe=>![nr.FITTED_TO_PATIENT,nr.CANCELLED].includes(pe.status)).sort((pe,Ce)=>new Date(pe.dueDate).getTime()-new Date(Ce.dueDate).getTime()).slice(0,5),[h]),xe=q.useMemo(()=>m.filter(Ce=>Ce.currentStock<=10).sort((Ce,Ie)=>Ce.currentStock-Ie.currentStock).slice(0,5),[m]),ce=q.useMemo(()=>{const pe={};I.forEach(Ie=>{const nt=u.find(et=>et.id===Ie.treatmentRecordId);if(nt){const et=y.find(Nt=>Nt.id===nt.dentistId);et&&(pe[et.id]||(pe[et.id]={name:et.name,earnings:0,color:et.color}),pe[et.id].earnings+=Ie.doctorShare)}});const Ce=Object.values(pe).reduce((Ie,nt)=>Ie+nt.earnings,0);return Object.values(pe).map(Ie=>({...Ie,percentage:Ce>0?Ie.earnings/Ce*100:0})).sort((Ie,nt)=>nt.earnings-Ie.earnings)},[I,u,y]),B=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-emerald-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.282-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.282.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),F=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-sky-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),ue=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[" ",e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})," "]}),We=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-indigo-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),Ye=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),Qe=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),Ne=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),Pe=e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-purple-800",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8",children:[e.jsx(zr,{title:n("dashboard.todaysRevenue"),value:C.format(_),icon:ue,color:"bg-green-100",subtitle:"Today's earnings",onClick:()=>s("reports")}),e.jsx(zr,{title:n("dashboard.todaysExpenses")||" ",value:C.format(A),icon:Qe,color:"bg-red-100",subtitle:"Today's expenses",onClick:()=>s("reports")}),e.jsx(zr,{title:n("dashboard.netToday"),value:C.format(G),icon:G>=0?Ye:Qe,color:G>=0?"bg-green-100":"bg-red-100",subtitle:"Today's net profit",onClick:()=>s("reports"),className:"ring-2 ring-yellow-400 ring-opacity-40 bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-300 shadow-yellow-200/50"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[e.jsx(zr,{title:n("dashboard.monthlyRevenue")||" ",value:C.format(he),icon:Ye,color:"bg-blue-100",subtitle:n("dashboard.thisMonth")||" "}),e.jsx(zr,{title:n("dashboard.monthlyExpenses")||" ",value:C.format(P),icon:Qe,color:"bg-red-100",subtitle:n("dashboard.thisMonth")||" "}),e.jsx(zr,{title:n("dashboard.doctorsDues"),value:C.format(re),icon:Ne,color:"bg-green-100",subtitle:"Outstanding payments",onClick:()=>s("doctors")}),e.jsx(zr,{title:n("dashboard.outstandingBalance")||" ",value:C.format(L),icon:Ne,color:"bg-green-100",subtitle:n("dashboard.pendingPayments")||" "})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 md:gap-8",children:[e.jsx(zr,{title:n("dashboard.totalPatients"),value:i.length,icon:B,color:"bg-emerald-100",subtitle:"Active patients"}),e.jsx(zr,{title:n("dashboard.newPatientsThisMonth"),value:ee,icon:We,color:"bg-indigo-100",subtitle:"This month"}),e.jsx(zr,{title:n("dashboard.appointmentsToday"),value:M,icon:F,color:"bg-sky-100",subtitle:"Scheduled today"}),e.jsx(zr,{title:n("dashboard.nextAppointment"),value:le?new Intl.DateTimeFormat(o,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(le.startTime)):n("dashboard.noUpcomingAppointments"),icon:Pe,color:"bg-purple-100",subtitle:le?i.find(pe=>pe.id===le.patientId)?.name:"",onClick:()=>s("scheduler")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-md border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:n("dashboard.upcomingWeekAppointments")}),e.jsx("button",{onClick:()=>s("scheduler"),className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"View All "})]}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:se.length>0?se.map(pe=>{const Ce=i.find(et=>et.id===pe.patientId),Ie=y.find(et=>et.id===pe.dentistId),nt=new Date(pe.startTime);return e.jsx("button",{onClick:()=>s("scheduler"),className:"w-full text-start p-3 rounded-lg hover:bg-slate-50 transition-colors border border-slate-200 focus:outline-none focus:ring-2 focus:ring-primary-light",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${Ie?.color||"bg-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-800",children:Ce?.name}),e.jsx("p",{className:"text-sm text-slate-600",children:Ie?.name})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:new Intl.DateTimeFormat(o,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(nt)}),e.jsx("p",{className:"text-xs text-slate-500",children:pe.reason||"No reason"})]})]})},pe.id)}):e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:n("dashboard.noUpcomingAppointments")})})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-slate-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:n("dashboard.atAGlance")}),z>0&&e.jsxs("div",{className:"flex items-center text-orange-600 text-sm font-medium",children:[Ne,e.jsxs("span",{className:"ml-1",children:[z," overdue"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-600 mb-2",children:n("dashboard.pendingLabCases")}),e.jsx("div",{className:"space-y-2",children:Y.length>0?Y.map(pe=>e.jsxs("button",{onClick:()=>s("labCases"),className:"w-full text-start p-2 rounded-lg hover:bg-slate-100 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("p",{className:"font-semibold text-slate-800",children:i.find(Ce=>Ce.id===pe.patientId)?.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n("labCases.due"),": ",pe.dueDate?j.format(new Date(pe.dueDate)):"No due date"]})]}),e.jsx("p",{className:"text-xs text-slate-600",children:pe.caseType})]},pe.id)):e.jsx("p",{className:"text-sm text-slate-500 p-2",children:n("dashboard.noPendingLabCases")})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-600 mb-2",children:n("dashboard.lowStockItems")}),e.jsx("div",{className:"space-y-2",children:xe.length>0?xe.map(pe=>e.jsx("button",{onClick:()=>s("inventory"),className:"w-full text-start p-2 rounded-lg hover:bg-slate-100 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-light",children:e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("p",{className:"font-semibold text-slate-800",children:pe.name}),e.jsxs("p",{className:"text-xs text-red-600 font-bold",children:[n("inventory.stock"),": ",pe.currentStock]})]})},pe.id)):e.jsx("p",{className:"text-sm text-slate-500 p-2",children:n("dashboard.noLowStockItems")})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:n("dashboard.doctorDailyPerformance")}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>s("doctors"),className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Doctors "}),e.jsx("button",{onClick:()=>s("reports"),className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:"Reports "})]})]}),e.jsx("div",{className:"space-y-3",children:ce.length>0?ce.map(pe=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold mb-1",children:[e.jsx("span",{className:"text-slate-700",children:pe.name}),e.jsx("span",{className:"text-slate-500",children:w.format(pe.earnings)})]}),e.jsx("div",{className:"w-full bg-neutral rounded-full h-2.5",children:e.jsx("div",{className:`${pe.color} h-2.5 rounded-full`,style:{width:`${pe.percentage}%`}})})]},pe.name)):e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:n("dashboard.noEarningsToday")})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-slate-100",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>s("patients"),className:"flex items-center justify-center p-3 bg-emerald-50 hover:bg-emerald-100 rounded-lg transition-colors border border-emerald-200",children:[e.jsx("div",{className:"text-emerald-700",children:B}),e.jsx("span",{className:"ml-2 text-sm font-medium text-emerald-800",children:"Add Patient"})]}),e.jsxs("button",{onClick:()=>s("scheduler"),className:"flex items-center justify-center p-3 bg-sky-50 hover:bg-sky-100 rounded-lg transition-colors border border-sky-200",children:[e.jsx("div",{className:"text-sky-700",children:F}),e.jsx("span",{className:"ml-2 text-sm font-medium text-sky-800",children:"Schedule"})]}),e.jsxs("button",{onClick:()=>s("accountSelection"),className:"flex items-center justify-center p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors border border-green-200",children:[e.jsx("div",{className:"text-green-700",children:ue}),e.jsx("span",{className:"ml-2 text-sm font-medium text-green-800",children:"Finance"})]}),e.jsxs("button",{onClick:()=>s("reports"),className:"flex items-center justify-center p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg transition-colors border border-indigo-200",children:[e.jsx("div",{className:"text-indigo-700",children:Ye}),e.jsx("span",{className:"ml-2 text-sm font-medium text-indigo-800",children:"Reports"})]})]})]})]})]})]})},Xf=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),_v=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),Cv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),dp=({onClose:a,onSave:s,clinicData:n,initialDateTime:o,appointmentToEdit:i})=>{const{t:c}=Ve(),{addNotification:u}=At(),[m,h]=q.useState(()=>{const f=i||{patientId:"",dentistId:"",startTime:o||new Date,endTime:o?new Date(o.getTime()+36e5):new Date(Date.now()+36e5),reason:"",status:Co.SCHEDULED,reminderTime:"1_day_before",reminderSent:!1},x=v=>{const N=new Date().getTimezoneOffset()*6e4;return new Date(v.getTime()-N).toISOString().slice(0,16)};return{...f,startTime:x(new Date(f.startTime)),endTime:x(new Date(f.endTime))}}),y=f=>{const{name:x,value:v}=f.target;h(N=>({...N,[x]:v}))},b=f=>{if(f.preventDefault(),console.log("DEBUG: handleSubmit called with formData:",m),!m.patientId||!m.dentistId||!m.startTime||!m.endTime){console.log("DEBUG: Validation failed - missing required fields"),u(c("addAppointmentModal.alertFillAllFields"),ve.ERROR);return}console.log("DEBUG: Validation passed, calling onSave");const x=new Date().toISOString();s({patientId:m.patientId,dentistId:m.dentistId,startTime:new Date(m.startTime),endTime:new Date(m.endTime),reason:m.reason,status:m.status,reminderTime:m.reminderTime,reminderSent:m.reminderSent,userId:"",createdAt:x,updatedAt:x}),console.log("DEBUG: onSave called successfully"),a()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:c(i?"scheduler.editAppointment":"scheduler.newAppointment")}),e.jsx("button",{onClick:a,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":c("addAppointmentModal.closeAriaLabel"),children:e.jsx(Xf,{})})]}),e.jsxs("form",{onSubmit:b,className:"p-6 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"patientId",className:"block text-sm font-medium text-slate-600",children:c("addAppointmentModal.patient")}),e.jsxs("select",{name:"patientId",id:"patientId",value:m.patientId,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:c("addAppointmentModal.selectPatient")}),n.patients.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dentistId",className:"block text-sm font-medium text-slate-600",children:c("addAppointmentModal.dentist")}),e.jsxs("select",{name:"dentistId",id:"dentistId",value:m.dentistId,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:c("addAppointmentModal.selectDentist")}),n.dentists.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startTime",className:"block text-sm font-medium text-slate-600",children:c("addAppointmentModal.startTime")}),e.jsx("input",{type:"datetime-local",id:"startTime",name:"startTime",value:m.startTime,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endTime",className:"block text-sm font-medium text-slate-600",children:c("addAppointmentModal.endTime")}),e.jsx("input",{type:"datetime-local",id:"endTime",name:"endTime",value:m.endTime,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-slate-600",children:c("addAppointmentModal.reasonForVisit")}),e.jsx("textarea",{name:"reason",id:"reason",value:m.reason,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full h-24 focus:ring-primary focus:border-primary",placeholder:c("addAppointmentModal.reasonPlaceholder"),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600",children:c("scheduler.status")}),e.jsx("select",{name:"status",id:"status",value:m.status,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:Object.values(Co).map(f=>e.jsx("option",{value:f,children:c(`appointmentStatus.${f}`)},f))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reminderTime",className:"block text-sm font-medium text-slate-600",children:c("reminders.reminderTime")}),e.jsxs("select",{name:"reminderTime",id:"reminderTime",value:m.reminderTime,onChange:y,className:"mt-1 p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"none",children:c("reminders.none")}),e.jsx("option",{value:"1_hour_before",children:c("reminders.1_hour_before")}),e.jsx("option",{value:"2_hours_before",children:c("reminders.2_hours_before")}),e.jsx("option",{value:"1_day_before",children:c("reminders.1_day_before")})]})]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:c("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:c("addAppointmentModal.schedule")})]})]})]})})},Ev=({appointment:a,patient:s,dentist:n,onClose:o,onEdit:i,onDelete:c})=>{const{t:u,locale:m}=Ve(),h=new Intl.DateTimeFormat(m,{dateStyle:"full",timeStyle:"short"}),[y,b]=q.useState(!1),f=()=>{c(),o()};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 p-4","aria-modal":"true",role:"dialog",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:u("scheduler.appointmentDetails")}),e.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":u("common.closeForm"),children:e.jsx(Xf,{})})]}),e.jsxs("main",{className:"p-6 space-y-4",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[u("addAppointmentModal.patient"),":"]})," ",s?.name||u("common.unknownPatient")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[u("addAppointmentModal.dentist"),":"]})," ",n?.name||u("common.unknownDentist")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[u("addAppointmentModal.reasonForVisit"),":"]})," ",a.reason]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[u("scheduler.dateTime"),":"]})," ",h.format(a.startTime)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[u("scheduler.duration"),":"]})," ",(a.endTime.getTime()-a.startTime.getTime())/6e4," ",u("scheduler.minutes")]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[u("scheduler.status"),":"]})," ",e.jsx("span",{className:"font-semibold",children:u(`appointmentStatus.${a.status}`)})]})]}),e.jsxs("footer",{className:"pt-2 p-4 flex justify-between items-center bg-slate-50",children:[e.jsx("button",{type:"button",onClick:()=>b(!0),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300",children:u("common.delete")}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:u("common.close")}),e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:u("common.edit")})]})]})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm",children:[e.jsx("header",{className:"p-4 border-b",children:e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:u("scheduler.confirmDelete")})}),e.jsx("main",{className:"p-6",children:e.jsx("p",{children:u("scheduler.deleteAppointmentConfirm")})}),e.jsxs("footer",{className:"pt-2 p-4 flex justify-end space-x-4 bg-slate-50",children:[e.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:u("common.cancel")}),e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300",children:u("common.delete")})]})]})})]})},Zc=(a,s)=>a.getFullYear()===s.getFullYear()&&a.getMonth()===s.getMonth()&&a.getDate()===s.getDate(),up=a=>{const s=a.getFullYear(),n=(a.getMonth()+1).toString().padStart(2,"0"),o=a.getDate().toString().padStart(2,"0");return`${s}-${n}-${o}`},Tv=({clinicData:a})=>{const{appointments:s,patients:n,dentists:o,addAppointment:i,updateAppointment:c,deleteAppointment:u}=a,{t:m,locale:h}=Ve(),[y,b]=q.useState(new Date),[f,x]=q.useState(new Date),[v,N]=q.useState({type:null}),[k,C]=q.useState(13),[w,j]=q.useState(24),D=new Intl.DateTimeFormat(h,{hour:"numeric",minute:"2-digit",hour12:!0}),M=q.useMemo(()=>{const se=new Map;return s.forEach(Y=>{const xe=up(Y.startTime),ce=o.find(B=>B.id===Y.dentistId);ce&&(se.has(xe)||se.set(xe,new Set),se.get(xe).add(ce.color))}),se},[s,o]),{daysInMonth:I,firstDayOfMonth:_}=q.useMemo(()=>{const se=f.getFullYear(),Y=f.getMonth();return{daysInMonth:new Date(se,Y+1,0).getDate(),firstDayOfMonth:new Date(se,Y,1).getDay()}},[f]),A=()=>x(se=>new Date(se.getFullYear(),se.getMonth()-1,1)),Q=()=>x(se=>new Date(se.getFullYear(),se.getMonth()+1,1)),G=q.useMemo(()=>s.filter(se=>Zc(se.startTime,y)).sort((se,Y)=>se.startTime.getTime()-Y.startTime.getTime()),[s,y]),re=q.useMemo(()=>w<=k?[]:Array.from({length:w-k},(se,Y)=>k+Y),[k,w]),le=se=>{console.log("DEBUG: handleSaveAppointment called with data:",se),v.type==="edit"?(console.log("DEBUG: Editing existing appointment"),c({...se,id:v.data.id})):(console.log("DEBUG: Adding new appointment"),i(se)),N({type:null})},he=se=>{u(se),N({type:null})},P=se=>{const Y=new Date(y);Y.setHours(se,0,0,0),N({type:"add",data:{initialDateTime:Y}})},L=new Intl.DateTimeFormat(h,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),z=new Intl.DateTimeFormat(h,{month:"long",year:"numeric"}),ee=new Intl.DateTimeFormat(h,{weekday:"short"});return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md flex flex-col h-full",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4 print:hidden",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:L.format(y)}),e.jsxs("div",{className:"flex items-center flex-wrap gap-x-4 gap-y-2 text-sm text-slate-600 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"start-hour",className:"font-medium",children:[m("scheduler.showFrom"),":"]}),e.jsx("select",{id:"start-hour",value:k,onChange:se=>C(parseInt(se.target.value,10)),className:"p-1 border border-slate-300 rounded-md bg-white focus:ring-primary focus:border-primary",children:Array.from({length:24}).map((se,Y)=>e.jsx("option",{value:Y,children:D.format(new Date(0,0,0,Y))},Y))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{htmlFor:"end-hour",className:"font-medium",children:[m("scheduler.to"),":"]}),e.jsx("select",{id:"end-hour",value:w,onChange:se=>j(parseInt(se.target.value,10)),className:"p-1 border border-slate-300 rounded-md bg-white focus:ring-primary focus:border-primary",children:Array.from({length:25}).map((se,Y)=>Y>0&&e.jsx("option",{value:Y,children:D.format(new Date(0,0,0,Y))},Y))})]})]})]}),e.jsx("button",{onClick:()=>N({type:"add",data:{initialDateTime:y}}),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark w-full sm:w-auto focus:outline-none focus:ring-2 focus:ring-primary-light self-start sm:self-center",children:m("scheduler.newAppointment")})]}),e.jsxs("div",{className:"flex-1 flex flex-col md:flex-row gap-6 overflow-hidden",children:[e.jsxs("div",{className:"w-full md:w-72 flex-shrink-0 print:hidden",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-semibold text-slate-700",children:z.format(f)}),e.jsxs("div",{className:"flex",children:[e.jsx("button",{onClick:A,className:"p-2 rounded-full hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":m("scheduler.previousWeek"),children:e.jsx(_v,{})}),e.jsx("button",{onClick:Q,className:"p-2 rounded-full hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":m("scheduler.nextWeek"),children:e.jsx(Cv,{})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-center text-sm",children:[["Su","Mo","Tu","We","Th","Fr","Sa"].map((se,Y)=>e.jsx("div",{className:"text-slate-500 font-semibold text-xs",children:ee.format(new Date(2023,0,Y+1))},Y)),Array.from({length:_}).map((se,Y)=>e.jsx("div",{},`empty-${Y}`)),Array.from({length:I}).map((se,Y)=>{const xe=new Date(f.getFullYear(),f.getMonth(),Y+1),ce=up(xe),B=Zc(xe,y),F=Zc(xe,new Date),ue=M.get(ce);return e.jsxs("button",{onClick:()=>b(xe),className:`relative p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-primary-light ${B?"bg-primary text-white":F?"bg-slate-200":"hover:bg-slate-100"}`,children:[Y+1,ue&&e.jsx("div",{className:"absolute bottom-1 start-1/2 -translate-x-1/2 flex gap-0.5",children:Array.from(ue).slice(0,3).map(We=>e.jsx("span",{className:`block w-1.5 h-1.5 rounded-full ${We}`},We))})]},ce)})]})]}),e.jsx("div",{className:"flex-1 relative overflow-y-auto border-s border-e border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-[auto_1fr] h-full",children:[e.jsx("div",{className:"w-16 text-end text-sm text-slate-500",children:re.map(se=>e.jsx("div",{className:"h-16 relative -top-2 pe-2",children:D.format(new Date(0,0,0,se))},se))}),e.jsx("div",{className:"relative",children:re.map(se=>{const Y=se,xe=se+1,ce=G.filter(B=>{const F=B.startTime.getHours();return F>=Y&&F<xe});return e.jsx("div",{className:"h-16 border-t border-slate-200 flex items-start gap-1 p-1",onClick:()=>P(se),role:"button",children:ce.map(B=>{const F=B.startTime.getHours()*60+B.startTime.getMinutes(),We=B.endTime.getHours()*60+B.endTime.getMinutes()-F,Ye=Math.max(We/60*4,1),Qe=n.find(Pe=>Pe.id===B.patientId),Ne=o.find(Pe=>Pe.id===B.dentistId);return e.jsxs("div",{className:`flex-1 p-2 rounded-lg text-white shadow-md overflow-hidden cursor-pointer transition-all hover:shadow-lg ${Ne?.color||"bg-slate-500"}`,style:{height:`${Ye}rem`,minWidth:"120px"},onClick:Pe=>{Pe.stopPropagation(),N({type:"details",data:B})},children:[e.jsx("p",{className:"font-semibold text-xs truncate",children:Qe?.name}),e.jsx("p",{className:"text-xs opacity-90 truncate",children:B.reason}),e.jsx("p",{className:"text-xs opacity-75 truncate",children:Ne?.name})]},B.id)})},se)})})]})})]}),v.type==="add"&&e.jsx(dp,{onClose:()=>N({type:null}),onSave:le,clinicData:a,initialDateTime:v.data.initialDateTime}),v.type==="edit"&&e.jsx(dp,{onClose:()=>N({type:null}),onSave:le,clinicData:a,appointmentToEdit:v.data}),v.type==="details"&&e.jsx(Ev,{appointment:v.data,patient:n.find(se=>se.id===v.data.patientId),dentist:o.find(se=>se.id===v.data.dentistId),onClose:()=>N({type:null}),onEdit:()=>N({type:"edit",data:v.data}),onDelete:()=>he(v.data.id)})]})},Dv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Pv=({dentistId:a,onClose:s,onAdd:n,doctorPayments:o})=>{const{t:i}=Ve(),{addNotification:c}=At(),{dentists:u,treatmentRecords:m}=ul(),[h,y]=q.useState({dentistId:a,date:new Date().toISOString().split("T")[0],amount:0,notes:""}),b=x=>{const{name:v,value:N}=x.target;y(k=>({...k,[v]:v==="amount"?parseFloat(N):N}))},f=x=>{if(x.preventDefault(),!h.date||!h.amount){c(i("addDoctorPaymentModal.alertRequiredFields"),ve.ERROR);return}if(h.amount<=0){c(i("addDoctorPaymentModal.alertPositiveAmount"),ve.ERROR);return}const v=new Date(h.date);if(isNaN(v.getTime())){c(i("addDoctorPaymentModal.alertInvalidDate"),ve.ERROR);return}const N=new Date;if(N.setHours(0,0,0,0),v>N){c(i("addDoctorPaymentModal.alertFutureDate"),ve.ERROR);return}if(!u.find(I=>I.id===a)){c(i("addDoctorPaymentModal.alertDoctorNotFound"),ve.ERROR);return}const w=m.filter(I=>I.dentistId===a).reduce((I,_)=>I+_.doctorShare,0),j=o.filter(I=>I.dentistId===a).reduce((I,_)=>I+_.amount,0),D=w-j;if(D<=0){c("     ",ve.ERROR);return}if(h.amount>D){c(`    : ${D.toFixed(2)}`,ve.ERROR);return}if(o.some(I=>I.dentistId===a&&I.date===h.date&&I.amount===h.amount)){c(i("addDoctorPaymentModal.alertDuplicatePayment"),ve.ERROR);return}n(h),s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center flex-shrink-0",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i("addDoctorPaymentModal.title")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(Dv,{})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 overflow-y-auto flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDoctorPaymentModal.paymentDate")}),e.jsx("input",{id:"paymentDate",name:"date",type:"date",value:h.date,onChange:b,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDoctorPaymentModal.amount")}),e.jsx("input",{id:"amount",name:"amount",type:"number",step:"0.01",value:h.amount,onChange:b,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,min:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-slate-600 mb-1",children:i("addDoctorPaymentModal.notes")}),e.jsx("textarea",{id:"notes",name:"notes",value:h.notes||"",onChange:b,placeholder:i("addDoctorPaymentModal.notesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("addDoctorPaymentModal.savePayment")})]})]})]})})},Zf=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Iv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),Rv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Wd=["bg-sky-500","bg-emerald-500","bg-amber-500","bg-rose-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-purple-500"],Av=({doctor:a,onClose:s,onUpdate:n,clinicData:o})=>{const{t:i,locale:c}=Ve(),{addNotification:u}=At(),{appointments:m,patients:h,treatmentRecords:y,treatmentDefinitions:b,doctorPayments:f}=o,[x,v]=q.useState(!1),[N,k]=q.useState(a),[C,w]=q.useState("details"),[j,D]=q.useState(!1),M=q.useMemo(()=>m.filter(z=>z.dentistId===a.id).sort((z,ee)=>ee.startTime.getTime()-z.startTime.getTime()),[m,a.id]),I=q.useMemo(()=>y.filter(z=>z.dentistId===a.id).sort((z,ee)=>new Date(ee.treatmentDate).getTime()-new Date(z.treatmentDate).getTime()),[y,a.id]),_=q.useMemo(()=>(f||[]).filter(z=>z.dentistId===a.id).sort((z,ee)=>new Date(ee.date).getTime()-new Date(z.date).getTime()),[f,a.id]),A=q.useMemo(()=>{const z=I.reduce((xe,ce)=>{const B=b.find(F=>F.id===ce.treatmentDefinitionId);return xe+(B?B.basePrice:0)},0),ee=I.reduce((xe,ce)=>xe+ce.doctorShare,0),se=_.reduce((xe,ce)=>xe+ce.amount,0),Y=ee-se;return{totalRevenue:z,totalEarnings:ee,totalPaymentsReceived:se,netBalance:Y}},[I,_,b]),Q=z=>{k(ee=>({...ee,[z.target.name]:z.target.value}))},G=z=>{k(ee=>({...ee,color:z}))},re=()=>{n(N),v(!1)},le=q.useCallback(z=>{o.addDoctorPayment(z),D(!1),u(i("notifications.paymentAdded"),ve.SUCCESS)},[o,u,i]),he=new Intl.DateTimeFormat(c,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),P=new Intl.DateTimeFormat(c,{year:"numeric",month:"short",day:"numeric"}),L=new Intl.NumberFormat(c,{style:"currency",currency:"EGP"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[!x&&e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-3 py-1 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-slate-300",children:[e.jsx(Rv,{})," ",i("common.edit")]}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("doctorDetails.closeAriaLabel"),children:e.jsx(Zf,{})})]})]}),e.jsx("nav",{className:"border-b border-slate-200 bg-slate-50 flex-shrink-0",children:e.jsx("ul",{className:"-mb-px flex space-x-4 rtl:space-x-reverse overflow-x-auto text-sm font-medium text-center text-slate-500",children:[{key:"details",label:"doctorDetails.tabDetails"},{key:"treatments",label:"doctorDetails.tabTreatments"},{key:"financials",label:"doctorDetails.tabFinancials"}].map(({key:z,label:ee})=>e.jsx("li",{children:e.jsx("button",{onClick:()=>w(z),className:`inline-block p-4 border-b-2 ${C===z?"border-primary text-primary":"border-transparent hover:text-slate-700 hover:border-slate-300"}`,children:i(ee)})},z))})}),e.jsxs("main",{className:"p-6 overflow-y-auto flex-1 bg-neutral",children:[C==="details"&&e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm space-y-4",children:x?e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{htmlFor:"edit-doctor-name",className:"sr-only",children:i("doctorDetails.fullName")}),e.jsx("input",{id:"edit-doctor-name",name:"name",value:N.name,onChange:Q,placeholder:i("doctorDetails.fullName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),e.jsx("label",{htmlFor:"edit-doctor-specialty",className:"sr-only",children:i("doctorDetails.specialty")}),e.jsx("input",{id:"edit-doctor-specialty",name:"specialty",value:N.specialty,onChange:Q,placeholder:i("doctorDetails.specialty"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:i("doctorDetails.colorTag")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Wd.map(z=>e.jsx("button",{type:"button",onClick:()=>G(z),className:`w-8 h-8 rounded-full ${z} ${N.color===z?"ring-2 ring-offset-2 ring-primary":""} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light`,"aria-label":i("doctorDetails.selectColorAriaLabel",{color:z.replace("bg-","")})},z))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("strong",{className:"text-slate-500 block",children:[i("doctorDetails.specialty"),":"]})," ",a.specialty]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-600 mb-2",children:i("doctorDetails.appointmentSchedule")}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg text-sm text-slate-600 max-h-48 overflow-y-auto shadow-inner",children:M.length>0?e.jsx("ul",{className:"space-y-2",children:M.map(z=>{const ee=h.find(se=>se.id===z.patientId);return e.jsxs("li",{className:"flex justify-between items-center bg-white p-2 rounded-md shadow-sm",children:[e.jsxs("span",{children:[he.format(z.startTime),": ",ee?.name," (",z.reason,")"]}),e.jsx("span",{className:"text-xs p-1 bg-slate-200 rounded",children:i(`appointmentStatus.${z.status}`)})]},z.id)})}):e.jsx("p",{children:i("doctorDetails.noAppointmentsFound")})})]})]})}),C==="treatments"&&e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-4",children:i("doctorDetails.treatmentsPerformed")}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg text-sm text-slate-600 max-h-96 overflow-y-auto shadow-inner",children:I.length>0?e.jsx("ul",{className:"space-y-2",children:I.map(z=>{const ee=h.find(Y=>Y.id===z.patientId),se=b.find(Y=>Y.id===z.treatmentDefinitionId);return e.jsxs("li",{className:"flex justify-between items-center bg-white p-2 rounded-md shadow-sm",children:[e.jsxs("span",{children:[P.format(new Date(z.treatmentDate)),": ",se?.name," (",ee?.name,")"]}),e.jsx("span",{className:"font-semibold",children:L.format(z.doctorShare)})]},z.id)})}):e.jsx("p",{children:i("doctorDetails.noTreatmentsFound")})})]}),C==="financials"&&e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-4",children:i("doctorDetails.financialSummary")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-neutral-light p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-slate-600",children:i("doctorDetails.totalEarnings")}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:L.format(A.totalEarnings)})]}),e.jsxs("div",{className:"bg-neutral-light p-3 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-slate-600",children:i("doctorDetails.totalPaymentsReceived")}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:L.format(A.totalPaymentsReceived)})]}),e.jsxs("div",{className:`col-span-1 sm:col-span-2 p-3 rounded-lg text-center ${A.netBalance>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("p",{className:"text-sm font-semibold",children:i("doctorDetails.netBalance")}),e.jsx("p",{className:"text-xl font-bold",children:L.format(A.netBalance)}),e.jsx("p",{className:"text-xs mt-1",children:A.netBalance>=0?i("financials.amountDue"):i("financials.overpaid")})]})]}),e.jsx("div",{className:"flex justify-start gap-3 mb-6 flex-wrap"}),e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-4",children:i("doctorDetails.transactions")}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner max-h-96 overflow-y-auto",children:_.length===0&&I.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:i("doctorDetails.noTransactions")}):e.jsxs("div",{className:"space-y-2",children:[_.map(z=>e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm flex justify-between items-center border-l-4 border-green-500",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:i("doctorDetails.payments")}),e.jsxs("p",{className:"text-sm text-slate-600",children:[P.format(new Date(z.date)),z.notes&&e.jsx("span",{className:"ms-2 ps-2 border-s border-slate-300",children:z.notes})]})]}),e.jsx("span",{className:"font-bold text-green-700",children:L.format(z.amount)})]},z.id)),I.map(z=>{const ee=h.find(Y=>Y.id===z.patientId),se=b.find(Y=>Y.id===z.treatmentDefinitionId);return e.jsxs("div",{className:"bg-white p-3 rounded-md shadow-sm flex justify-between items-center border-l-4 border-blue-500",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-slate-800",children:[i("doctorDetails.earnings")," - ",se?.name," (",ee?.name,")"]}),e.jsxs("p",{className:"text-sm text-slate-600",children:[P.format(new Date(z.treatmentDate)),z.notes&&e.jsxs("span",{className:"ms-2 ps-2 border-s border-slate-300",children:[z.notes.slice(0,50),"..."]})]})]}),e.jsx("span",{className:"font-bold text-blue-700",children:L.format(z.doctorShare)})]},z.id)})]})})]})]}),x&&e.jsxs("footer",{className:"p-4 border-t flex justify-end space-x-4 bg-slate-50 rounded-b-xl",children:[e.jsx("button",{type:"button",onClick:()=>{v(!1),k(a)},className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"button",onClick:re,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("common.saveChanges")})]}),j&&e.jsx(Pv,{dentistId:a.id,onClose:()=>D(!1),onAdd:le,doctorPayments:o.doctorPayments})]})})},Ov=({onClose:a,onAdd:s})=>{const{t:n}=Ve(),[o,i]=q.useState({name:"",specialty:"",color:Wd[0]}),c=h=>{i(y=>({...y,[h.target.name]:h.target.value}))},u=h=>{i(y=>({...y,color:h}))},m=h=>{h.preventDefault(),s(o),a()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:n("addDoctorModal.title")}),e.jsx("button",{onClick:a,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":n("addDoctorModal.closeAriaLabel"),children:e.jsx(Zf,{})})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4 overflow-y-auto",children:[e.jsx("label",{htmlFor:"add-doctor-name",className:"sr-only",children:n("addDoctorModal.fullName")}),e.jsx("input",{id:"add-doctor-name",name:"name",value:o.name,onChange:c,placeholder:n("addDoctorModal.fullName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsx("label",{htmlFor:"add-doctor-specialty",className:"sr-only",children:n("addDoctorModal.specialty")}),e.jsx("input",{id:"add-doctor-specialty",name:"specialty",value:o.specialty,onChange:c,placeholder:n("addDoctorModal.specialty"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:n("addDoctorModal.colorTag")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Wd.map(h=>e.jsx("button",{type:"button",onClick:()=>u(h),className:`w-8 h-8 rounded-full ${h} ${o.color===h?"ring-2 ring-offset-2 ring-primary":""} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light`,"aria-label":n("doctorDetails.selectColorAriaLabel",{color:h.replace("bg-","")})},h))})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:n("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:n("addDoctorModal.saveDoctor")})]})]})]})})},Mv=({clinicData:a})=>{const{dentists:s,addDoctor:n,updateDoctor:o,treatmentRecords:i,doctorPayments:c}=a,{t:u}=Ve(),[m,h]=q.useState(null),[y,b]=q.useState(!1),f=new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"});return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:()=>b(!0),className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(Iv,{}),u("doctorList.addNewDoctor")]})}),e.jsx("div",{className:"space-y-3",children:s.map(x=>{const v=i.filter(C=>C.dentistId===x.id).reduce((C,w)=>C+w.doctorShare,0),N=c.filter(C=>C.dentistId===x.id).reduce((C,w)=>C+w.amount,0),k=v-N;return e.jsxs("div",{className:"border border-slate-200 rounded-xl p-4 flex justify-between items-center gap-3 hover:bg-slate-50 shadow-sm transition-shadow duration-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-4 h-4 rounded-full ${x.color}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:x.name}),e.jsx("p",{className:"text-sm text-slate-600",children:x.specialty}),k>0&&e.jsxs("p",{className:"text-xs font-semibold text-blue-600 mt-1",children:[" : ",f.format(k)]})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>h(x),className:"text-primary hover:text-primary-dark font-semibold px-4 py-2 rounded-lg bg-primary/10 hover:bg-primary/20 text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:u("doctorList.viewDetails")})})]},x.id)})}),m&&e.jsx(Av,{doctor:m,onUpdate:o,onClose:()=>h(null),clinicData:a}),y&&e.jsx(Ov,{onAdd:n,onClose:()=>b(!1)})]})},Lv=()=>e.jsx("style",{children:`
    @media print {
      @page {
        size: A4;
        margin: 1cm;
      }
      body {
        font-size: 12px;
        line-height: 1.4;
      }
      .print-header {
        margin-bottom: 1.5rem;
        page-break-after: avoid;
      }
      .print-section {
        margin-bottom: 1rem;
        page-break-inside: avoid;
      }
      table {
        font-size: 10px;
      }
      h1 {
        font-size: 18px;
      }
      h2, h3, h4 {
        font-size: 14px;
      }
    }
  `}),hr=({title:a,headers:s,data:n})=>e.jsxs("div",{className:"mb-6 break-inside-avoid",children:[e.jsx("h4",{className:"text-md font-bold text-slate-800 mb-2",children:a}),e.jsxs("table",{className:"w-full text-sm border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsx("tr",{children:s.map(o=>e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:o},o))})}),e.jsx("tbody",{children:n.map((o,i)=>e.jsx("tr",{className:"border-b border-slate-200",children:o.map((c,u)=>e.jsx("td",{className:"p-2 border border-slate-300",children:c},u))},i))})]})]}),au=({clinicData:a,activeTab:s,startDate:n,endDate:o})=>{const{t:i,locale:c}=Ve(),{patients:u,appointments:m,expenses:h,inventoryItems:y,treatmentDefinitions:b,dentists:f,treatmentRecords:x,labCases:v,payments:N,supplierInvoices:k,suppliers:C,clinicInfo:w}=a,j=new Intl.NumberFormat(c,{style:"currency",currency:"EGP"}),D=new Intl.DateTimeFormat(c,{year:"numeric",month:"short",day:"numeric"}),M=(P,L)=>{if(!n||!o)return P;const z=new Date(n);z.setHours(0,0,0,0);const ee=new Date(o);return ee.setHours(23,59,59,999),P.filter(se=>{const Y=se[L],xe=new Date(Y);return!isNaN(xe.getTime())&&xe>=z&&xe<=ee})},I=q.useMemo(()=>{const P=u.filter(se=>{if(!n||!o)return!0;const Y=new Date(n);Y.setHours(0,0,0,0);const xe=new Date(o);xe.setHours(23,59,59,999);const ce=new Date(se.lastVisit);return ce>=Y&&ce<=xe}),L=P.reduce((se,Y)=>(se[Y.gender]=(se[Y.gender]||0)+1,se),{}),z={"0-18":0,"19-35":0,"36-55":0,"56+":0};P.forEach(se=>{const Y=new Date(se.dob),xe=Date.now()-Y.getTime(),ce=new Date(xe),B=Math.abs(ce.getUTCFullYear()-1970);B<=18?z["0-18"]++:B<=35?z["19-35"]++:B<=55?z["36-55"]++:z["56+"]++});const ee=u.filter(se=>{const Y=new Date(se.lastVisit);if(!n||!o)return!1;const xe=new Date(n);xe.setHours(0,0,0,0);const ce=new Date(o);return ce.setHours(23,59,59,999),Y>=xe&&Y<=ce}).length;return{totalPatients:P.length,genderDistribution:L,ageDistribution:z,newPatientsThisPeriod:ee}},[u,n,o]),_=q.useMemo(()=>{const P=M(x,"treatmentDate"),L=M(h,"date"),z=P.reduce((B,F)=>B+F.totalTreatmentCost,0),ee=L.reduce((B,F)=>B+F.amount,0),se=a.doctorPayments.reduce((B,F)=>B+F.amount,0),Y=z-(ee+se),xe={};P.forEach(B=>{const F=b.find(ue=>ue.id===B.treatmentDefinitionId)?.name||i("common.unknownTreatment");xe[F]=(xe[F]||0)+B.totalTreatmentCost});const ce={[Gr.RENT]:0,[Gr.SALARIES]:0,[Gr.UTILITIES]:0,[Gr.LAB_FEES]:0,[Gr.SUPPLIES]:0,[Gr.MARKETING]:0,[Gr.MISC]:0};return L.forEach(B=>{ce[B.category]+=B.amount}),{totalIncome:z,totalExpenses:ee,netProfit:Y,incomeByTreatment:xe,expensesByCategory:ce}},[x,h,b,n,o,i]),A=q.useMemo(()=>{const P=M(m,"startTime"),L=P.length,z=P.filter(xe=>xe.status===Co.COMPLETED).length,ee=P.filter(xe=>xe.status===Co.CANCELLED).length,se=L>0?z/L*100:0,Y={};return P.forEach(xe=>{const ce=f.find(B=>B.id===xe.dentistId)?.name||i("common.unknownDentist");Y[ce]=(Y[ce]||0)+1}),{totalAppointments:L,completedAppointments:z,cancelledAppointments:ee,completionRate:se,appointmentsByDentist:Y}},[m,f,n,o,i]),Q=q.useMemo(()=>{const L=y.filter(ee=>ee.currentStock<=5),z=y.reduce((ee,se)=>ee+se.currentStock*se.unitCost,0);return{lowStockItems:L,allInventoryItems:y,allItemsValue:z}},[y]),G=q.useMemo(()=>{const P=M(x,"treatmentDate"),L={};return P.forEach(ee=>{const se=b.find(Y=>Y.id===ee.treatmentDefinitionId)?.name||i("common.unknownTreatment");L[se]||(L[se]={count:0,totalRevenue:0,totalClinicShare:0,totalDoctorShare:0}),L[se].count++,L[se].totalRevenue+=ee.totalTreatmentCost,L[se].totalClinicShare+=ee.clinicShare,L[se].totalDoctorShare+=ee.doctorShare}),{allTreatmentPerformance:Object.entries(L).map(([ee,se])=>({treatment:ee,count:se.count,averagePrice:se.count>0?se.totalRevenue/se.count:0,totalRevenue:se.totalRevenue,totalClinicShare:se.totalClinicShare,totalDoctorShare:se.totalDoctorShare})).sort((ee,se)=>se.totalRevenue-ee.totalRevenue)}},[x,b,n,o,i]),re=q.useMemo(()=>({filteredLabCases:M(v,"sentDate")}),[v,n,o]);q.useMemo(()=>({filteredPayments:M(N,"date")}),[N,n,o]);const le=q.useMemo(()=>({filteredSupplierInvoices:M(k,"invoiceDate")}),[k,n,o]),he={patientStats:i("reports.tabPatientStatistics"),financialSummary:i("reports.tabFinancialSummary"),appointmentOverview:i("reports.tabAppointmentOverview"),inventoryReport:i("reports.tabInventoryReport"),treatmentPerformance:i("reports.tabTreatmentPerformance"),labCasesReport:i("reports.tabLabCasesReport"),paymentsReport:i("reports.tabPaymentsReport"),supplierInvoicesReport:i("reports.tabSupplierInvoicesReport"),dentistsReport:i("reports.tabDentistsReport"),suppliersReport:i("reports.tabSuppliersReport"),dailyFinancialSummary:i("reports.dailyFinancialSummary.title"),monthlyFinancialSummary:i("reports.monthlyFinancialSummary.title"),quarterlyAnnualOverview:i("reports.quarterlyAnnualOverview.title")};return e.jsxs(e.Fragment,{children:[e.jsx(Lv,{}),e.jsxs("div",{className:"p-4 bg-white text-slate-900",dir:"rtl",children:[e.jsxs("header",{className:"print-header text-center mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-1",children:w.name||i("appName")}),e.jsxs("div",{className:"text-sm text-slate-600 space-y-1",children:[w.address&&e.jsx("p",{children:w.address}),e.jsxs("div",{className:"flex justify-center gap-4",children:[w.phone&&e.jsxs("span",{children:[i("common.phone"),": ",w.phone]}),w.email&&e.jsxs("span",{children:[i("common.email"),": ",w.email]})]})]})]}),e.jsx("h2",{className:"text-xl font-semibold text-slate-700 mb-2",children:he[s]}),e.jsxs("p",{className:"text-md text-slate-600",children:[i("reports.dateRange"),": ",n?D.format(new Date(n)):i("common.na")," - ",o?D.format(new Date(o)):i("common.na")]})]}),e.jsxs("main",{children:[s==="patientStats"&&e.jsxs("div",{className:"print-section space-y-6",children:[e.jsx(hr,{title:i("reports.patientStats.genderDistribution"),headers:[i("patientDetails.gender"),i("reports.treatmentPerformance.count")],data:Object.entries(I.genderDistribution).map(([P,L])=>[i(P.toLowerCase()),L])}),e.jsx(hr,{title:i("reports.patientStats.ageDistribution"),headers:[i("reports.patientStats.ageGroup"),i("reports.treatmentPerformance.count")],data:Object.entries(I.ageDistribution).map(([P,L])=>[P,L])})]}),s==="financialSummary"&&e.jsxs("div",{className:"print-section space-y-6",children:[e.jsx(hr,{title:i("reports.financialSummary.incomeByTreatment"),headers:[i("reports.treatmentPerformance.treatment"),i("reports.financialSummary.totalIncome")],data:Object.entries(_.incomeByTreatment).map(([P,L])=>[P,j.format(L)])}),e.jsx(hr,{title:i("reports.financialSummary.expensesByCategory"),headers:[i("expenses.category"),i("expenses.amount")],data:Object.entries(_.expensesByCategory).filter(([,P])=>P>0).map(([P,L])=>[i(`expenseCategory.${P}`),j.format(L)])})]}),s==="appointmentOverview"&&e.jsx("div",{className:"print-section space-y-6",children:e.jsx(hr,{title:i("reports.appointmentOverview.appointmentsByDentist"),headers:[i("addAppointmentModal.dentist"),i("reports.appointmentOverview.totalAppointments")],data:Object.entries(A.appointmentsByDentist).map(([P,L])=>[P,L])})}),s==="inventoryReport"&&e.jsx("div",{className:"print-section space-y-6",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.inventoryReport.allInventoryItems")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.inventoryReport.itemName")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.inventoryReport.currentStock")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.inventoryReport.unitCost")})]})}),e.jsx("tbody",{children:Q.allInventoryItems.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:P.name}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.currentStock}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.unitCost)})]},P.id))})]})}),s==="treatmentPerformance"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.treatmentPerformance.allTreatmentPerformance")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.treatment")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.count")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.averagePrice")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.totalRevenue")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.totalClinicShare")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("reports.treatmentPerformance.totalDoctorShare")})]})}),e.jsx("tbody",{children:G.allTreatmentPerformance.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:P.treatment}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.count}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.averagePrice)}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.totalRevenue)}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.totalClinicShare)}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.totalDoctorShare)})]},P.treatment))})]})}),s==="labCasesReport"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.labCasesReport.allLabCases")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("labCase.patientName")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("labCase.caseType")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("labCase.status")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("labCase.cost")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("labCase.dueDate")})]})}),e.jsx("tbody",{children:re.filteredLabCases.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:u.find(L=>L.id===P.patientId)?.name||i("common.unknownPatient")}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.caseType}),e.jsx("td",{className:"p-2 border border-slate-300",children:i(`labCaseStatus.${P.status}`)}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.labCost)}),e.jsx("td",{className:"p-2 border border-slate-300",children:D.format(new Date(P.dueDate))})]},P.id))})]})}),s==="paymentsReport"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.paymentsReport.allPayments")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("payment.patientName")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("payment.amount")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("payment.method")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("payment.date")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("payment.notes")})]})}),e.jsx("tbody",{children:N.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:u.find(L=>L.id===P.patientId)?.name||i("common.unknownPatient")}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.amount)}),e.jsx("td",{className:"p-2 border border-slate-300",children:i(`paymentMethod.${P.method}`)}),e.jsx("td",{className:"p-2 border border-slate-300",children:D.format(new Date(P.date))}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.notes||"-"})]},P.id))})]})}),s==="supplierInvoicesReport"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.supplierInvoicesReport.allSupplierInvoices")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplierInvoice.supplierName")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplierInvoice.invoiceNumber")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplierInvoice.totalAmount")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplierInvoice.date")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplierInvoice.status")})]})}),e.jsx("tbody",{children:le.filteredSupplierInvoices.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:C.find(L=>L.id===P.supplierId)?.name||i("common.unknownSupplier")}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.invoiceNumber}),e.jsx("td",{className:"p-2 border border-slate-300",children:j.format(P.amount)}),e.jsx("td",{className:"p-2 border border-slate-300",children:D.format(new Date(P.invoiceDate))}),e.jsx("td",{className:"p-2 border border-slate-300",children:i(`supplierInvoiceStatus.${P.status}`)})]},P.id))})]})}),s==="dentistsReport"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.dentistsReport.allDentists")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("dentist.name")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("dentist.specialty")})]})}),e.jsx("tbody",{children:f.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:P.name}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.specialty})]},P.id))})]})}),s==="suppliersReport"&&e.jsx("div",{className:"print-section",children:e.jsxs("table",{className:"min-w-full text-sm text-slate-700 border-collapse border border-slate-300",children:[e.jsx("caption",{className:"text-md font-bold text-slate-800 mb-2 text-start p-2 bg-slate-100",children:i("reports.suppliersReport.allSuppliers")}),e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplier.name")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplier.contactPerson")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplier.phone")}),e.jsx("th",{className:"p-2 text-right font-semibold border border-slate-300",children:i("supplier.email")})]})}),e.jsx("tbody",{children:C.map(P=>e.jsxs("tr",{className:"border-b border-slate-200 last:border-b-0",children:[e.jsx("td",{className:"p-2 border border-slate-300",children:P.name}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.contactPerson}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.phone}),e.jsx("td",{className:"p-2 border border-slate-300",children:P.email})]},P.id))})]})}),s==="dailyFinancialSummary"&&e.jsxs("div",{className:"print-section space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800",children:[i("reports.dailyFinancialSummary.title")," - ",new Date(n).toLocaleDateString(c)]}),e.jsx(hr,{title:i("reports.dailyFinancialSummary.kpiCards"),headers:[i("common.metric"),i("common.value")],data:[[i("reports.dailyFinancialSummary.todaysRevenue"),j.format(N.filter(P=>P.date===n).reduce((P,L)=>P+L.amount,0))],[i("dashboard.totalEarnings"),j.format(N.filter(P=>P.date===n).reduce((P,L)=>P+L.doctorShare,0))],[i("reports.dailyFinancialSummary.todaysExpenses"),j.format(h.filter(P=>P.date===n).reduce((P,L)=>P+L.amount,0))],[i("reports.dailyFinancialSummary.todaysProfit"),j.format(N.filter(P=>P.date===n).reduce((P,L)=>P+L.amount,0)-h.filter(P=>P.date===n).reduce((P,L)=>P+L.amount,0)-N.filter(P=>P.date===n).reduce((P,L)=>P+L.doctorShare,0))],[i("reports.dailyFinancialSummary.pendingPayments"),j.format(x.filter(P=>new Date(P.treatmentDate)<=new Date(n)).reduce((P,L)=>P+L.totalTreatmentCost,0)-N.filter(P=>new Date(P.date)<=new Date(n)).reduce((P,L)=>P+L.amount,0))],[i("reports.dailyFinancialSummary.overdueInvoices"),j.format(x.filter(P=>{const L=new Date(P.treatmentDate);return(new Date(n).getTime()-L.getTime())/(1e3*60*60*24)>30&&P.totalTreatmentCost>N.filter(ee=>ee.patientId===P.patientId).reduce((ee,se)=>ee+se.amount,0)}).reduce((P,L)=>P+L.totalTreatmentCost,0))]]}),e.jsx(hr,{title:i("reports.dailyFinancialSummary.todaysPayments"),headers:[i("common.patient"),i("payment.amount"),i("payment.method")],data:N.filter(P=>P.date===n).map(P=>[u.find(z=>z.id===P.patientId)?.name||i("common.unknown"),j.format(P.amount),P.method])}),e.jsx(hr,{title:i("reports.dailyFinancialSummary.todaysExpenses"),headers:[i("expense.description"),i("expense.amount"),i("expense.category")],data:h.filter(P=>P.date===n).map(P=>[P.description,j.format(P.amount),i(`expenseCategory.${P.category}`)])})]}),s==="monthlyFinancialSummary"&&e.jsxs("div",{className:"print-section space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800",children:[i("reports.monthlyFinancialSummary.title")," - ",new Date(n).toLocaleDateString(c,{month:"long",year:"numeric"})]}),e.jsx(hr,{title:i("reports.monthlyFinancialSummary.kpiCards"),headers:[i("common.metric"),i("common.value")],data:[[i("reports.monthlyFinancialSummary.thisMonthRevenue"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0))],[i("dashboard.totalEarnings"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.doctorShare,0))],[i("reports.monthlyFinancialSummary.thisMonthExpenses"),j.format(h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0))],[i("reports.monthlyFinancialSummary.clinicProfitThisMonth"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0)-h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0)-N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.doctorShare,0))]]}),e.jsx(hr,{title:i("reports.monthlyFinancialSummary.monthlyPayments"),headers:[i("common.patient"),i("payment.amount"),i("common.date")],data:N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).slice(0,20).map(P=>[u.find(z=>z.id===P.patientId)?.name||i("common.unknown"),j.format(P.amount),D.format(new Date(P.date))])}),e.jsx(hr,{title:i("reports.monthlyFinancialSummary.monthlyExpenses"),headers:[i("expense.description"),i("expense.amount"),i("expense.category")],data:h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).slice(0,20).map(P=>[P.description,j.format(P.amount),i(`expenseCategory.${P.category}`)])})]}),s==="quarterlyAnnualOverview"&&e.jsxs("div",{className:"print-section space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800",children:[i("reports.quarterlyAnnualOverview.title")," - ",n.split("-")[0]]}),e.jsx(hr,{title:i("reports.quarterlyAnnualOverview.kpiCards"),headers:[i("common.metric"),i("common.value")],data:[[i("reports.quarterlyAnnualOverview.totalRevenue"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0))],[i("dashboard.totalEarnings"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.doctorShare,0))],[i("reports.quarterlyAnnualOverview.totalExpenses"),j.format(h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0))],[i("reports.quarterlyAnnualOverview.cumulativeProfit"),j.format(N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0)-h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.amount,0)-N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).reduce((P,L)=>P+L.doctorShare,0))]]}),e.jsx(hr,{title:i("reports.quarterlyAnnualOverview.periodPayments"),headers:[i("common.patient"),i("payment.amount"),i("common.date")],data:N.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).slice(0,20).map(P=>[u.find(z=>z.id===P.patientId)?.name||i("common.unknown"),j.format(P.amount),D.format(new Date(P.date))])}),e.jsx(hr,{title:i("reports.quarterlyAnnualOverview.periodExpenses"),headers:[i("expense.description"),i("expense.amount"),i("expense.category")],data:h.filter(P=>{const L=new Date(P.date),z=new Date(n),ee=new Date(o);return L>=z&&L<=ee}).slice(0,20).map(P=>[P.description,j.format(P.amount),i(`expenseCategory.${P.category}`)])})]})]})]})]})},ol=({title:a,data:s,colorClass:n})=>{const o=Math.max(...s.map(i=>i.value));return e.jsxs("div",{className:"w-full",children:[a&&e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a}),e.jsx("div",{className:"flex items-end space-x-2 h-64",children:s.map((i,c)=>e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-full ${n} rounded-t`,style:{height:`${i.value/o*100}%`}}),e.jsx("span",{className:"text-xs mt-2 text-center",children:i.label}),e.jsx("span",{className:"text-xs text-gray-500",children:i.value})]},c))})]})},Ea=({title:a,data:s,onSegmentClick:n})=>{const[o,i]=q.useState(null),[c,u]=q.useState(null),m=s.reduce((x,v)=>x+v.value,0);if(m===0)return e.jsxs("div",{className:"w-full",children:[a&&e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a}),e.jsx("div",{className:"flex items-center justify-center h-64 text-slate-500",children:"No data to display"})]});const h=s.map((x,v)=>{const N=x.value/m*100,k=s.slice(0,v).reduce((w,j)=>w+j.value/m*360,0),C=k+x.value/m*360;return{...x,percentage:N,startAngle:k,endAngle:C}}),y=(x,v,N)=>{i(N);const k=x.currentTarget.getBoundingClientRect();u({x:k.left+k.width/2,y:k.top-10,content:`${v.label}: ${v.value.toLocaleString()} (${v.percentage.toFixed(1)}%)`})},b=()=>{i(null),u(null)},f=x=>{n&&n(x)};return e.jsxs("div",{className:"w-full relative",children:[a&&e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a}),e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-4",children:[e.jsxs("div",{className:"relative w-64 h-64",children:[e.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:h.map((x,v)=>{const N=x.percentage>50?1:0,k=50+40*Math.cos(x.startAngle*Math.PI/180),C=50+40*Math.sin(x.startAngle*Math.PI/180),w=50+40*Math.cos(x.endAngle*Math.PI/180),j=50+40*Math.sin(x.endAngle*Math.PI/180);return e.jsx("path",{d:`M 50 50 L ${k} ${C} A 40 40 0 ${N} 1 ${w} ${j} Z`,fill:x.color,stroke:"white",strokeWidth:"0.5",style:{cursor:n?"pointer":"default",opacity:o===v?.8:1,transform:o===v?"scale(1.05)":"scale(1)",transformOrigin:"50% 50%"},onMouseEnter:D=>y(D,x,v),onMouseLeave:b,onClick:()=>f(x)},v)})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-semibold text-slate-700",children:["Total: ",m.toLocaleString()]})})]}),e.jsx("div",{className:"flex-1 space-y-2",children:h.map((x,v)=>e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors ${o===v?"bg-slate-100":""}`,onMouseEnter:()=>i(v),onMouseLeave:()=>i(null),onClick:()=>f(x),style:{cursor:n?"pointer":"default"},children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:x.color}}),e.jsx("span",{className:"text-sm text-slate-700 flex-1",children:x.label}),e.jsxs("span",{className:"text-sm font-semibold text-slate-800",children:[x.percentage.toFixed(1),"%"]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["(",x.value.toLocaleString(),")"]})]},v))})]}),c&&e.jsx("div",{className:"absolute bg-black text-white text-xs px-2 py-1 rounded shadow-lg pointer-events-none z-10",style:{left:c.x,top:c.y,transform:"translate(-50%, -100%)"},children:c.content})]})},Fv=({clinicData:a})=>{const{t:s,locale:n}=Ve(),[o,i]=q.useState(new Date().toISOString().split("T")[0]),c=new Intl.NumberFormat(n,{style:"currency",currency:"EGP"}),u=q.useMemo(()=>{const b=new Date(o),f=new Date(b);f.setHours(0,0,0,0);const x=new Date(b);x.setHours(23,59,59,999);const v=a.payments.filter(G=>new Date(G.date)>=f&&new Date(G.date)<=x),N=a.expenses.filter(G=>new Date(G.date)>=f&&new Date(G.date)<=x),k=v.reduce((G,re)=>G+re.amount,0),C=N.reduce((G,re)=>G+re.amount,0),w=v.reduce((G,re)=>G+re.doctorShare,0),j=k-C-w,D=k>0?w/k*100:0,M=a.treatmentRecords.filter(G=>new Date(G.treatmentDate)<=x).reduce((G,re)=>{const le=a.treatmentDefinitions.find(he=>he.id===re.treatmentDefinitionId);return G+(le?le.basePrice:0)},0)-a.payments.filter(G=>new Date(G.date)<=x).reduce((G,re)=>G+re.amount,0),I=a.treatmentRecords.filter(G=>{const re=new Date(G.treatmentDate),le=(b.getTime()-re.getTime())/(1e3*60*60*24),he=a.treatmentDefinitions.find(L=>L.id===G.treatmentDefinitionId),P=he?he.basePrice:0;return le>30&&P>a.payments.filter(L=>L.patientId===G.patientId).reduce((L,z)=>L+z.amount,0)}).reduce((G,re)=>{const le=a.treatmentDefinitions.find(he=>he.id===re.treatmentDefinitionId);return G+(le?le.basePrice:0)},0),_=a.appointments.filter(G=>new Date(G.startTime).toDateString()===b.toDateString()).length,A=new Set(v.map(G=>G.patientId)).size,Q=(()=>{const G={};v.forEach(le=>{const he=a.treatmentRecords.find(P=>P.id===le.treatmentRecordId);if(he){const P=a.dentists.find(L=>L.id===he.dentistId);P&&(G[P.id]||(G[P.id]={name:P.name,earnings:0,color:P.color}),G[P.id].earnings+=le.doctorShare)}});const re=Object.values(G).reduce((le,he)=>le+he.earnings,0);return Object.values(G).map(le=>({...le,percentage:re>0?le.earnings/re*100:0})).sort((le,he)=>he.earnings-le.earnings)})();return{todaysRevenue:k,todaysExpenses:C,todaysDoctorShares:w,todaysDoctorPercentage:D,todaysProfit:j,pendingPayments:Math.max(0,M),overdueInvoices:Math.max(0,I),todaysPayments:v,todaysExpensesArray:N,numPayments:v.length,numExpenses:N.length,todaysAppointments:_,uniquePatientsToday:A,todaysDoctorEarnings:Q}},[a,o]),m=q.useMemo(()=>{const b=[];for(let f=6;f>=0;f--){const x=new Date(o);x.setDate(x.getDate()-f);const v=x.toISOString().split("T")[0],N=a.payments.filter(k=>k.date===v).reduce((k,C)=>k+C.amount,0);b.push({label:x.toLocaleDateString(n,{month:"short",day:"numeric"}),value:N})}return b},[a.payments,o,n]),h=q.useMemo(()=>{const b=u.todaysExpensesArray.reduce((x,v)=>(x[v.category]=(x[v.category]||0)+v.amount,x),{}),f=["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899"];return Object.entries(b).map(([x,v],N)=>({label:s(`expenseCategory.${x}`),value:v,color:f[N%f.length]}))},[u.todaysExpensesArray,s]),y=()=>{Kr(`${s("reports.dailyFinancialSummary.title")} - ${new Date(o).toLocaleDateString(n)}`,e.jsx(au,{clinicData:a,activeTab:"dailyFinancialSummary",startDate:o,endDate:o}))};return e.jsxs("div",{className:"space-y-8 p-6 bg-slate-50 min-h-screen",dir:"rtl",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:s("reports.dailyFinancialSummary.title")}),e.jsx("p",{className:"text-slate-600",children:s("reports.dailyFinancialSummary.subtitle")})]}),e.jsxs("button",{onClick:y,className:"bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary-dark flex items-center gap-2 font-medium transition-colors duration-200 shadow-md hover:shadow-lg",children:[" ",s("reports.printReport")]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.selectDate")}),e.jsx("div",{className:"max-w-xs",children:e.jsx("input",{type:"date",value:o,onChange:b=>i(b.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c.format(u.todaysRevenue)}),e.jsx("div",{className:"text-sm text-blue-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c.format(u.todaysDoctorShares)}),e.jsx("div",{className:"text-sm text-yellow-700",dir:"rtl",children:"  "})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:u.todaysExpenses}),e.jsx("div",{className:"text-sm text-red-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${u.todaysProfit>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${u.todaysProfit>=0?"text-green-600":"text-red-600"}`,children:c.format(u.todaysProfit)}),e.jsx("div",{className:`text-sm ${u.todaysProfit>=0?"text-green-700":"text-red-700"}`,dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.format(u.pendingPayments)}),e.jsx("div",{className:"text-sm text-orange-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:c.format(u.overdueInvoices)}),e.jsx("div",{className:"text-sm text-purple-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg border border-indigo-200",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:u.numPayments}),e.jsx("div",{className:"text-sm text-indigo-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-pink-50 p-4 rounded-lg border border-pink-200",children:[e.jsx("div",{className:"text-2xl font-bold text-pink-600",children:u.numExpenses}),e.jsx("div",{className:"text-sm text-pink-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-teal-50 p-4 rounded-lg border border-teal-200",children:[e.jsx("div",{className:"text-2xl font-bold text-teal-600",children:u.todaysAppointments}),e.jsx("div",{className:"text-sm text-teal-700",dir:"rtl",children:" "})]}),e.jsxs("div",{className:"bg-cyan-50 p-4 rounded-lg border border-cyan-200",children:[e.jsx("div",{className:"text-2xl font-bold text-cyan-600",children:u.uniquePatientsToday}),e.jsx("div",{className:"text-sm text-cyan-700",dir:"rtl",children:"  "})]}),e.jsxs("div",{className:"bg-lime-50 p-4 rounded-lg border border-lime-200",children:[e.jsxs("div",{className:"text-2xl font-bold text-lime-600",children:[u.todaysDoctorPercentage.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-lime-700",dir:"rtl",children:"  "})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",dir:"rtl",children:"  "}),e.jsx("div",{className:"space-y-3",children:u.todaysDoctorEarnings.length>0?u.todaysDoctorEarnings.map(b=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold mb-1",children:[e.jsx("span",{className:"text-slate-700",children:b.name}),e.jsx("span",{className:"text-slate-500",children:c.format(b.earnings)})]}),e.jsx("div",{className:"w-full bg-neutral rounded-full h-2.5",children:e.jsx("div",{className:`${b.color} h-2.5 rounded-full`,style:{width:`${b.percentage}%`}})})]},b.name)):e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"      "})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(ol,{title:s("reports.dailyFinancialSummary.revenueTrend"),data:m,colorClass:"bg-blue-500"})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Ea,{title:s("reports.dailyFinancialSummary.expensesBreakdown"),data:h})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.dailyFinancialSummary.todaysPayments")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("common.patient")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("payment.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("payment.method")})]})}),e.jsx("tbody",{children:u.todaysPayments.slice(0,10).map(b=>{const f=a.patients.find(x=>x.id===b.patientId);return e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:f?.name||s("common.unknown")}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:c.format(b.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:b.method})]},b.id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.dailyFinancialSummary.todaysExpensesList")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.description")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.category")})]})}),e.jsx("tbody",{children:u.todaysExpensesArray.slice(0,10).map(b=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:b.description}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:c.format(b.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:s(`expenseCategory.${b.category}`)})]},b.id))})]})})]})]})]})},Vd=({title:a,data:s,colorClass:n,onPointClick:o})=>{const[i,c]=q.useState(null),[u,m]=q.useState(null),h=Math.max(...s.map(k=>k.value)),y=Math.min(...s.map(k=>k.value)),b=h-y||1,f=s.map((k,C)=>{const w=C/(s.length-1)*100,j=100-(k.value-y)/b*100;return`${w},${j}`}).join(" "),x=(k,C,w)=>{c(w);const j=k.currentTarget.getBoundingClientRect();m({x:j.left+j.width/2,y:j.top-10,content:`${C.label}: ${C.value.toLocaleString()}`})},v=()=>{c(null),m(null)},N=(k,C)=>{o&&o({...k,index:C})};return e.jsxs("div",{className:"w-full relative",children:[a&&e.jsx("h3",{className:"text-lg font-semibold mb-4",children:a}),e.jsxs("div",{className:"relative h-64",children:[e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 10 0 L 0 0 0 10",fill:"none",stroke:"#e2e8f0",strokeWidth:"0.5"})})}),e.jsx("rect",{width:"100",height:"100",fill:"url(#grid)"}),e.jsx("polyline",{fill:"none",stroke:"currentColor",strokeWidth:"2",className:n,points:f}),s.map((k,C)=>{const w=C/(s.length-1)*100,j=100-(k.value-y)/b*100;return e.jsx("circle",{cx:w,cy:j,r:i===C?"3":"1.5",fill:"currentColor",className:n,style:{cursor:o?"pointer":"default",transition:"r 0.2s ease"},onMouseEnter:D=>x(D,k,C),onMouseLeave:v,onClick:()=>N(k,C)},C)})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 flex justify-between text-xs text-slate-500",children:s.map((k,C)=>e.jsx("span",{className:"text-center",children:k.label},C))}),e.jsxs("div",{className:"absolute left-0 top-0 bottom-0 flex flex-col justify-between text-xs text-slate-500 -ml-8",children:[e.jsx("span",{children:h.toLocaleString()}),e.jsx("span",{children:((h+y)/2).toLocaleString()}),e.jsx("span",{children:y.toLocaleString()})]})]}),u&&e.jsx("div",{className:"absolute bg-black text-white text-xs px-2 py-1 rounded shadow-lg pointer-events-none z-10",style:{left:u.x,top:u.y,transform:"translate(-50%, -100%)"},children:u.content}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:s.map((k,C)=>e.jsxs("button",{className:`px-3 py-1 text-xs rounded-full transition-colors ${i===C?"bg-blue-100 text-blue-800":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,onMouseEnter:()=>c(C),onMouseLeave:()=>c(null),onClick:()=>N(k,C),style:{cursor:o?"pointer":"default"},children:[k.label,": ",k.value.toLocaleString()]},C))})]})},$v=({clinicData:a})=>{const{t:s,locale:n}=Ve(),[o,i]=q.useState(()=>{const f=new Date;return`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}`}),c=new Intl.NumberFormat(n,{style:"currency",currency:"EGP"}),u=q.useMemo(()=>{const[f,x]=o.split("-").map(Number),v=new Date(f,x-1,1),N=new Date(f,x,0),k=a.payments.filter(he=>{const P=new Date(he.date);return P>=v&&P<=N}),C=a.expenses.filter(he=>{const P=new Date(he.date);return P>=v&&P<=N}),w=k.reduce((he,P)=>he+P.amount,0),j=C.reduce((he,P)=>he+P.amount,0),D=w-j-k.reduce((he,P)=>he+P.doctorShare,0),M=N.getDate(),I={dailyRevenue:w/M,dailyExpenses:j/M,dailyProfit:D/M},_=new Date(f,x-2,1),A=new Date(f,x-1,0),Q=a.payments.filter(he=>{const P=new Date(he.date);return P>=_&&P<=A}).reduce((he,P)=>he+P.amount,0),G=a.expenses.filter(he=>{const P=new Date(he.date);return P>=_&&P<=A}).reduce((he,P)=>he+P.amount,0),re=Q-G-a.payments.filter(he=>{const P=new Date(he.date);return P>=_&&P<=A}).reduce((he,P)=>he+P.doctorShare,0),le={revenueGrowth:Q>0?(w-Q)/Q*100:0,expenseGrowth:G>0?(j-G)/G*100:0,profitGrowth:re!==0?(D-re)/Math.abs(re)*100:0};return{thisMonthRevenue:w,thisMonthExpenses:j,clinicProfitThisMonth:D,monthlyAverages:I,growthRates:le,monthPayments:k,monthExpenses:C}},[a,o]),m=q.useMemo(()=>{const[f,x]=o.split("-").map(Number),v=new Date(f,x,0).getDate(),N=[];for(let k=1;k<=v;k++){const C=`${f}-${String(x).padStart(2,"0")}-${String(k).padStart(2,"0")}`,w=a.payments.filter(j=>j.date===C).reduce((j,D)=>j+D.amount,0);(k%5===0||k===v)&&N.push({label:k.toString(),value:w})}return N},[a.payments,o]),h=q.useMemo(()=>{const f=u.monthExpenses.reduce((v,N)=>(v[N.category]=(v[N.category]||0)+N.amount,v),{}),x=["#ef4444","#f97316","#eab308","#22c55e","#3b82f6","#8b5cf6","#ec4899"];return Object.entries(f).map(([v,N],k)=>({label:s(`expenseCategory.${v}`),value:N,color:x[k%x.length]}))},[u.monthExpenses,s]),y=q.useMemo(()=>{const f=[],[x,v]=o.split("-").map(Number);for(let N=v-5;N<=v;N++){let k=N,C=x;N<=0&&(k=12+N,C=x-1);const w=new Date(C,k-1,1),j=new Date(C,k,0),D=a.payments.filter(_=>{const A=new Date(_.date);return A>=w&&A<=j}).reduce((_,A)=>_+A.amount,0),M=a.expenses.filter(_=>{const A=new Date(_.date);return A>=w&&A<=j}).reduce((_,A)=>_+A.amount,0),I=D-M;f.push({label:new Date(C,k-1,1).toLocaleDateString(n,{month:"short",year:"numeric"}),value:I})}return f},[a,o,n]),b=()=>{const[f,x]=o.split("-"),v=`${f}-${x}-01`,N=new Date(parseInt(f),parseInt(x),0).toISOString().split("T")[0];Kr(`${s("reports.monthlyFinancialSummary.title")} - ${new Date(v).toLocaleDateString(n,{month:"long",year:"numeric"})}`,e.jsx(au,{clinicData:a,activeTab:"monthlyFinancialSummary",startDate:v,endDate:N}))};return e.jsxs("div",{className:"space-y-8 p-6 bg-slate-50 min-h-screen",dir:"rtl",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:s("reports.monthlyFinancialSummary.title")}),e.jsx("p",{className:"text-slate-600",children:s("reports.monthlyFinancialSummary.subtitle")})]}),e.jsxs("button",{onClick:b,className:"bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary-dark flex items-center gap-2 font-medium transition-colors duration-200 shadow-md hover:shadow-lg",children:[" ",s("reports.printReport")]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.selectMonth")}),e.jsx("div",{className:"max-w-xs",children:e.jsx("input",{type:"month",value:o,onChange:f=>i(f.target.value),className:"w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.monthlyFinancialSummary.thisMonthRevenue")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:c.format(u.thisMonthRevenue)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.monthlyFinancialSummary.thisMonthExpenses")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:c.format(u.thisMonthExpenses)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:`bg-white p-6 rounded-xl shadow-lg border-l-4 ${u.clinicProfitThisMonth>=0?"border-green-500":"border-red-500"}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.monthlyFinancialSummary.clinicProfitThisMonth")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:c.format(u.clinicProfitThisMonth)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.monthlyFinancialSummary.monthlyAverages")}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:[s("reports.dailyRevenue"),": ",c.format(u.monthlyAverages.dailyRevenue)]}),e.jsxs("p",{children:[s("reports.dailyExpenses"),": ",c.format(u.monthlyAverages.dailyExpenses)]})]})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-indigo-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.monthlyFinancialSummary.growthRates")}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:u.growthRates.revenueGrowth>=0?"text-green-600":"text-red-600",children:[s("reports.revenue"),": ",u.growthRates.revenueGrowth.toFixed(1),"%"]}),e.jsxs("p",{className:u.growthRates.expenseGrowth<=0?"text-green-600":"text-red-600",children:[s("reports.expenses"),": ",u.growthRates.expenseGrowth.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Vd,{title:s("reports.monthlyFinancialSummary.revenueChart"),data:m,colorClass:"bg-blue-500"})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Ea,{title:s("reports.monthlyFinancialSummary.expenseBreakdown"),data:h})})]}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Vd,{title:s("reports.monthlyFinancialSummary.profitTrend"),data:y,colorClass:"bg-green-500"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.monthlyFinancialSummary.monthlyPayments")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("common.patient")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("payment.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("common.date")})]})}),e.jsx("tbody",{children:u.monthPayments.slice(0,10).map(f=>{const x=a.patients.find(v=>v.id===f.patientId);return e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:x?.name||s("common.unknown")}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:c.format(f.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:new Date(f.date).toLocaleDateString(n,{month:"short",day:"numeric"})})]},f.id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.monthlyFinancialSummary.monthlyExpenses")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.description")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.category")})]})}),e.jsx("tbody",{children:u.monthExpenses.slice(0,10).map(f=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:f.description}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:c.format(f.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:s(`expenseCategory.${f.category}`)})]},f.id))})]})})]})]})]})},Uv=({clinicData:a})=>{const{t:s,locale:n}=Ve(),[o,i]=q.useState(()=>{const N=new Date;return`${N.getFullYear()}-Q${Math.ceil((N.getMonth()+1)/3)}`}),[c,u]=q.useState("quarterly"),m=new Intl.NumberFormat(n,{style:"currency",currency:"EGP"}),h=q.useMemo(()=>{const[N,k]=o.includes("Q")?o.split("-Q").map((L,z)=>parseInt(L)):[parseInt(o),0];let C,w;if(c==="quarterly"){const L=(k-1)*3;C=new Date(N,L,1),w=new Date(N,L+3,0)}else C=new Date(N,0,1),w=new Date(N,11,31);const j=a.payments.filter(L=>{const z=new Date(L.date);return z>=C&&z<=w}),D=a.expenses.filter(L=>{const z=new Date(L.date);return z>=C&&z<=w}),M={revenue:j.reduce((L,z)=>L+z.amount,0),expenses:D.reduce((L,z)=>L+z.amount,0),profit:0};M.profit=M.revenue-M.expenses-j.reduce((L,z)=>L+z.doctorShare,0);const I=N-1;let _,A;if(c==="quarterly"){const L=(k-1)*3;_=new Date(I,L,1),A=new Date(I,L+3,0)}else _=new Date(I,0,1),A=new Date(I,11,31);const Q=a.payments.filter(L=>{const z=new Date(L.date);return z>=_&&z<=A}),G=a.expenses.filter(L=>{const z=new Date(L.date);return z>=_&&z<=A}),re={revenue:Q.reduce((L,z)=>L+z.amount,0),expenses:G.reduce((L,z)=>L+z.amount,0),profit:0};re.profit=re.revenue-re.expenses-Q.reduce((L,z)=>L+z.doctorShare,0);const le={revenueChange:re.revenue>0?(M.revenue-re.revenue)/re.revenue*100:0,expenseChange:re.expenses>0?(M.expenses-re.expenses)/re.expenses*100:0,profitChange:re.profit!==0?(M.profit-re.profit)/Math.abs(re.profit)*100:0},he=c==="annual"?[1,2,3,4].map(L=>{const z=(L-1)*3,ee=new Date(N,z,1),se=new Date(N,z+3,0),Y=a.payments.filter(ce=>{const B=new Date(ce.date);return B>=ee&&B<=se}).reduce((ce,B)=>ce+B.amount,0),xe=a.expenses.filter(ce=>{const B=new Date(ce.date);return B>=ee&&B<=se}).reduce((ce,B)=>ce+B.amount,0);return{quarter:`Q${L}`,revenue:Y,expenses:xe,profit:Y-xe-a.payments.filter(ce=>{const B=new Date(ce.date);return B>=ee&&B<=se}).reduce((ce,B)=>ce+B.doctorShare,0)}}):[],P=M.profit;return{quarterlyAnnualTotals:M,yearOverYearComparisons:le,seasonalTrends:he,cumulativeProfit:P,periodPayments:j,periodExpenses:D}},[a,o,c]),y=q.useMemo(()=>{const[N]=o.includes("Q")?o.split("-Q").map((w,j)=>parseInt(w)):[parseInt(o),0],k=h.quarterlyAnnualTotals,C={revenue:k.revenue*(1-h.yearOverYearComparisons.revenueChange/100),expenses:k.expenses*(1-h.yearOverYearComparisons.expenseChange/100),profit:k.profit*(1-h.yearOverYearComparisons.profitChange/100)};return[{label:`${N-1}`,value:C.revenue},{label:`${N}`,value:k.revenue}]},[h,o]),b=q.useMemo(()=>c==="quarterly"?[]:h.seasonalTrends.map(N=>({label:N.quarter,value:N.profit})),[h.seasonalTrends,c]),f=q.useMemo(()=>{if(c==="quarterly")return[];const N=["#22c55e","#ef4444"];return[{label:"Revenue",value:h.quarterlyAnnualTotals.revenue,color:N[0]},{label:"Expenses",value:h.quarterlyAnnualTotals.expenses,color:N[1]}]},[h.quarterlyAnnualTotals,c]),x=q.useMemo(()=>{const N=[],[k]=o.includes("Q")?o.split("-Q").map((C,w)=>parseInt(C)):[parseInt(o),0];for(let C=k-4;C<=k;C++){let w,j;if(c==="quarterly"){const[,_]=o.split("-Q").map((Q,G)=>parseInt(Q)),A=(_-1)*3;w=new Date(C,A,1),j=new Date(C,A+3,0)}else w=new Date(C,0,1),j=new Date(C,11,31);const D=a.payments.filter(_=>{const A=new Date(_.date);return A>=w&&A<=j}).reduce((_,A)=>_+A.amount,0),M=a.expenses.filter(_=>{const A=new Date(_.date);return A>=w&&A<=j}).reduce((_,A)=>_+A.amount,0),I=D-M-a.payments.filter(_=>{const A=new Date(_.date);return A>=w&&A<=j}).reduce((_,A)=>_+A.doctorShare,0);N.push({label:C.toString(),value:I})}return N},[a,o,c]),v=()=>{const[N,k]=o.includes("Q")?o.split("-Q").map((j,D)=>parseInt(j)):[parseInt(o),0];let C,w;if(c==="quarterly"){const j=(k-1)*3;C=new Date(N,j,1).toISOString().split("T")[0],w=new Date(N,j+3,0).toISOString().split("T")[0]}else C=`${N}-01-01`,w=`${N}-12-31`;Kr(`${s("reports.quarterlyAnnualOverview.title")} - ${c==="quarterly"?`Q${k}`:""} ${N}`,e.jsx(au,{clinicData:a,activeTab:"quarterlyAnnualOverview",startDate:C,endDate:w}))};return e.jsxs("div",{className:"space-y-8 p-6 bg-slate-50 min-h-screen",dir:"rtl",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-2",children:s("reports.quarterlyAnnualOverview.title")}),e.jsx("p",{className:"text-slate-600",children:s("reports.quarterlyAnnualOverview.subtitle")})]}),e.jsxs("button",{onClick:v,className:"bg-primary text-white px-6 py-3 rounded-lg hover:bg-primary-dark flex items-center gap-2 font-medium transition-colors duration-200 shadow-md hover:shadow-lg",children:[" ",s("reports.printReport")]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:s("reports.viewType")}),e.jsxs("select",{value:c,onChange:N=>u(N.target.value),className:"p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:[e.jsx("option",{value:"quarterly",children:s("reports.quarterly")}),e.jsx("option",{value:"annual",children:s("reports.annual")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:s(c==="quarterly"?"reports.selectQuarter":"reports.selectYear")}),c==="quarterly"?e.jsx("select",{value:o,onChange:N=>i(N.target.value),className:"p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:Array.from({length:4},(N,k)=>{const C=new Date().getFullYear();return e.jsxs("option",{value:`${C}-Q${k+1}`,children:["Q",k+1," ",C]},`${C}-Q${k+1}`)})}):e.jsx("select",{value:o,onChange:N=>i(N.target.value),className:"p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:Array.from({length:5},(N,k)=>{const C=new Date().getFullYear()-2+k;return e.jsx("option",{value:C.toString(),children:C},C)})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.quarterlyAnnualOverview.totalRevenue")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:m.format(h.quarterlyAnnualTotals.revenue)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.quarterlyAnnualOverview.totalExpenses")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:m.format(h.quarterlyAnnualTotals.expenses)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:`bg-white p-6 rounded-xl shadow-lg border-l-4 ${h.cumulativeProfit>=0?"border-green-500":"border-red-500"}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.quarterlyAnnualOverview.cumulativeProfit")}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:m.format(h.cumulativeProfit)})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 mb-1",children:s("reports.quarterlyAnnualOverview.yearOverYear")}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:h.yearOverYearComparisons.revenueChange>=0?"text-green-600":"text-red-600",children:[s("reports.revenue"),": ",h.yearOverYearComparisons.revenueChange.toFixed(1),"%"]}),e.jsxs("p",{className:h.yearOverYearComparisons.profitChange>=0?"text-green-600":"text-red-600",children:[s("reports.profit"),": ",h.yearOverYearComparisons.profitChange.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"text-4xl opacity-20",children:""})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(ol,{title:s("reports.quarterlyAnnualOverview.comparisonChart"),data:y,colorClass:"bg-blue-500"})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Vd,{title:s("reports.quarterlyAnnualOverview.trendChart"),data:x,colorClass:"bg-green-500"})})]}),c==="annual"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(ol,{title:s("reports.quarterlyAnnualOverview.seasonalTrends"),data:b,colorClass:"bg-purple-500"})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:e.jsx(Ea,{title:s("reports.quarterlyAnnualOverview.revenueExpenseBreakdown"),data:f})})]}),c==="annual"&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Quarterly Performance Comparison"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:h.seasonalTrends.map((N,k)=>e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-slate-700 mb-2",children:N.quarter}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:["Revenue: ",e.jsx("span",{className:"font-semibold text-green-600",children:m.format(N.revenue)})]}),e.jsxs("p",{children:["Expenses: ",e.jsx("span",{className:"font-semibold text-red-600",children:m.format(N.expenses)})]}),e.jsxs("p",{children:["Profit: ",e.jsx("span",{className:`font-semibold ${N.profit>=0?"text-blue-600":"text-red-600"}`,children:m.format(N.profit)})]})]})]},N.quarter))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.quarterlyAnnualOverview.periodPayments")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("common.patient")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("payment.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("common.date")})]})}),e.jsx("tbody",{children:h.periodPayments.slice(0,10).map(N=>{const k=a.patients.find(C=>C.id===N.patientId);return e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:k?.name||s("common.unknown")}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:m.format(N.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:new Date(N.date).toLocaleDateString(n,{month:"short",day:"numeric",year:"numeric"})})]},N.id)})})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:s("reports.quarterlyAnnualOverview.periodExpenses")}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 border-b border-slate-200",children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.description")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.amount")}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-slate-700",children:s("expense.category")})]})}),e.jsx("tbody",{children:h.periodExpenses.slice(0,10).map(N=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:N.description}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:m.format(N.amount)}),e.jsx("td",{className:"px-4 py-3 text-sm text-slate-600 text-right",children:s(`expenseCategory.${N.category}`)})]},N.id))})]})})]})]})]})},mp=({clinicData:a,setCurrentView:s,initialTab:n})=>{const{t:o,locale:i}=Ve(),[c,u]=q.useState(n||"overview"),m=q.useMemo(()=>{const{patients:w,treatmentRecords:j,payments:D}=a,M=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"});return w.map(I=>{const _=j.filter(he=>he.patientId===I.id),A=D.filter(he=>he.patientId===I.id),Q=_.reduce((he,P)=>he+P.totalTreatmentCost,0),G=A.reduce((he,P)=>he+P.amount,0),re=Q-G,le=_.length;return{patient:I,totalRevenue:Q,totalPaid:G,outstandingBalance:re,treatmentCount:le,currencyFormatter:M}})},[a,i]),h=q.useMemo(()=>{const{dentists:w,treatmentRecords:j,doctorPayments:D}=a,M=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"});return w.map(I=>{const _=j.filter(P=>P.dentistId===I.id),A=D.filter(P=>P.dentistId===I.id),Q=_.reduce((P,L)=>P+L.totalTreatmentCost,0),G=_.reduce((P,L)=>P+L.doctorShare,0),re=A.reduce((P,L)=>P+L.amount,0),le=G-re,he=_.length;return{doctor:I,totalRevenue:Q,totalEarnings:G,totalPaymentsReceived:re,netBalance:le,treatmentCount:he,currencyFormatter:M}})},[a,i]),y=q.useMemo(()=>{const{suppliers:w,inventoryItems:j,expenses:D}=a,M=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"});return w.map(I=>{const _=j.filter(P=>P.supplierId===I.id),A=D.filter(P=>P.supplierId===I.id),Q=_.reduce((P,L)=>P+L.unitCost*L.currentStock,0),G=A.reduce((P,L)=>P+L.amount,0),re=Q+G,le=_.length,he=A.length;return{supplier:I,totalPurchases:Q,totalExpenses:G,totalValue:re,itemCount:le,expenseCount:he,currencyFormatter:M}})},[a,i]),b=[{id:"overview",label:o("reports.overview"),icon:""},{id:"patients",label:o("reports.patientReports"),icon:""},{id:"doctors",label:o("reports.doctorReports"),icon:""},{id:"suppliers",label:o("reports.supplierReports"),icon:""},{id:"daily",label:o("reports.dailyFinancialSummary.title"),icon:""},{id:"monthly",label:o("reports.monthlyFinancialSummary.title"),icon:""},{id:"quarterly",label:o("reports.quarterlyAnnualOverview.title"),icon:""}],f=w=>{switch(w){case"overview":return o("reports.overviewDescription");case"patients":return"      ";case"doctors":return"     ";case"suppliers":return"    ";case"daily":return"      ";case"monthly":return"      ";case"quarterly":return"       ";default:return""}},x=()=>{const{patients:w,dentists:j,appointments:D,labCases:M,payments:I,expenses:_}=a,A=I.reduce((F,ue)=>F+ue.amount,0),Q=_.reduce((F,ue)=>F+ue.amount,0),G=I.reduce((F,ue)=>F+ue.doctorShare,0),re=A-G-Q,le=a.treatmentRecords.reduce((F,ue)=>F+ue.totalTreatmentCost,0),he=I.reduce((F,ue)=>F+ue.amount,0),P=le-he,L=new Date;L.setHours(0,0,0,0);const z=I.filter(F=>{const ue=new Date(F.date);return ue.setHours(0,0,0,0),ue.getTime()===L.getTime()}),ee=_.filter(F=>{const ue=new Date(F.date);return ue.setHours(0,0,0,0),ue.getTime()===L.getTime()}),se=z.reduce((F,ue)=>F+ue.amount,0),Y=z.reduce((F,ue)=>F+ue.doctorShare,0),xe=ee.reduce((F,ue)=>F+ue.amount,0),ce=se-Y-xe,B=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:o("reports.overview")}),e.jsx("p",{className:"text-gray-600 mb-6",children:o("reports.overviewDescription")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.length}),e.jsx("div",{className:"text-sm text-blue-700",children:o("common.patients")})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.length}),e.jsx("div",{className:"text-sm text-green-700",children:o("common.doctors")})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:D.length}),e.jsx("div",{className:"text-sm text-purple-700",children:o("appointmentScheduler.title")})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:M.length}),e.jsx("div",{className:"text-sm text-orange-700",children:o("labCasesManagement.title")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:o("reports.dailyFinancialSummary.title")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:B.format(se)}),e.jsx("div",{className:"text-sm text-blue-700",children:o("reports.dailyFinancialSummary.todaysRevenue")})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:B.format(Y)}),e.jsx("div",{className:"text-sm text-yellow-700",dir:"rtl",children:"  "})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:B.format(xe)}),e.jsx("div",{className:"text-sm text-red-700",children:o("reports.dailyFinancialSummary.todaysExpenses")})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${ce>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${ce>=0?"text-green-600":"text-red-600"}`,children:B.format(ce)}),e.jsx("div",{className:`text-sm ${ce>=0?"text-green-700":"text-red-700"}`,children:o("reports.dailyFinancialSummary.todaysProfit")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:o("reports.financialOverview")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:B.format(A)}),e.jsx("div",{className:"text-sm text-green-700",children:o("reports.totalRevenue")})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:B.format(Q)}),e.jsx("div",{className:"text-sm text-red-700",children:o("reports.totalExpenses")})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${re>=0?"bg-blue-50 border-blue-200":"bg-red-50 border-red-200"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${re>=0?"text-blue-600":"text-red-600"}`,children:B.format(re)}),e.jsx("div",{className:`text-sm ${re>=0?"text-blue-700":"text-red-700"}`,children:o("reports.netProfit")})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:B.format(P)}),e.jsx("div",{className:"text-sm text-orange-700",children:o("reports.outstandingBalance")})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:" "}),e.jsx("div",{className:"mb-8",children:e.jsx(Ea,{title:"   ",data:[{label:"",value:I.filter(F=>F.method==="Cash").reduce((F,ue)=>F+ue.amount,0),color:"#10B981"},{label:" ",value:I.filter(F=>F.method==="Credit Card").reduce((F,ue)=>F+ue.amount,0),color:"#3B82F6"},{label:" ",value:I.filter(F=>F.method==="Bank Transfer").reduce((F,ue)=>F+ue.amount,0),color:"#8B5CF6"},{label:"",value:I.filter(F=>!["Cash","Credit Card","Bank Transfer"].includes(F.method)).reduce((F,ue)=>F+ue.amount,0),color:"#F59E0B"}]})}),e.jsx("div",{className:"mb-8",children:e.jsx(ol,{title:" ",data:[{label:"",value:I.filter(F=>new Date(F.date).getMonth()===0).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===1).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===2).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===3).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===4).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===5).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===6).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===7).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===8).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===9).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===10).reduce((F,ue)=>F+ue.amount,0)},{label:"",value:I.filter(F=>new Date(F.date).getMonth()===11).reduce((F,ue)=>F+ue.amount,0)}],colorClass:"bg-blue-500"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"  "}),e.jsx(Ea,{title:"",data:[{label:"",value:A,color:"#10B981"},{label:"",value:Q,color:"#EF4444"}]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:" "}),e.jsx(Ea,{title:"",data:[{label:"",value:_.filter(F=>F.category==="RENT").reduce((F,ue)=>F+ue.amount,0),color:"#F59E0B"},{label:"",value:_.filter(F=>F.category==="SALARIES").reduce((F,ue)=>F+ue.amount,0),color:"#8B5CF6"},{label:"",value:_.filter(F=>F.category==="UTILITIES").reduce((F,ue)=>F+ue.amount,0),color:"#06B6D4"},{label:" ",value:_.filter(F=>F.category==="LAB_FEES").reduce((F,ue)=>F+ue.amount,0),color:"#84CC16"},{label:"",value:_.filter(F=>F.category==="SUPPLIES").reduce((F,ue)=>F+ue.amount,0),color:"#F97316"},{label:"",value:_.filter(F=>F.category==="MARKETING").reduce((F,ue)=>F+ue.amount,0),color:"#EC4899"},{label:"",value:_.filter(F=>!["RENT","SALARIES","UTILITIES","LAB_FEES","SUPPLIES","MARKETING"].includes(F.category)).reduce((F,ue)=>F+ue.amount,0),color:"#6B7280"}]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.slice(1).map(F=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("span",{className:"text-2xl",children:F.icon}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:F.label})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",dir:"rtl",children:f(F.id)}),e.jsx("button",{onClick:()=>u(F.id),className:"bg-primary text-white px-4 py-2 rounded hover:bg-primary-dark transition-colors text-sm font-medium",children:o("common.view")})]},F.id))})]})},v=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",dir:"rtl",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:o("reports.patientList")}),e.jsx("div",{className:"space-y-4",children:m.map(({patient:w,totalRevenue:j,totalPaid:D,outstandingBalance:M,treatmentCount:I,currencyFormatter:_})=>e.jsx("div",{className:"border border-slate-200 rounded-xl p-4 hover:bg-slate-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:w.name}),e.jsxs("p",{className:"text-sm text-slate-600",children:[w.phone," | ",w.email]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalRevenue"),":"]}),e.jsx("span",{className:"font-semibold text-slate-800 ml-1",children:_.format(j)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalPaid"),":"]}),e.jsx("span",{className:"font-semibold text-green-600 ml-1",children:_.format(D)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.outstandingBalance"),":"]}),e.jsx("span",{className:`font-semibold ml-1 ${M>=0?"text-green-600":"text-red-600"}`,children:_.format(M)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.treatmentCount"),":"]}),e.jsx("span",{className:"font-semibold text-slate-800 ml-1",children:I})]})]})]}),e.jsxs("button",{onClick:()=>{const{treatmentRecords:A,payments:Q}=a,G=A.filter(L=>L.patientId===w.id),re=Q.filter(L=>L.patientId===w.id),le=G.reduce((L,z)=>L+z.totalTreatmentCost,0),he=re.reduce((L,z)=>L+z.amount,0),P=e.jsxs("div",{className:"p-8 bg-white text-slate-900",dir:"rtl",children:[e.jsxs("header",{className:"text-center mb-10 border-b-2 border-slate-300 pb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-2",children:o("patientReport.title")}),e.jsx("h2",{className:"text-2xl font-bold text-primary-dark mb-4",children:w.name}),e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsxs("p",{children:[": ",w.phone]}),e.jsxs("p",{children:[" : ",w.email]}),e.jsxs("p",{children:[" : ",w.dob?new Date(w.dob).toLocaleDateString("ar-EG"):" "]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:o("patientReport.summary")}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("patientReport.totalRevenue")}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:_.format(le)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("patientReport.totalPaid")}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:_.format(he)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:`text-xl font-bold ${M>=0?"text-green-600":"text-red-600"}`,children:_.format(M)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:I})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:re.length})]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:" "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""})]})}),e.jsx("tbody",{children:G.map(L=>{const z=a.dentists.find(ee=>ee.id===L.dentistId);return e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:new Date(L.treatmentDate).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:L.treatmentName}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z?.name||" "}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold",children:_.format(L.totalTreatmentCost)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:L.notes||"-"})]},L.id)})})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:" "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""})]})}),e.jsx("tbody",{children:re.map(L=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:new Date(L.date).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold text-green-600",children:_.format(L.amount)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:L.method}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:L.notes||"-"})]},L.id))})]})]}),e.jsxs("footer",{className:"text-center text-sm text-slate-500 border-t border-slate-300 pt-6",children:[e.jsxs("p",{children:["     ",new Date().toLocaleDateString("ar-EG"),"  ",new Date().toLocaleTimeString("ar-EG")]}),e.jsx("p",{className:"mt-2",children:"  -    "})]})]});Kr(`${o("patientReport.title")} - ${w.name}`,P)},className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:[" ",o("reports.printReport")]})]})},w.id))})]})}),N=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",dir:"rtl",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:o("reports.doctorList")}),e.jsx("div",{className:"space-y-4",children:h.map(({doctor:w,totalRevenue:j,totalEarnings:D,totalPaymentsReceived:M,netBalance:I,treatmentCount:_,currencyFormatter:A})=>e.jsx("div",{className:"border border-slate-200 rounded-xl p-4 hover:bg-slate-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("span",{className:`w-4 h-4 rounded-full ${w.color}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:w.name}),e.jsx("p",{className:"text-sm text-slate-600",children:w.specialty}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalRevenue"),":"]}),e.jsx("span",{className:"font-semibold text-slate-800 ml-1",children:A.format(j)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalEarnings"),":"]}),e.jsx("span",{className:"font-semibold text-green-600 ml-1",children:A.format(D)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalPaymentsReceived"),":"]}),e.jsx("span",{className:"font-semibold text-blue-600 ml-1",children:A.format(M)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.netBalance"),":"]}),e.jsx("span",{className:`font-semibold ml-1 ${I>=0?"text-green-600":"text-red-600"}`,children:A.format(I)})]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[o("reports.treatmentCount"),": ",_]})]})]}),e.jsxs("button",{onClick:()=>{const{treatmentRecords:Q,doctorPayments:G}=a,re=Q.filter(z=>z.dentistId===w.id),le=G.filter(z=>z.dentistId===w.id),he=re.reduce((z,ee)=>z+ee.doctorShare,0),P=le.reduce((z,ee)=>z+ee.amount,0),L=e.jsxs("div",{className:"p-8 bg-white text-slate-900",dir:"rtl",children:[e.jsxs("header",{className:"text-center mb-10 border-b-2 border-slate-300 pb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-2",children:o("doctorReport.title")}),e.jsx("h2",{className:"text-2xl font-bold text-primary-dark mb-4",children:w.name}),e.jsx("div",{className:"text-sm text-slate-600",children:e.jsxs("p",{children:[": ",w.specialty]})})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:o("doctorReport.summary")}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("doctorReport.totalEarnings")}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:A.format(he)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("doctorReport.totalPaymentsReceived")}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:A.format(P)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:`text-xl font-bold ${I>=0?"text-green-600":"text-red-600"}`,children:A.format(I)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:_})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:"  "}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:le.length})]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:" "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""})]})}),e.jsx("tbody",{children:re.map(z=>{const ee=a.patients.find(se=>se.id===z.patientId);return e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:new Date(z.treatmentDate).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:ee?.name||" "}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.treatmentName}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold",children:A.format(z.totalTreatmentCost)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold text-green-600",children:A.format(z.doctorShare)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.notes||"-"})]},z.id)})})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:"  "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""})]})}),e.jsx("tbody",{children:le.map(z=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:new Date(z.date).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold text-green-600",children:A.format(z.amount)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.notes||"-"})]},z.id))})]})]}),e.jsxs("footer",{className:"text-center text-sm text-slate-500 border-t border-slate-300 pt-6",children:[e.jsxs("p",{children:["     ",new Date().toLocaleDateString("ar-EG"),"  ",new Date().toLocaleTimeString("ar-EG")]}),e.jsx("p",{className:"mt-2",children:"  -    "})]})]});Kr(`${o("doctorReport.title")} - ${w.name}`,L)},className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:[" ",o("reports.printReport")]})]})},w.id))})]})}),k=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",dir:"rtl",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-800 mb-6",children:o("reports.supplierList")}),e.jsx("div",{className:"space-y-4",children:y.map(({supplier:w,totalPurchases:j,totalExpenses:D,totalValue:M,itemCount:I,expenseCount:_,currencyFormatter:A})=>e.jsx("div",{className:"border border-slate-200 rounded-xl p-4 hover:bg-slate-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:w.name}),e.jsxs("p",{className:"text-sm text-slate-600",children:[w.contactPerson," | ",w.phone]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalPurchases"),":"]}),e.jsx("span",{className:"font-semibold text-slate-800 ml-1",children:A.format(j)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalExpenses"),":"]}),e.jsx("span",{className:"font-semibold text-red-600 ml-1",children:A.format(D)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.totalValue"),":"]}),e.jsx("span",{className:"font-semibold text-blue-600 ml-1",children:A.format(M)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[o("reports.itemCount"),":"]}),e.jsx("span",{className:"font-semibold text-slate-800 ml-1",children:I})]})]}),e.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:[o("reports.expenseCount"),": ",_]})]}),e.jsxs("button",{onClick:()=>{const{inventoryItems:Q,expenses:G}=a,re=Q.filter(z=>z.supplierId===w.id),le=G.filter(z=>z.supplierId===w.id),he=re.reduce((z,ee)=>z+ee.unitCost*ee.currentStock,0),P=le.reduce((z,ee)=>z+ee.amount,0),L=e.jsxs("div",{className:"p-8 bg-white text-slate-900",dir:"rtl",children:[e.jsxs("header",{className:"text-center mb-10 border-b-2 border-slate-300 pb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-2",children:o("supplierReport.title")}),e.jsx("h2",{className:"text-2xl font-bold text-primary-dark mb-4",children:w.name}),e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsxs("p",{children:[" : ",w.contactPerson]}),e.jsxs("p",{children:[": ",w.phone]}),e.jsxs("p",{children:[" : ",w.email]}),e.jsxs("p",{children:[" : ",w.supplierType==="materialSupplier"?" ":" "]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:o("supplierReport.summary")}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("supplierReport.totalPurchases")}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:A.format(he)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:o("supplierReport.totalExpenses")}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:A.format(P)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:A.format(M)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:I})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-slate-600",children:" "}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:_})]})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:"  "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:" "})]})}),e.jsx("tbody",{children:re.map(z=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.name}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm text-center",children:z.currentStock}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold",children:A.format(z.unitCost)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold text-blue-600",children:A.format(z.unitCost*z.currentStock)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.expiryDate?new Date(z.expiryDate).toLocaleDateString("ar-EG"):"-"})]},z.id))})]})]}),e.jsxs("section",{className:"mb-10",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-6 border-b border-slate-200 pb-2",children:" "}),e.jsxs("table",{className:"w-full border-collapse border border-slate-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-100",children:[e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""}),e.jsx("th",{className:"border border-slate-300 p-3 text-right text-sm font-bold",children:""})]})}),e.jsx("tbody",{children:le.map(z=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:new Date(z.date).toLocaleDateString("ar-EG")}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:z.description}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm font-semibold text-red-600",children:A.format(z.amount)}),e.jsx("td",{className:"border border-slate-300 p-3 text-sm",children:o(`expenseCategory.${z.category}`)})]},z.id))})]})]}),e.jsxs("footer",{className:"text-center text-sm text-slate-500 border-t border-slate-300 pt-6",children:[e.jsxs("p",{children:["     ",new Date().toLocaleDateString("ar-EG"),"  ",new Date().toLocaleTimeString("ar-EG")]}),e.jsx("p",{className:"mt-2",children:"  -    "})]})]});Kr(`${o("supplierReport.title")} - ${w.name}`,L)},className:"px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors",children:[" ",o("reports.printReport")]})]})},w.id))})]})}),C=()=>{switch(c){case"overview":return x();case"patients":return v();case"doctors":return N();case"suppliers":return k();case"daily":return e.jsx(Fv,{clinicData:a});case"monthly":return e.jsx($v,{clinicData:a});case"quarterly":return e.jsx(Uv,{clinicData:a});default:return x()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",dir:"rtl",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:o("reports.title")}),e.jsx("p",{className:"text-gray-600",children:o("reports.description")})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:b.map(w=>e.jsxs("button",{onClick:()=>u(w.id),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${c===w.id?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{children:w.icon}),w.label]},w.id))})}),e.jsx("div",{className:"p-6",children:C()})]})]})},Bv={[ve.SUCCESS]:{bg:"bg-green-100",text:"text-green-800",icon:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"},[ve.ERROR]:{bg:"bg-red-100",text:"text-red-800",icon:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"},[ve.INFO]:{bg:"bg-sky-100",text:"text-sky-800",icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},[ve.WARNING]:{bg:"bg-amber-100",text:"text-amber-800",icon:"M10 18a8 8 0 100-16 8 8 0 000 16zM11 7v4m0 4h.01"}},qv=({notification:a})=>{const{removeNotification:s}=At(),[n,o]=q.useState(!1);q.useEffect(()=>{const h=setTimeout(()=>{o(!0),setTimeout(()=>s(a.id),300)},5e3);return()=>clearTimeout(h)},[a.id,s]);const i=()=>{o(!0),setTimeout(()=>s(a.id),300)},{bg:c,text:u,icon:m}=Bv[a.type];return e.jsxs("div",{className:`relative rounded-xl shadow-lg p-4 flex items-start gap-3 transition-all duration-300 transform ${c} ${u} ${n?"opacity-0 translate-x-full":"opacity-100 translate-x-0"}`,role:"alert",children:[e.jsx("svg",{className:"h-5 w-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:m,clipRule:"evenodd"})}),e.jsx("p",{className:"flex-1 text-sm font-semibold",children:a.message}),e.jsxs("button",{onClick:i,className:`ms-auto -mx-1.5 -my-1.5 p-1.5 rounded-lg inline-flex h-8 w-8 ${c} ${u} hover:bg-opacity-50`,"aria-label":"Close",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})},e0=()=>{const{notifications:a}=At();return e.jsx("div",{className:"fixed top-4 end-4 z-[100] w-full max-w-xs space-y-2",dir:"rtl",children:a.map(s=>e.jsx(qv,{notification:s},s.id))})},zv=()=>{const{user:a}=Ss(),{addNotification:s}=At(),[n,o]=q.useState([]),[i,c]=q.useState(!0),[u,m]=q.useState(!1),[h,y]=q.useState(null),[b,f]=q.useState({username:"",email:"",password:"",role:$t.ADMIN,permissions:[]});q.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:D,error:M}=await me.from("user_profiles").select("*").order("created_at",{ascending:!1});if(M)throw M;o(D||[])}catch(D){console.error("Error fetching users:",D),s("Failed to fetch users","error")}finally{c(!1)}},v=async D=>{D.preventDefault();try{if(h){const{error:M}=await me.from("user_profiles").update({username:b.username,role:b.role,permissions:b.permissions.length>0?b.permissions:N(b.role),updated_at:new Date().toISOString()}).eq("id",h.id);if(M)throw M;s("User updated successfully","success")}else{const{data:M,error:I}=await me.auth.signUp({email:b.email,password:b.password});if(I)throw I;const{error:_}=await me.from("user_profiles").insert({user_id:M.user?.id,username:b.username,role:b.role,permissions:b.permissions.length>0?b.permissions:N(b.role),id:M.user?.id});if(_)throw _;s("User created successfully","success")}m(!1),y(null),w(),x()}catch(M){console.error("Error saving user:",M),s(M.message||"Failed to save user","error")}},N=D=>{switch(D){case $t.ADMIN:return["view_dashboard","manage_users","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports","view_finance","edit_finance"];case $t.DOCTOR:return["view_dashboard","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports"];case $t.ASSISTANT:return["view_dashboard","view_patients","edit_patients","view_scheduler","edit_scheduler"];case $t.RECEPTIONIST:return["view_dashboard","view_patients","view_scheduler","edit_scheduler","view_reports"];default:return[]}},k=D=>{y(D),f({username:D.username,email:"",password:"",role:D.role,permissions:D.permissions||[]}),m(!0)},C=async D=>{if(confirm("Are you sure you want to delete this user?"))try{const{error:M}=await me.from("user_profiles").delete().eq("id",D);if(M)throw M;s("User deleted successfully","success"),x()}catch(M){console.error("Error deleting user:",M),s("Failed to delete user","error")}},w=()=>{f({username:"",email:"",password:"",role:$t.ADMIN,permissions:[]})},j=()=>{y(null),w(),m(!0)};return i?e.jsx("div",{className:"flex justify-center items-center h-64",children:"Loading..."}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"User Management"}),e.jsx("button",{onClick:j,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Add New User"})]}),e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:D.username}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:D.role}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(D.created_at).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>k(D),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Edit"}),e.jsx("button",{onClick:()=>C(D.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},D.id))})]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:h?"Edit User":"Add New User"}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),e.jsx("input",{type:"text",value:b.username,onChange:D=>f({...b,username:D.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),!h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{type:"email",value:b.email,onChange:D=>f({...b,email:D.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{type:"password",value:b.password,onChange:D=>f({...b,password:D.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Role"}),e.jsxs("select",{value:b.role,onChange:D=>{const M=D.target.value;f({...b,role:M,permissions:N(M)})},className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:[e.jsx("option",{value:$t.ADMIN,children:"Admin"}),e.jsx("option",{value:$t.DOCTOR,children:"Doctor"}),e.jsx("option",{value:$t.ASSISTANT,children:"Assistant"}),e.jsx("option",{value:$t.RECEPTIONIST,children:"Receptionist"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Permissions"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border rounded p-2",children:[{id:"view_dashboard",label:"View Dashboard"},{id:"manage_users",label:"Manage Users"},{id:"view_patients",label:"View Patients"},{id:"edit_patients",label:"Edit Patients"},{id:"view_scheduler",label:"View Scheduler"},{id:"edit_scheduler",label:"Edit Scheduler"},{id:"view_reports",label:"View Reports"},{id:"view_finance",label:"View Finance"},{id:"edit_finance",label:"Edit Finance"}].map(D=>e.jsxs("label",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:b.permissions.includes(D.id),onChange:M=>{const I=M.target.checked;f(_=>({..._,permissions:I?[..._.permissions,D.id]:_.permissions.filter(A=>A!==D.id)}))},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:D.label})]},D.id))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select specific permissions or leave empty to use role defaults"})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"mr-4 bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:h?"Update":"Create"})]})]})]})})}),e.jsx(e0,{})]})},Hv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})}),Wv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.653-.124-1.282-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.653.124-1.282.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),Vv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Gv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h8a2 2 0 002-2v-3a2 2 0 00-2-2H9.5m3.5-6.5a2 2 0 11-4 0 2 2 0 014 0z"})}),Kv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 1a3 3 0 00-3 3v1h10V4a3 3 0 00-3-3H8zM5 6v10a2 2 0 002 2h10a2 2 0 002-2V6H5z"})}),Jv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),Yv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),Qv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),Xv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Zv=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),ew=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),tw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),rw=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),sw=({currentView:a,setCurrentView:s})=>{const{t:n}=Ve(),o=[{id:"dashboard",label:n("sidebar.dashboard"),icon:e.jsx(Hv,{})},{id:"patients",label:n("sidebar.patients"),icon:e.jsx(Wv,{})},{id:"scheduler",label:n("sidebar.scheduler"),icon:e.jsx(Vv,{})},{id:"doctors",label:n("sidebar.doctors"),icon:e.jsx(Gv,{})},{id:"suppliers",label:n("sidebar.suppliers"),icon:e.jsx(Kv,{})},{id:"inventory",label:n("sidebar.inventory"),icon:e.jsx(Jv,{})},{id:"labCases",label:n("sidebar.labCases"),icon:e.jsx(Yv,{})},{id:"expenses",label:n("sidebar.expenses"),icon:e.jsx(Qv,{})},{id:"treatmentDefinitions",label:n("sidebar.treatmentDefinitions"),icon:e.jsx(Xv,{})},{id:"doctorAccounts",label:n("sidebar.doctorAccounts"),icon:e.jsx(Zv,{})},{id:"financialAccounts",label:n("sidebar.financialAccounts"),icon:e.jsx(ew,{})},{id:"reports",label:n("sidebar.reports"),icon:e.jsx(tw,{})},{id:"settings",label:n("sidebar.settings"),icon:e.jsx(rw,{})}];return e.jsx("nav",{className:"fixed bottom-0 start-0 end-0 h-20 bg-white border-t border-slate-200 flex z-20 md:hidden print:hidden",children:e.jsx("div",{className:"flex items-stretch w-full h-full overflow-x-auto",children:o.map(i=>e.jsxs("button",{onClick:()=>s(i.id),className:`flex flex-col items-center justify-center flex-shrink-0 w-24 h-full transition-colors duration-200 text-sm focus:outline-none focus:ring-2 focus:ring-primary-light ${a===i.id?"text-primary bg-primary/10":"text-slate-500 hover:text-primary hover:bg-slate-50"}`,"aria-current":a===i.id?"page":void 0,children:[i.icon,e.jsx("span",{className:"text-xs font-medium whitespace-nowrap",children:i.label})]},i.id))})})};var Zi={exports:{}},el={exports:{}};/*! Axios v1.13.2 Copyright (c) 2025 Matt Zabriskie and contributors */var ed,hp;function nw(){if(hp)return ed;hp=1;function a(S,E){return function(){return S.apply(E,arguments)}}const{toString:s}=Object.prototype,{getPrototypeOf:n}=Object,{iterator:o,toStringTag:i}=Symbol,c=(S=>E=>{const R=s.call(E);return S[R]||(S[R]=R.slice(8,-1).toLowerCase())})(Object.create(null)),u=S=>(S=S.toLowerCase(),E=>c(E)===S),m=S=>E=>typeof E===S,{isArray:h}=Array,y=m("undefined");function b(S){return S!==null&&!y(S)&&S.constructor!==null&&!y(S.constructor)&&N(S.constructor.isBuffer)&&S.constructor.isBuffer(S)}const f=u("ArrayBuffer");function x(S){let E;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?E=ArrayBuffer.isView(S):E=S&&S.buffer&&f(S.buffer),E}const v=m("string"),N=m("function"),k=m("number"),C=S=>S!==null&&typeof S=="object",w=S=>S===!0||S===!1,j=S=>{if(c(S)!=="object")return!1;const E=n(S);return(E===null||E===Object.prototype||Object.getPrototypeOf(E)===null)&&!(i in S)&&!(o in S)},D=S=>{if(!C(S)||b(S))return!1;try{return Object.keys(S).length===0&&Object.getPrototypeOf(S)===Object.prototype}catch{return!1}},M=u("Date"),I=u("File"),_=u("Blob"),A=u("FileList"),Q=S=>C(S)&&N(S.pipe),G=S=>{let E;return S&&(typeof FormData=="function"&&S instanceof FormData||N(S.append)&&((E=c(S))==="formdata"||E==="object"&&N(S.toString)&&S.toString()==="[object FormData]"))},re=u("URLSearchParams"),[le,he,P,L]=["ReadableStream","Request","Response","Headers"].map(u),z=S=>S.trim?S.trim():S.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ee(S,E,{allOwnKeys:R=!1}={}){if(S===null||typeof S>"u")return;let O,$;if(typeof S!="object"&&(S=[S]),h(S))for(O=0,$=S.length;O<$;O++)E.call(null,S[O],O,S);else{if(b(S))return;const J=R?Object.getOwnPropertyNames(S):Object.keys(S),K=J.length;let ge;for(O=0;O<K;O++)ge=J[O],E.call(null,S[ge],ge,S)}}function se(S,E){if(b(S))return null;E=E.toLowerCase();const R=Object.keys(S);let O=R.length,$;for(;O-- >0;)if($=R[O],E===$.toLowerCase())return $;return null}const Y=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:xg,xe=S=>!y(S)&&S!==Y;function ce(){const{caseless:S,skipUndefined:E}=xe(this)&&this||{},R={},O=($,J)=>{const K=S&&se(R,J)||J;j(R[K])&&j($)?R[K]=ce(R[K],$):j($)?R[K]=ce({},$):h($)?R[K]=$.slice():(!E||!y($))&&(R[K]=$)};for(let $=0,J=arguments.length;$<J;$++)arguments[$]&&ee(arguments[$],O);return R}const B=(S,E,R,{allOwnKeys:O}={})=>(ee(E,($,J)=>{R&&N($)?S[J]=a($,R):S[J]=$},{allOwnKeys:O}),S),F=S=>(S.charCodeAt(0)===65279&&(S=S.slice(1)),S),ue=(S,E,R,O)=>{S.prototype=Object.create(E.prototype,O),S.prototype.constructor=S,Object.defineProperty(S,"super",{value:E.prototype}),R&&Object.assign(S.prototype,R)},We=(S,E,R,O)=>{let $,J,K;const ge={};if(E=E||{},S==null)return E;do{for($=Object.getOwnPropertyNames(S),J=$.length;J-- >0;)K=$[J],(!O||O(K,S,E))&&!ge[K]&&(E[K]=S[K],ge[K]=!0);S=R!==!1&&n(S)}while(S&&(!R||R(S,E))&&S!==Object.prototype);return E},Ye=(S,E,R)=>{S=String(S),(R===void 0||R>S.length)&&(R=S.length),R-=E.length;const O=S.indexOf(E,R);return O!==-1&&O===R},Qe=S=>{if(!S)return null;if(h(S))return S;let E=S.length;if(!k(E))return null;const R=new Array(E);for(;E-- >0;)R[E]=S[E];return R},Ne=(S=>E=>S&&E instanceof S)(typeof Uint8Array<"u"&&n(Uint8Array)),Pe=(S,E)=>{const O=(S&&S[o]).call(S);let $;for(;($=O.next())&&!$.done;){const J=$.value;E.call(S,J[0],J[1])}},pe=(S,E)=>{let R;const O=[];for(;(R=S.exec(E))!==null;)O.push(R);return O},Ce=u("HTMLFormElement"),Ie=S=>S.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(R,O,$){return O.toUpperCase()+$}),nt=(({hasOwnProperty:S})=>(E,R)=>S.call(E,R))(Object.prototype),et=u("RegExp"),Nt=(S,E)=>{const R=Object.getOwnPropertyDescriptors(S),O={};ee(R,($,J)=>{let K;(K=E($,J,S))!==!1&&(O[J]=K||$)}),Object.defineProperties(S,O)},He=S=>{Nt(S,(E,R)=>{if(N(S)&&["arguments","caller","callee"].indexOf(R)!==-1)return!1;const O=S[R];if(N(O)){if(E.enumerable=!1,"writable"in E){E.writable=!1;return}E.set||(E.set=()=>{throw Error("Can not rewrite read-only method '"+R+"'")})}})},ct=(S,E)=>{const R={},O=$=>{$.forEach(J=>{R[J]=!0})};return h(S)?O(S):O(String(S).split(E)),R},pr=()=>{},fr=(S,E)=>S!=null&&Number.isFinite(S=+S)?S:E;function rn(S){return!!(S&&N(S.append)&&S[i]==="FormData"&&S[o])}const ls=S=>{const E=new Array(10),R=(O,$)=>{if(C(O)){if(E.indexOf(O)>=0)return;if(b(O))return O;if(!("toJSON"in O)){E[$]=O;const J=h(O)?[]:{};return ee(O,(K,ge)=>{const Ae=R(K,$+1);!y(Ae)&&(J[ge]=Ae)}),E[$]=void 0,J}}return O};return R(S,0)},Jr=u("AsyncFunction"),sn=S=>S&&(C(S)||N(S))&&N(S.then)&&N(S.catch),nn=((S,E)=>S?setImmediate:E?((R,O)=>(Y.addEventListener("message",({source:$,data:J})=>{$===Y&&J===R&&O.length&&O.shift()()},!1),$=>{O.push($),Y.postMessage(R,"*")}))(`axios@${Math.random()}`,[]):R=>setTimeout(R))(typeof setImmediate=="function",N(Y.postMessage)),$n=typeof queueMicrotask<"u"?queueMicrotask.bind(Y):typeof process<"u"&&process.nextTick||nn;var te={isArray:h,isArrayBuffer:f,isBuffer:b,isFormData:G,isArrayBufferView:x,isString:v,isNumber:k,isBoolean:w,isObject:C,isPlainObject:j,isEmptyObject:D,isReadableStream:le,isRequest:he,isResponse:P,isHeaders:L,isUndefined:y,isDate:M,isFile:I,isBlob:_,isRegExp:et,isFunction:N,isStream:Q,isURLSearchParams:re,isTypedArray:Ne,isFileList:A,forEach:ee,merge:ce,extend:B,trim:z,stripBOM:F,inherits:ue,toFlatObject:We,kindOf:c,kindOfTest:u,endsWith:Ye,toArray:Qe,forEachEntry:Pe,matchAll:pe,isHTMLForm:Ce,hasOwnProperty:nt,hasOwnProp:nt,reduceDescriptors:Nt,freezeMethods:He,toObjectSet:ct,toCamelCase:Ie,noop:pr,toFiniteNumber:fr,findKey:se,global:Y,isContextDefined:xe,isSpecCompliantForm:rn,toJSONObject:ls,isAsyncFn:Jr,isThenable:sn,setImmediate:nn,asap:$n,isIterable:S=>S!=null&&N(S[o])};function Xe(S,E,R,O,$){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=S,this.name="AxiosError",E&&(this.code=E),R&&(this.config=R),O&&(this.request=O),$&&(this.response=$,this.status=$.status?$.status:null)}te.inherits(Xe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:te.toJSONObject(this.config),code:this.code,status:this.status}}});const ks=Xe.prototype,Un={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(S=>{Un[S]={value:S}}),Object.defineProperties(Xe,Un),Object.defineProperty(ks,"isAxiosError",{value:!0}),Xe.from=(S,E,R,O,$,J)=>{const K=Object.create(ks);te.toFlatObject(S,K,function(je){return je!==Error.prototype},ke=>ke!=="isAxiosError");const ge=S&&S.message?S.message:"Error",Ae=E==null&&S?S.code:E;return Xe.call(K,ge,Ae,R,O,$),S&&K.cause==null&&Object.defineProperty(K,"cause",{value:S,configurable:!0}),K.name=S&&S.name||"Error",J&&Object.assign(K,J),K};var _s=null;function Yr(S){return te.isPlainObject(S)||te.isArray(S)}function Oa(S){return te.endsWith(S,"[]")?S.slice(0,-2):S}function Bn(S,E,R){return S?S.concat(E).map(function($,J){return $=Oa($),!R&&J?"["+$+"]":$}).join(R?".":""):E}function Ma(S){return te.isArray(S)&&!S.some(Yr)}const Po=te.toFlatObject(te,{},null,function(E){return/^is[A-Z]/.test(E)});function cs(S,E,R){if(!te.isObject(S))throw new TypeError("target must be an object");E=E||new FormData,R=te.toFlatObject(R,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Ze,Le){return!te.isUndefined(Le[Ze])});const O=R.metaTokens,$=R.visitor||je,J=R.dots,K=R.indexes,Ae=(R.Blob||typeof Blob<"u"&&Blob)&&te.isSpecCompliantForm(E);if(!te.isFunction($))throw new TypeError("visitor must be a function");function ke(_e){if(_e===null)return"";if(te.isDate(_e))return _e.toISOString();if(te.isBoolean(_e))return _e.toString();if(!Ae&&te.isBlob(_e))throw new Xe("Blob is not supported. Use a Buffer instead.");return te.isArrayBuffer(_e)||te.isTypedArray(_e)?Ae&&typeof Blob=="function"?new Blob([_e]):Buffer.from(_e):_e}function je(_e,Ze,Le){let kt=_e;if(_e&&!Le&&typeof _e=="object"){if(te.endsWith(Ze,"{}"))Ze=O?Ze:Ze.slice(0,-2),_e=JSON.stringify(_e);else if(te.isArray(_e)&&Ma(_e)||(te.isFileList(_e)||te.endsWith(Ze,"[]"))&&(kt=te.toArray(_e)))return Ze=Oa(Ze),kt.forEach(function(Pt,Jt){!(te.isUndefined(Pt)||Pt===null)&&E.append(K===!0?Bn([Ze],Jt,J):K===null?Ze:Ze+"[]",ke(Pt))}),!1}return Yr(_e)?!0:(E.append(Bn(Le,Ze,J),ke(_e)),!1)}const Be=[],ht=Object.assign(Po,{defaultVisitor:je,convertValue:ke,isVisitable:Yr});function Ot(_e,Ze){if(!te.isUndefined(_e)){if(Be.indexOf(_e)!==-1)throw Error("Circular reference detected in "+Ze.join("."));Be.push(_e),te.forEach(_e,function(kt,or){(!(te.isUndefined(kt)||kt===null)&&$.call(E,kt,te.isString(or)?or.trim():or,Ze,ht))===!0&&Ot(kt,Ze?Ze.concat(or):[or])}),Be.pop()}}if(!te.isObject(S))throw new TypeError("data must be an object");return Ot(S),E}function an(S){const E={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(S).replace(/[!'()~]|%20|%00/g,function(O){return E[O]})}function Cs(S,E){this._pairs=[],S&&cs(S,this,E)}const on=Cs.prototype;on.append=function(E,R){this._pairs.push([E,R])},on.toString=function(E){const R=E?function(O){return E.call(this,O,an)}:an;return this._pairs.map(function($){return R($[0])+"="+R($[1])},"").join("&")};function qn(S){return encodeURIComponent(S).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function H(S,E,R){if(!E)return S;const O=R&&R.encode||qn;te.isFunction(R)&&(R={serialize:R});const $=R&&R.serialize;let J;if($?J=$(E,R):J=te.isURLSearchParams(E)?E.toString():new Cs(E,R).toString(O),J){const K=S.indexOf("#");K!==-1&&(S=S.slice(0,K)),S+=(S.indexOf("?")===-1?"?":"&")+J}return S}class fe{constructor(){this.handlers=[]}use(E,R,O){return this.handlers.push({fulfilled:E,rejected:R,synchronous:O?O.synchronous:!1,runWhen:O?O.runWhen:null}),this.handlers.length-1}eject(E){this.handlers[E]&&(this.handlers[E]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(E){te.forEach(this.handlers,function(O){O!==null&&E(O)})}}var oe=fe,ne={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ee=typeof URLSearchParams<"u"?URLSearchParams:Cs,ie=typeof FormData<"u"?FormData:null,qe=typeof Blob<"u"?Blob:null,Te={isBrowser:!0,classes:{URLSearchParams:Ee,FormData:ie,Blob:qe},protocols:["http","https","file","blob","url","data"]};const Ue=typeof window<"u"&&typeof document<"u",tt=typeof navigator=="object"&&navigator||void 0,ze=Ue&&(!tt||["ReactNative","NativeScript","NS"].indexOf(tt.product)<0),pt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",rt=Ue&&window.location.href||"http://localhost";var yt=Object.freeze({__proto__:null,hasBrowserEnv:Ue,hasStandardBrowserWebWorkerEnv:pt,hasStandardBrowserEnv:ze,navigator:tt,origin:rt}),at={...yt,...Te};function Kt(S,E){return cs(S,new at.classes.URLSearchParams,{visitor:function(R,O,$,J){return at.isNode&&te.isBuffer(R)?(this.append(O,R.toString("base64")),!1):J.defaultVisitor.apply(this,arguments)},...E})}function kr(S){return te.matchAll(/\w+|\[(\w*)]/g,S).map(E=>E[0]==="[]"?"":E[1]||E[0])}function Qr(S){const E={},R=Object.keys(S);let O;const $=R.length;let J;for(O=0;O<$;O++)J=R[O],E[J]=S[J];return E}function lt(S){function E(R,O,$,J){let K=R[J++];if(K==="__proto__")return!0;const ge=Number.isFinite(+K),Ae=J>=R.length;return K=!K&&te.isArray($)?$.length:K,Ae?(te.hasOwnProp($,K)?$[K]=[$[K],O]:$[K]=O,!ge):((!$[K]||!te.isObject($[K]))&&($[K]=[]),E(R,O,$[K],J)&&te.isArray($[K])&&($[K]=Qr($[K])),!ge)}if(te.isFormData(S)&&te.isFunction(S.entries)){const R={};return te.forEachEntry(S,(O,$)=>{E(kr(O),$,R,0)}),R}return null}function de(S,E,R){if(te.isString(S))try{return(E||JSON.parse)(S),te.trim(S)}catch(O){if(O.name!=="SyntaxError")throw O}return(R||JSON.stringify)(S)}const Ut={transitional:ne,adapter:["xhr","http","fetch"],transformRequest:[function(E,R){const O=R.getContentType()||"",$=O.indexOf("application/json")>-1,J=te.isObject(E);if(J&&te.isHTMLForm(E)&&(E=new FormData(E)),te.isFormData(E))return $?JSON.stringify(lt(E)):E;if(te.isArrayBuffer(E)||te.isBuffer(E)||te.isStream(E)||te.isFile(E)||te.isBlob(E)||te.isReadableStream(E))return E;if(te.isArrayBufferView(E))return E.buffer;if(te.isURLSearchParams(E))return R.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),E.toString();let ge;if(J){if(O.indexOf("application/x-www-form-urlencoded")>-1)return Kt(E,this.formSerializer).toString();if((ge=te.isFileList(E))||O.indexOf("multipart/form-data")>-1){const Ae=this.env&&this.env.FormData;return cs(ge?{"files[]":E}:E,Ae&&new Ae,this.formSerializer)}}return J||$?(R.setContentType("application/json",!1),de(E)):E}],transformResponse:[function(E){const R=this.transitional||Ut.transitional,O=R&&R.forcedJSONParsing,$=this.responseType==="json";if(te.isResponse(E)||te.isReadableStream(E))return E;if(E&&te.isString(E)&&(O&&!this.responseType||$)){const K=!(R&&R.silentJSONParsing)&&$;try{return JSON.parse(E,this.parseReviver)}catch(ge){if(K)throw ge.name==="SyntaxError"?Xe.from(ge,Xe.ERR_BAD_RESPONSE,this,null,this.response):ge}}return E}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:at.classes.FormData,Blob:at.classes.Blob},validateStatus:function(E){return E>=200&&E<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};te.forEach(["delete","get","head","post","put","patch"],S=>{Ut.headers[S]={}});var Es=Ut;const ln=te.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var hl=S=>{const E={};let R,O,$;return S&&S.split(`
`).forEach(function(K){$=K.indexOf(":"),R=K.substring(0,$).trim().toLowerCase(),O=K.substring($+1).trim(),!(!R||E[R]&&ln[R])&&(R==="set-cookie"?E[R]?E[R].push(O):E[R]=[O]:E[R]=E[R]?E[R]+", "+O:O)}),E};const La=Symbol("internals");function Ts(S){return S&&String(S).trim().toLowerCase()}function cn(S){return S===!1||S==null?S:te.isArray(S)?S.map(cn):String(S)}function Io(S){const E=Object.create(null),R=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let O;for(;O=R.exec(S);)E[O[1]]=O[2];return E}const pl=S=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(S.trim());function Fa(S,E,R,O,$){if(te.isFunction(O))return O.call(this,E,R);if($&&(E=R),!!te.isString(E)){if(te.isString(O))return E.indexOf(O)!==-1;if(te.isRegExp(O))return O.test(E)}}function St(S){return S.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(E,R,O)=>R.toUpperCase()+O)}function fl(S,E){const R=te.toCamelCase(" "+E);["get","set","has"].forEach(O=>{Object.defineProperty(S,O+R,{value:function($,J,K){return this[O].call(this,E,$,J,K)},configurable:!0})})}class Ds{constructor(E){E&&this.set(E)}set(E,R,O){const $=this;function J(ge,Ae,ke){const je=Ts(Ae);if(!je)throw new Error("header name must be a non-empty string");const Be=te.findKey($,je);(!Be||$[Be]===void 0||ke===!0||ke===void 0&&$[Be]!==!1)&&($[Be||Ae]=cn(ge))}const K=(ge,Ae)=>te.forEach(ge,(ke,je)=>J(ke,je,Ae));if(te.isPlainObject(E)||E instanceof this.constructor)K(E,R);else if(te.isString(E)&&(E=E.trim())&&!pl(E))K(hl(E),R);else if(te.isObject(E)&&te.isIterable(E)){let ge={},Ae,ke;for(const je of E){if(!te.isArray(je))throw TypeError("Object iterator must return a key-value pair");ge[ke=je[0]]=(Ae=ge[ke])?te.isArray(Ae)?[...Ae,je[1]]:[Ae,je[1]]:je[1]}K(ge,R)}else E!=null&&J(R,E,O);return this}get(E,R){if(E=Ts(E),E){const O=te.findKey(this,E);if(O){const $=this[O];if(!R)return $;if(R===!0)return Io($);if(te.isFunction(R))return R.call(this,$,O);if(te.isRegExp(R))return R.exec($);throw new TypeError("parser must be boolean|regexp|function")}}}has(E,R){if(E=Ts(E),E){const O=te.findKey(this,E);return!!(O&&this[O]!==void 0&&(!R||Fa(this,this[O],O,R)))}return!1}delete(E,R){const O=this;let $=!1;function J(K){if(K=Ts(K),K){const ge=te.findKey(O,K);ge&&(!R||Fa(O,O[ge],ge,R))&&(delete O[ge],$=!0)}}return te.isArray(E)?E.forEach(J):J(E),$}clear(E){const R=Object.keys(this);let O=R.length,$=!1;for(;O--;){const J=R[O];(!E||Fa(this,this[J],J,E,!0))&&(delete this[J],$=!0)}return $}normalize(E){const R=this,O={};return te.forEach(this,($,J)=>{const K=te.findKey(O,J);if(K){R[K]=cn($),delete R[J];return}const ge=E?St(J):String(J).trim();ge!==J&&delete R[J],R[ge]=cn($),O[ge]=!0}),this}concat(...E){return this.constructor.concat(this,...E)}toJSON(E){const R=Object.create(null);return te.forEach(this,(O,$)=>{O!=null&&O!==!1&&(R[$]=E&&te.isArray(O)?O.join(", "):O)}),R}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([E,R])=>E+": "+R).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(E){return E instanceof this?E:new this(E)}static concat(E,...R){const O=new this(E);return R.forEach($=>O.set($)),O}static accessor(E){const O=(this[La]=this[La]={accessors:{}}).accessors,$=this.prototype;function J(K){const ge=Ts(K);O[ge]||(fl($,K),O[ge]=!0)}return te.isArray(E)?E.forEach(J):J(E),this}}Ds.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),te.reduceDescriptors(Ds.prototype,({value:S},E)=>{let R=E[0].toUpperCase()+E.slice(1);return{get:()=>S,set(O){this[R]=O}}}),te.freezeMethods(Ds);var ar=Ds;function Ps(S,E){const R=this||Es,O=E||R,$=ar.from(O.headers);let J=O.data;return te.forEach(S,function(ge){J=ge.call(R,J,$.normalize(),E?E.status:void 0)}),$.normalize(),J}function Ro(S){return!!(S&&S.__CANCEL__)}function ds(S,E,R){Xe.call(this,S??"canceled",Xe.ERR_CANCELED,E,R),this.name="CanceledError"}te.inherits(ds,Xe,{__CANCEL__:!0});function dn(S,E,R){const O=R.config.validateStatus;!R.status||!O||O(R.status)?S(R):E(new Xe("Request failed with status code "+R.status,[Xe.ERR_BAD_REQUEST,Xe.ERR_BAD_RESPONSE][Math.floor(R.status/100)-4],R.config,R.request,R))}function _r(S){const E=/^([-+\w]{1,25})(:?\/\/|:)/.exec(S);return E&&E[1]||""}function gl(S,E){S=S||10;const R=new Array(S),O=new Array(S);let $=0,J=0,K;return E=E!==void 0?E:1e3,function(Ae){const ke=Date.now(),je=O[J];K||(K=ke),R[$]=Ae,O[$]=ke;let Be=J,ht=0;for(;Be!==$;)ht+=R[Be++],Be=Be%S;if($=($+1)%S,$===J&&(J=(J+1)%S),ke-K<E)return;const Ot=je&&ke-je;return Ot?Math.round(ht*1e3/Ot):void 0}}function gr(S,E){let R=0,O=1e3/E,$,J;const K=(ke,je=Date.now())=>{R=je,$=null,J&&(clearTimeout(J),J=null),S(...ke)};return[(...ke)=>{const je=Date.now(),Be=je-R;Be>=O?K(ke,je):($=ke,J||(J=setTimeout(()=>{J=null,K($)},O-Be)))},()=>$&&K($)]}const zn=(S,E,R=3)=>{let O=0;const $=gl(50,250);return gr(J=>{const K=J.loaded,ge=J.lengthComputable?J.total:void 0,Ae=K-O,ke=$(Ae),je=K<=ge;O=K;const Be={loaded:K,total:ge,progress:ge?K/ge:void 0,bytes:Ae,rate:ke||void 0,estimated:ke&&ge&&je?(ge-K)/ke:void 0,event:J,lengthComputable:ge!=null,[E?"download":"upload"]:!0};S(Be)},R)},Ao=(S,E)=>{const R=S!=null;return[O=>E[0]({lengthComputable:R,total:S,loaded:O}),E[1]]},Oo=S=>(...E)=>te.asap(()=>S(...E));var Hn=at.hasStandardBrowserEnv?((S,E)=>R=>(R=new URL(R,at.origin),S.protocol===R.protocol&&S.host===R.host&&(E||S.port===R.port)))(new URL(at.origin),at.navigator&&/(msie|trident)/i.test(at.navigator.userAgent)):()=>!0,Wn=at.hasStandardBrowserEnv?{write(S,E,R,O,$,J,K){if(typeof document>"u")return;const ge=[`${S}=${encodeURIComponent(E)}`];te.isNumber(R)&&ge.push(`expires=${new Date(R).toUTCString()}`),te.isString(O)&&ge.push(`path=${O}`),te.isString($)&&ge.push(`domain=${$}`),J===!0&&ge.push("secure"),te.isString(K)&&ge.push(`SameSite=${K}`),document.cookie=ge.join("; ")},read(S){if(typeof document>"u")return null;const E=document.cookie.match(new RegExp("(?:^|; )"+S+"=([^;]*)"));return E?decodeURIComponent(E[1]):null},remove(S){this.write(S,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function un(S){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(S)}function Vn(S,E){return E?S.replace(/\/?\/$/,"")+"/"+E.replace(/^\/+/,""):S}function Mo(S,E,R){let O=!un(E);return S&&(O||R==!1)?Vn(S,E):E}const Lo=S=>S instanceof ar?{...S}:S;function Ar(S,E){E=E||{};const R={};function O(ke,je,Be,ht){return te.isPlainObject(ke)&&te.isPlainObject(je)?te.merge.call({caseless:ht},ke,je):te.isPlainObject(je)?te.merge({},je):te.isArray(je)?je.slice():je}function $(ke,je,Be,ht){if(te.isUndefined(je)){if(!te.isUndefined(ke))return O(void 0,ke,Be,ht)}else return O(ke,je,Be,ht)}function J(ke,je){if(!te.isUndefined(je))return O(void 0,je)}function K(ke,je){if(te.isUndefined(je)){if(!te.isUndefined(ke))return O(void 0,ke)}else return O(void 0,je)}function ge(ke,je,Be){if(Be in E)return O(ke,je);if(Be in S)return O(void 0,ke)}const Ae={url:J,method:J,data:J,baseURL:K,transformRequest:K,transformResponse:K,paramsSerializer:K,timeout:K,timeoutMessage:K,withCredentials:K,withXSRFToken:K,adapter:K,responseType:K,xsrfCookieName:K,xsrfHeaderName:K,onUploadProgress:K,onDownloadProgress:K,decompress:K,maxContentLength:K,maxBodyLength:K,beforeRedirect:K,transport:K,httpAgent:K,httpsAgent:K,cancelToken:K,socketPath:K,responseEncoding:K,validateStatus:ge,headers:(ke,je,Be)=>$(Lo(ke),Lo(je),Be,!0)};return te.forEach(Object.keys({...S,...E}),function(je){const Be=Ae[je]||$,ht=Be(S[je],E[je],je);te.isUndefined(ht)&&Be!==ge||(R[je]=ht)}),R}var $a=S=>{const E=Ar({},S);let{data:R,withXSRFToken:O,xsrfHeaderName:$,xsrfCookieName:J,headers:K,auth:ge}=E;if(E.headers=K=ar.from(K),E.url=H(Mo(E.baseURL,E.url,E.allowAbsoluteUrls),S.params,S.paramsSerializer),ge&&K.set("Authorization","Basic "+btoa((ge.username||"")+":"+(ge.password?unescape(encodeURIComponent(ge.password)):""))),te.isFormData(R)){if(at.hasStandardBrowserEnv||at.hasStandardBrowserWebWorkerEnv)K.setContentType(void 0);else if(te.isFunction(R.getHeaders)){const Ae=R.getHeaders(),ke=["content-type","content-length"];Object.entries(Ae).forEach(([je,Be])=>{ke.includes(je.toLowerCase())&&K.set(je,Be)})}}if(at.hasStandardBrowserEnv&&(O&&te.isFunction(O)&&(O=O(E)),O||O!==!1&&Hn(E.url))){const Ae=$&&J&&Wn.read(J);Ae&&K.set($,Ae)}return E},mn=typeof XMLHttpRequest<"u"&&function(S){return new Promise(function(R,O){const $=$a(S);let J=$.data;const K=ar.from($.headers).normalize();let{responseType:ge,onUploadProgress:Ae,onDownloadProgress:ke}=$,je,Be,ht,Ot,_e;function Ze(){Ot&&Ot(),_e&&_e(),$.cancelToken&&$.cancelToken.unsubscribe(je),$.signal&&$.signal.removeEventListener("abort",je)}let Le=new XMLHttpRequest;Le.open($.method.toUpperCase(),$.url,!0),Le.timeout=$.timeout;function kt(){if(!Le)return;const Pt=ar.from("getAllResponseHeaders"in Le&&Le.getAllResponseHeaders()),xr={data:!ge||ge==="text"||ge==="json"?Le.responseText:Le.response,status:Le.status,statusText:Le.statusText,headers:Pt,config:S,request:Le};dn(function(tr){R(tr),Ze()},function(tr){O(tr),Ze()},xr),Le=null}"onloadend"in Le?Le.onloadend=kt:Le.onreadystatechange=function(){!Le||Le.readyState!==4||Le.status===0&&!(Le.responseURL&&Le.responseURL.indexOf("file:")===0)||setTimeout(kt)},Le.onabort=function(){Le&&(O(new Xe("Request aborted",Xe.ECONNABORTED,S,Le)),Le=null)},Le.onerror=function(Jt){const xr=Jt&&Jt.message?Jt.message:"Network Error",hs=new Xe(xr,Xe.ERR_NETWORK,S,Le);hs.event=Jt||null,O(hs),Le=null},Le.ontimeout=function(){let Jt=$.timeout?"timeout of "+$.timeout+"ms exceeded":"timeout exceeded";const xr=$.transitional||ne;$.timeoutErrorMessage&&(Jt=$.timeoutErrorMessage),O(new Xe(Jt,xr.clarifyTimeoutError?Xe.ETIMEDOUT:Xe.ECONNABORTED,S,Le)),Le=null},J===void 0&&K.setContentType(null),"setRequestHeader"in Le&&te.forEach(K.toJSON(),function(Jt,xr){Le.setRequestHeader(xr,Jt)}),te.isUndefined($.withCredentials)||(Le.withCredentials=!!$.withCredentials),ge&&ge!=="json"&&(Le.responseType=$.responseType),ke&&([ht,_e]=zn(ke,!0),Le.addEventListener("progress",ht)),Ae&&Le.upload&&([Be,Ot]=zn(Ae),Le.upload.addEventListener("progress",Be),Le.upload.addEventListener("loadend",Ot)),($.cancelToken||$.signal)&&(je=Pt=>{Le&&(O(!Pt||Pt.type?new ds(null,S,Le):Pt),Le.abort(),Le=null)},$.cancelToken&&$.cancelToken.subscribe(je),$.signal&&($.signal.aborted?je():$.signal.addEventListener("abort",je)));const or=_r($.url);if(or&&at.protocols.indexOf(or)===-1){O(new Xe("Unsupported protocol "+or+":",Xe.ERR_BAD_REQUEST,S));return}Le.send(J||null)})},Ua=(S,E)=>{const{length:R}=S=S?S.filter(Boolean):[];if(E||R){let O=new AbortController,$;const J=function(ke){if(!$){$=!0,ge();const je=ke instanceof Error?ke:this.reason;O.abort(je instanceof Xe?je:new ds(je instanceof Error?je.message:je))}};let K=E&&setTimeout(()=>{K=null,J(new Xe(`timeout ${E} of ms exceeded`,Xe.ETIMEDOUT))},E);const ge=()=>{S&&(K&&clearTimeout(K),K=null,S.forEach(ke=>{ke.unsubscribe?ke.unsubscribe(J):ke.removeEventListener("abort",J)}),S=null)};S.forEach(ke=>ke.addEventListener("abort",J));const{signal:Ae}=O;return Ae.unsubscribe=()=>te.asap(ge),Ae}};const mt=function*(S,E){let R=S.byteLength;if(R<E){yield S;return}let O=0,$;for(;O<R;)$=O+E,yield S.slice(O,$),O=$},$o=async function*(S,E){for await(const R of Uo(S))yield*mt(R,E)},Uo=async function*(S){if(S[Symbol.asyncIterator]){yield*S;return}const E=S.getReader();try{for(;;){const{done:R,value:O}=await E.read();if(R)break;yield O}}finally{await E.cancel()}},Gn=(S,E,R,O)=>{const $=$o(S,E);let J=0,K,ge=Ae=>{K||(K=!0,O&&O(Ae))};return new ReadableStream({async pull(Ae){try{const{done:ke,value:je}=await $.next();if(ke){ge(),Ae.close();return}let Be=je.byteLength;if(R){let ht=J+=Be;R(ht)}Ae.enqueue(new Uint8Array(je))}catch(ke){throw ge(ke),ke}},cancel(Ae){return ge(Ae),$.return()}},{highWaterMark:2})},Ba=64*1024,{isFunction:hn}=te,Bo=(({Request:S,Response:E})=>({Request:S,Response:E}))(te.global),{ReadableStream:Kn,TextEncoder:pn}=te.global,Or=(S,...E)=>{try{return!!S(...E)}catch{return!1}},Xr=S=>{S=te.merge.call({skipUndefined:!0},Bo,S);const{fetch:E,Request:R,Response:O}=S,$=E?hn(E):typeof fetch=="function",J=hn(R),K=hn(O);if(!$)return!1;const ge=$&&hn(Kn),Ae=$&&(typeof pn=="function"?(_e=>Ze=>_e.encode(Ze))(new pn):async _e=>new Uint8Array(await new R(_e).arrayBuffer())),ke=J&&ge&&Or(()=>{let _e=!1;const Ze=new R(at.origin,{body:new Kn,method:"POST",get duplex(){return _e=!0,"half"}}).headers.has("Content-Type");return _e&&!Ze}),je=K&&ge&&Or(()=>te.isReadableStream(new O("").body)),Be={stream:je&&(_e=>_e.body)};$&&["text","arrayBuffer","blob","formData","stream"].forEach(_e=>{!Be[_e]&&(Be[_e]=(Ze,Le)=>{let kt=Ze&&Ze[_e];if(kt)return kt.call(Ze);throw new Xe(`Response type '${_e}' is not supported`,Xe.ERR_NOT_SUPPORT,Le)})});const ht=async _e=>{if(_e==null)return 0;if(te.isBlob(_e))return _e.size;if(te.isSpecCompliantForm(_e))return(await new R(at.origin,{method:"POST",body:_e}).arrayBuffer()).byteLength;if(te.isArrayBufferView(_e)||te.isArrayBuffer(_e))return _e.byteLength;if(te.isURLSearchParams(_e)&&(_e=_e+""),te.isString(_e))return(await Ae(_e)).byteLength},Ot=async(_e,Ze)=>{const Le=te.toFiniteNumber(_e.getContentLength());return Le??ht(Ze)};return async _e=>{let{url:Ze,method:Le,data:kt,signal:or,cancelToken:Pt,timeout:Jt,onDownloadProgress:xr,onUploadProgress:hs,responseType:tr,headers:Ga,withCredentials:Zn="same-origin",fetchOptions:Ho}=$a(_e),Wo=E||fetch;tr=tr?(tr+"").toLowerCase():"text";let As=Ua([or,Pt&&Pt.toAbortSignal()],Jt),yn=null;const ps=As&&As.unsubscribe&&(()=>{As.unsubscribe()});let Vo;try{if(hs&&ke&&Le!=="get"&&Le!=="head"&&(Vo=await Ot(Ga,kt))!==0){let ss=new R(Ze,{method:"POST",body:kt,duplex:"half"}),Os;if(te.isFormData(kt)&&(Os=ss.headers.get("content-type"))&&Ga.setContentType(Os),ss.body){const[Ka,Ms]=Ao(Vo,zn(Oo(hs)));kt=Gn(ss.body,Ba,Ka,Ms)}}te.isString(Zn)||(Zn=Zn?"include":"omit");const yr=J&&"credentials"in R.prototype,Go={...Ho,signal:As,method:Le.toUpperCase(),headers:Ga.normalize().toJSON(),body:kt,duplex:"half",credentials:yr?Zn:void 0};yn=J&&new R(Ze,Go);let rs=await(J?Wo(yn,Ho):Wo(Ze,Go));const Ko=je&&(tr==="stream"||tr==="response");if(je&&(xr||Ko&&ps)){const ss={};["status","statusText","headers"].forEach(Ls=>{ss[Ls]=rs[Ls]});const Os=te.toFiniteNumber(rs.headers.get("content-length")),[Ka,Ms]=xr&&Ao(Os,zn(Oo(xr),!0))||[];rs=new O(Gn(rs.body,Ba,Ka,()=>{Ms&&Ms(),ps&&ps()}),ss)}tr=tr||"text";let yl=await Be[te.findKey(Be,tr)||"text"](rs,_e);return!Ko&&ps&&ps(),await new Promise((ss,Os)=>{dn(ss,Os,{data:yl,headers:ar.from(rs.headers),status:rs.status,statusText:rs.statusText,config:_e,request:yn})})}catch(yr){throw ps&&ps(),yr&&yr.name==="TypeError"&&/Load failed|fetch/i.test(yr.message)?Object.assign(new Xe("Network Error",Xe.ERR_NETWORK,_e,yn),{cause:yr.cause||yr}):Xe.from(yr,yr&&yr.code,_e,yn)}}},Zr=new Map,Is=S=>{let E=S&&S.env||{};const{fetch:R,Request:O,Response:$}=E,J=[O,$,R];let K=J.length,ge=K,Ae,ke,je=Zr;for(;ge--;)Ae=J[ge],ke=je.get(Ae),ke===void 0&&je.set(Ae,ke=ge?new Map:Xr(E)),je=ke;return ke};Is();const us={http:_s,xhr:mn,fetch:{get:Is}};te.forEach(us,(S,E)=>{if(S){try{Object.defineProperty(S,"name",{value:E})}catch{}Object.defineProperty(S,"adapterName",{value:E})}});const Mr=S=>`- ${S}`,xl=S=>te.isFunction(S)||S===null||S===!1;function qo(S,E){S=te.isArray(S)?S:[S];const{length:R}=S;let O,$;const J={};for(let K=0;K<R;K++){O=S[K];let ge;if($=O,!xl(O)&&($=us[(ge=String(O)).toLowerCase()],$===void 0))throw new Xe(`Unknown adapter '${ge}'`);if($&&(te.isFunction($)||($=$.get(E))))break;J[ge||"#"+K]=$}if(!$){const K=Object.entries(J).map(([Ae,ke])=>`adapter ${Ae} `+(ke===!1?"is not supported by the environment":"is not available in the build"));let ge=R?K.length>1?`since :
`+K.map(Mr).join(`
`):" "+Mr(K[0]):"as no adapter specified";throw new Xe("There is no suitable adapter to dispatch the request "+ge,"ERR_NOT_SUPPORT")}return $}var Rs={getAdapter:qo,adapters:us};function qa(S){if(S.cancelToken&&S.cancelToken.throwIfRequested(),S.signal&&S.signal.aborted)throw new ds(null,S)}function za(S){return qa(S),S.headers=ar.from(S.headers),S.data=Ps.call(S,S.transformRequest),["post","put","patch"].indexOf(S.method)!==-1&&S.headers.setContentType("application/x-www-form-urlencoded",!1),Rs.getAdapter(S.adapter||Es.adapter,S)(S).then(function(O){return qa(S),O.data=Ps.call(S,S.transformResponse,O),O.headers=ar.from(O.headers),O},function(O){return Ro(O)||(qa(S),O&&O.response&&(O.response.data=Ps.call(S,S.transformResponse,O.response),O.response.headers=ar.from(O.response.headers))),Promise.reject(O)})}const fn="1.13.2",gn={};["object","boolean","number","function","string","symbol"].forEach((S,E)=>{gn[S]=function(O){return typeof O===S||"a"+(E<1?"n ":" ")+S}});const zo={};gn.transitional=function(E,R,O){function $(J,K){return"[Axios v"+fn+"] Transitional option '"+J+"'"+K+(O?". "+O:"")}return(J,K,ge)=>{if(E===!1)throw new Xe($(K," has been removed"+(R?" in "+R:"")),Xe.ERR_DEPRECATED);return R&&!zo[K]&&(zo[K]=!0,console.warn($(K," has been deprecated since v"+R+" and will be removed in the near future"))),E?E(J,K,ge):!0}},gn.spelling=function(E){return(R,O)=>(console.warn(`${O} is likely a misspelling of ${E}`),!0)};function xn(S,E,R){if(typeof S!="object")throw new Xe("options must be an object",Xe.ERR_BAD_OPTION_VALUE);const O=Object.keys(S);let $=O.length;for(;$-- >0;){const J=O[$],K=E[J];if(K){const ge=S[J],Ae=ge===void 0||K(ge,J,S);if(Ae!==!0)throw new Xe("option "+J+" must be "+Ae,Xe.ERR_BAD_OPTION_VALUE);continue}if(R!==!0)throw new Xe("Unknown option "+J,Xe.ERR_BAD_OPTION)}}var es={assertOptions:xn,validators:gn};const Wt=es.validators;class ms{constructor(E){this.defaults=E||{},this.interceptors={request:new oe,response:new oe}}async request(E,R){try{return await this._request(E,R)}catch(O){if(O instanceof Error){let $={};Error.captureStackTrace?Error.captureStackTrace($):$=new Error;const J=$.stack?$.stack.replace(/^.+\n/,""):"";try{O.stack?J&&!String(O.stack).endsWith(J.replace(/^.+\n.+\n/,""))&&(O.stack+=`
`+J):O.stack=J}catch{}}throw O}}_request(E,R){typeof E=="string"?(R=R||{},R.url=E):R=E||{},R=Ar(this.defaults,R);const{transitional:O,paramsSerializer:$,headers:J}=R;O!==void 0&&es.assertOptions(O,{silentJSONParsing:Wt.transitional(Wt.boolean),forcedJSONParsing:Wt.transitional(Wt.boolean),clarifyTimeoutError:Wt.transitional(Wt.boolean)},!1),$!=null&&(te.isFunction($)?R.paramsSerializer={serialize:$}:es.assertOptions($,{encode:Wt.function,serialize:Wt.function},!0)),R.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?R.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:R.allowAbsoluteUrls=!0),es.assertOptions(R,{baseUrl:Wt.spelling("baseURL"),withXsrfToken:Wt.spelling("withXSRFToken")},!0),R.method=(R.method||this.defaults.method||"get").toLowerCase();let K=J&&te.merge(J.common,J[R.method]);J&&te.forEach(["delete","get","head","post","put","patch","common"],_e=>{delete J[_e]}),R.headers=ar.concat(K,J);const ge=[];let Ae=!0;this.interceptors.request.forEach(function(Ze){typeof Ze.runWhen=="function"&&Ze.runWhen(R)===!1||(Ae=Ae&&Ze.synchronous,ge.unshift(Ze.fulfilled,Ze.rejected))});const ke=[];this.interceptors.response.forEach(function(Ze){ke.push(Ze.fulfilled,Ze.rejected)});let je,Be=0,ht;if(!Ae){const _e=[za.bind(this),void 0];for(_e.unshift(...ge),_e.push(...ke),ht=_e.length,je=Promise.resolve(R);Be<ht;)je=je.then(_e[Be++],_e[Be++]);return je}ht=ge.length;let Ot=R;for(;Be<ht;){const _e=ge[Be++],Ze=ge[Be++];try{Ot=_e(Ot)}catch(Le){Ze.call(this,Le);break}}try{je=za.call(this,Ot)}catch(_e){return Promise.reject(_e)}for(Be=0,ht=ke.length;Be<ht;)je=je.then(ke[Be++],ke[Be++]);return je}getUri(E){E=Ar(this.defaults,E);const R=Mo(E.baseURL,E.url,E.allowAbsoluteUrls);return H(R,E.params,E.paramsSerializer)}}te.forEach(["delete","get","head","options"],function(E){ms.prototype[E]=function(R,O){return this.request(Ar(O||{},{method:E,url:R,data:(O||{}).data}))}}),te.forEach(["post","put","patch"],function(E){function R(O){return function(J,K,ge){return this.request(Ar(ge||{},{method:E,headers:O?{"Content-Type":"multipart/form-data"}:{},url:J,data:K}))}}ms.prototype[E]=R(),ms.prototype[E+"Form"]=R(!0)});var Jn=ms;class Ha{constructor(E){if(typeof E!="function")throw new TypeError("executor must be a function.");let R;this.promise=new Promise(function(J){R=J});const O=this;this.promise.then($=>{if(!O._listeners)return;let J=O._listeners.length;for(;J-- >0;)O._listeners[J]($);O._listeners=null}),this.promise.then=$=>{let J;const K=new Promise(ge=>{O.subscribe(ge),J=ge}).then($);return K.cancel=function(){O.unsubscribe(J)},K},E(function(J,K,ge){O.reason||(O.reason=new ds(J,K,ge),R(O.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(E){if(this.reason){E(this.reason);return}this._listeners?this._listeners.push(E):this._listeners=[E]}unsubscribe(E){if(!this._listeners)return;const R=this._listeners.indexOf(E);R!==-1&&this._listeners.splice(R,1)}toAbortSignal(){const E=new AbortController,R=O=>{E.abort(O)};return this.subscribe(R),E.signal.unsubscribe=()=>this.unsubscribe(R),E.signal}static source(){let E;return{token:new Ha(function($){E=$}),cancel:E}}}var Wa=Ha;function Yn(S){return function(R){return S.apply(null,R)}}function Va(S){return te.isObject(S)&&S.isAxiosError===!0}const Qn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Qn).forEach(([S,E])=>{Qn[E]=S});var ts=Qn;function Xn(S){const E=new Jn(S),R=a(Jn.prototype.request,E);return te.extend(R,Jn.prototype,E,{allOwnKeys:!0}),te.extend(R,E,null,{allOwnKeys:!0}),R.create=function($){return Xn(Ar(S,$))},R}const bt=Xn(Es);return bt.Axios=Jn,bt.CanceledError=ds,bt.CancelToken=Wa,bt.isCancel=Ro,bt.VERSION=fn,bt.toFormData=cs,bt.AxiosError=Xe,bt.Cancel=bt.CanceledError,bt.all=function(E){return Promise.all(E)},bt.spread=Yn,bt.isAxiosError=Va,bt.mergeConfig=Ar,bt.AxiosHeaders=ar,bt.formToJSON=S=>lt(te.isHTMLForm(S)?new FormData(S):S),bt.getAdapter=Rs.getAdapter,bt.HttpStatusCode=ts,bt.default=bt,ed=bt,ed}const aw="8.1.6",ow={version:aw};var td,pp;function ou(){return pp||(pp=1,td=function a(s,n,o){if(typeof s!="object"||s===null)throw new Error("Non object passed to convertKeys: "+s);if(Array.isArray(s))return s;Array.isArray(o)||(o=[]);for(const i in s)if(s.hasOwnProperty(i)){const c=n(i);typeof s[i]=="object"&&s[i]!==null&&!o.includes(i)&&!o.includes(c)&&(s[i]=a(s[i],n,o)),c!==i&&(s[c]=s[i],delete s[i])}return s}),td}var rd,fp;function iw(){return fp||(fp=1,rd=function(s){if(typeof s!="string")throw new Error("String expected for conversion to snake case");return s.trim().replace(/_+|\-+/g," ").replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(n,o){return Number(n)===0?"":o===0?n.toLowerCase():n.toUpperCase()})}),rd}var sd,gp;function To(){if(gp)return sd;gp=1;const a=ou(),s=iw();return sd=function(o,i){return a(o,s,i)},sd}var nd,xp;function lw(){return xp||(xp=1,nd=function(s){if(typeof s!="string")throw new Error("String expected for conversion to snake case");return s.trim().replace(/(\s*\-*\b\w|[A-Z])/g,function(n){return n=n.trim().toLowerCase().replace("-",""),(n[0]==="_"?"":"_")+n}).slice(1)}),nd}var ad,yp;function ml(){if(yp)return ad;yp=1;const a=ou(),s=lw();return ad=function(o,i){return a(o,s,i)},ad}var od,bp;function Do(){return bp||(bp=1,od=function(s){return JSON.parse(JSON.stringify(s))}),od}const cw={},dw=Object.freeze(Object.defineProperty({__proto__:null,default:cw},Symbol.toStringTag,{value:"Module"})),vp=Gd(dw);var id,wp;function uw(){if(wp)return id;wp=1;const a=To(),s=ml(),n=Do(),o=vp,i=vp;class c{constructor(m){m&&this.fromData(m)}fromData(m){if(typeof m!="object")throw new Error("Expecting object for Mail data");m=n(m),m=a(m);const{content:h,filename:y,type:b,disposition:f,contentId:x,filePath:v}=m;if(typeof h<"u"&&typeof v<"u")throw new Error("The props 'content' and 'filePath' cannot be used together.");this.setFilename(y),this.setType(b),this.setDisposition(f),this.setContentId(x),this.setContent(v?this.readFile(v):h)}readFile(m){return o.readFileSync(i.resolve(m))}setContent(m){if(typeof m=="string"){this.content=m;return}else if(m instanceof Buffer&&m.toString!==void 0){this.content=m.toString(),this.disposition==="attachment"&&(this.content=m.toString("base64"));return}throw new Error("`content` expected to be either Buffer or string")}setFileContent(m){if(m instanceof Buffer&&m.toString!==void 0){this.content=m.toString("base64");return}throw new Error("`content` expected to be Buffer")}setFilename(m){if(!(typeof m>"u")){if(m&&typeof m!="string")throw new Error("String expected for `filename`");this.filename=m}}setType(m){if(!(typeof m>"u")){if(typeof m!="string")throw new Error("String expected for `type`");this.type=m}}setDisposition(m){if(!(typeof m>"u")){if(typeof m!="string")throw new Error("String expected for `disposition`");this.disposition=m}}setContentId(m){if(!(typeof m>"u")){if(typeof m!="string")throw new Error("String expected for `contentId`");this.contentId=m}}toJSON(){const{content:m,filename:h,type:y,disposition:b,contentId:f}=this,x={content:m,filename:h};return typeof y<"u"&&(x.type=y),typeof b<"u"&&(x.disposition=b),typeof f<"u"&&(x.contentId=f),s(x)}}return id=c,id}var ld,jp;function t0(){return jp||(jp=1,ld=function(s){if(s.indexOf("<")===-1)return["",s];let[n,o]=s.split("<");return n=n.trim(),o=o.replace(">","").trim(),[n,o]}),ld}var cd,Np;function iu(){if(Np)return cd;Np=1;const a=t0();class s{constructor(o){o&&this.fromData(o)}fromData(o){if(typeof o=="string"){const[u,m]=a(o);o={name:u,email:m}}if(typeof o!="object")throw new Error("Expecting object or string for EmailAddress data");const{name:i,email:c}=o;this.setEmail(c),this.setName(i)}setName(o){if(!(typeof o>"u")){if(typeof o!="string")throw new Error("String expected for `name`");this.name=o}}setEmail(o){if(typeof o>"u")throw new Error("Must provide `email`");if(typeof o!="string")throw new Error("String expected for `email`");this.email=o}toJSON(){const{email:o,name:i}=this,c={email:o};return i!==""&&(c.name=i),c}static create(o){return Array.isArray(o)?o.filter(i=>!!i).map(i=>this.create(i)):o instanceof s?o:new s(o)}}return cd=s,cd}var dd,Sp;function mw(){if(Sp)return dd;Sp=1;var a=function(j){return s(j)&&!n(j)};function s(w){return!!w&&typeof w=="object"}function n(w){var j=Object.prototype.toString.call(w);return j==="[object RegExp]"||j==="[object Date]"||c(w)}var o=typeof Symbol=="function"&&Symbol.for,i=o?Symbol.for("react.element"):60103;function c(w){return w.$$typeof===i}function u(w){return Array.isArray(w)?[]:{}}function m(w,j){return j.clone!==!1&&j.isMergeableObject(w)?k(u(w),w,j):w}function h(w,j,D){return w.concat(j).map(function(M){return m(M,D)})}function y(w,j){if(!j.customMerge)return k;var D=j.customMerge(w);return typeof D=="function"?D:k}function b(w){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(w).filter(function(j){return Object.propertyIsEnumerable.call(w,j)}):[]}function f(w){return Object.keys(w).concat(b(w))}function x(w,j){try{return j in w}catch{return!1}}function v(w,j){return x(w,j)&&!(Object.hasOwnProperty.call(w,j)&&Object.propertyIsEnumerable.call(w,j))}function N(w,j,D){var M={};return D.isMergeableObject(w)&&f(w).forEach(function(I){M[I]=m(w[I],D)}),f(j).forEach(function(I){v(w,I)||(x(w,I)&&D.isMergeableObject(j[I])?M[I]=y(I,D)(w[I],j[I],D):M[I]=m(j[I],D))}),M}function k(w,j,D){D=D||{},D.arrayMerge=D.arrayMerge||h,D.isMergeableObject=D.isMergeableObject||a,D.cloneUnlessOtherwiseSpecified=m;var M=Array.isArray(j),I=Array.isArray(w),_=M===I;return _?M?D.arrayMerge(w,j,D):N(w,j,D):m(j,D)}k.all=function(j,D){if(!Array.isArray(j))throw new Error("first argument should be an array");return j.reduce(function(M,I){return k(M,I,D)},{})};var C=k;return dd=C,dd}var ud,kp;function r0(){return kp||(kp=1,ud=function a(s,n="{{",o="}}"){if(Array.isArray(s))return s.map(c=>a(c,n,o));const i={};for(const c in s)s.hasOwnProperty(c)&&(i[n+c+o]=String(s[c]));return i}),ud}var md,_p;function s0(){if(_p)return md;_p=1;const a=iu(),s=To(),n=ml(),o=Do(),i=mw(),c=r0();class u{constructor(h){this.to=[],this.cc=[],this.bcc=[],this.headers={},this.customArgs={},this.substitutions={},this.substitutionWrappers=["{{","}}"],this.dynamicTemplateData={},h&&this.fromData(h)}fromData(h){if(typeof h!="object")throw new Error("Expecting object for Mail data");h=o(h),h=s(h,["substitutions","dynamicTemplateData","customArgs","headers"]);const{to:y,from:b,cc:f,bcc:x,subject:v,headers:N,customArgs:k,sendAt:C,substitutions:w,substitutionWrappers:j,dynamicTemplateData:D}=h;this.setTo(y),this.setFrom(b),this.setCc(f),this.setBcc(x),this.setSubject(v),this.setHeaders(N),this.setSubstitutions(w),this.setSubstitutionWrappers(j),this.setCustomArgs(k),this.setDynamicTemplateData(D),this.setSendAt(C)}setSubject(h){if(!(typeof h>"u")){if(typeof h!="string")throw new Error("String expected for `subject`");this.subject=h}}setSendAt(h){if(!(typeof h>"u")){if(!Number.isInteger(h))throw new Error("Integer expected for `sendAt`");this.sendAt=h}}setTo(h){typeof h>"u"||(Array.isArray(h)||(h=[h]),this.to=a.create(h))}setFrom(h){typeof h>"u"||(this.from=a.create(h))}addTo(h){typeof h>"u"||this.to.push(a.create(h))}setCc(h){typeof h>"u"||(Array.isArray(h)||(h=[h]),this.cc=a.create(h))}addCc(h){typeof h>"u"||this.cc.push(a.create(h))}setBcc(h){typeof h>"u"||(Array.isArray(h)||(h=[h]),this.bcc=a.create(h))}addBcc(h){typeof h>"u"||this.bcc.push(a.create(h))}setHeaders(h){if(!(typeof h>"u")){if(typeof h!="object"||h===null)throw new Error("Object expected for `headers`");this.headers=h}}addHeader(h,y){if(typeof h!="string")throw new Error("String expected for header key");if(typeof y!="string")throw new Error("String expected for header value");this.headers[h]=y}setCustomArgs(h){if(!(typeof h>"u")){if(typeof h!="object"||h===null)throw new Error("Object expected for `customArgs`");this.customArgs=h}}addCustomArg(h,y){if(typeof h!="string")throw new Error("String expected for custom arg key");if(typeof y!="string")throw new Error("String expected for custom arg value");this.customArgs[h]=y}setSubstitutions(h){if(!(typeof h>"u")){if(typeof h!="object")throw new Error("Object expected for `substitutions`");this.substitutions=h}}addSubstitution(h,y){if(typeof h!="string")throw new Error("String expected for substitution key");if(typeof y!="string"&&typeof y!="number")throw new Error("String or Number expected for substitution value");this.substitutions[h]=y}reverseMergeSubstitutions(h){if(!(typeof h>"u"||h===null)){if(typeof h!="object")throw new Error("Object expected for `substitutions` in reverseMergeSubstitutions");this.substitutions=Object.assign({},h,this.substitutions)}}setSubstitutionWrappers(h){if(!(typeof h>"u"||h===null)){if(!Array.isArray(h)||h.length!==2)throw new Error("Array expected with two elements for `substitutionWrappers`");this.substitutionWrappers=h}}deepMergeDynamicTemplateData(h){if(!(typeof h>"u"||h===null)){if(typeof h!="object")throw new Error("Object expected for `dynamicTemplateData` in deepMergeDynamicTemplateData");this.dynamicTemplateData=i(h,this.dynamicTemplateData)}}setDynamicTemplateData(h){if(!(typeof h>"u")){if(typeof h!="object")throw new Error("Object expected for `dynamicTemplateData`");this.dynamicTemplateData=h}}toJSON(){const{to:h,from:y,cc:b,bcc:f,subject:x,headers:v,customArgs:N,sendAt:k,substitutions:C,substitutionWrappers:w,dynamicTemplateData:j}=this,D={to:h};if(Array.isArray(b)&&b.length>0&&(D.cc=b),Array.isArray(f)&&f.length>0&&(D.bcc=f),Object.keys(v).length>0&&(D.headers=v),C&&Object.keys(C).length>0){const[M,I]=w;D.substitutions=c(C,M,I)}return Object.keys(N).length>0&&(D.customArgs=N),j&&Object.keys(j).length>0&&(D.dynamicTemplateData=j),typeof x<"u"&&(D.subject=x),typeof k<"u"&&(D.sendAt=k),typeof y<"u"&&(D.from=y),n(D,["substitutions","dynamicTemplateData","customArgs","headers"])}}return md=u,md}var hd,Cp;function n0(){return Cp||(Cp=1,hd=function(s){return s.map(n=>typeof n=="object"&&n!==null&&typeof n.toJSON=="function"?n.toJSON():n)}),hd}var pd,Ep;function hw(){return Ep||(Ep=1,pd={DYNAMIC_TEMPLATE_CHAR_WARNING:`
Content with characters ', " or & may need to be escaped with three brackets
{{{ content }}}
See https://sendgrid.com/docs/for-developers/sending-email/using-handlebars/ for more information.`}),pd}var fd,Tp;function pw(){if(Tp)return fd;Tp=1;const a=(s,n,o,i)=>{if(!(typeof s>"u"||typeof s[o]>"u")&&typeof s[o]!==i)throw new Error(`${i} expected for \`${n}.${o}\``)};return fd={validateMailSettings(s){if(typeof s!="object")throw new Error("Object expected for `mailSettings`");const{bcc:n,bypassListManagement:o,bypassSpamManagement:i,bypassBounceManagement:c,bypassUnsubscribeManagement:u,footer:m,sandboxMode:h,spamCheck:y}=s;a(n,"bcc","enable","boolean"),a(n,"bcc","email","string"),a(o,"bypassListManagement","enable","boolean"),a(i,"bypassSpamManagement","enable","boolean"),a(c,"bypassBounceManagement","enable","boolean"),a(u,"bypassUnsubscribeManagement","enable","boolean"),a(m,"footer","enable","boolean"),a(m,"footer","text","string"),a(m,"footer","html","string"),a(h,"sandboxMode","enable","boolean"),a(y,"spamCheck","enable","boolean"),a(y,"spamCheck","threshold","number"),a(y,"spamCheck","postToUrl","string")},validateTrackingSettings(s){if(typeof s!="object")throw new Error("Object expected for `trackingSettings`");const{clickTracking:n,openTracking:o,subscriptionTracking:i,ganalytics:c}=s;a(n,"clickTracking","enable","boolean"),a(n,"clickTracking","enableText","boolean"),a(o,"openTracking","enable","boolean"),a(o,"openTracking","substitutionTag","string"),a(i,"subscriptionTracking","enable","boolean"),a(i,"subscriptionTracking","text","string"),a(i,"subscriptionTracking","html","string"),a(i,"subscriptionTracking","substitutionTag","string"),a(c,"ganalytics","enable","boolean"),a(c,"ganalytics","utm_source","string"),a(c,"ganalytics","utm_medium","string"),a(c,"ganalytics","utm_term","string"),a(c,"ganalytics","utm_content","string"),a(c,"ganalytics","utm_campaign","string")}},fd}var gd,Dp;function fw(){if(Dp)return gd;Dp=1;const a=iu(),s=s0(),n=To(),o=ml(),i=Do(),c=n0(),{DYNAMIC_TEMPLATE_CHAR_WARNING:u}=hw(),{validateMailSettings:m,validateTrackingSettings:h}=pw();class y{constructor(f){this.isDynamic=!1,this.hideWarnings=!1,this.personalizations=[],this.attachments=[],this.content=[],this.categories=[],this.headers={},this.sections={},this.customArgs={},this.trackingSettings={},this.mailSettings={},this.asm={},this.substitutions=null,this.substitutionWrappers=null,this.dynamicTemplateData=null,f&&this.fromData(f)}fromData(f){if(typeof f!="object")throw new Error("Expecting object for Mail data");f=i(f),f=n(f,["substitutions","dynamicTemplateData","customArgs","headers","sections"]);const{to:x,from:v,replyTo:N,cc:k,bcc:C,sendAt:w,subject:j,text:D,html:M,content:I,templateId:_,personalizations:A,attachments:Q,ipPoolName:G,batchId:re,sections:le,headers:he,categories:P,category:L,customArgs:z,asm:ee,mailSettings:se,trackingSettings:Y,substitutions:xe,substitutionWrappers:ce,dynamicTemplateData:B,isMultiple:F,hideWarnings:ue,replyToList:We}=f;this.setFrom(v),this.setReplyTo(N),this.setSubject(j),this.setSendAt(w),this.setTemplateId(_),this.setBatchId(re),this.setIpPoolName(G),this.setAttachments(Q),this.setContent(I),this.setSections(le),this.setHeaders(he),this.setCategories(L),this.setCategories(P),this.setCustomArgs(z),this.setAsm(ee),this.setMailSettings(se),this.setTrackingSettings(Y),this.setHideWarnings(ue),this.setReplyToList(We),this.isDynamic?this.setDynamicTemplateData(B):(this.setSubstitutions(xe),this.setSubstitutionWrappers(ce)),this.addTextContent(D),this.addHtmlContent(M),A?this.setPersonalizations(A):F&&Array.isArray(x)?x.forEach(Ye=>this.addTo(Ye,k,C)):this.addTo(x,k,C)}setFrom(f){if(this._checkProperty("from",f,[this._checkUndefined])){if(typeof f!="string"&&typeof f.email!="string")throw new Error("String or address object expected for `from`");this.from=a.create(f)}}setReplyTo(f){if(this._checkProperty("replyTo",f,[this._checkUndefined])){if(typeof f!="string"&&typeof f.email!="string")throw new Error("String or address object expected for `replyTo`");this.replyTo=a.create(f)}}setSubject(f){this._setProperty("subject",f,"string")}setSendAt(f){this._checkProperty("sendAt",f,[this._checkUndefined,this._createCheckThatThrows(Number.isInteger,"Integer expected for `sendAt`")])&&(this.sendAt=f)}setTemplateId(f){this._setProperty("templateId",f,"string")&&f.indexOf("d-")===0&&(this.isDynamic=!0)}setBatchId(f){this._setProperty("batchId",f,"string")}setIpPoolName(f){this._setProperty("ipPoolName",f,"string")}setAsm(f){if(this._checkProperty("asm",f,[this._checkUndefined,this._createTypeCheck("object")])){if(typeof f.groupId!="number")throw new Error("Expected `asm` to include an integer in its `groupId` field");if(f.groupsToDisplay&&(!Array.isArray(f.groupsToDisplay)||!f.groupsToDisplay.every(x=>typeof x=="number")))throw new Error("Array of integers expected for `asm.groupsToDisplay`");this.asm=f}}setPersonalizations(f){if(this._doArrayCheck("personalizations",f)){if(!f.every(x=>typeof x=="object"))throw new Error("Array of objects expected for `personalizations`");this.personalizations=[],f.forEach(x=>this.addPersonalization(x))}}addPersonalization(f){this.isDynamic&&f.substitutions?delete f.substitutions:!this.isDynamic&&f.dynamicTemplateData&&delete f.dynamicTemplateData,f instanceof s||(f=new s(f)),this.isDynamic?this.applyDynamicTemplateData(f):this.applySubstitutions(f),this.personalizations.push(f)}addTo(f,x,v){if(typeof f>"u"&&typeof x>"u"&&typeof v>"u")throw new Error("Provide at least one of to, cc or bcc");this.addPersonalization(new s({to:f,cc:x,bcc:v}))}setSubstitutions(f){this._setProperty("substitutions",f,"object")}setSubstitutionWrappers(f){let x=(v,N)=>{if(!Array.isArray(N)||N.length!==2)throw new Error("Array expected with two elements for `"+v+"`")};this._checkProperty("substitutionWrappers",f,[this._checkUndefined,x])&&(this.substitutionWrappers=f)}applySubstitutions(f){f instanceof s&&(f.reverseMergeSubstitutions(this.substitutions),f.setSubstitutionWrappers(this.substitutionWrappers))}applyDynamicTemplateData(f){f instanceof s&&f.deepMergeDynamicTemplateData(this.dynamicTemplateData)}setDynamicTemplateData(f){if(!(typeof f>"u")){if(typeof f!="object")throw new Error("Object expected for `dynamicTemplateData`");this.hideWarnings||Object.values(f).forEach(x=>{/['"&]/.test(x)&&console.warn(u)}),this.dynamicTemplateData=f}}setContent(f){if(this._doArrayCheck("content",f)){if(!f.every(x=>typeof x=="object"))throw new Error("Expected each entry in `content` to be an object");if(!f.every(x=>typeof x.type=="string"))throw new Error("Expected each `content` entry to contain a `type` string");if(!f.every(x=>typeof x.value=="string"))throw new Error("Expected each `content` entry to contain a `value` string");this.content=f}}addContent(f){this._checkProperty("content",f,[this._createTypeCheck("object")])&&this.content.push(f)}addTextContent(f){this._checkProperty("text",f,[this._checkUndefined,this._createTypeCheck("string")])&&this.addContent({value:f,type:"text/plain"})}addHtmlContent(f){this._checkProperty("html",f,[this._checkUndefined,this._createTypeCheck("string")])&&this.addContent({value:f,type:"text/html"})}setAttachments(f){if(this._doArrayCheck("attachments",f)){if(!f.every(x=>typeof x.content=="string"))throw new Error("Expected each attachment to contain a `content` string");if(!f.every(x=>typeof x.filename=="string"))throw new Error("Expected each attachment to contain a `filename` string");if(!f.every(x=>!x.type||typeof x.type=="string"))throw new Error("Expected the attachment's `type` field to be a string");if(!f.every(x=>!x.disposition||typeof x.disposition=="string"))throw new Error("Expected the attachment's `disposition` field to be a string");this.attachments=f}}addAttachment(f){this._checkProperty("attachment",f,[this._checkUndefined,this._createTypeCheck("object")])&&this.attachments.push(f)}setCategories(f){let x=(v,N)=>{if(!Array.isArray(N)||!N.every(k=>typeof k=="string"))throw new Error("Array of strings expected for `"+v+"`")};typeof f=="string"&&(f=[f]),this._checkProperty("categories",f,[this._checkUndefined,x])&&(this.categories=f)}addCategory(f){this._checkProperty("category",f,[this._createTypeCheck("string")])&&this.categories.push(f)}setHeaders(f){this._setProperty("headers",f,"object")}addHeader(f,x){this._checkProperty("key",f,[this._createTypeCheck("string")])&&this._checkProperty("value",x,[this._createTypeCheck("string")])&&(this.headers[f]=x)}setSections(f){this._setProperty("sections",f,"object")}setCustomArgs(f){this._setProperty("customArgs",f,"object")}setTrackingSettings(f){typeof f>"u"||(h(f),this.trackingSettings=f)}setMailSettings(f){typeof f>"u"||(m(f),this.mailSettings=f)}setHideWarnings(f){if(!(typeof f>"u")){if(typeof f!="boolean")throw new Error("Boolean expected for `hideWarnings`");this.hideWarnings=f}}toJSON(){const{from:f,replyTo:x,sendAt:v,subject:N,content:k,templateId:C,personalizations:w,attachments:j,ipPoolName:D,batchId:M,asm:I,sections:_,headers:A,categories:Q,customArgs:G,mailSettings:re,trackingSettings:le,replyToList:he}=this,P={from:f,subject:N,personalizations:c(w)};return Array.isArray(j)&&j.length>0&&(P.attachments=c(j)),Array.isArray(Q)&&Q.length>0&&(P.categories=Q.filter(L=>L!=="")),Array.isArray(k)&&k.length>0&&(P.content=c(k)),Object.keys(A).length>0&&(P.headers=A),Object.keys(re).length>0&&(P.mailSettings=re),Object.keys(le).length>0&&(P.trackingSettings=le),Object.keys(G).length>0&&(P.customArgs=G),Object.keys(_).length>0&&(P.sections=_),Object.keys(I).length>0&&(P.asm=I),typeof x<"u"&&(P.replyTo=x),typeof v<"u"&&(P.sendAt=v),typeof M<"u"&&(P.batchId=M),typeof C<"u"&&(P.templateId=C),typeof D<"u"&&(P.ipPoolName=D),typeof he<"u"&&(P.replyToList=he),o(P,["substitutions","dynamicTemplateData","customArgs","headers","sections"])}static create(f){return Array.isArray(f)?f.filter(x=>!!x).map(x=>this.create(x)):f instanceof y?f:new y(f)}_checkProperty(f,x,v){return!v.some(N=>N(f,x))}_setProperty(f,x,v){let N=this._checkProperty(f,x,[this._checkUndefined,this._createTypeCheck(v)]);return N&&(this[f]=x),N}_checkUndefined(f,x){return typeof x>"u"}_createTypeCheck(f){return(x,v)=>{if(typeof v!==f)throw new Error(f+" expected for `"+x+"`")}}_createCheckThatThrows(f,x){return(v,N)=>{if(!f(N))throw new Error(x)}}_setArrayProperty(f,x){this._doArrayCheck(f,x)&&(this[f]=x)}_doArrayCheck(f,x){return this._checkProperty(f,x,[this._checkUndefined,this._createCheckThatThrows(Array.isArray,"Array expected for`"+f+"`")])}setReplyToList(f){if(this._doArrayCheck("replyToList",f)&&f.length){if(!f.every(x=>x&&typeof x.email=="string"))throw new Error("Expected each replyTo to contain an `email` string");this.replyToList=f}}}return gd=y,gd}var xd,Pp;function gw(){if(Pp)return xd;Pp=1;class a{constructor(n,o,i){this.statusCode=n,this.body=o,this.headers=i}toString(){return"HTTP "+this.statusCode+" "+this.body}}return xd=a,xd}var yd,Ip;function xw(){if(Ip)return yd;Ip=1;class a extends Error{constructor(n){super();const{headers:o,status:i,statusText:c,data:u}=n;this.code=i,this.message=c,this.response={headers:o,body:u},this.stack||Error.captureStackTrace(this,this.constructor);const m=new RegExp(process.cwd()+"/","gi");this.stack=this.stack.replace(m,"")}toString(){const{body:n}=this.response;let o=`${this.message} (${this.code})`;return n&&Array.isArray(n.errors)&&n.errors.forEach(i=>{const c=i.message,u=i.field,m=i.help;o+=`
  ${c}
    ${u}
    ${m}`}),o}toJSON(){const{message:n,code:o,response:i}=this;return{message:n,code:o,response:i}}}return yd=a,yd}var bd,Rp;function yw(){if(Rp)return bd;Rp=1;const a=To(),s=Do(),n=["day","week","month"],o=["us","ca"],i=["desc","asc"];class c{constructor(m){this.startDate=null,this.endDate=null,this.aggregatedBy=null,m&&this.fromData(m)}fromData(m){if(typeof m!="object")throw new Error("Expecting object for Statistics data");m=s(m),m=a(m,["substitutions","customArgs"]);const{startDate:h,endDate:y,aggregatedBy:b}=m;this.setStartDate(h),this.setEndDate(y),this.setAggregatedBy(b)}setStartDate(m){if(typeof m>"u")throw new Error("Date expected for `startDate`");if(new Date(m)==="Invalid Date"||isNaN(new Date(m)))throw new Error("Date expected for `startDate`");console.log(m),this.startDate=new Date(m).toISOString().slice(0,10)}setEndDate(m){if(typeof m>"u"){this.endDate=new Date().toISOString().slice(0,10);return}if(new Date(m)==="Invalid Date"||isNaN(new Date(m)))throw new Error("Date expected for `endDate`");this.endDate=new Date(m).toISOString().slice(0,10)}setAggregatedBy(m){if(!(typeof m>"u"))if(typeof m=="string"&&n.includes(m.toLowerCase()))this.aggregatedBy=m;else throw new Error("Incorrect value for `aggregatedBy`")}getGlobal(){const{startDate:m,endDate:h,aggregatedBy:y}=this;return{startDate:m,endDate:h,aggregatedBy:y}}getAdvanced(m){const h=this.getGlobal();return typeof m>"u"||typeof m=="string"&&o.includes(m.toLowerCase())&&(h.country=m),h}getAdvancedMailboxProviders(m){const h=this.getGlobal();if(typeof m>"u")return h;if(Array.isArray(m)&&m.some(y=>typeof y!="string"))throw new Error("Array of strings expected for `mailboxProviders`");return h.mailBoxProviders=m,h}getAdvancedBrowsers(m){const h=this.getGlobal();if(typeof m>"u")return h;if(Array.isArray(m)&&m.some(y=>typeof y!="string"))throw new Error("Array of strings expected for `browsers`");return h.browsers=m,h}getCategories(m){if(typeof m>"u")throw new Error("Array of strings expected for `categories`");if(!this._isValidArrayOfStrings(m))throw new Error("Array of strings expected for `categories`");const h=this.getGlobal();return h.categories=m,h}getSubuser(m){if(typeof m>"u")throw new Error("Array of strings expected for `subusers`");if(!this._isValidArrayOfStrings(m))throw new Error("Array of strings expected for `subusers`");const h=this.getGlobal();return h.subusers=m,h}getSubuserSum(m="delivered",h=i[0],y=5,b=0){if(typeof m!="string")throw new Error("string expected for `sortByMetric`");if(!i.includes(h.toLowerCase()))throw new Error("desc or asc expected for `sortByDirection`");if(typeof y!="number")throw new Error("number expected for `limit`");if(typeof b!="number")throw new Error("number expected for `offset`");const f=this.getGlobal();return f.sortByMetric=m,f.sortByDirection=h,f.limit=y,f.offset=b,f}getSubuserMonthly(m="delivered",h=i[0],y=5,b=0){if(typeof m!="string")throw new Error("string expected for `sortByMetric`");if(!i.includes(h.toLowerCase()))throw new Error("desc or asc expected for `sortByDirection`");if(typeof y!="number")throw new Error("number expected for `limit`");if(typeof b!="number")throw new Error("number expected for `offset`");const f=this.getGlobal();return f.sortByMetric=m,f.sortByDirection=h,f.limit=y,f.offset=b,f}_isValidArrayOfStrings(m){return!(!Array.isArray(m)||m.length<1||m.some(h=>typeof h!="string"))}}return bd=c,bd}var vd,Ap;function bw(){if(Ap)return vd;Ap=1;const a=uw(),s=iu(),n=fw(),o=s0(),i=gw(),c=xw(),u=yw();return vd={Attachment:a,EmailAddress:s,Mail:n,Personalization:o,Response:i,ResponseError:c,Statistics:u},vd}var wd,Op;function vw(){return Op||(Op=1,wd=function(s,n){if(typeof s!="object"||s===null)throw new Error("Not an object provided for base");if(typeof n!="object"||n===null)throw new Error("Not an object provided for data");const o=Object.assign({},s);for(const i in n)n.hasOwnProperty(i)&&(n[i]&&Array.isArray(n[i])?o[i]=n[i]:n[i]&&typeof n[i]=="object"?o[i]=Object.assign({},n[i]):n[i]&&(o[i]=n[i]));return o}),wd}var jd,Mp;function ww(){if(Mp)return jd;Mp=1;const a=n0(),s=ou(),n=Do(),o=vw(),i=t0(),c=To(),u=ml(),m=r0();return jd={arrayToJSON:a,convertKeys:s,deepClone:n,mergeData:o,splitNameEmail:i,toCamelCase:c,toSnakeCase:u,wrapSubstitutions:m},jd}var Nd,Lp;function a0(){if(Lp)return Nd;Lp=1;const a=bw(),s=ww();return Nd={classes:a,helpers:s},Nd}var Sd,Fp;function o0(){if(Fp)return Sd;Fp=1;const a=nw(),s=ow,{helpers:{mergeData:n},classes:{Response:o,ResponseError:i}}=a0(),c="SG.",u="https://api.sendgrid.com/",m="https://email.twilio.com/",h="global",y={eu:"https://api.eu.sendgrid.com/",global:"https://api.sendgrid.com/"};class b{constructor(){this.auth="",this.impersonateSubuser="",this.sendgrid_region=h,this.defaultHeaders={Accept:"application/json","Content-Type":"application/json","User-Agent":"sendgrid/"+s.version+";nodejs"},this.defaultRequest={baseUrl:u,url:"",method:"GET",headers:{},maxContentLength:1/0,maxBodyLength:1/0}}setApiKey(x){this.auth="Bearer "+x,this.setDefaultRequest("baseUrl",y[this.sendgrid_region]),this.isValidApiKey(x)||console.warn(`API key does not start with "${c}".`)}setTwilioEmailAuth(x,v){const N=Buffer.from(x+":"+v).toString("base64");this.auth="Basic "+N,this.setDefaultRequest("baseUrl",m),this.isValidTwilioAuth(x,v)||console.warn("Twilio Email credentials must be non-empty strings.")}isValidApiKey(x){return this.isString(x)&&x.trim().startsWith(c)}isValidTwilioAuth(x,v){return this.isString(x)&&x&&this.isString(v)&&v}isString(x){return typeof x=="string"||x instanceof String}setImpersonateSubuser(x){this.impersonateSubuser=x}setDefaultHeader(x,v){return x!==null&&typeof x=="object"?(Object.assign(this.defaultHeaders,x),this):(this.defaultHeaders[x]=v,this)}setDefaultRequest(x,v){return x!==null&&typeof x=="object"?(Object.assign(this.defaultRequest,x),this):(this.defaultRequest[x]=v,this)}setDataResidency(x){return y.hasOwnProperty(x)?(this.sendgrid_region=x,this.setDefaultRequest("baseUrl",y[x])):console.warn('Region can only be "global" or "eu".'),this}createHeaders(x){const v=n(this.defaultHeaders,x);return typeof v.Authorization>"u"&&this.auth&&(v.Authorization=this.auth),this.impersonateSubuser&&(v["On-Behalf-Of"]=this.impersonateSubuser),v}createRequest(x){let v={url:x.uri||x.url,baseUrl:x.baseUrl,method:x.method,data:x.body,params:x.qs,headers:x.headers};return v=n(this.defaultRequest,v),v.headers=this.createHeaders(v.headers),v.baseURL=v.baseUrl,delete v.baseUrl,v}request(x,v){x=this.createRequest(x);const N=new Promise((k,C)=>{a(x).then(w=>k([new o(w.status,w.data,w.headers),w.data])).catch(w=>w.response&&w.response.status>=400?C(new i(w.response)):C(w))});if(v&&typeof v!="function")throw new Error("Callback passed is not a function.");return v?N.then(k=>v(null,k)).catch(k=>v(k,null)):N}}return Sd=b,Sd}var kd,$p;function jw(){if($p)return kd;$p=1;const a=o0();return kd=new a,kd}var Up;function Nw(){if(Up)return el.exports;Up=1;const a=jw(),s=o0();return el.exports=a,el.exports.Client=s,el.exports}var _d,Bp;function i0(){if(Bp)return _d;Bp=1;const{Client:a}=Nw(),{classes:{Mail:s}}=a0();class n{constructor(){this.setClient(new a),this.setSubstitutionWrappers("{{","}}"),this.secretRules=[]}setClient(i){return this.client=i,this}setApiKey(i){return this.client.setApiKey(i),this}setTwilioEmailAuth(i,c){this.client.setTwilioEmailAuth(i,c)}setTimeout(i){typeof i>"u"||this.client.setDefaultRequest("timeout",i)}setSubstitutionWrappers(i,c){if(typeof i>"u"||typeof c>"u")throw new Error("Must provide both left and right side wrappers");return Array.isArray(this.substitutionWrappers)||(this.substitutionWrappers=[]),this.substitutionWrappers[0]=i,this.substitutionWrappers[1]=c,this}setSecretRules(i){i instanceof Array||(i=[i]);const c=i.map(function(u){const m=typeof u;if(m==="string")return{pattern:new RegExp(u)};if(m==="object"){u instanceof RegExp?u={pattern:u}:u.hasOwnProperty("pattern")&&typeof u.pattern=="string"&&(u.pattern=new RegExp(u.pattern));try{return u.pattern.test(""),u}catch{}}});this.secretRules=c.filter(function(u){return u})}filterSecrets(i){if(typeof i=="object"&&!i.hasOwnProperty("content"))return;const c=this;i.content.forEach(function(u){c.secretRules.forEach(function(m){if(m.hasOwnProperty("pattern")&&!m.pattern.test(u.value))return;let h=`The pattern '${m.pattern}'`;throw m.name&&(h+=`identified by '${m.name}'`),h+=" was found in the Mail content!",new Error(h)})})}send(i,c=!1,u){if(typeof c=="function"&&(u=c,c=!1),Array.isArray(i)){const m=Promise.all(i.map(h=>this.send(h,c)));return u&&m.then(h=>u(null,h)).catch(h=>u(h,null)),m}try{typeof i.isMultiple>"u"&&(i.isMultiple=c),typeof i.substitutionWrappers>"u"&&(i.substitutionWrappers=this.substitutionWrappers);const m=s.create(i),h=m.toJSON();this.filterSecrets(h);const y={method:"POST",url:"/v3/mail/send",headers:m.headers,body:h};return this.client.request(y,u)}catch(m){return u&&u(m,null),Promise.reject(m)}}sendMultiple(i,c){return this.send(i,!0,c)}}return _d=n,_d}var Cd,qp;function Sw(){if(qp)return Cd;qp=1;const a=i0();return Cd=new a,Cd}var zp;function kw(){if(zp)return Zi.exports;zp=1;const a=Sw(),s=i0();return Zi.exports=a,Zi.exports.MailService=s,Zi.exports}var _w=kw();const Hp=il(_w),Cw=({supplier:a,clinicData:s})=>{const{t:n,locale:o}=Ve(),{clinicInfo:i,supplierInvoices:c,expenses:u}=s,m=new Intl.DateTimeFormat(o,{year:"numeric",month:"long",day:"numeric"}),h=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),y=q.useMemo(()=>c.filter(x=>x.supplierId===a.id).sort((x,v)=>new Date(x.invoiceDate).getTime()-new Date(v.invoiceDate).getTime()),[c,a.id]),b=q.useMemo(()=>{const x=y.reduce((k,C)=>k+C.amount,0),v=y.reduce((k,C)=>k+C.payments.reduce((w,j)=>w+j.amount,0),0),N=x-v;return{totalBilled:x,totalPaid:v,outstandingBalance:N}},[y]),f=q.useMemo(()=>u.filter(x=>x.supplierId===a.id).sort((x,v)=>new Date(x.date).getTime()-new Date(v.date).getTime()),[u,a.id]);return e.jsxs("div",{className:"p-8 bg-white text-slate-900 min-h-screen",dir:o==="ar"?"rtl":"ltr",style:{width:"210mm",minHeight:"297mm",margin:"0 auto",fontSize:"12px",lineHeight:"1.4"},children:[e.jsxs("header",{className:"text-center mb-10 break-inside-avoid",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-1",children:i.name||n("appName")}),e.jsx("p",{className:"text-sm text-slate-600",children:i.address}),e.jsxs("p",{className:"text-sm text-slate-600",children:[i.phone," | ",i.email]})]}),e.jsx("h2",{className:"text-xl font-bold text-primary-dark mt-6 mb-2",children:n("supplierStatement.financialTitle")}),e.jsx("p",{className:"text-sm text-slate-700",children:n("patientReport.generatedOn",{date:m.format(new Date)})})]}),e.jsxs("section",{className:"mb-10 p-6 border rounded-lg bg-neutral-light shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:n("supplierStatement.statementDetails")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.supplierName"),":"]})," ",a.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.contactPerson"),":"]})," ",a.contactPerson||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.phone"),":"]})," ",a.phone||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.email"),":"]})," ",a.email||"-"]})]})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("invoices.title")}),y.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("invoices.date")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("invoices.invoiceNumber")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("invoices.billed")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("invoices.paidAmount")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("invoices.remaining")})]})}),e.jsx("tbody",{children:y.map(x=>{const v=x.payments.reduce((k,C)=>k+C.amount,0),N=x.amount-v;return e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:m.format(new Date(x.invoiceDate))}),e.jsx("td",{className:"p-3 border border-slate-300",children:x.invoiceNumber||x.id.slice(-6)}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(x.amount)}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(v)}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(N)})]},x.id)})})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("invoices.noInvoices")})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("financials.payments")}),f.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("expenses.date")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("expenses.description")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("expenses.category")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("expenses.amount")})]})}),e.jsx("tbody",{children:f.map(x=>e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:m.format(new Date(x.date))}),e.jsx("td",{className:"p-3 border border-slate-300",children:x.description}),e.jsx("td",{className:"p-3 border border-slate-300",children:n(`expenseCategory.${x.category}`)}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(x.amount)})]},x.id))})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("supplierStatement.noPaymentsRecorded")})]}),e.jsx("section",{className:"flex justify-end mt-12 mb-10",children:e.jsxs("div",{className:"w-full max-w-sm p-6 bg-blue-50 rounded-lg shadow-md border-primary-light",children:[e.jsx("h3",{className:"text-xl font-bold text-primary-dark mb-4",children:n("invoices.outstandingBalance")}),e.jsx("p",{className:"text-4xl font-extrabold text-primary-dark",children:h.format(b.outstandingBalance)})]})}),e.jsx("footer",{className:"text-center mt-12 text-slate-600 text-sm",children:e.jsx("p",{children:n("patientReport.footer")})})]})},Ew=({supplier:a,clinicData:s})=>{const{t:n,locale:o}=Ve(),{clinicInfo:i,labCases:c,patients:u}=s,m=new Intl.DateTimeFormat(o,{year:"numeric",month:"long",day:"numeric"}),h=new Intl.DateTimeFormat(o,{year:"numeric",month:"short",day:"numeric"}),y=new Intl.NumberFormat(o,{style:"currency",currency:"EGP"}),b=q.useMemo(()=>c.filter(x=>x.labId===a.id).sort((x,v)=>new Date(x.sentDate).getTime()-new Date(v.sentDate).getTime()),[c,a.id]),f=q.useMemo(()=>{const x=b.length,v=b.reduce((N,k)=>N+k.labCost,0);return{totalCases:x,totalCost:v}},[b]);return a.type!=="Dental Lab"?e.jsxs("div",{className:"p-8 bg-white text-slate-900 min-h-screen text-center",dir:o==="ar"?"rtl":"ltr",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:n("supplierStatement.notDentalLab")}),e.jsx("p",{className:"text-md text-slate-700",children:n("supplierStatement.selectDentalLab")})]}):e.jsxs("div",{className:"p-8 bg-white text-slate-900 min-h-screen",dir:o==="ar"?"rtl":"ltr",style:{width:"210mm",minHeight:"297mm",margin:"0 auto",fontSize:"12px",lineHeight:"1.4"},children:[e.jsxs("header",{className:"text-center mb-10 break-inside-avoid",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-1",children:i.name||n("appName")}),e.jsx("p",{className:"text-sm text-slate-600",children:i.address}),e.jsxs("p",{className:"text-sm text-slate-600",children:[i.phone," | ",i.email]})]}),e.jsx("h2",{className:"text-xl font-bold text-primary-dark mt-6 mb-2",children:n("supplierStatement.caseTitle")}),e.jsx("p",{className:"text-sm text-slate-700",children:n("patientReport.generatedOn",{date:m.format(new Date)})})]}),e.jsxs("section",{className:"mb-10 p-6 border rounded-lg bg-neutral-light shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:n("supplierStatement.caseDetails")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-md text-slate-700",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.supplierName"),":"]})," ",a.name]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.contactPerson"),":"]})," ",a.contactPerson||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.phone"),":"]})," ",a.phone||"-"]}),e.jsxs("div",{children:[e.jsxs("strong",{children:[n("suppliers.email"),":"]})," ",a.email||"-"]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-slate-200",children:[e.jsxs("p",{className:"text-lg text-slate-700",children:[e.jsxs("strong",{children:[n("supplierStatement.totalCases"),":"]})," ",f.totalCases]}),e.jsxs("p",{className:"text-lg text-slate-700",children:[e.jsxs("strong",{children:[n("supplierStatement.totalCost"),":"]})," ",y.format(f.totalCost)]})]})]}),e.jsxs("section",{className:"mb-10 break-inside-avoid",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-4 border-b pb-2",children:n("labCases.labCaseTracker")}),b.length>0?e.jsxs("table",{className:"w-full text-md border-collapse border border-slate-400",children:[e.jsx("thead",{className:"bg-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.patient")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.caseType")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.sentDate")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.dueDate")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.status")}),e.jsx("th",{className:"p-3 text-right font-semibold border border-slate-300",children:n("labCases.cost")})]})}),e.jsxs("tbody",{children:[b.map(x=>{const v=u.find(N=>N.id===x.patientId);return e.jsxs("tr",{className:"border-b border-slate-200",children:[e.jsx("td",{className:"p-3 border border-slate-300",children:v?.name||n("common.unknownPatient")}),e.jsx("td",{className:"p-3 border border-slate-300",children:x.caseType}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(new Date(x.sentDate))}),e.jsx("td",{className:"p-3 border border-slate-300",children:h.format(new Date(x.dueDate))}),e.jsx("td",{className:"p-3 border border-slate-300",children:n(`labCaseStatus.${x.status}`)}),e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(x.labCost)})]},x.id)}),e.jsxs("tr",{className:"bg-slate-50 font-bold",children:[e.jsxs("td",{colSpan:5,className:"p-3 text-right border border-slate-300",children:[n("supplierStatement.totalCost"),":"]}),e.jsx("td",{className:"p-3 border border-slate-300",children:y.format(f.totalCost)})]})]})]}):e.jsx("p",{className:"text-center text-slate-500 py-4",children:n("labCases.noCasesRecorded")})]}),e.jsx("footer",{className:"text-center mt-12 text-slate-600 text-sm",children:e.jsx("p",{children:n("patientReport.footer")})})]})},l0=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),c0=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Tw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),lu=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Dw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),Pw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),Iw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 me-1 text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Wp=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m0 0v1a2 2 0 002 2h6a2 2 0 002-2v-1M8 12h8m-8 4h.01M5 12h.01M19 12h.01M5 16h.01M19 16h.01"})}),Rw=({supplier:a,onClose:s,onSave:n})=>{const{t:o}=Ve(),[i,c]=q.useState(a||{name:"",contactPerson:"",phone:"",email:"",type:"Material Supplier"}),u=h=>{c({...i,[h.target.name]:h.target.value})},m=h=>{h.preventDefault(),n(i),s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:o(a?"suppliers.editSupplier":"suppliers.addNewSupplier")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":o("common.closeForm"),children:e.jsx(lu,{})})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[e.jsx("label",{htmlFor:"supplier-name",className:"sr-only",children:o("suppliers.supplierName")}),e.jsx("input",{id:"supplier-name",name:"name",value:i.name,onChange:u,placeholder:o("suppliers.supplierName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsx("label",{htmlFor:"contact-person",className:"sr-only",children:o("suppliers.contactPerson")}),e.jsx("input",{id:"contact-person",name:"contactPerson",value:i.contactPerson,onChange:u,placeholder:o("suppliers.contactPerson"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),e.jsx("label",{htmlFor:"supplier-phone",className:"sr-only",children:o("suppliers.phone")}),e.jsx("input",{id:"supplier-phone",name:"phone",value:i.phone,onChange:u,placeholder:o("suppliers.phone"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),e.jsx("label",{htmlFor:"supplier-email",className:"sr-only",children:o("suppliers.email")}),e.jsx("input",{id:"supplier-email",name:"email",type:"email",value:i.email,onChange:u,placeholder:o("suppliers.email"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-slate-600 mb-1",children:o("suppliers.supplierType")}),e.jsxs("select",{id:"type",name:"type",value:i.type,onChange:u,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"Material Supplier",children:o("supplierType.materialSupplier")}),e.jsx("option",{value:"Dental Lab",children:o("supplierType.dentalLab")})]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:o("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:o("common.save")})]})]})]})})},Aw=({invoice:a,supplierId:s,clinicData:n,onClose:o,onSave:i})=>{const{t:c}=Ve(),[u,m]=q.useState(a||{supplierId:s,invoiceNumber:"",invoiceDate:new Date().toISOString().split("T")[0],dueDate:"",amount:0,status:dl.UNPAID,items:[{description:"",amount:0}],invoiceImageUrl:"",payments:[]}),h=n.suppliers.find(w=>w.id===s),y=h?.type==="Dental Lab"?n.labCases.filter(w=>w.labId===s):[],b=u.labCaseId?y.find(w=>w.id===u.labCaseId):null;q.useMemo(()=>{b&&!a&&m(w=>({...w,invoiceNumber:`LC-${b.caseType}-${Date.now()}`,amount:b.labCost,items:[{description:`Lab case: ${b.caseType}`,amount:b.labCost}],dueDate:b.dueDate}))},[b,a]);const f=w=>{const{name:j,value:D}=w.target;m({...u,[j]:j==="amount"?parseFloat(D):D})},x=(w,j,D)=>{const M=[...u.items];M[w]={...M[w],[j]:j==="amount"?parseFloat(D)||0:D},m({...u,items:M})},v=()=>{m({...u,items:[...u.items,{description:"",amount:0}]})},N=w=>{u.items.length>1&&m({...u,items:u.items.filter((j,D)=>D!==w)})},k=w=>{const j=w.target.files?.[0];if(j){const D=new FileReader;D.onloadend=()=>{m(M=>({...M,invoiceImageUrl:D.result}))},D.readAsDataURL(j)}},C=w=>{w.preventDefault();const j=u.items.reduce((M,I)=>M+(I.amount||0),0),D={...u,amount:j};i(D),o()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[60] p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:c(a?"invoices.editInvoice":"invoices.addInvoice")}),e.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-slate-200","aria-label":c("common.closeForm"),children:e.jsx(lu,{})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsx("input",{name:"invoiceNumber",value:u.invoiceNumber,onChange:f,placeholder:c("invoices.invoiceNumber"),className:"p-2 border border-slate-300 rounded-lg w-full"}),h?.type==="Dental Lab"&&y.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-2",children:"  "}),e.jsxs("select",{name:"labCaseId",value:u.labCaseId||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full",children:[e.jsx("option",{value:"",children:"   ()"}),y.map(w=>e.jsxs("option",{value:w.id,children:[w.caseType," - ",n.patients.find(j=>j.id===w.patientId)?.name||"Unknown Patient"," (",w.status,")"]},w.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",htmlFor:"invoiceDate",children:c("invoices.invoiceDate")}),e.jsx("input",{id:"invoiceDate",name:"invoiceDate",type:"date",value:u.invoiceDate,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600",htmlFor:"dueDate",children:c("invoices.dueDate")}),e.jsx("input",{id:"dueDate",name:"dueDate",type:"date",value:u.dueDate||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-2",children:" "}),u.items.map((w,j)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"",value:w.description,onChange:D=>x(j,"description",D.target.value),className:"flex-1 p-2 border border-slate-300 rounded-lg"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"",value:w.amount,onChange:D=>x(j,"amount",D.target.value),className:"w-24 p-2 border border-slate-300 rounded-lg"}),u.items.length>1&&e.jsx("button",{type:"button",onClick:()=>N(j),className:"px-2 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:""})]},j)),e.jsx("button",{type:"button",onClick:v,className:"text-sm text-primary hover:text-primary-dark",children:"+  "})]}),e.jsx("div",{className:"bg-slate-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-slate-600",children:[" : ",new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(u.items.reduce((w,j)=>w+(j.amount||0),0))]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-600 block mb-2",children:c("invoices.attachInvoice")}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:k,className:"text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"}),u.invoiceImageUrl&&e.jsx("img",{src:u.invoiceImageUrl,alt:"Invoice preview",className:"mt-2 max-h-32 rounded-lg"})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300",children:c("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark",children:c("common.save")})]})]})]})})},Ow=({supplier:a,onClose:s,clinicData:n})=>{const{t:o,locale:i}=Ve(),{supplierInvoices:c,addSupplierInvoice:u,updateSupplierInvoice:m,paySupplierInvoice:h,expenses:y}=n,{addNotification:b}=At(),[f,x]=q.useState({type:null}),v=new Intl.NumberFormat(i,{style:"currency",currency:"EGP"}),N=new Intl.DateTimeFormat(i,{year:"numeric",month:"short",day:"numeric"}),k=q.useMemo(()=>c.filter(_=>_.supplierId===a.id).sort((_,A)=>new Date(A.invoiceDate).getTime()-new Date(_.invoiceDate).getTime()),[c,a.id]),C=q.useMemo(()=>y.filter(_=>_.supplierId===a.id||k.some(A=>A.payments.some(Q=>Q.expenseId===_.id))).sort((_,A)=>new Date(A.date).getTime()-new Date(_.date).getTime()),[y,a.id,k]),w=q.useMemo(()=>{console.log("Debug: Supplier ID:",a.id),console.log("Debug: Related Invoices:",k),console.log("Debug: Related Expenses:",C);const _=k.reduce((G,re)=>(console.log("Debug: Invoice amount:",re.amount,"for invoice:",re.id),G+re.amount),0),A=C.reduce((G,re)=>(console.log("Debug: Expense amount:",re.amount,"for expense:",re.id),G+re.amount),0),Q=_-A;return console.log("Debug: Financial Summary - Total Billed:",_,"Total Paid:",A,"Outstanding:",Q),{totalBilled:_,totalPaid:A,outstandingBalance:Q}},[k,C]),j=_=>{"id"in _&&_.id?(m(_),b(o("notifications.invoiceUpdated"),ve.SUCCESS)):(u(_),b(o("notifications.invoiceAdded"),ve.SUCCESS)),x({type:null})},D=_=>{const A=_.payments.reduce((G,re)=>G+re.amount,0),Q=_.amount-A;Q>0&&window.confirm(o("invoices.confirmPayRemaining",{amount:v.format(Q)}))&&(h(_),b(o("notifications.paymentRecorded"),ve.SUCCESS))},M=()=>{Kr(o("supplierStatement.financialTitle"),e.jsx(Cw,{supplier:a,clinicData:n}))},I=()=>{Kr(o("supplierStatement.caseTitle"),e.jsx(Ew,{supplier:a,clinicData:n}))};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:M,className:"flex items-center px-3 py-1 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-slate-300",children:[e.jsx(Wp,{})," ",o("supplierStatement.financialTitle")]}),a.type==="Dental Lab"&&e.jsxs("button",{onClick:I,className:"flex items-center px-3 py-1 bg-slate-100 rounded-lg hover:bg-slate-200 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-slate-300",children:[e.jsx(Wp,{})," ",o("supplierStatement.caseTitle")]}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200","aria-label":o("common.closeForm"),children:e.jsx(lu,{})})]})]}),e.jsxs("main",{className:"p-6 overflow-y-auto space-y-6 bg-slate-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-slate-600 mb-2",children:" "}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",a.contactPerson||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:":"})," ",a.phone||"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",a.email||"-"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-slate-600 mb-2",children:" "}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",v.format(w.totalBilled)]}),e.jsxs("p",{children:[e.jsx("strong",{children:" :"})," ",v.format(w.totalPaid)]}),e.jsxs("p",{className:"font-bold",children:[e.jsx("strong",{children:" :"})," ",v.format(w.outstandingBalance)]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:""}),e.jsxs("button",{onClick:()=>x({type:"add_invoice"}),className:"flex items-center bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark text-sm",children:[e.jsx(l0,{}),"  "]})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm space-y-3",children:k.length>0?k.map(_=>{const A=_.payments.reduce((G,re)=>G+re.amount,0),Q=_.amount-A;return e.jsxs("div",{className:"border p-3 rounded-lg",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-slate-800",children:[o("invoices.invoice")," #",_.invoiceNumber||_.id.slice(-6)]}),e.jsxs("p",{className:"text-sm text-slate-600",children:[o("invoices.date"),": ",N.format(new Date(_.invoiceDate))]}),_.dueDate&&e.jsxs("p",{className:"text-xs text-slate-500",children:[o("invoices.due"),": ",N.format(new Date(_.dueDate))]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("p",{className:"text-lg font-bold",children:v.format(_.amount)}),e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${Q<=0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Q<=0?o("invoices.paid"):`${o("invoices.remaining")}: ${v.format(Q)}`})]})]}),_.items&&_.items.length>0&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-xs text-slate-600 space-y-1",children:[e.jsx("p",{className:"font-semibold text-xs text-slate-500",children:" :"}),_.items.map((G,re)=>e.jsxs("div",{className:"flex items-center justify-between ps-2",children:[e.jsx("span",{children:G.description||"  "}),e.jsx("span",{children:v.format(G.amount||0)})]},re))]}),_.payments.length>0&&e.jsxs("div",{className:"mt-2 pt-2 border-t text-xs text-slate-600 space-y-1",children:[e.jsx("p",{className:"font-semibold text-xs text-slate-500",children:":"}),_.payments.map(G=>{const re=y.find(le=>le.id===G.expenseId);return e.jsxs("div",{className:"flex items-center justify-between ps-2",children:[e.jsxs("span",{children:[e.jsx(Iw,{}),N.format(new Date(G.date))," - ",re?.description||""]}),e.jsx("span",{children:v.format(G.amount)})]},G.expenseId)})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[_.invoiceImageUrl&&e.jsxs("a",{href:_.invoiceImageUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(Dw,{}),o("invoices.viewAttachment")]}),Q>0&&e.jsxs("button",{onClick:()=>D(_),className:"flex items-center gap-1 text-sm bg-green-100 text-green-700 px-2 py-1 rounded-lg hover:bg-green-200",children:[e.jsx(Pw,{}),o("invoices.payRemaining")]}),e.jsxs("button",{onClick:()=>x({type:"edit_invoice",data:_}),className:"flex items-center gap-1 text-sm bg-slate-100 text-slate-700 px-2 py-1 rounded-lg hover:bg-slate-200",children:[e.jsx(c0,{}),o("common.edit")]})]})]},_.id)}):e.jsx("p",{className:"text-slate-500 text-center py-4",children:"    ."})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-2",children:"  "}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm space-y-3",children:C.length>0?C.map(_=>{const A=k.some(G=>G.payments.some(re=>re.expenseId===_.id)),Q=k.find(G=>G.payments.some(re=>re.expenseId===_.id));return e.jsx("div",{className:"border p-3 rounded-lg",children:e.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:A?`  ${Q?.invoiceNumber||Q?.id.slice(-6)}`:_.description}),e.jsxs("p",{className:"text-sm text-slate-600",children:[": ",N.format(new Date(_.date))]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[": ",_.category==="SUPPLIES"?"":_.category==="RENT"?"":_.category==="SALARIES"?"":_.category==="UTILITIES"?"":_.category==="MARKETING"?"":_.category==="LAB_FEES"?" ":""]})]}),e.jsxs("div",{className:"text-end",children:[e.jsxs("p",{className:"text-lg font-bold text-red-600",children:["-",v.format(_.amount)]}),A&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:" "})]})]})},_.id)}):e.jsx("p",{className:"text-slate-500 text-center py-4",children:"    ."})})]})]})]}),(f.type==="add_invoice"||f.type==="edit_invoice")&&e.jsx(Aw,{supplierId:a.id,invoice:f.data,clinicData:n,onClose:()=>x({type:null}),onSave:j})]})},Mw=({clinicData:a})=>{const{suppliers:s,addSupplier:n,updateSupplier:o,deleteSupplier:i}=a,{t:c}=Ve(),[u,m]=q.useState(!1),[h,y]=q.useState(void 0),[b,f]=q.useState(void 0),x=N=>{"id"in N&&N.id?o(N):n(N),y(void 0)},v=N=>{window.confirm(c("suppliers.confirmDelete",{name:N.name}))&&i(N.id)};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:c("suppliers.suppliersList")}),e.jsxs("button",{onClick:()=>m(!0),className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(l0,{})," ",c("suppliers.addSupplier")]})]}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:c("suppliers.noSuppliersAdded")}):e.jsx("ul",{className:"space-y-2",children:s.map(N=>{const k=a.supplierInvoices.filter(D=>D.supplierId===N.id),C=k.reduce((D,M)=>D+M.amount,0),w=a.expenses.filter(D=>D.supplierId===N.id||k.some(M=>M.payments.some(I=>I.expenseId===D.id))).reduce((D,M)=>D+M.amount,0),j=C-w;return e.jsxs("li",{className:"flex flex-col sm:flex-row justify-between sm:items-center bg-white p-3 rounded-md shadow-sm gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:N.name}),e.jsxs("p",{className:"text-sm text-slate-600",children:[N.contactPerson," - ",N.phone]}),e.jsx("p",{className:"text-xs text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full inline-block mt-1",children:N.type==="Material Supplier"?c("supplierType.materialSupplier"):c("supplierType.dentalLab")}),j>0&&e.jsxs("p",{className:"text-xs font-semibold text-orange-600 mt-1",children:[" : ",new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(j)]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-center",children:[e.jsx("button",{onClick:()=>f(N),className:"text-secondary hover:text-green-700 font-semibold px-3 py-1 rounded-lg bg-secondary/10 hover:bg-secondary/20 text-sm focus:outline-none focus:ring-2 focus:ring-secondary/50",children:c("suppliers.viewDetails")}),e.jsx("button",{onClick:()=>{y(N),m(!0)},className:"text-primary hover:text-primary-dark p-2 rounded-lg hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary-light","aria-label":c("suppliers.editSupplierAriaLabel",{name:N.name}),children:e.jsx(c0,{})}),e.jsx("button",{onClick:()=>v(N),className:"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-300","aria-label":c("suppliers.deleteSupplierAriaLabel",{name:N.name}),children:e.jsx(Tw,{})})]})]},N.id)})})})]}),u&&e.jsx(Rw,{supplier:h,onClose:()=>{m(!1),y(void 0)},onSave:x}),b&&e.jsx(Ow,{supplier:b,onClose:()=>f(void 0),clinicData:a})]})},Lw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Fw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),$w=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Uw=({item:a,onClose:s,onSave:n,suppliers:o})=>{const{t:i}=Ve(),[c,u]=q.useState(a||{name:"",description:"",supplierId:"",currentStock:0,unitCost:0,minStockLevel:5}),m=y=>{const{name:b,value:f}=y.target;if(b==="currentStock"||b==="unitCost"||b==="minStockLevel"){const x=parseFloat(f);u({...c,[b]:isNaN(x)?0:x})}else u({...c,[b]:f})},h=y=>{if(y.preventDefault(),!c.name||!c.supplierId){alert("Name and supplier are required");return}if(c.currentStock<0||c.unitCost<0||c.minStockLevel<0){alert("Stock levels and costs cannot be negative");return}n(c),s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i(a?"inventory.editItem":"inventory.addNewItem")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx($w,{})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsx("label",{htmlFor:"item-name",className:"sr-only",children:i("inventory.itemName")}),e.jsx("input",{id:"item-name",name:"name",value:c.name,onChange:m,placeholder:i("inventory.itemName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsx("label",{htmlFor:"item-description",className:"sr-only",children:i("inventory.description")}),e.jsx("textarea",{id:"item-description",name:"description",value:c.description,onChange:m,placeholder:i("inventory.descriptionPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"item-supplier",className:"block text-sm font-medium text-slate-600 mb-1",children:i("inventory.supplier")}),e.jsxs("select",{id:"item-supplier",name:"supplierId",value:c.supplierId,onChange:m,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:i("inventory.selectSupplier")}),o.filter(y=>y.type==="Material Supplier").map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentStock",className:"block text-sm font-medium text-slate-600 mb-1",children:i("inventory.currentStock")}),e.jsx("input",{id:"currentStock",name:"currentStock",type:"number",value:c.currentStock,onChange:m,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"unitCost",className:"block text-sm font-medium text-slate-600 mb-1",children:i("inventory.unitCost")}),e.jsx("input",{id:"unitCost",name:"unitCost",type:"number",step:"0.01",value:c.unitCost,onChange:m,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"minStockLevel",className:"block text-sm font-medium text-slate-600 mb-1",children:i("inventory.minStockLevel")}),e.jsx("input",{id:"minStockLevel",name:"minStockLevel",type:"number",value:c.minStockLevel,onChange:m,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expiryDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("inventory.expiryDate")}),e.jsx("input",{id:"expiryDate",name:"expiryDate",type:"date",value:c.expiryDate||"",onChange:m,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("common.save")})]})]})]})})},Bw=({clinicData:a})=>{const{inventoryItems:s,addInventoryItem:n,updateInventoryItem:o,suppliers:i}=a,{t:c,locale:u}=Ve(),{addNotification:m}=At(),[h,y]=q.useState(!1),[b,f]=q.useState(void 0),x=new Intl.NumberFormat(u,{style:"currency",currency:"EGP"}),v=new Intl.DateTimeFormat(u,{year:"numeric",month:"short",day:"numeric"}),N=C=>{"id"in C&&C.id?(o(C),m(c("notifications.inventoryItemUpdated"),ve.SUCCESS)):(n(C),m(c("notifications.inventoryItemAdded"),ve.SUCCESS)),f(void 0),y(!1)},k=C=>{if(C.currentStock<=0)return{label:c("inventoryStatus.outOfStock"),class:"bg-red-100 text-red-700"};if(C.currentStock<=C.minStockLevel)return{label:c("inventoryStatus.lowStock"),class:"bg-amber-100 text-amber-700"};if(C.expiryDate){const w=new Date(C.expiryDate),j=new Date,D=2160*60*60*1e3;if(w.getTime()<j.getTime())return{label:c("inventoryStatus.expired"),class:"bg-red-100 text-red-700"};if(w.getTime()-j.getTime()<D)return{label:c("inventoryStatus.expiresSoon"),class:"bg-orange-100 text-orange-700"}}return{label:c("inventoryStatus.ok"),class:"bg-green-100 text-green-700"}};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:c("inventory.inventoryItems")}),e.jsxs("button",{onClick:()=>{f(void 0),y(!0)},className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(Lw,{})," ",c("inventory.addItem")]})]}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:c("inventory.noItemsAdded")}):e.jsx("ul",{className:"space-y-3",children:s.map(C=>{const w=i.find(D=>D.id===C.supplierId),j=k(C);return e.jsxs("li",{className:"flex flex-col sm:flex-row justify-between sm:items-center bg-white p-3 rounded-md shadow-sm gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-slate-800",children:C.name}),e.jsx("p",{className:"text-sm text-slate-600 truncate",children:C.description||c("common.na")}),e.jsxs("p",{className:"text-xs text-slate-500",children:[c("inventory.supplier"),": ",w?.name||c("inventory.supplierNotAvailable")," | ",c("inventory.currentStock"),": ",C.currentStock||0]}),C.expiryDate&&e.jsxs("p",{className:"text-xs text-slate-500",children:[c("inventory.expiryDate"),": ",v.format(new Date(C.expiryDate))]})]}),e.jsxs("div",{className:"flex flex-col items-end sm:items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${j.class}`,children:j.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:!isNaN(C.unitCost)&&C.unitCost>0?x.format(C.unitCost):x.format(0)}),e.jsx("button",{onClick:()=>{f(C),y(!0)},className:"text-primary hover:text-primary-dark p-2 rounded-lg hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary-light","aria-label":c("inventory.editItemAriaLabel",{name:C.name}),children:e.jsx(Fw,{})})]})]})]},C.id)})})}),h&&e.jsx(Uw,{item:b,onClose:()=>{y(!1),f(void 0)},onSave:N,suppliers:i})]})},qw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),zw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Hw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Ww=({labCase:a,onClose:s,onSave:n,clinicData:o})=>{const{t:i}=Ve(),{addNotification:c}=At(),{patients:u,suppliers:m}=o,[h,y]=q.useState(a||{patientId:"",labId:"",caseType:"",sentDate:new Date().toISOString().split("T")[0],dueDate:"",returnDate:"",status:nr.DRAFT,labCost:0,notes:""}),b=q.useMemo(()=>m.filter(v=>v.type==="Dental Lab"),[m]),f=v=>{const{name:N,value:k}=v.target;y({...h,[N]:N==="labCost"?parseFloat(k):k})},x=v=>{if(v.preventDefault(),!h.patientId||!h.labId||!h.caseType||!h.sentDate||!h.dueDate){c(i("labCases.alertFillAllFields"),ve.ERROR);return}if(h.status!==nr.DRAFT&&h.status!==nr.SENT_TO_LAB&&h.labCost>0&&o.suppliers.find(k=>k.id===h.labId)){const k={supplierId:h.labId,invoiceNumber:`LC-${h.caseType}-${Date.now()}`,invoiceDate:new Date().toISOString().split("T")[0],dueDate:h.dueDate,amount:h.labCost,status:dl.UNPAID,items:[{description:`Lab case: ${h.caseType}`,amount:h.labCost}],payments:[]};o.addSupplierInvoice(k),c(i("notifications.invoiceAddedForLabCase"),ve.SUCCESS)}n(h),s()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:i(a?"labCases.editCase":"labCases.addNewCase")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":i("common.closeForm"),children:e.jsx(Hw,{})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"patientId",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.patient")}),e.jsxs("select",{id:"patientId",name:"patientId",value:h.patientId,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:i("labCases.selectPatient")}),u.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"labId",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.dentalLab")}),e.jsxs("select",{id:"labId",name:"labId",value:h.labId,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:[e.jsx("option",{value:"",children:i("labCases.selectDentalLab")}),b.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"caseType",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.caseType")}),e.jsx("input",{id:"caseType",name:"caseType",value:h.caseType,onChange:f,placeholder:i("labCases.caseTypePlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sentDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.sentDate")}),e.jsx("input",{id:"sentDate",name:"sentDate",type:"date",value:h.sentDate,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.dueDate")}),e.jsx("input",{id:"dueDate",name:"dueDate",type:"date",value:h.dueDate,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"returnDate",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.returnDate")}),e.jsx("input",{id:"returnDate",name:"returnDate",type:"date",value:h.returnDate||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"labCost",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.labCost")}),e.jsx("input",{id:"labCost",name:"labCost",type:"number",step:"0.01",value:h.labCost||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.status")}),e.jsx("select",{id:"status",name:"status",value:h.status,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:Object.values(nr).map(v=>e.jsx("option",{value:v,children:i(`labCaseStatus.${v}`)},v))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-slate-600 mb-1",children:i("labCases.notes")}),e.jsx("textarea",{id:"notes",name:"notes",value:h.notes,onChange:f,placeholder:i("labCases.notesPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:i("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:i("common.save")})]})]})]})})},Vw=({clinicData:a})=>{const{labCases:s,addLabCase:n,updateLabCase:o,patients:i,suppliers:c}=a,{t:u,locale:m}=Ve(),{addNotification:h}=At(),[y,b]=q.useState(!1),[f,x]=q.useState(void 0),v=new Intl.NumberFormat(m,{style:"currency",currency:"EGP"}),N=new Intl.DateTimeFormat(m,{year:"numeric",month:"short",day:"numeric"}),k=w=>{"id"in w&&w.id?(o(w),h(u("notifications.labCaseUpdated"),ve.SUCCESS)):(n(w),h(u("notifications.labCaseAdded"),ve.SUCCESS)),x(void 0),b(!1)},C=w=>{switch(w){case nr.DRAFT:return"bg-slate-100 text-slate-700";case nr.SENT_TO_LAB:return"bg-blue-100 text-blue-700";case nr.RECEIVED_FROM_LAB:return"bg-green-100 text-green-700";case nr.FITTED_TO_PATIENT:return"bg-emerald-100 text-emerald-700";case nr.CANCELLED:return"bg-red-100 text-red-700";default:return"bg-slate-100 text-slate-700"}};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:u("labCases.labCaseTracker")}),e.jsxs("button",{onClick:()=>{x(void 0),b(!0)},className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(qw,{})," ",u("labCases.addCase")]})]}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:u("labCases.noCasesRecorded")}):e.jsx("ul",{className:"space-y-3",children:s.map(w=>{const j=i.find(I=>I.id===w.patientId),D=c.find(I=>I.id===w.labId),M=C(w.status);return e.jsxs("li",{className:"flex flex-col sm:flex-row justify-between sm:items-center bg-white p-3 rounded-md shadow-sm gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-bold text-slate-800",children:[w.caseType," - ",j?.name||u("common.unknownPatient")]}),e.jsxs("p",{className:"text-sm text-slate-600",children:[": ",D?.name||u("common.na"),e.jsxs("span",{className:"ms-2 ps-2 border-s border-slate-300",children:[" : ",w.sentDate?N.format(new Date(w.sentDate)):u("common.na")," |  : ",w.dueDate?N.format(new Date(w.dueDate)):u("common.na")]}),w.returnDate&&e.jsxs("span",{className:"ms-2 ps-2 border-s border-slate-300",children:[u("labCases.returnDate"),": ",w.returnDate?N.format(new Date(w.returnDate)):"Not returned"]})]}),w.notes&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[u("labCases.notes"),": ",w.notes]})]}),e.jsxs("div",{className:"flex flex-col items-end sm:items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:`text-xs font-semibold px-2 py-0.5 rounded-full ${M}`,children:w.status==="DRAFT"?"":u(`labCaseStatus.${w.status}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-semibold text-slate-700",children:[isNaN(w.labCost)||w.labCost===null||w.labCost===void 0?u("common.na"):v.format(w.labCost)," .."]}),e.jsx("button",{onClick:()=>{x(w),b(!0)},className:"text-primary hover:text-primary-dark p-2 rounded-lg hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary-light","aria-label":u("labCases.editCaseAriaLabel",{caseType:w.caseType,patientName:j?.name||u("common.unknownPatient")}),children:e.jsx(zw,{})})]})]})]},w.id)})})}),y&&e.jsx(Ww,{labCase:f,onClose:()=>{b(!1),x(void 0)},onSave:k,clinicData:a})]})},Gw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),Kw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),Jw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),Yw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Qw=({expense:a,onClose:s,onSave:n,clinicData:o})=>{const{suppliers:i,supplierInvoices:c}=o,{t:u,locale:m}=Ve(),h=new Intl.NumberFormat(m,{style:"currency",currency:"EGP"}),[y,b]=q.useState(a||{date:new Date().toISOString().split("T")[0],description:"",amount:0,category:Gr.MISC,supplierId:void 0,supplierInvoiceId:void 0}),f=k=>{const{name:C,value:w}=k.target;if(C==="amount"){const j=parseFloat(w);b({...y,[C]:isNaN(j)?0:j})}else b({...y,[C]:w})},x=k=>{if(k.preventDefault(),y.amount<=0){alert("Amount must be greater than 0");return}const C={...y};C.supplierId===""&&delete C.supplierId,C.supplierInvoiceId===""&&delete C.supplierInvoiceId,n(C),s()},v=q.useMemo(()=>y.supplierId?c.filter(k=>k.supplierId===y.supplierId&&k.status===dl.UNPAID):[],[y.supplierId,c]),N=k=>{const C=k.payments.reduce((w,j)=>w+j.amount,0);return k.amount-C};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:u(a?"expenses.editExpense":"expenses.addNewExpense")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":u("common.closeForm"),children:e.jsx(Yw,{})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-date",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.date")}),e.jsx("input",{id:"expense-date",name:"date",type:"date",value:y.date,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-description",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.description")}),e.jsx("textarea",{id:"expense-description",name:"description",value:y.description,onChange:f,placeholder:u("expenses.descriptionPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-amount",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.amount")}),e.jsx("input",{id:"expense-amount",name:"amount",type:"number",step:"0.01",value:y.amount,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-category",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.category")}),e.jsx("select",{id:"expense-category",name:"category",value:y.category,onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,children:Object.values(Gr).map(k=>e.jsx("option",{value:k,children:u(`expenseCategory.${k}`)},k))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-supplier",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.selectSupplier")}),e.jsxs("select",{id:"expense-supplier",name:"supplierId",value:y.supplierId||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:u("expenses.noSupplier")}),i.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),y.supplierId&&v.length>0&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expense-invoice",className:"block text-sm font-medium text-slate-600 mb-1",children:u("expenses.applyToInvoice")}),e.jsxs("select",{id:"expense-invoice",name:"supplierInvoiceId",value:y.supplierInvoiceId||"",onChange:f,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",children:[e.jsx("option",{value:"",children:u("expenses.paymentOnAccount")}),v.map(k=>e.jsxs("option",{value:k.id,children:[u("invoices.invoice")," #",k.invoiceNumber||k.id.slice(-4)," - ",u("invoices.remaining"),": ",h.format(N(k))]},k.id))]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:u("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:u("common.save")})]})]})]})})},Xw=({clinicData:a})=>{const{expenses:s,addExpense:n,updateExpense:o,deleteExpense:i,suppliers:c,supplierInvoices:u}=a,{t:m,locale:h}=Ve(),[y,b]=q.useState(!1),[f,x]=q.useState(void 0),v=new Intl.NumberFormat(h,{style:"currency",currency:"EGP"}),N=new Intl.DateTimeFormat(h,{year:"numeric",month:"short",day:"numeric"}),k=w=>{"id"in w&&w.id?o(w):n(w),x(void 0)},C=w=>{window.confirm(m("expenses.confirmDelete",{description:w.description}))&&i(w.id)};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:m("expenses.clinicExpenses")}),e.jsxs("button",{onClick:()=>b(!0),className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(Gw,{})," ",m("expenses.addExpense")]})]}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:m("expenses.noExpensesRecorded")}):e.jsx("ul",{className:"space-y-2",children:s.map(w=>{const j=w.supplierId?c.find(M=>M.id===w.supplierId):null,D=w.supplierInvoiceId?u.find(M=>M.id===w.supplierInvoiceId):null;return e.jsxs("li",{className:"flex justify-between items-center bg-white p-3 rounded-md shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:w.description}),e.jsxs("p",{className:"text-sm text-slate-600",children:[m(`expenseCategory.${w.category}`)," - ",N.format(new Date(w.date)),j&&e.jsxs("span",{className:"ms-2 ps-2 border-s border-slate-300",children:[m("expenses.supplier"),": ",j.name,D&&` (#${D.invoiceNumber||D.id.slice(-4)})`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-slate-700",children:v.format(w.amount)}),e.jsx("button",{onClick:()=>{x(w),b(!0)},className:"text-primary hover:text-primary-dark text-sm p-2 rounded-lg hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary-light","aria-label":m("expenses.editExpenseAriaLabel",{description:w.description}),children:e.jsx(Kw,{})}),e.jsx("button",{onClick:()=>C(w),className:"text-red-600 hover:text-red-800 text-sm p-2 rounded-lg hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-300","aria-label":m("expenses.deleteExpenseAriaLabel",{description:w.description}),children:e.jsx(Jw,{})})]})]},w.id)})})}),y&&e.jsx(Qw,{expense:f,onClose:()=>{b(!1),x(void 0)},onSave:k,clinicData:a})]})},Zw=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),ej=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),tj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),rj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),sj=({definition:a,onClose:s,onSave:n})=>{const{t:o}=Ve(),[i,c]=q.useState(a||{name:"",description:"",basePrice:0,doctorPercentage:.5,clinicPercentage:.5}),u=y=>{const{name:b,value:f}=y.target;if(b==="basePrice"){const x=parseFloat(f);c({...i,[b]:isNaN(x)?0:x})}else if(b==="doctorPercentage"||b==="clinicPercentage"){const x=parseFloat(f);!isNaN(x)&&x>=0&&x<=1&&(c(v=>({...v,[b]:x})),c(b==="doctorPercentage"?v=>({...v,clinicPercentage:1-x}):v=>({...v,doctorPercentage:1-x})))}else c({...i,[b]:f})},m=y=>{if(y.preventDefault(),i.basePrice<=0){alert("Base price must be greater than 0");return}if(i.doctorPercentage<0||i.doctorPercentage>1){alert("Doctor percentage must be between 0 and 1");return}if(i.clinicPercentage<0||i.clinicPercentage>1){alert("Clinic percentage must be between 0 and 1");return}if(Math.abs(i.doctorPercentage+i.clinicPercentage-1)>.01){alert("Doctor and clinic percentages must add up to 100%");return}n(i),s()},h=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4","aria-modal":"true",role:"dialog",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("header",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-700",children:o(a?"treatments.editTreatment":"treatments.addNewTreatment")}),e.jsx("button",{onClick:s,className:"p-1 rounded-full hover:bg-slate-200 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":o("common.closeForm"),children:e.jsx(rj,{})})]}),e.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[e.jsx("label",{htmlFor:"treatment-name",className:"sr-only",children:o("treatments.treatmentName")}),e.jsx("input",{id:"treatment-name",name:"name",value:i.name,onChange:u,placeholder:o("treatments.treatmentName"),className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsx("label",{htmlFor:"treatment-description",className:"sr-only",children:o("treatments.description")}),e.jsx("textarea",{id:"treatment-description",name:"description",value:i.description,onChange:u,placeholder:o("treatments.descriptionPlaceholder"),className:"p-2 border border-slate-300 rounded-lg w-full h-20 focus:ring-primary focus:border-primary"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"basePrice",className:"block text-sm font-medium text-slate-600 mb-1",children:o("treatments.basePrice")}),e.jsx("input",{id:"basePrice",name:"basePrice",type:"number",step:"0.01",value:i.basePrice,onChange:u,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"doctorPercentage",className:"block text-sm font-medium text-slate-600 mb-1",children:o("treatments.doctorPercentage")}),e.jsx("input",{id:"doctorPercentage",name:"doctorPercentage",type:"number",step:"0.01",min:"0",max:"1",value:i.doctorPercentage,onChange:u,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:h.format(i.doctorPercentage)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"clinicPercentage",className:"block text-sm font-medium text-slate-600 mb-1",children:o("treatments.clinicPercentage")}),e.jsx("input",{id:"clinicPercentage",name:"clinicPercentage",type:"number",step:"0.01",min:"0",max:"1",value:i.clinicPercentage,onChange:u,className:"p-2 border border-slate-300 rounded-lg w-full focus:ring-primary focus:border-primary",required:!0,disabled:!0}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[h.format(i.clinicPercentage)," (",o("treatments.auto"),")"]})]})]}),e.jsxs("footer",{className:"pt-2 flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-neutral-dark rounded-lg hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300",children:o("common.cancel")}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:o("common.save")})]})]})]})})},nj=({clinicData:a})=>{const{treatmentDefinitions:s,addTreatmentDefinition:n,updateTreatmentDefinition:o,deleteTreatmentDefinition:i}=a,{t:c,locale:u}=Ve(),[m,h]=q.useState(!1),[y,b]=q.useState(void 0),f=new Intl.NumberFormat(u,{style:"currency",currency:"EGP"}),x=new Intl.NumberFormat(u,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0}),v=k=>{"id"in k&&k.id?o(k):n(k),b(void 0)},N=k=>{window.confirm(c("treatments.confirmDelete",{name:k.name}))&&i(k.id)};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-700",children:c("treatments.manageTreatments")}),e.jsxs("button",{onClick:()=>h(!0),className:"bg-primary text-white px-3 py-1 rounded-lg hover:bg-primary-dark flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(Zw,{})," ",c("treatments.addTreatment")]})]}),e.jsx("div",{className:"bg-neutral p-4 rounded-lg shadow-inner",children:s.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:c("treatments.noTreatmentsAdded")}):e.jsx("ul",{className:"space-y-2",children:s.map(k=>e.jsxs("li",{className:"flex justify-between items-center bg-white p-3 rounded-md shadow-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800",children:k.name}),e.jsxs("p",{className:"text-sm text-slate-600",children:[" : ",isNaN(k.basePrice)?" ":f.format(k.basePrice)]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[": ",isNaN(k.doctorPercentage)?" ":x.format(k.doctorPercentage)," | : ",isNaN(k.clinicPercentage)?" ":x.format(k.clinicPercentage)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b(k),h(!0)},className:"text-primary hover:text-primary-dark text-sm p-2 rounded-lg hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary-light","aria-label":c("treatments.editTreatmentAriaLabel",{name:k.name}),children:e.jsx(ej,{})}),e.jsx("button",{onClick:()=>N(k),className:"text-red-600 hover:text-red-800 text-sm p-2 rounded-lg hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-300","aria-label":c("treatments.deleteTreatmentAriaLabel",{name:k.name}),children:e.jsx(tj,{})})]})]},k.id))})}),m&&e.jsx(sj,{definition:y,onClose:()=>{h(!1),b(void 0)},onSave:v})]})},aj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),Vp=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 me-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})}),oj=({clinicData:a})=>{const{t:s}=Ve(),{addNotification:n}=At(),o=q.useRef(null),{restoreData:i,...c}=a,[u,m]=q.useState(a.clinicInfo),[h,y]=q.useState(a.whatsappMessageTemplate),[b,f]=q.useState(a.reminderMessageTemplate),x=()=>{try{const M=JSON.stringify(c,null,2),I=new Blob([M],{type:"application/json"}),_=URL.createObjectURL(I),A=document.createElement("a");A.href=_;const Q=new Date().toISOString().split("T")[0];A.download=`curasoft-backup-${Q}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(_),n(s("notifications.backupSuccess"),ve.SUCCESS)}catch(M){console.error("Backup failed:",M),n(s("notifications.backupError"),ve.ERROR)}},v=()=>{o.current?.click()},N=async M=>{const I=M.target.files?.[0];if(I){if(window.confirm(s("settings.restore.confirm"))){const _=new FileReader;_.onload=async A=>{try{const Q=A.target?.result;if(typeof Q=="string"){const G=JSON.parse(Q);await i(G),n(s("notifications.restoreSuccess"),ve.SUCCESS),setTimeout(()=>window.location.reload(),1e3)}}catch(Q){console.error("Restore failed:",Q),n(s("notifications.restoreError"),ve.ERROR)}},_.readAsText(I)}o.current&&(o.current.value="")}},k=async()=>{if(window.confirm(s("settings.sampleData.confirm")))try{const M=await fetch("/sample-data.json");if(!M.ok)throw new Error("Failed to load sample data file");const I=await M.json();for(const _ of I.patients)await a.addPatient(_);for(const _ of I.dentists)await a.addDoctor(_);for(const _ of I.suppliers)await a.addSupplier(_);for(const _ of I.inventoryItems)await a.addInventoryItem(_);for(const _ of I.expenses)await a.addExpense(_);for(const _ of I.treatmentDefinitions)await a.addTreatmentDefinition(_);for(const _ of I.treatmentRecords)await a.addTreatmentRecord(_.patientId,_);for(const _ of I.labCases)await a.addLabCase(_);for(const _ of I.payments)await a.addPayment(_);for(const _ of I.supplierInvoices)await a.addSupplierInvoice(_);for(const _ of I.appointments)await a.addAppointment(_);n(s("settings.sampleData.success"),ve.SUCCESS)}catch(M){console.error("Failed to load sample data:",M),n(s("settings.sampleData.error"),ve.ERROR)}},C=()=>{if(window.confirm(s("settings.clear.confirm")))try{Object.keys(localStorage).forEach(M=>{M.startsWith("curasoft_")&&localStorage.removeItem(M)}),n(s("settings.clear.success"),ve.SUCCESS),setTimeout(()=>window.location.reload(),1e3)}catch(M){console.error("Failed to clear data:",M),n(s("settings.clear.error"),ve.ERROR)}},w=()=>{if(window.confirm("       "))try{localStorage.removeItem("curasoft_clinic_info"),localStorage.removeItem("curasoft_whatsapp_template"),localStorage.removeItem("curasoft_reminder_template"),n("    ",ve.SUCCESS),setTimeout(()=>window.location.reload(),1e3)}catch(M){console.error("Failed to clear settings:",M),n("   ",ve.ERROR)}},j=()=>{if(window.confirm("                ."))try{const M=["curasoft_clinic_info","curasoft_whatsapp_template","curasoft_reminder_template"];Object.keys(localStorage).forEach(I=>{I.startsWith("curasoft_")&&!M.includes(I)&&localStorage.removeItem(I)}),n("    ",ve.SUCCESS),setTimeout(()=>window.location.reload(),1e3)}catch(M){console.error("Failed to reset data:",M),n("    ",ve.ERROR)}},D=()=>{a.updateClinicInfo(u)};return e.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-xl shadow-md space-y-8 max-w-4xl mx-auto",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:" "}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:"   "}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),e.jsx("input",{type:"text",value:u.name,onChange:M=>m({...u,name:M.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),e.jsx("input",{type:"text",value:u.address,onChange:M=>m({...u,address:M.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),e.jsx("input",{type:"tel",value:u.phone,onChange:M=>m({...u,phone:M.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"  "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:" "}),e.jsx("input",{type:"email",value:u.email,onChange:M=>m({...u,email:M.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"  "})]})]}),e.jsx("button",{onClick:D,className:"mt-4 bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary-light",children:"  "})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:"   "}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:"      "}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:" :"}),e.jsxs("div",{className:"text-sm text-slate-600 bg-slate-50 p-3 rounded-lg",children:[e.jsx("code",{children:"{patientName}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicName}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicAddress}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicPhone}"})," -   "]})]}),e.jsx("textarea",{value:a.whatsappMessageTemplate,onChange:M=>a.updateWhatsappMessageTemplate(M.target.value),rows:4,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"   ..."}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"             "})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:"   "}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:"      "}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:" :"}),e.jsxs("div",{className:"text-sm text-slate-600 bg-slate-50 p-3 rounded-lg",children:[e.jsx("code",{children:"{patientName}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{doctorName}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicName}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{appointmentDate}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{appointmentTime}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicAddress}"})," -  ",e.jsx("br",{}),e.jsx("code",{children:"{clinicPhone}"})," -   "]})]}),e.jsx("textarea",{value:a.reminderMessageTemplate,onChange:M=>a.updateReminderMessageTemplate(M.target.value),rows:6,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"    ..."}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"        "})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:s("settings.backup.title")}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:s("settings.backup.description")}),e.jsxs("button",{onClick:x,className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-primary-light",children:[e.jsx(aj,{})," ",s("settings.backup.button")]})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-700",children:s("settings.restore.title")}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-2",children:s("settings.restore.description")}),e.jsx("p",{className:"text-sm text-red-600 font-semibold mb-4",children:s("settings.restore.warning")}),e.jsxs("button",{onClick:v,className:"bg-slate-600 text-white px-4 py-2 rounded-lg hover:bg-slate-700 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-slate-500",children:[e.jsx(Vp,{})," ",s("settings.restore.button")]}),e.jsx("input",{type:"file",ref:o,onChange:N,accept:".json",className:"hidden"})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-green-600",children:s("settings.sampleData.title")}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 mb-4",children:s("settings.sampleData.description")}),e.jsxs("button",{onClick:k,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-600 flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx(Vp,{})," ",s("settings.sampleData.button")]})]}),e.jsxs("div",{className:"border-t pt-8",children:[e.jsx("h3",{className:"text-lg font-bold text-red-600",children:s("settings.dangerZone.title")}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:s("settings.dangerZone.description")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800",children:"  "}),e.jsx("p",{className:"text-sm text-red-700",children:"   (   )    "})]}),e.jsx("button",{onClick:j,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 flex-shrink-0",children:"  "})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800",children:"  "}),e.jsx("p",{className:"text-sm text-red-700",children:"       "})]}),e.jsx("button",{onClick:w,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 flex-shrink-0",children:" "})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800",children:s("settings.clear.title")}),e.jsx("p",{className:"text-sm text-red-700",children:s("settings.clear.description")})]}),e.jsx("button",{onClick:C,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 flex-shrink-0",children:s("settings.clear.button")})]})]})]})]})};var ij={};const lj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-5-5.917V5a2 2 0 10-4 0v.083A6 6 0 004 11v3.159c0 .538-.214 1.055-.595 1.436L2 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),cj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12.062 17.498a9.423 9.423 0 0 1-4.71-1.392l-5.13.84 1.09-4.992a9.423 9.423 0 0 1-1.282-5.024C2.03 3.018 6.54-1.5 12 .002c5.46 1.5 8.97 7.018 7.47 12.478a9.423 9.423 0 0 1-7.408 5.02z"})}),dj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),uj=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),mj=({clinicData:a,setCurrentView:s})=>{const{t:n,locale:o}=Ve(),{patients:i,appointments:c,updateAppointment:u,inventoryItems:m,labCases:h,payments:y,treatmentRecords:b}=a,[f,x]=q.useState(!1),[v,N]=q.useState({sent:0,opened:0,responded:0}),k=q.useMemo(()=>{const j=[],D=new Date,M=10,I=3,_=30;return c.forEach(A=>{if(A.reminderSent||A.reminderTime==="none"||A.startTime<D)return;const Q=A.startTime.getTime();let G=0;if(A.reminderTime==="1_hour_before"?G=3600*1e3:A.reminderTime==="2_hours_before"?G=7200*1e3:A.reminderTime==="1_day_before"&&(G=1440*60*1e3),Q-D.getTime()<=G){const re=i.find(le=>le.id===A.patientId);j.push({id:`apt_${A.id}`,type:"appointment",title:re?.name||n("common.unknownPatient"),description:`${A.reason} at ${new Intl.DateTimeFormat(o,{hour:"2-digit",minute:"2-digit"}).format(A.startTime)}`,actionLabel:n("reminders.sendReminder"),action:()=>C(A),data:A,priority:"high"})}}),m.forEach(A=>{if(A.currentStock<=M){const Q=A.currentStock<=5?2:A.currentStock<=8?1:0;j.push({id:`inv_${A.id}`,type:"low_stock",title:n("notifications.lowStockAlert"),description:n("notifications.lowStockMessage",{itemName:A.name,count:A.currentStock}),actionLabel:n("sidebar.inventory"),action:()=>{s("inventory"),x(!1)},data:A,priority:A.currentStock<=5?"high":"medium",escalationLevel:Q})}}),h.forEach(A=>{if([nr.FITTED_TO_PATIENT,nr.CANCELLED].includes(A.status))return;const Q=new Date(A.dueDate),G=(Q.getTime()-D.getTime())/(1e3*3600*24);if(G<=I){const re=i.find(le=>le.id===A.patientId);j.push({id:`lab_${A.id}`,type:"lab",title:n("notifications.labCaseDueAlert"),description:n("notifications.labCaseDueMessage",{caseType:A.caseType,patientName:re?.name||"",date:new Intl.DateTimeFormat(o).format(Q)}),actionLabel:n("sidebar.labCases"),action:()=>{s("labCases"),x(!1)},data:A,priority:G<=1?"high":"medium"})}}),b.forEach(A=>{const Q=y.filter(G=>G.treatmentRecordId===A.id).reduce((G,re)=>G+re.amount,0);if(Q<A.totalTreatmentCost){const G=new Date(A.treatmentDate),re=(D.getTime()-G.getTime())/(1e3*60*60*24);if(re>_){const le=i.find(P=>P.id===A.patientId),he=A.totalTreatmentCost-Q;j.push({id:`overdue_${A.id}`,type:"overdue_payment",title:`Overdue Payment - ${le?.name||"Unknown Patient"}`,description:`Outstanding balance: EGP ${he.toFixed(2)} (${Math.floor(re)} days overdue)`,actionLabel:"View Patient",action:()=>{s("patients"),x(!1)},data:{treatmentRecord:A,patient:le,outstandingAmount:he},priority:re>60?"high":"medium",escalationLevel:Math.floor(re/30)})}}}),j.sort((A,Q)=>{const G={high:3,medium:2,low:1},re=G[A.priority||"low"],le=G[Q.priority||"low"];return re!==le?le-re:(Q.escalationLevel||0)-(A.escalationLevel||0)})},[c,m,h,i,y,b,s,n,o]),C=async(j,D="whatsapp")=>{const M=i.find(G=>G.id===j.patientId),I=a.dentists.find(G=>G.id===j.dentistId);if(!M)return;const _=new Intl.DateTimeFormat(o,{year:"numeric",month:"long",day:"numeric"}),A=new Intl.DateTimeFormat(o,{hour:"2-digit",minute:"2-digit"}),Q=a.reminderMessageTemplate.replace(/\{patientName\}/g,M.name).replace(/\{doctorName\}/g,I?.name||"").replace(/\{clinicName\}/g,a.clinicInfo.name||" ").replace(/\{appointmentDate\}/g,_.format(j.startTime)).replace(/\{appointmentTime\}/g,A.format(j.startTime)).replace(/\{clinicAddress\}/g,a.clinicInfo.address||"").replace(/\{clinicPhone\}/g,a.clinicInfo.phone||"");try{if(D==="whatsapp"){let G=M.phone.replace(/[^0-9]/g,"");G.startsWith("0")&&(G=G.substring(1));const le=`https://wa.me/${`20${G}`}?text=${encodeURIComponent(Q)}`;window.open(le,"_blank")}else D==="email"&&M.email?(Hp.setApiKey(ij.SENDGRID_API_KEY||""),await Hp.send({to:M.email,from:"noreply@curasof.com",subject:`Appointment Reminder - ${a.clinicInfo.name}`,text:Q,html:`<p>${Q.replace(/\n/g,"<br>")}</p>`})):D==="sms"&&M.phone&&(console.log("SMS functionality is currently disabled"),C(j,"whatsapp"));N(G=>({...G,sent:G.sent+1})),u({...j,reminderSent:!0}),k.length<=1&&x(!1)}catch(G){console.error("Failed to send reminder:",G),D!=="whatsapp"&&C(j,"whatsapp")}},w=j=>{const D={high:"bg-red-100 text-red-800 hover:bg-red-200 focus:ring-red-300",medium:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200 focus:ring-yellow-300",low:"bg-blue-100 text-blue-800 hover:bg-blue-200 focus:ring-blue-300"};switch(j.type){case"appointment":return e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("button",{onClick:()=>C(j.data,"whatsapp"),className:"w-full flex items-center justify-center gap-2 px-3 py-1 rounded-lg text-sm font-semibold focus:outline-none focus:ring-2 bg-green-100 text-green-800 hover:bg-green-200 focus:ring-green-300",children:[e.jsx(cj,{})," WhatsApp"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>C(j.data,"email"),className:"flex-1 px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",disabled:!j.data.patientId||!i.find(M=>M.id===j.data.patientId)?.email,children:"Email"}),e.jsx("button",{onClick:()=>C(j.data,"sms"),className:"flex-1 px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",disabled:!j.data.patientId||!i.find(M=>M.id===j.data.patientId)?.phone,children:"SMS"})]})]});case"inventory":case"lab":case"low_stock":case"overdue_payment":return e.jsxs("button",{onClick:j.action,className:`mt-2 w-full flex items-center justify-center gap-2 px-3 py-1 rounded-lg text-sm font-semibold focus:outline-none focus:ring-2 ${D[j.priority||"low"]}`,children:[j.type==="inventory"||j.type==="low_stock"?e.jsx(dj,{}):j.type==="lab"?e.jsx(uj,{}):""," ",j.actionLabel]});default:return null}};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(j=>!j),className:"relative p-2 rounded-full hover:bg-slate-200","aria-label":n("reminders.toggleNotifications"),children:[e.jsx(lj,{}),k.length>0&&e.jsx("span",{className:"absolute top-0 end-0 block h-5 w-5 rounded-full bg-red-500 text-white text-xs flex items-center justify-center ring-2 ring-white",children:k.length})]}),f&&e.jsxs("div",{className:"absolute end-0 mt-2 w-96 bg-white rounded-xl shadow-lg border z-20 max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b bg-slate-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-slate-800",children:n("reminders.pendingReminders")}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Sent: ",v.sent," | Opened: ",v.opened]})]})}),k.length>0?e.jsx("ul",{className:"max-h-96 overflow-y-auto",children:k.map(j=>e.jsxs("li",{className:`p-3 hover:bg-slate-50 border-b last:border-b-0 ${j.priority==="high"?"border-l-4 border-l-red-400 bg-red-50/30":j.priority==="medium"?"border-l-4 border-l-yellow-400 bg-yellow-50/30":"border-l-4 border-l-blue-400 bg-blue-50/30"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("p",{className:"font-semibold text-sm",children:j.title}),j.escalationLevel&&j.escalationLevel>0&&e.jsxs("span",{className:"text-xs bg-red-100 text-red-700 px-2 py-1 rounded-full",children:["Level ",j.escalationLevel]})]}),e.jsx("p",{className:"text-xs text-slate-600 mb-2",children:j.description}),w(j)]},j.id))}):e.jsx("p",{className:"p-4 text-center text-sm text-slate-500",children:n("reminders.noPendingReminders")})]})]})},hj=()=>{const[a,s]=q.useState("dashboard"),n=ul(),{t:o,direction:i,locale:c}=Ve(),{isAdmin:u,hasPermission:m,loading:h}=Ss();console.log("App rendering - auth loading:",h),console.log("App rendering - clinic data available:",!!n),q.useEffect(()=>{document.documentElement.lang=c,document.documentElement.dir=i},[i,c]);const y=q.useCallback(()=>{const{userProfile:f}=Ss();switch(a){case"dashboard":return f?.permissions?.includes("view_dashboard")?e.jsx(cp,{clinicData:n,setCurrentView:s}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"patients":return f?.permissions?.includes("view_patients")?e.jsx(kv,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"scheduler":return f?.permissions?.includes("view_scheduler")?e.jsx(Tv,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"doctors":return f?.permissions?.includes("view_patients")?e.jsx(Mv,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"suppliers":return f?.permissions?.includes("view_finance")?e.jsx(Mw,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"inventory":return f?.permissions?.includes("view_finance")?e.jsx(Bw,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"labCases":return f?.permissions?.includes("view_finance")?e.jsx(Vw,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"expenses":return f?.permissions?.includes("view_finance")?e.jsx(Xw,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"treatmentDefinitions":return f?.permissions?.includes("view_finance")?e.jsx(nj,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"reports":return f?.permissions?.includes("view_reports")?e.jsx(mp,{clinicData:n,setCurrentView:s,initialTab:"daily"}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"patientReports":case"doctorReports":case"supplierReports":return f?.permissions?.includes("view_reports")?e.jsx(mp,{clinicData:n,setCurrentView:s,initialTab:"patients"}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"settings":return f?.permissions?.includes("view_dashboard")?e.jsx(oj,{clinicData:n}):e.jsx("div",{className:"text-center py-8",children:"Access denied."});case"userManagement":return u?e.jsx(zv,{}):e.jsx("div",{className:"text-center py-8",children:"Access denied. Admin privileges required."});default:return f?.permissions?.includes("view_dashboard")?e.jsx(cp,{clinicData:n,setCurrentView:s}):e.jsx("div",{className:"text-center py-8",children:"Access denied."})}},[a,n,s]),b={dashboard:o("sidebar.dashboard"),patients:o("patientManagement.title"),scheduler:o("appointmentScheduler.title"),doctors:o("doctorManagement.title"),suppliers:o("suppliersManagement.title"),inventory:o("inventoryManagement.title"),labCases:o("labCasesManagement.title"),expenses:o("expensesManagement.title"),treatmentDefinitions:o("treatmentDefinitionsManagement.title"),reports:o("sidebar.reports"),settings:o("sidebar.settings"),userManagement:"User Management",accountSelection:"Account Selection"};return h?(console.log("Showing loading state - auth still loading"),e.jsx("div",{className:"bg-neutral-light text-slate-800 min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Loading..."})]})})):(console.log("Rendering main app content"),e.jsxs("div",{className:"bg-neutral-light text-slate-800 min-h-screen",children:[e.jsxs("div",{className:"md:flex",children:[e.jsx(Nb,{currentView:a,setCurrentView:s}),e.jsxs("div",{className:"flex-1 flex flex-col w-full print:block",children:[e.jsxs("header",{className:"bg-white shadow-sm p-4 z-10 sticky top-0 md:static print:hidden",children:[" ",e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("img",{src:"/vite.svg",alt:o("appName"),className:"h-8 w-8 me-3 md:hidden"}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-slate-700",children:b[a]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ClinicSwitcher,{}),e.jsx(mj,{clinicData:n,setCurrentView:s})]})]})]}),e.jsxs("main",{className:"flex-1 bg-neutral p-4 md:p-6 pb-24 md:pb-6 print:p-0 print:pb-0 print:block",children:[" ",y()]})]})]}),e.jsx(sw,{currentView:a,setCurrentView:s})]}))},d0=q.createContext(void 0),pj=({children:a})=>{const s={};return e.jsx(d0.Provider,{value:s,children:a})},fj=()=>{const a=q.useContext(d0);if(a===void 0)throw new Error("useClinic must be used within a ClinicProvider");return a};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xj=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,n,o)=>o?o.toUpperCase():n.toLowerCase()),Gp=a=>{const s=xj(a);return s.charAt(0).toUpperCase()+s.slice(1)},u0=(...a)=>a.filter((s,n,o)=>!!s&&s.trim()!==""&&o.indexOf(s)===n).join(" ").trim(),yj=a=>{for(const s in a)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=q.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:i="",children:c,iconNode:u,...m},h)=>q.createElement("svg",{ref:h,...bj,width:s,height:s,stroke:a,strokeWidth:o?Number(n)*24/Number(s):n,className:u0("lucide",i),...!c&&!yj(m)&&{"aria-hidden":"true"},...m},[...u.map(([y,b])=>q.createElement(y,b)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=(a,s)=>{const n=q.forwardRef(({className:o,...i},c)=>q.createElement(vj,{ref:c,iconNode:s,className:u0(`lucide-${gj(Gp(a))}`,`lucide-${a}`,o),...i}));return n.displayName=Gp(a),n};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],jj=Fn("arrow-left",wj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sj=Fn("circle-alert",Nj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kp=Fn("circle-check-big",kj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _j=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ed=Fn("eye-off",_j);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Td=Fn("eye",Cj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Tj=Fn("lock",Ej);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Dd=Fn("mail",Dj),Jp=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21V10.5"})]}),Pj=()=>{const[a,s]=q.useState("login"),[n,o]=q.useState(""),[i,c]=q.useState(""),[u,m]=q.useState(""),[h,y]=q.useState(""),[b,f]=q.useState(!1),[x,v]=q.useState(!1),[N,k]=q.useState(null),[C,w]=q.useState(null),[j,D]=q.useState(!1),[M,I]=q.useState(!1),[_,A]=q.useState({}),[Q,G]=q.useState(!1),re="login_checking",{t:le}=Ve(),{user:he,fetchUserClinics:P,clinics:L,persistSession:z,setInternalUser:ee,login:se,signup:Y,resetPassword:xe,updatePassword:ce,verifyEmail:B}=Ss(),{currentClinic:F,setCurrentClinic:ue,switchClinic:We}=fj();q.useEffect(()=>{console.log("LoginPage: useEffect triggered, user:",he,"clinics.length:",L.length),he&&L.length>0?(console.log("LoginPage: Proceeding with clinics:",L),L.length===1?(ue(L[0]),localStorage.setItem("currentClinicId",L[0].id),window.location.reload()):L.length>1&&I(!0)):console.log("LoginPage: Not proceeding, user or clinics missing")},[he,L,ue]);const Ye=He=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(He),Qe=()=>{const He={};return(a==="login"||a==="signup")&&(n.trim()?Ye(n)||(He.email="Please enter a valid email address"):He.email=le("validation.required"),i.trim()?i.length<6&&(He.password="Password must be at least 6 characters"):He.password=le("validation.required"),a==="signup"&&(u.trim()?i!==u&&(He.confirmPassword="Passwords do not match"):He.confirmPassword=le("validation.required"))),a==="reset-password"&&(n.trim()?Ye(n)||(He.email="Please enter a valid email address"):He.email=le("validation.required")),a==="verify-email"&&(h.trim()||(He.verificationCode="Please enter the verification code")),A(He),Object.keys(He).length===0},Ne=async He=>{if(He.preventDefault(),k(null),w(null),A({}),!!Qe()){if(j||sessionStorage.getItem(re)){console.log("LoginPage: Submission already in progress, ignoring");return}D(!0),sessionStorage.setItem(re,"true");try{if(!me)throw new Error("Supabase is not configured.");if((await se(n,i)).success){w("Login successful! Redirecting..."),await P(),await z();return}const pr=await rb(n,i);if(!pr.success)throw new Error(pr.error);const fr=pr.user;console.log("LoginPage: Authentication successful, user:",fr),sessionStorage.setItem("clinic_user",JSON.stringify({id:fr.id,username:fr.username,role:fr.role,permissions:fr.permissions,loginTime:new Date().toISOString()})),console.log("LoginPage: User data stored in sessionStorage"),console.log("LoginPage: Calling setInternalUser"),ee(fr),console.log("LoginPage: setInternalUser completed"),console.log("LoginPage: Calling fetchUserClinics"),await P(),console.log("LoginPage: fetchUserClinics completed"),console.log("LoginPage: Calling persistSession"),await z(),console.log("LoginPage: persistSession completed"),k(null)}catch(ct){console.error("Login error:",ct),k(ct.message||le("auth.login.errorGeneric"))}finally{D(!1),sessionStorage.removeItem(re)}}},Pe=async He=>{if(He.preventDefault(),k(null),w(null),A({}),!!Qe()){D(!0);try{const ct=await Y(n,i,{username:n});ct.success?(w("Account created successfully! Please check your email for verification."),s("verify-email")):k(ct.error||"Signup failed")}catch(ct){console.error("Signup error:",ct),k(ct.message||"Signup failed")}finally{D(!1)}}},pe=async He=>{if(He.preventDefault(),k(null),w(null),A({}),!!Qe()){D(!0);try{const ct=await B(h);ct.success?(w("Email verified successfully! You can now log in."),s("login"),y("")):k(ct.error||"Email verification failed")}catch(ct){console.error("Email verification error:",ct),k(ct.message||"Email verification failed")}finally{D(!1)}}},Ce=async He=>{if(He.preventDefault(),k(null),w(null),A({}),!!Qe()){D(!0);try{const ct=await xe(n);ct.success?(w("Password reset email sent! Please check your email."),G(!0)):k(ct.error||"Password reset failed")}catch(ct){console.error("Password reset error:",ct),k(ct.message||"Password reset failed")}finally{D(!1)}}},Ie=async He=>{await We(He),window.location.reload()},nt=()=>{o(""),c(""),m(""),y(""),k(null),w(null),A({}),G(!1)},et=He=>{s(He),nt()};if(M)return e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Jp,{}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mt-4",children:le("auth.clinicSelection.title")}),e.jsx("p",{className:"text-slate-500",children:le("auth.clinicSelection.subtitle")})]}),e.jsx("div",{className:"space-y-4",children:L.map(He=>e.jsx("button",{onClick:()=>Ie(He.id),className:"w-full p-4 border border-slate-300 rounded-lg hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-primary transition-colors","aria-label":`${le("auth.clinicSelection.name")}: ${He.name}, ${le("auth.clinicSelection.address")}: ${He.address}`,children:e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-slate-800",children:He.name}),e.jsx("p",{className:"text-sm text-slate-500",children:He.address})]})},He.id))})]})});const Nt=()=>{switch(a){case"login":return e.jsxs("form",{onSubmit:Ne,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700",children:le("auth.login.email")}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"email",type:"email",value:n,onChange:He=>o(He.target.value),required:!0,"aria-invalid":!!_.email,"aria-describedby":_.email?"email-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Enter your email"}),e.jsx(Dd,{className:"absolute right-3 top-2.5 h-4 w-4 text-slate-400"})]}),_.email&&e.jsx("p",{id:"email-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700",children:le("auth.login.password")}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"password",type:b?"text":"password",value:i,onChange:He=>c(He.target.value),required:!0,"aria-invalid":!!_.password,"aria-describedby":_.password?"password-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.password?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:le("auth.login.passwordPlaceholder")}),e.jsx("button",{type:"button",onClick:()=>f(!b),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors","aria-label":b?"Hide password":"Show password",children:b?e.jsx(Ed,{className:"h-4 w-4"}):e.jsx(Td,{className:"h-4 w-4"})})]}),_.password&&e.jsx("p",{id:"password-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.password})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{type:"button",onClick:()=>et("reset-password"),className:"text-sm text-primary hover:text-primary-dark",children:"Forgot password?"})}),e.jsx("button",{type:"submit",disabled:j,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light disabled:bg-primary/50 disabled:cursor-not-allowed transition-colors","aria-describedby":j?"loading-status":void 0,children:j?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),le("auth.login.processing")]}):le("auth.login.loginButton")})]});case"signup":return e.jsxs("form",{onSubmit:Pe,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"signup-email",className:"block text-sm font-medium text-slate-700",children:le("auth.login.email")}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"signup-email",type:"email",value:n,onChange:He=>o(He.target.value),required:!0,"aria-invalid":!!_.email,"aria-describedby":_.email?"signup-email-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Enter your email"}),e.jsx(Dd,{className:"absolute right-3 top-2.5 h-4 w-4 text-slate-400"})]}),_.email&&e.jsx("p",{id:"signup-email-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"signup-password",className:"block text-sm font-medium text-slate-700",children:le("auth.login.password")}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"signup-password",type:b?"text":"password",value:i,onChange:He=>c(He.target.value),required:!0,"aria-invalid":!!_.password,"aria-describedby":_.password?"signup-password-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.password?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Create a password"}),e.jsx("button",{type:"button",onClick:()=>f(!b),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors","aria-label":b?"Hide password":"Show password",children:b?e.jsx(Ed,{className:"h-4 w-4"}):e.jsx(Td,{className:"h-4 w-4"})})]}),_.password&&e.jsx("p",{id:"signup-password-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.password})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-slate-700",children:"Confirm Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"confirm-password",type:x?"text":"password",value:u,onChange:He=>m(He.target.value),required:!0,"aria-invalid":!!_.confirmPassword,"aria-describedby":_.confirmPassword?"confirm-password-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.confirmPassword?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Confirm your password"}),e.jsx("button",{type:"button",onClick:()=>v(!x),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors","aria-label":x?"Hide password":"Show password",children:x?e.jsx(Ed,{className:"h-4 w-4"}):e.jsx(Td,{className:"h-4 w-4"})})]}),_.confirmPassword&&e.jsx("p",{id:"confirm-password-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:j,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light disabled:bg-primary/50 disabled:cursor-not-allowed transition-colors","aria-describedby":j?"loading-status":void 0,children:j?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Account..."]}):le("auth.signup.button")})]});case"verify-email":return e.jsxs("form",{onSubmit:pe,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Kp,{className:"mx-auto h-12 w-12 text-green-500"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Check your email"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["We've sent a verification code to ",n]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"verification-code",className:"block text-sm font-medium text-slate-700",children:"Verification Code"}),e.jsx("input",{id:"verification-code",type:"text",value:h,onChange:He=>y(He.target.value),required:!0,"aria-invalid":!!_.verificationCode,"aria-describedby":_.verificationCode?"verification-code-error":void 0,className:`mt-1 block w-full px-3 py-2 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                  focus:outline-none focus:ring-1 transition-colors ${_.verificationCode?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Enter verification code"}),_.verificationCode&&e.jsx("p",{id:"verification-code-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.verificationCode})]}),e.jsx("button",{type:"submit",disabled:j,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light disabled:bg-primary/50 disabled:cursor-not-allowed transition-colors",children:j?"Verifying...":"Verify Email"})]});case"reset-password":return e.jsxs("form",{onSubmit:Ce,className:"space-y-6",noValidate:!0,children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Tj,{className:"mx-auto h-12 w-12 text-blue-500"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Reset your password"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Enter your email address and we'll send you a link to reset your password."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reset-email",className:"block text-sm font-medium text-slate-700",children:le("auth.login.email")}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("input",{id:"reset-email",type:"email",value:n,onChange:He=>o(He.target.value),required:!0,"aria-invalid":!!_.email,"aria-describedby":_.email?"reset-email-error":void 0,className:`block w-full px-3 py-2 pr-10 bg-white border rounded-md text-sm shadow-sm placeholder-slate-400
                    focus:outline-none focus:ring-1 transition-colors ${_.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-slate-300 focus:border-primary focus:ring-primary"}`,placeholder:"Enter your email"}),e.jsx(Dd,{className:"absolute right-3 top-2.5 h-4 w-4 text-slate-400"})]}),_.email&&e.jsx("p",{id:"reset-email-error",className:"mt-1 text-sm text-red-600",role:"alert",children:_.email})]}),e.jsx("button",{type:"submit",disabled:j||Q,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light disabled:bg-primary/50 disabled:cursor-not-allowed transition-colors",children:j?"Sending...":Q?"Email Sent":"Send Reset Link"})]});default:return null}};return e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Jp,{}),e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 mt-4",children:[a==="login"&&le("auth.login.title"),a==="signup"&&le("auth.signup.title"),a==="verify-email"&&"Verify Email",a==="reset-password"&&"Reset Password"]}),e.jsxs("p",{className:"text-slate-500",children:[a==="login"&&le("auth.login.subtitle"),a==="signup"&&"Create your account to get started",a==="verify-email"&&"Complete your account setup",a==="reset-password"&&"Recover your account"]})]}),(N||C)&&e.jsx("div",{className:`border rounded-lg p-4 ${N?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex",children:[N?e.jsx(Sj,{className:"h-5 w-5 text-red-400"}):e.jsx(Kp,{className:"h-5 w-5 text-green-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:`text-sm ${N?"text-red-800":"text-green-800"}`,children:N||C})})]})}),Nt(),e.jsxs("div",{className:"flex justify-center space-x-4",children:[a==="login"&&e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",onClick:()=>et("signup"),className:"text-sm text-primary hover:text-primary-dark",children:le("auth.login.noAccount")})}),(a==="signup"||a==="verify-email"||a==="reset-password")&&e.jsxs("button",{type:"button",onClick:()=>et("login"),className:"flex items-center text-sm text-primary hover:text-primary-dark",children:[e.jsx(jj,{className:"h-4 w-4 mr-1"}),"Back to Login"]})]}),j&&e.jsx("div",{id:"loading-status",className:"sr-only","aria-live":"polite",children:"Processing your request, please wait..."})]})})},Ij=()=>{const{t:a}=Ve();return e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-2xl bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600",children:a("auth.config.title")}),e.jsx("p",{className:"text-slate-600 mt-2",children:a("auth.config.message")})]}),e.jsxs("div",{className:"text-sm text-slate-700 bg-slate-100 p-4 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:a("auth.config.instructions")}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Open the `backend_setup.md` file."}),e.jsx("li",{children:"Follow the steps to create a free Supabase project."}),e.jsx("li",{children:"Copy your project's URL and anon key."}),e.jsx("li",{children:"Add them as secrets named `SUPABASE_URL` and `SUPABASE_ANON_KEY` in your environment."})]})]})]})})},Rj=()=>{const{user:a,loading:s}=Ss(),[n,o]=q.useState(null),i="authapp_checking_users";console.log("AuthApp: Component render - user:",!!a,"loading:",s,"hasUsers:",n),q.useEffect(()=>{console.log("AuthApp: useEffect running - checking for infinite loop"),(async()=>{if(console.log("AuthApp: Starting checkExistingUsers"),sessionStorage.getItem(i)){console.log("AuthApp: checkExistingUsers already running, skipping");return}if(sessionStorage.setItem(i,"true"),console.log("AuthApp: Set checking key, proceeding"),!me){console.log("AuthApp: Supabase not configured, setting hasUsers to false"),o(!1),sessionStorage.removeItem(i);return}try{console.log("AuthApp: Preparing query to user_profiles");const m=me.from("user_profiles").select("id").limit(1),h=new Promise((f,x)=>{console.log("AuthApp: Setting up 5s timeout"),setTimeout(()=>{console.log("AuthApp: Timeout reached, rejecting"),x(new Error("Request timeout"))},5e3)});console.log("AuthApp: Starting Promise.race");const{data:y,error:b}=await Promise.race([m,h]);if(console.log("AuthApp: Promise.race resolved",{data:y,error:b}),b)if(console.log("AuthApp: Query returned error",b),b.code==="PGRST116"||b.message.includes("permission denied")||b.message.includes("does not exist"))console.log("AuthApp: Table does not exist or permission denied, setting hasUsers to false"),o(!1);else throw console.log("AuthApp: Unexpected error, throwing"),b;else{const f=y&&y.length>0;console.log("AuthApp: Query successful, usersExist:",f),o(f)}}catch(m){console.log("AuthApp: Caught error in checkExistingUsers",m),console.warn("User check failed, defaulting to setup mode:",m),o(!1)}finally{console.log("AuthApp: Removing checking key"),sessionStorage.removeItem(i)}})()},[]);const c=()=>{const{t:u}=Ve(),[m,h]=q.useState({username:"admin",password:"123",confirmPassword:"123"}),[y,b]=q.useState(!1),[f,x]=q.useState(null),[v,N]=q.useState(null),k=async C=>{if(C.preventDefault(),x(null),N(null),m.password!==m.confirmPassword){x("Passwords do not match");return}if(m.password.length<3){x("Password must be at least 3 characters long");return}b(!0);try{if(!me)throw new Error("Supabase is not configured.");const w=crypto.randomUUID();console.log("Creating first admin user with username:",m.username);const{error:j}=await me.from("user_profiles").insert({id:w,user_id:null,username:m.username,role:$t.ADMIN,permissions:["view_dashboard","manage_users","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports","view_finance","edit_finance"]});if(j)throw j;N("Admin user created successfully! You can now log in."),setTimeout(()=>{sessionStorage.setItem("clinic_user",JSON.stringify({id:w,username:m.username,role:$t.ADMIN,permissions:["view_dashboard","manage_users","view_patients","edit_patients","view_scheduler","edit_scheduler","view_reports","view_finance","edit_finance"],loginTime:new Date().toISOString()})),window.location.reload()},2e3)}catch(w){x(w.message||"Failed to create admin user")}finally{b(!1)}};return e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-xl p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"h-16 w-16 bg-primary rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mt-4",children:"Setup First Admin"}),e.jsx("p",{className:"text-slate-500 text-center",children:"Create the first administrator account for your clinic management system"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-4 text-sm text-blue-800",children:[e.jsx("p",{className:"font-semibold",children:"Default Credentials:"}),e.jsx("p",{children:"Username: admin"}),e.jsx("p",{children:"Password: 123"}),e.jsx("p",{className:"text-xs mt-1",children:"You can change these later in User Management"})]})]}),e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[f&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:f})}),v&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg relative",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:v})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:m.username,onChange:C=>h({...m,username:C.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary",placeholder:"Enter admin username"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:m.password,onChange:C=>h({...m,password:C.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary",placeholder:""})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:"password",value:m.confirmPassword,onChange:C=>h({...m,confirmPassword:C.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary",placeholder:""})]}),e.jsx("button",{type:"submit",disabled:y,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light disabled:bg-primary/50",children:y?"Creating Admin User...":"Create Admin User"})]})]})})};return s?e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Authenticating..."})]})}):me?(console.log("AuthApp: user present:",!!a,"loading:",s),a?(console.log("AuthApp: Rendering App component"),e.jsx(hj,{})):n===null?e.jsx("div",{className:"min-h-screen bg-neutral-light flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Checking system setup..."})]})}):n?e.jsx(Pj,{}):e.jsx(c,{})):e.jsx(Ij,{})},m0=document.getElementById("root");if(!m0)throw new Error("Could not find root element to mount to");const Aj=Yp.createRoot(m0);Aj.render(e.jsx(Jd.StrictMode,{children:e.jsx(Vf,{children:e.jsx(Kf,{children:e.jsx(Yf,{children:e.jsxs(pj,{children:[e.jsx(Rj,{}),e.jsx(e0,{})]})})})})}));
